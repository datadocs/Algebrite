"use strict";(()=>{var A=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var No=A(($U,Mu)=>{var Ft=function(e){"use strict";var t=1e7,r=7,n=9007199254740992,o=T(n),i="0123456789abcdefghijklmnopqrstuvwxyz",s=typeof BigInt=="function";function u(f,m,b,q){return typeof f>"u"?u[0]:typeof m<"u"?+m==10&&!b?Ee(f):jx(f,m,b,q):Ee(f)}function c(f,m){this.value=f,this.sign=m,this.isSmall=!1}c.prototype=Object.create(u.prototype);function d(f){this.value=f,this.sign=f<0,this.isSmall=!0}d.prototype=Object.create(u.prototype);function _(f){this.value=f}_.prototype=Object.create(u.prototype);function R(f){return-n<f&&f<n}function T(f){return f<1e7?[f]:f<1e14?[f%1e7,Math.floor(f/1e7)]:[f%1e7,Math.floor(f/1e7)%1e7,Math.floor(f/1e14)]}function k(f){Z(f);var m=f.length;if(m<4&&Zn(f,o)<0)switch(m){case 0:return 0;case 1:return f[0];case 2:return f[0]+f[1]*t;default:return f[0]+(f[1]+f[2]*t)*t}return f}function Z(f){for(var m=f.length;f[--m]===0;);f.length=m+1}function Y(f){for(var m=new Array(f),b=-1;++b<f;)m[b]=0;return m}function Oe(f){return f>0?Math.floor(f):Math.ceil(f)}function tt(f,m){var b=f.length,q=m.length,O=new Array(b),x=0,P=t,L,$;for($=0;$<q;$++)L=f[$]+m[$]+x,x=L>=P?1:0,O[$]=L-x*P;for(;$<b;)L=f[$]+x,x=L===P?1:0,O[$++]=L-x*P;return x>0&&O.push(x),O}function Ze(f,m){return f.length>=m.length?tt(f,m):tt(m,f)}function ke(f,m){var b=f.length,q=new Array(b),O=t,x,P;for(P=0;P<b;P++)x=f[P]-O+m,m=Math.floor(x/O),q[P]=x-m*O,m+=1;for(;m>0;)q[P++]=m%O,m=Math.floor(m/O);return q}c.prototype.add=function(f){var m=Ee(f);if(this.sign!==m.sign)return this.subtract(m.negate());var b=this.value,q=m.value;return m.isSmall?new c(ke(b,Math.abs(q)),this.sign):new c(Ze(b,q),this.sign)},c.prototype.plus=c.prototype.add,d.prototype.add=function(f){var m=Ee(f),b=this.value;if(b<0!==m.sign)return this.subtract(m.negate());var q=m.value;if(m.isSmall){if(R(b+q))return new d(b+q);q=T(Math.abs(q))}return new c(ke(q,Math.abs(b)),b<0)},d.prototype.plus=d.prototype.add,_.prototype.add=function(f){return new _(this.value+Ee(f).value)},_.prototype.plus=_.prototype.add;function st(f,m){var b=f.length,q=m.length,O=new Array(b),x=0,P=t,L,$;for(L=0;L<q;L++)$=f[L]-x-m[L],$<0?($+=P,x=1):x=0,O[L]=$;for(L=q;L<b;L++){if($=f[L]-x,$<0)$+=P;else{O[L++]=$;break}O[L]=$}for(;L<b;L++)O[L]=f[L];return Z(O),O}function Me(f,m,b){var q;return Zn(f,m)>=0?q=st(f,m):(q=st(m,f),b=!b),q=k(q),typeof q=="number"?(b&&(q=-q),new d(q)):new c(q,b)}function at(f,m,b){var q=f.length,O=new Array(q),x=-m,P=t,L,$;for(L=0;L<q;L++)$=f[L]+x,x=Math.floor($/P),$%=P,O[L]=$<0?$+P:$;return O=k(O),typeof O=="number"?(b&&(O=-O),new d(O)):new c(O,b)}c.prototype.subtract=function(f){var m=Ee(f);if(this.sign!==m.sign)return this.add(m.negate());var b=this.value,q=m.value;return m.isSmall?at(b,Math.abs(q),this.sign):Me(b,q,this.sign)},c.prototype.minus=c.prototype.subtract,d.prototype.subtract=function(f){var m=Ee(f),b=this.value;if(b<0!==m.sign)return this.add(m.negate());var q=m.value;return m.isSmall?new d(b-q):at(q,Math.abs(b),b>=0)},d.prototype.minus=d.prototype.subtract,_.prototype.subtract=function(f){return new _(this.value-Ee(f).value)},_.prototype.minus=_.prototype.subtract,c.prototype.negate=function(){return new c(this.value,!this.sign)},d.prototype.negate=function(){var f=this.sign,m=new d(-this.value);return m.sign=!f,m},_.prototype.negate=function(){return new _(-this.value)},c.prototype.abs=function(){return new c(this.value,!1)},d.prototype.abs=function(){return new d(Math.abs(this.value))},_.prototype.abs=function(){return new _(this.value>=0?this.value:-this.value)};function ir(f,m){var b=f.length,q=m.length,O=b+q,x=Y(O),P=t,L,$,pe,Fe,Te;for(pe=0;pe<b;++pe){Fe=f[pe];for(var nt=0;nt<q;++nt)Te=m[nt],L=Fe*Te+x[pe+nt],$=Math.floor(L/P),x[pe+nt]=L-$*P,x[pe+nt+1]+=$}return Z(x),x}function Gt(f,m){var b=f.length,q=new Array(b),O=t,x=0,P,L;for(L=0;L<b;L++)P=f[L]*m+x,x=Math.floor(P/O),q[L]=P-x*O;for(;x>0;)q[L++]=x%O,x=Math.floor(x/O);return q}function qr(f,m){for(var b=[];m-- >0;)b.push(0);return b.concat(f)}function It(f,m){var b=Math.max(f.length,m.length);if(b<=30)return ir(f,m);b=Math.ceil(b/2);var q=f.slice(b),O=f.slice(0,b),x=m.slice(b),P=m.slice(0,b),L=It(O,P),$=It(q,x),pe=It(Ze(O,q),Ze(P,x)),Fe=Ze(Ze(L,qr(st(st(pe,L),$),b)),qr($,2*b));return Z(Fe),Fe}function fi(f,m){return-.012*f-.012*m+15e-6*f*m>0}c.prototype.multiply=function(f){var m=Ee(f),b=this.value,q=m.value,O=this.sign!==m.sign,x;if(m.isSmall){if(q===0)return u[0];if(q===1)return this;if(q===-1)return this.negate();if(x=Math.abs(q),x<t)return new c(Gt(b,x),O);q=T(x)}return fi(b.length,q.length)?new c(It(b,q),O):new c(ir(b,q),O)},c.prototype.times=c.prototype.multiply;function Vn(f,m,b){return f<t?new c(Gt(m,f),b):new c(ir(m,T(f)),b)}d.prototype._multiplyBySmall=function(f){return R(f.value*this.value)?new d(f.value*this.value):Vn(Math.abs(f.value),T(Math.abs(this.value)),this.sign!==f.sign)},c.prototype._multiplyBySmall=function(f){return f.value===0?u[0]:f.value===1?this:f.value===-1?this.negate():Vn(Math.abs(f.value),this.value,this.sign!==f.sign)},d.prototype.multiply=function(f){return Ee(f)._multiplyBySmall(this)},d.prototype.times=d.prototype.multiply,_.prototype.multiply=function(f){return new _(this.value*Ee(f).value)},_.prototype.times=_.prototype.multiply;function el(f){var m=f.length,b=Y(m+m),q=t,O,x,P,L,$;for(P=0;P<m;P++){L=f[P],x=0-L*L;for(var pe=P;pe<m;pe++)$=f[pe],O=2*(L*$)+b[P+pe]+x,x=Math.floor(O/q),b[P+pe]=O-x*q;b[P+m]=x}return Z(b),b}c.prototype.square=function(){return new c(el(this.value),!1)},d.prototype.square=function(){var f=this.value*this.value;return R(f)?new d(f):new c(el(T(Math.abs(this.value))),!1)},_.prototype.square=function(f){return new _(this.value*this.value)};function xu(f,m){var b=f.length,q=m.length,O=t,x=Y(m.length),P=m[q-1],L=Math.ceil(O/(2*P)),$=Gt(f,L),pe=Gt(m,L),Fe,Te,nt,Lr,Ar,Sd,Rd;for($.length<=b&&$.push(0),pe.push(0),P=pe[q-1],Te=b-q;Te>=0;Te--){for(Fe=O-1,$[Te+q]!==P&&(Fe=Math.floor(($[Te+q]*O+$[Te+q-1])/P)),nt=0,Lr=0,Sd=pe.length,Ar=0;Ar<Sd;Ar++)nt+=Fe*pe[Ar],Rd=Math.floor(nt/O),Lr+=$[Te+Ar]-(nt-Rd*O),nt=Rd,Lr<0?($[Te+Ar]=Lr+O,Lr=-1):($[Te+Ar]=Lr,Lr=0);for(;Lr!==0;){for(Fe-=1,nt=0,Ar=0;Ar<Sd;Ar++)nt+=$[Te+Ar]-O+pe[Ar],nt<0?($[Te+Ar]=nt+O,nt=0):($[Te+Ar]=nt,nt=1);Lr+=nt}x[Te]=Fe}return $=tl($,L)[0],[k(x),k($)]}function pu(f,m){for(var b=f.length,q=m.length,O=[],x=[],P=t,L,$,pe,Fe,Te;b;){if(x.unshift(f[--b]),Z(x),Zn(x,m)<0){O.push(0);continue}$=x.length,pe=x[$-1]*P+x[$-2],Fe=m[q-1]*P+m[q-2],$>q&&(pe=(pe+1)*P),L=Math.ceil(pe/Fe);do{if(Te=Gt(m,L),Zn(Te,x)<=0)break;L--}while(L);O.push(L),x=st(x,Te)}return O.reverse(),[k(O),k(x)]}function tl(f,m){var b=f.length,q=Y(b),O=t,x,P,L,$;for(L=0,x=b-1;x>=0;--x)$=L*O+f[x],P=Oe($/m),L=$-P*m,q[x]=P|0;return[q,L|0]}function nn(f,m){var b,q=Ee(m);if(s)return[new _(f.value/q.value),new _(f.value%q.value)];var O=f.value,x=q.value,P;if(x===0)throw new Error("Cannot divide by zero");if(f.isSmall)return q.isSmall?[new d(Oe(O/x)),new d(O%x)]:[u[0],f];if(q.isSmall){if(x===1)return[f,u[0]];if(x==-1)return[f.negate(),u[0]];var L=Math.abs(x);if(L<t){b=tl(O,L),P=k(b[0]);var $=b[1];return f.sign&&($=-$),typeof P=="number"?(f.sign!==q.sign&&(P=-P),[new d(P),new d($)]):[new c(P,f.sign!==q.sign),new d($)]}x=T(L)}var pe=Zn(O,x);if(pe===-1)return[u[0],f];if(pe===0)return[u[f.sign===q.sign?1:-1],u[0]];O.length+x.length<=200?b=xu(O,x):b=pu(O,x),P=b[0];var Fe=f.sign!==q.sign,Te=b[1],nt=f.sign;return typeof P=="number"?(Fe&&(P=-P),P=new d(P)):P=new c(P,Fe),typeof Te=="number"?(nt&&(Te=-Te),Te=new d(Te)):Te=new c(Te,nt),[P,Te]}c.prototype.divmod=function(f){var m=nn(this,f);return{quotient:m[0],remainder:m[1]}},_.prototype.divmod=d.prototype.divmod=c.prototype.divmod,c.prototype.divide=function(f){return nn(this,f)[0]},_.prototype.over=_.prototype.divide=function(f){return new _(this.value/Ee(f).value)},d.prototype.over=d.prototype.divide=c.prototype.over=c.prototype.divide,c.prototype.mod=function(f){return nn(this,f)[1]},_.prototype.mod=_.prototype.remainder=function(f){return new _(this.value%Ee(f).value)},d.prototype.remainder=d.prototype.mod=c.prototype.remainder=c.prototype.mod,c.prototype.pow=function(f){var m=Ee(f),b=this.value,q=m.value,O,x,P;if(q===0)return u[1];if(b===0)return u[0];if(b===1)return u[1];if(b===-1)return m.isEven()?u[1]:u[-1];if(m.sign)return u[0];if(!m.isSmall)throw new Error("The exponent "+m.toString()+" is too large.");if(this.isSmall&&R(O=Math.pow(b,q)))return new d(Oe(O));for(x=this,P=u[1];q&!0&&(P=P.times(x),--q),q!==0;)q/=2,x=x.square();return P},d.prototype.pow=c.prototype.pow,_.prototype.pow=function(f){var m=Ee(f),b=this.value,q=m.value,O=BigInt(0),x=BigInt(1),P=BigInt(2);if(q===O)return u[1];if(b===O)return u[0];if(b===x)return u[1];if(b===BigInt(-1))return m.isEven()?u[1]:u[-1];if(m.isNegative())return new _(O);for(var L=this,$=u[1];(q&x)===x&&($=$.times(L),--q),q!==O;)q/=P,L=L.square();return $},c.prototype.modPow=function(f,m){if(f=Ee(f),m=Ee(m),m.isZero())throw new Error("Cannot take modPow with modulus 0");var b=u[1],q=this.mod(m);for(f.isNegative()&&(f=f.multiply(u[-1]),q=q.modInv(m));f.isPositive();){if(q.isZero())return u[0];f.isOdd()&&(b=b.multiply(q).mod(m)),f=f.divide(2),q=q.square().mod(m)}return b},_.prototype.modPow=d.prototype.modPow=c.prototype.modPow;function Zn(f,m){if(f.length!==m.length)return f.length>m.length?1:-1;for(var b=f.length-1;b>=0;b--)if(f[b]!==m[b])return f[b]>m[b]?1:-1;return 0}c.prototype.compareAbs=function(f){var m=Ee(f),b=this.value,q=m.value;return m.isSmall?1:Zn(b,q)},d.prototype.compareAbs=function(f){var m=Ee(f),b=Math.abs(this.value),q=m.value;return m.isSmall?(q=Math.abs(q),b===q?0:b>q?1:-1):-1},_.prototype.compareAbs=function(f){var m=this.value,b=Ee(f).value;return m=m>=0?m:-m,b=b>=0?b:-b,m===b?0:m>b?1:-1},c.prototype.compare=function(f){if(f===1/0)return-1;if(f===-1/0)return 1;var m=Ee(f),b=this.value,q=m.value;return this.sign!==m.sign?m.sign?1:-1:m.isSmall?this.sign?-1:1:Zn(b,q)*(this.sign?-1:1)},c.prototype.compareTo=c.prototype.compare,d.prototype.compare=function(f){if(f===1/0)return-1;if(f===-1/0)return 1;var m=Ee(f),b=this.value,q=m.value;return m.isSmall?b==q?0:b>q?1:-1:b<0!==m.sign?b<0?-1:1:b<0?1:-1},d.prototype.compareTo=d.prototype.compare,_.prototype.compare=function(f){if(f===1/0)return-1;if(f===-1/0)return 1;var m=this.value,b=Ee(f).value;return m===b?0:m>b?1:-1},_.prototype.compareTo=_.prototype.compare,c.prototype.equals=function(f){return this.compare(f)===0},_.prototype.eq=_.prototype.equals=d.prototype.eq=d.prototype.equals=c.prototype.eq=c.prototype.equals,c.prototype.notEquals=function(f){return this.compare(f)!==0},_.prototype.neq=_.prototype.notEquals=d.prototype.neq=d.prototype.notEquals=c.prototype.neq=c.prototype.notEquals,c.prototype.greater=function(f){return this.compare(f)>0},_.prototype.gt=_.prototype.greater=d.prototype.gt=d.prototype.greater=c.prototype.gt=c.prototype.greater,c.prototype.lesser=function(f){return this.compare(f)<0},_.prototype.lt=_.prototype.lesser=d.prototype.lt=d.prototype.lesser=c.prototype.lt=c.prototype.lesser,c.prototype.greaterOrEquals=function(f){return this.compare(f)>=0},_.prototype.geq=_.prototype.greaterOrEquals=d.prototype.geq=d.prototype.greaterOrEquals=c.prototype.geq=c.prototype.greaterOrEquals,c.prototype.lesserOrEquals=function(f){return this.compare(f)<=0},_.prototype.leq=_.prototype.lesserOrEquals=d.prototype.leq=d.prototype.lesserOrEquals=c.prototype.leq=c.prototype.lesserOrEquals,c.prototype.isEven=function(){return(this.value[0]&1)===0},d.prototype.isEven=function(){return(this.value&1)===0},_.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},c.prototype.isOdd=function(){return(this.value[0]&1)===1},d.prototype.isOdd=function(){return(this.value&1)===1},_.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},c.prototype.isPositive=function(){return!this.sign},d.prototype.isPositive=function(){return this.value>0},_.prototype.isPositive=d.prototype.isPositive,c.prototype.isNegative=function(){return this.sign},d.prototype.isNegative=function(){return this.value<0},_.prototype.isNegative=d.prototype.isNegative,c.prototype.isUnit=function(){return!1},d.prototype.isUnit=function(){return Math.abs(this.value)===1},_.prototype.isUnit=function(){return this.abs().value===BigInt(1)},c.prototype.isZero=function(){return!1},d.prototype.isZero=function(){return this.value===0},_.prototype.isZero=function(){return this.value===BigInt(0)},c.prototype.isDivisibleBy=function(f){var m=Ee(f);return m.isZero()?!1:m.isUnit()?!0:m.compareAbs(2)===0?this.isEven():this.mod(m).isZero()},_.prototype.isDivisibleBy=d.prototype.isDivisibleBy=c.prototype.isDivisibleBy;function hu(f){var m=f.abs();if(m.isUnit())return!1;if(m.equals(2)||m.equals(3)||m.equals(5))return!0;if(m.isEven()||m.isDivisibleBy(3)||m.isDivisibleBy(5))return!1;if(m.lesser(49))return!0}function rl(f,m){for(var b=f.prev(),q=b,O=0,x,P,L,$;q.isEven();)q=q.divide(2),O++;e:for(L=0;L<m.length;L++)if(!f.lesser(m[L])&&($=Ft(m[L]).modPow(q,f),!($.isUnit()||$.equals(b)))){for(x=O-1;x!=0;x--){if($=$.square().mod(f),$.isUnit())return!1;if($.equals(b))continue e}return!1}return!0}c.prototype.isPrime=function(f){var m=hu(this);if(m!==e)return m;var b=this.abs(),q=b.bitLength();if(q<=64)return rl(b,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var O=Math.log(2)*q.toJSNumber(),x=Math.ceil(f===!0?2*Math.pow(O,2):O),P=[],L=0;L<x;L++)P.push(Ft(L+2));return rl(b,P)},_.prototype.isPrime=d.prototype.isPrime=c.prototype.isPrime,c.prototype.isProbablePrime=function(f,m){var b=hu(this);if(b!==e)return b;for(var q=this.abs(),O=f===e?5:f,x=[],P=0;P<O;P++)x.push(Ft.randBetween(2,q.minus(2),m));return rl(q,x)},_.prototype.isProbablePrime=d.prototype.isProbablePrime=c.prototype.isProbablePrime,c.prototype.modInv=function(f){for(var m=Ft.zero,b=Ft.one,q=Ee(f),O=this.abs(),x,P,L;!O.isZero();)x=q.divide(O),P=m,L=q,m=b,q=O,b=P.subtract(x.multiply(b)),O=L.subtract(x.multiply(O));if(!q.isUnit())throw new Error(this.toString()+" and "+f.toString()+" are not co-prime");return m.compare(0)===-1&&(m=m.add(f)),this.isNegative()?m.negate():m},_.prototype.modInv=d.prototype.modInv=c.prototype.modInv,c.prototype.next=function(){var f=this.value;return this.sign?at(f,1,this.sign):new c(ke(f,1),this.sign)},d.prototype.next=function(){var f=this.value;return f+1<n?new d(f+1):new c(o,!1)},_.prototype.next=function(){return new _(this.value+BigInt(1))},c.prototype.prev=function(){var f=this.value;return this.sign?new c(ke(f,1),!0):at(f,1,this.sign)},d.prototype.prev=function(){var f=this.value;return f-1>-n?new d(f-1):new c(o,!0)},_.prototype.prev=function(){return new _(this.value-BigInt(1))};for(var on=[1];2*on[on.length-1]<=t;)on.push(2*on[on.length-1]);var di=on.length,Xn=on[di-1];function Au(f){return Math.abs(f)<=t}c.prototype.shiftLeft=function(f){var m=Ee(f).toJSNumber();if(!Au(m))throw new Error(String(m)+" is too large for shifting.");if(m<0)return this.shiftRight(-m);var b=this;if(b.isZero())return b;for(;m>=di;)b=b.multiply(Xn),m-=di-1;return b.multiply(on[m])},_.prototype.shiftLeft=d.prototype.shiftLeft=c.prototype.shiftLeft,c.prototype.shiftRight=function(f){var m,b=Ee(f).toJSNumber();if(!Au(b))throw new Error(String(b)+" is too large for shifting.");if(b<0)return this.shiftLeft(-b);for(var q=this;b>=di;){if(q.isZero()||q.isNegative()&&q.isUnit())return q;m=nn(q,Xn),q=m[1].isNegative()?m[0].prev():m[0],b-=di-1}return m=nn(q,on[b]),m[1].isNegative()?m[0].prev():m[0]},_.prototype.shiftRight=d.prototype.shiftRight=c.prototype.shiftRight;function nl(f,m,b){m=Ee(m);for(var q=f.isNegative(),O=m.isNegative(),x=q?f.not():f,P=O?m.not():m,L=0,$=0,pe=null,Fe=null,Te=[];!x.isZero()||!P.isZero();)pe=nn(x,Xn),L=pe[1].toJSNumber(),q&&(L=Xn-1-L),Fe=nn(P,Xn),$=Fe[1].toJSNumber(),O&&($=Xn-1-$),x=pe[0],P=Fe[0],Te.push(b(L,$));for(var nt=b(q?1:0,O?1:0)!==0?Ft(-1):Ft(0),Lr=Te.length-1;Lr>=0;Lr-=1)nt=nt.multiply(Xn).add(Ft(Te[Lr]));return nt}c.prototype.not=function(){return this.negate().prev()},_.prototype.not=d.prototype.not=c.prototype.not,c.prototype.and=function(f){return nl(this,f,function(m,b){return m&b})},_.prototype.and=d.prototype.and=c.prototype.and,c.prototype.or=function(f){return nl(this,f,function(m,b){return m|b})},_.prototype.or=d.prototype.or=c.prototype.or,c.prototype.xor=function(f){return nl(this,f,function(m,b){return m^b})},_.prototype.xor=d.prototype.xor=c.prototype.xor;var ol=1<<30,Id=(t&-t)*(t&-t)|ol;function os(f){var m=f.value,b=typeof m=="number"?m|ol:typeof m=="bigint"?m|BigInt(ol):m[0]+m[1]*t|Id;return b&-b}function Ou(f,m){if(m.compareTo(f)<=0){var b=Ou(f,m.square(m)),q=b.p,O=b.e,x=q.multiply(m);return x.compareTo(f)<=0?{p:x,e:O*2+1}:{p:q,e:O*2}}return{p:Ft(1),e:0}}c.prototype.bitLength=function(){var f=this;return f.compareTo(Ft(0))<0&&(f=f.negate().subtract(Ft(1))),f.compareTo(Ft(0))===0?Ft(0):Ft(Ou(f,Ft(2)).e).add(Ft(1))},_.prototype.bitLength=d.prototype.bitLength=c.prototype.bitLength;function il(f,m){return f=Ee(f),m=Ee(m),f.greater(m)?f:m}function is(f,m){return f=Ee(f),m=Ee(m),f.lesser(m)?f:m}function Xb(f,m){if(f=Ee(f).abs(),m=Ee(m).abs(),f.equals(m))return f;if(f.isZero())return m;if(m.isZero())return f;for(var b=u[1],q,O;f.isEven()&&m.isEven();)q=is(os(f),os(m)),f=f.divide(q),m=m.divide(q),b=b.multiply(q);for(;f.isEven();)f=f.divide(os(f));do{for(;m.isEven();)m=m.divide(os(m));f.greater(m)&&(O=m,m=f,f=O),m=m.subtract(f)}while(!m.isZero());return b.isUnit()?f:f.multiply(b)}function Gx(f,m){return f=Ee(f).abs(),m=Ee(m).abs(),f.divide(Xb(f,m)).multiply(m)}function Fx(f,m,b){f=Ee(f),m=Ee(m);var q=b||Math.random,O=is(f,m),x=il(f,m),P=x.subtract(O).add(1);if(P.isSmall)return O.add(Math.floor(q()*P));for(var L=sl(P,t).value,$=[],pe=!0,Fe=0;Fe<L.length;Fe++){var Te=pe?L[Fe]+(Fe+1<L.length?L[Fe+1]/t:0):t,nt=Oe(q()*Te);$.push(nt),nt<L[Fe]&&(pe=!1)}return O.add(u.fromArray($,t,!1))}var jx=function(f,m,b,q){b=b||i,f=String(f),q||(f=f.toLowerCase(),b=b.toLowerCase());var O=f.length,x,P=Math.abs(m),L={};for(x=0;x<b.length;x++)L[b[x]]=x;for(x=0;x<O;x++){var $=f[x];if($!=="-"&&$ in L&&L[$]>=P){if($==="1"&&P===1)continue;throw new Error($+" is not a valid digit in base "+m+".")}}m=Ee(m);var pe=[],Fe=f[0]==="-";for(x=Fe?1:0;x<f.length;x++){var $=f[x];if($ in L)pe.push(Ee(L[$]));else if($==="<"){var Te=x;do x++;while(f[x]!==">"&&x<f.length);pe.push(Ee(f.slice(Te+1,x)))}else throw new Error($+" is not a valid character")}return Hb(pe,m,Fe)};function Hb(f,m,b){var q=u[0],O=u[1],x;for(x=f.length-1;x>=0;x--)q=q.add(f[x].times(O)),O=O.times(m);return b?q.negate():q}function zx(f,m){return m=m||i,f<m.length?m[f]:"<"+f+">"}function sl(f,m){if(m=Ft(m),m.isZero()){if(f.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(m.equals(-1)){if(f.isZero())return{value:[0],isNegative:!1};if(f.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-f.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var b=Array.apply(null,Array(f.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return b.unshift([1]),{value:[].concat.apply([],b),isNegative:!1}}var q=!1;if(f.isNegative()&&m.isPositive()&&(q=!0,f=f.abs()),m.isUnit())return f.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(f.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:q};for(var O=[],x=f,P;x.isNegative()||x.compareAbs(m)>=0;){P=x.divmod(m),x=P.quotient;var L=P.remainder;L.isNegative()&&(L=m.minus(L).abs(),x=x.next()),O.push(L.toJSNumber())}return O.push(x.toJSNumber()),{value:O.reverse(),isNegative:q}}function Qb(f,m,b){var q=sl(f,m);return(q.isNegative?"-":"")+q.value.map(function(O){return zx(O,b)}).join("")}c.prototype.toArray=function(f){return sl(this,f)},d.prototype.toArray=function(f){return sl(this,f)},_.prototype.toArray=function(f){return sl(this,f)},c.prototype.toString=function(f,m){if(f===e&&(f=10),f!==10)return Qb(this,f,m);for(var b=this.value,q=b.length,O=String(b[--q]),x="0000000",P;--q>=0;)P=String(b[q]),O+=x.slice(P.length)+P;var L=this.sign?"-":"";return L+O},d.prototype.toString=function(f,m){return f===e&&(f=10),f!=10?Qb(this,f,m):String(this.value)},_.prototype.toString=d.prototype.toString,_.prototype.toJSON=c.prototype.toJSON=d.prototype.toJSON=function(){return this.toString()},c.prototype.valueOf=function(){return parseInt(this.toString(),10)},c.prototype.toJSNumber=c.prototype.valueOf,d.prototype.valueOf=function(){return this.value},d.prototype.toJSNumber=d.prototype.valueOf,_.prototype.valueOf=_.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};function Wb(f){if(R(+f)){var m=+f;if(m===Oe(m))return s?new _(BigInt(m)):new d(m);throw new Error("Invalid integer: "+f)}var b=f[0]==="-";b&&(f=f.slice(1));var q=f.split(/e/i);if(q.length>2)throw new Error("Invalid integer: "+q.join("e"));if(q.length===2){var O=q[1];if(O[0]==="+"&&(O=O.slice(1)),O=+O,O!==Oe(O)||!R(O))throw new Error("Invalid integer: "+O+" is not a valid exponent.");var x=q[0],P=x.indexOf(".");if(P>=0&&(O-=x.length-P-1,x=x.slice(0,P)+x.slice(P+1)),O<0)throw new Error("Cannot include negative exponent part for integers");x+=new Array(O+1).join("0"),f=x}var L=/^([0-9][0-9]*)$/.test(f);if(!L)throw new Error("Invalid integer: "+f);if(s)return new _(BigInt(b?"-"+f:f));for(var $=[],pe=f.length,Fe=r,Te=pe-Fe;pe>0;)$.push(+f.slice(Te,pe)),Te-=Fe,Te<0&&(Te=0),pe-=Fe;return Z($),new c($,b)}function Yx(f){if(s)return new _(BigInt(f));if(R(f)){if(f!==Oe(f))throw new Error(f+" is not an integer.");return new d(f)}return Wb(f.toString())}function Ee(f){return typeof f=="number"?Yx(f):typeof f=="string"?Wb(f):typeof f=="bigint"?new _(f):f}for(var mi=0;mi<1e3;mi++)u[mi]=Ee(mi),mi>0&&(u[-mi]=Ee(-mi));return u.one=u[1],u.zero=u[0],u.minusOne=u[-1],u.max=il,u.min=is,u.gcd=Xb,u.lcm=Gx,u.isInstance=function(f){return f instanceof c||f instanceof d||f instanceof _},u.randBetween=Fx,u.fromArray=function(f,m,b){return Hb(f.map(Ee),Ee(m||10),b)},u}();typeof Mu<"u"&&Mu.hasOwnProperty("exports")&&(Mu.exports=Ft);typeof define=="function"&&define.amd&&define(function(){return Ft})});var Tu=A(ss=>{"use strict";var Vx=ss&&ss.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ss,"__esModule",{value:!0});ss.mcmp=void 0;var UU=Vx(No());function Zx(e,t){return e.compare(t)}ss.mcmp=Zx});var sr=A(Io=>{"use strict";Object.defineProperty(Io,"__esModule",{value:!0});Io.findPossibleExponentialForm=Io.findPossibleClockForm=Io.Find=void 0;var Nu=Q(),Xx=Ie(),Ht=N(),Hx=U();function al(e,t){if(Xx.equal(e,t))return!0;if(Ht.istensor(e)){for(let r=0;r<e.tensor.nelem;r++)if(al(e.tensor.elem[r],t))return!0;return!1}return Ht.iscons(e)?[...e].some(r=>al(r,t)):!1}Io.Find=al;function wd(e,t){if(Nu.isimaginaryunit(e))return!1;if(Ht.ispower(e)&&!Nu.isinteger(Ht.caddr(t))&&al(Ht.cadr(e),Ht.Constants.imaginaryunit)||Ht.ispower(e)&&Nu.equaln(Ht.cadr(e),-1)&&!Nu.isinteger(Ht.caddr(t)))return!0;if(Ht.istensor(e)){for(let r=0;r<e.tensor.nelem;r++)if(wd(e.tensor.elem[r],t))return!0;return!1}return Ht.iscons(e)?[...e].some(r=>wd(r,t)):!1}Io.findPossibleClockForm=wd;function Ld(e){if(Ht.ispower(e)&&Ht.cadr(e)===Hx.symbol(Ht.E))return al(Ht.caddr(e),Ht.Constants.imaginaryunit);if(Ht.istensor(e)){for(let t=0;t<e.tensor.nelem;t++)if(Ld(e.tensor.elem[t]))return!0;return!1}return Ht.iscons(e)?[...e].some(Ld):!1}Io.findPossibleExponentialForm=Ld});var eg=A(as=>{"use strict";Object.defineProperty(as,"__esModule",{value:!0});as.set_component=as.index_function=void 0;var Jb=St(),Cd=N(),pn=xe(),Kb=j(),_i=Et();function Qx(e,t){let{ndim:r}=e.tensor,n=t.length;n>r&&pn.stop("too many indices for tensor");let o=0;for(let u=0;u<n;u++){let c=Kb.nativeInt(t[u]);(c<1||c>e.tensor.dim[u])&&pn.stop("index out of range"),o=o*e.tensor.dim[u]+c-1}if(r===n)return e.tensor.elem[o];o=e.tensor.dim.slice(n).reduce((u,c)=>u*c,o);let i=e.tensor.dim.slice(n).reduce((u,c)=>u*c,1),s=Jb.alloc_tensor(i);s.tensor.ndim=r-n,s.tensor.dim=e.tensor.dim.slice(n);for(let u=0;u<i;u++)s.tensor.elem[u]=e.tensor.elem[o+u];return _i.check_tensor_dimensions(e),_i.check_tensor_dimensions(s),s}as.index_function=Qx;function Wx(e,...t){t.length<2&&pn.stop("error in indexed assign");let[r,...n]=t;Cd.istensor(r)||pn.stop("error in indexed assign: assigning to something that is not a tensor");let{ndim:o}=r.tensor,i=n.length;i>o&&pn.stop("error in indexed assign");let s=0;for(let c=0;c<i;c++){let d=Kb.nativeInt(n[c]);(d<1||d>r.tensor.dim[c])&&pn.stop(`error in indexed assign
`),s=s*r.tensor.dim[c]+d-1}for(let c=i;c<o;c++)s=s*r.tensor.dim[c]+0;let u=Jb.alloc_tensor(r.tensor.nelem);if(u.tensor.ndim=r.tensor.ndim,u.tensor.dim=Array.from(r.tensor.dim),u.tensor.elem=Array.from(r.tensor.elem),_i.check_tensor_dimensions(r),_i.check_tensor_dimensions(u),r=u,o===i)return Cd.istensor(e)&&pn.stop("error in indexed assign"),r.tensor.elem[s]=e,_i.check_tensor_dimensions(r),r;Cd.istensor(e)||pn.stop("error in indexed assign"),o-i!==e.tensor.ndim&&pn.stop("error in indexed assign");for(let c=0;c<e.tensor.ndim;c++)r.tensor.dim[i+c]!==e.tensor.dim[c]&&pn.stop("error in indexed assign");for(let c=0;c<e.tensor.nelem;c++)r.tensor.elem[s+c]=e.tensor.elem[c];return _i.check_tensor_dimensions(r),_i.check_tensor_dimensions(e),r}as.set_component=Wx});var ee=A(Iu=>{"use strict";Object.defineProperty(Iu,"__esModule",{value:!0});Iu.makeList=void 0;var tg=N(),Jx=U();function Kx(...e){let t=Jx.symbol(tg.NIL);for(let r=e.length-1;r>=0;r--)t=new tg.Cons(e[r],t);return t}Iu.makeList=Kx});var Pd=A(ls=>{"use strict";Object.defineProperty(ls,"__esModule",{value:!0});ls.Eval_function_reference=ls.define_user_function=void 0;var Hn=N(),e0=xe(),Su=U(),t0=G(),r0=ee();function n0(e){let t=Hn.caadr(e),r=Hn.cdadr(e),n=Hn.caddr(e);return Hn.issymbol(t)||e0.stop("function name?"),Hn.car(n)===Su.symbol(Hn.EVAL)&&(n=t0.Eval(Hn.cadr(n))),n=r0.makeList(Su.symbol(Hn.FUNCTION),n,r),Su.set_binding(t,n),Su.symbol(Hn.NIL)}ls.define_user_function=n0;function o0(e){return e}ls.Eval_function_reference=o0});var kd=A(us=>{"use strict";Object.defineProperty(us,"__esModule",{value:!0});us.lcm=us.Eval_lcm=void 0;var Ru=N(),rg=G(),i0=bi(),Dd=X();function s0(e){e=Ru.cdr(e);let t=rg.Eval(Ru.car(e));return Ru.iscons(e)&&(t=e.tail().reduce((r,n)=>ng(r,rg.Eval(n)),t)),t}us.Eval_lcm=s0;function ng(e,t){return Ru.doexpand(a0,e,t)}us.lcm=ng;function a0(e,t){return Dd.inverse(Dd.divide(Dd.divide(i0.gcd(e,t),e),t))}});var ll=A(cs=>{"use strict";Object.defineProperty(cs,"__esModule",{value:!0});cs.filter=cs.Eval_filter=void 0;var l0=St(),Qn=N(),u0=sr(),c0=ce(),og=G();function f0(e){e=Qn.cdr(e);let t=og.Eval(Qn.car(e));return Qn.iscons(e)&&(t=e.tail().reduce((r,n)=>wu(r,og.Eval(n)),t)),t}cs.Eval_filter=f0;function wu(e,t){return d0(e,t)}cs.filter=wu;function d0(e,t){return Qn.isadd(e)?m0(e,t):Qn.istensor(e)?_0(e,t):u0.Find(e,t)?Qn.Constants.zero:e}function m0(e,t){return Qn.iscons(e)?e.tail().reduce((r,n)=>c0.add(r,wu(n,t)),Qn.Constants.zero):Qn.Constants.zero}function _0(e,t){let r=e.tensor.nelem,n=l0.alloc_tensor(r);return n.tensor.ndim=e.tensor.ndim,n.tensor.dim=Array.from(e.tensor.dim),n.tensor.elem=e.tensor.elem.map(o=>wu(o,t)),n}});var Vr=A(Cu=>{"use strict";Object.defineProperty(Cu,"__esModule",{value:!0});Cu.subst=void 0;var b0=St(),gi=N(),g0=Ie(),y0=Et(),ig=U();function Lu(e,t,r){if(t===ig.symbol(gi.NIL)||r===ig.symbol(gi.NIL))return e;if(gi.istensor(e)){let n=b0.alloc_tensor(e.tensor.nelem);return n.tensor.ndim=e.tensor.ndim,n.tensor.dim=Array.from(e.tensor.dim),n.tensor.elem=e.tensor.elem.map(o=>{let i=Lu(o,t,r);return y0.check_tensor_dimensions(n),i}),n}return g0.equal(e,t)?r:gi.iscons(e)?new gi.Cons(Lu(gi.car(e),t,r),Lu(gi.cdr(e),t,r)):e}Cu.subst=Lu});var yi=A(fs=>{"use strict";Object.defineProperty(fs,"__esModule",{value:!0});fs.coeff=fs.Eval_coeff=void 0;var So=N(),sg=U(),v0=Ie(),q0=ce(),Pu=G(),E0=ll(),ag=X(),x0=xt(),p0=Vr();function h0(e){let t=Pu.Eval(So.cadddr(e)),r=Pu.Eval(So.caddr(e)),n=Pu.Eval(So.cadr(e));return t===sg.symbol(So.NIL)&&(t=r,r=sg.symbol(So.SYMBOL_X)),E0.filter(ag.divide(n,x0.power(r,t)),r)}fs.Eval_coeff=h0;function A0(e,t){let r=[];for(;;){let n=Pu.Eval(p0.subst(e,t,So.Constants.zero));if(r.push(n),e=q0.subtract(e,n),v0.equal(e,So.Constants.zero))return r;e=So.doexpand(ag.divide,e,t)}}fs.coeff=A0});var Du=A(ds=>{"use strict";Object.defineProperty(ds,"__esModule",{value:!0});ds.clockform=ds.Eval_clock=void 0;var ul=N(),O0=U(),lg=sn(),$d=ms(),M0=G(),T0=ee(),Ud=X(),N0=!1;function I0(e){return ug(M0.Eval(ul.cadr(e)))}ds.Eval_clock=I0;function ug(e){let t=T0.makeList(O0.symbol(ul.POWER),ul.Constants.negOne,Ud.divide($d.arg(e),ul.Constants.Pi())),r=Ud.multiply(lg.abs(e),t);return N0&&(console.log(`clockform: abs of ${e} : ${lg.abs(e)}`),console.log(`clockform: arg of ${e} : ${$d.arg(e)}`),console.log(`clockform: divide : ${Ud.divide($d.arg(e),ul.Constants.Pi())}`),console.log(`clockform: power : ${t}`),console.log(`clockform: multiply : ${r}`)),r}ds.clockform=ug});var ku=A(_s=>{"use strict";Object.defineProperty(_s,"__esModule",{value:!0});_s.polar=_s.Eval_polar=void 0;var Bd=N(),S0=Ie(),R0=sn(),w0=ms(),L0=G(),cg=X();function C0(e){return fg(L0.Eval(Bd.cadr(e)))}_s.Eval_polar=C0;function fg(e){return Bd.evalPolar(()=>cg.multiply(R0.abs(e),S0.exponential(cg.multiply(Bd.Constants.imaginaryunit,w0.arg(e)))))}_s.polar=fg});var vi=A(bs=>{"use strict";Object.defineProperty(bs,"__esModule",{value:!0});bs.conjugate=bs.Eval_conj=void 0;var $u=N(),P0=sr(),D0=Du(),dg=G(),k0=X(),$0=ku(),U0=Vr();function B0(e){return e=dg.Eval($u.cadr(e)),P0.Find(e,$u.Constants.imaginaryunit)?Gd(e):D0.clockform(Gd($0.polar(e)))}bs.Eval_conj=B0;function Gd(e){return dg.Eval(U0.subst(e,$u.Constants.imaginaryunit,k0.negate($u.Constants.imaginaryunit)))}bs.conjugate=Gd});var Zr=A(Uu=>{"use strict";Object.defineProperty(Uu,"__esModule",{value:!0});Uu.guess=void 0;var an=N(),cl=sr(),ln=U();function G0(e){return cl.Find(e,ln.symbol(an.SYMBOL_X))?ln.symbol(an.SYMBOL_X):cl.Find(e,ln.symbol(an.SYMBOL_Y))?ln.symbol(an.SYMBOL_Y):cl.Find(e,ln.symbol(an.SYMBOL_Z))?ln.symbol(an.SYMBOL_Z):cl.Find(e,ln.symbol(an.SYMBOL_T))?ln.symbol(an.SYMBOL_T):cl.Find(e,ln.symbol(an.SYMBOL_S))?ln.symbol(an.SYMBOL_S):ln.symbol(an.SYMBOL_X)}Uu.guess=G0});var Fd=A(gs=>{"use strict";Object.defineProperty(gs,"__esModule",{value:!0});gs.msub=gs.madd=void 0;function F0(e,t){return e.add(t)}gs.madd=F0;function j0(e,t){return e.subtract(t)}gs.msub=j0});var vs=A(ys=>{"use strict";var z0=ys&&ys.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ys,"__esModule",{value:!0});ys.mgcd=void 0;var Y0=z0(No());function V0(e,t){return Y0.default.gcd(e,t)}ys.mgcd=V0});var un=A(hn=>{"use strict";Object.defineProperty(hn,"__esModule",{value:!0});hn.mdivrem=hn.mmod=hn.mdiv=hn.mmul=void 0;function Z0(e,t){return e.multiply(t)}hn.mmul=Z0;function X0(e,t){return e.divide(t)}hn.mdiv=X0;function H0(e,t){return e.mod(t)}hn.mmod=H0;function Q0(e,t){let r=e.divmod(t);return[r.quotient,r.remainder]}hn.mdivrem=Q0});var jd=A(Bu=>{"use strict";Object.defineProperty(Bu,"__esModule",{value:!0});Bu.mprime=void 0;function W0(e){return e.isProbablePrime()}Bu.mprime=W0});var yg=A(Es=>{"use strict";var J0=Es&&Es.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Es,"__esModule",{value:!0});Es.factor_number=void 0;var K0=J0(No()),wo=N(),_g=Tu(),ep=xe(),bg=U(),Ro=j(),zd=Q(),gg=ee(),mg=Fd(),tp=vs(),qs=un(),rp=jd(),jt=K0.default(0);function np(e){if(zd.equaln(e,0)||zd.equaln(e,1)||zd.equaln(e,-1))return e;jt=e.q.a;let t=op();return t.length==1?t[0]:gg.makeList(bg.symbol(wo.MULTIPLY),...t)}Es.factor_number=np;function op(){let e=[];jt.isNegative()&&(jt=Ro.setSignTo(jt,1),e.push(wo.Constants.negOne));for(let t=0;t<1e4;t++)if(e.push(...ip(t)),jt.compare(1)===0)return e;return e.push(...sp()),e}function ip(e){let t=[],r,n=Ro.mint(wo.primetab[e]),o=0;for(;;){if(jt.compare(1)===0)return o&&t.push(fl(n,o)),t;let i;if([r,i]=Array.from(qs.mdivrem(jt,n)),i.isZero())o++,jt=r;else break}return o&&t.push(fl(n,o)),_g.mcmp(r,n)===-1&&(t.push(fl(jt,1)),jt=Ro.mint(1)),t}function sp(){let e=[],t=Ro.mint(1),r=Ro.mint(5),n=Ro.mint(2),o=1,i=1;for(;;){if(rp.mprime(jt))return e.push(fl(jt,1)),e;for(;;){wo.defs.esc_flag&&ep.stop("esc");let s=mg.msub(n,r);s=Ro.setSignTo(s,1);let u=tp.mgcd(s,jt);if(wo.MEQUAL(u,1)){--o===0&&(n=r,i*=2,o=i),s=qs.mmul(r,r),r=mg.madd(s,t),s=qs.mmod(r,jt),r=s;continue}if(e.push(fl(u,1)),_g.mcmp(u,jt)===0)return e;s=qs.mdiv(jt,u),jt=s,s=qs.mmod(r,jt),r=s,s=qs.mmod(n,jt),n=s;break}}}function fl(e,t){let r=new wo.Num(e);return t>1&&(r=gg.makeList(bg.symbol(wo.POWER),r,new wo.Num(Ro.mint(t)))),r}});var dl=A(Lo=>{"use strict";Object.defineProperty(Lo,"__esModule",{value:!0});Lo.factor_small_number=Lo.factor=Lo.Eval_factor=void 0;var An=N(),ap=xe(),lp=U(),Yd=j(),Vd=G(),qg=xs(),up=Zr(),cp=Q(),fp=X(),dp=yg();function mp(e){let t=Vd.Eval(An.cadr(e)),r=Vd.Eval(An.caddr(e)),n=r===lp.symbol(An.NIL)?up.guess(t):r,o=Eg(t,n);return e=An.cdddr(e),An.iscons(e)&&(o=[...e].reduce((i,s)=>_p(i,Vd.Eval(s)),o)),o}Lo.Eval_factor=mp;function _p(e,t){if(An.ismultiply(e)){let n=[];return e.tail().forEach(o=>vg(n,o,t)),fp.multiply_all_noexpand(n)}let r=[];return vg(r,e,t),r[0]}function vg(e,t,r){let n=qg.factorpoly(t,r);if(An.ismultiply(n)){e.push(...n.tail());return}e.push(n)}function Eg(e,t){return cp.isinteger(e)?dp.factor_number(e):qg.factorpoly(e,t)}Lo.factor=Eg;function bp(e){isNaN(e)&&ap.stop("number too big to factor");let t=[];e<0&&(e=-e);for(let r=0;r<An.MAXPRIMETAB;r++){let n=An.primetab[r];if(n>e/n)break;let o=0;for(;e%n===0;)e/=n,o++;o&&(t.push(Yd.integer(n)),t.push(Yd.integer(o)))}return e>1&&(t.push(Yd.integer(e)),t.push(An.Constants.one)),t}Lo.factor_small_number=bp});var Xd=A(hs=>{"use strict";Object.defineProperty(hs,"__esModule",{value:!0});hs.ydivisors=hs.divisors=void 0;var gp=bi(),yp=St(),$e=N(),xg=Ie(),vp=ce(),ps=j(),Gu=dl(),qp=Q(),Zd=X(),Ep=xt();function xp(e){let t=pg(e),r=t.length;t.sort(xg.cmp_expr);let n=yp.alloc_tensor(r);return n.tensor.ndim=1,n.tensor.dim[0]=r,n.tensor.elem=t,n}hs.divisors=xp;var pp=e=>[].concat(...e);function pg(e){let t=[];if($e.isNumericAtom(e))t.push(...Gu.factor_small_number(ps.nativeInt(e)));else if($e.isadd(e))t.push(...hp(e));else if($e.ismultiply(e)){if(e=$e.cdr(e),$e.isNumericAtom($e.car(e))&&(t.push(...Gu.factor_small_number(ps.nativeInt($e.car(e)))),e=$e.cdr(e)),$e.iscons(e)){let n=[...e].map(o=>$e.ispower(o)?[$e.cadr(o),$e.caddr(o)]:[o,$e.Constants.one]);t.push(...pp(n))}}else $e.ispower(e)?t.push($e.cadr(e),$e.caddr(e)):t.push(e,$e.Constants.one);let r=t.length;return t.push($e.Constants.one),hg(t,0,r),t.slice(r)}hs.ydivisors=pg;function hg(e,t,r){let n=e.pop();if(t===r){e.push(n);return}let o=e[t+0],i=e[t+1],s=ps.nativeInt(i);if(!isNaN(s))for(let u=0;u<=Math.abs(s);u++)e.push(Zd.multiply(n,Ep.power(o,ps.integer(xg.sign(s)*u)))),hg(e,t+2,r)}function hp(e){let t=$e.iscons(e)?e.tail().reduce(gp.gcd):$e.car(e),r=[],n=t;if(qp.isplusone(n))return r.push(e,$e.Constants.one),r;if($e.isNumericAtom(n))r.push(...Gu.factor_small_number(ps.nativeInt(n)));else if($e.ismultiply(n)){let i=$e.cdr(n);$e.isNumericAtom($e.car(i))?r.push(...Gu.factor_small_number(ps.nativeInt($e.car(i)))):r.push($e.car(i),$e.Constants.one),$e.iscons(i)&&i.tail().forEach(s=>r.push(s,$e.Constants.one))}else r.push(n,$e.Constants.one);n=Zd.inverse(n);let o=$e.iscons(e)?e.tail().reduce((i,s)=>vp.add(i,Zd.multiply(n,s)),$e.Constants.zero):$e.cdr(e);return r.push(o,$e.Constants.one),r}});var Fu=A(Os=>{"use strict";Object.defineProperty(Os,"__esModule",{value:!0});Os.divpoly=Os.Eval_quotient=void 0;var As=N(),Ag=U(),Og=ce(),Ap=j(),Mg=yi(),Hd=G(),Qd=X(),Op=xt();function Mp(e){let t=Hd.Eval(As.cadr(e)),r=Hd.Eval(As.caddr(e)),n=Hd.Eval(As.cadddr(e));return n===Ag.symbol(As.NIL)&&(n=Ag.symbol(As.SYMBOL_X)),Tg(t,r,n)}Os.Eval_quotient=Mp;function Tg(e,t,r){let n=Mg.coeff(e,r),o=n.length-1,i=Mg.coeff(t,r),s=i.length-1,u=o-s,c=As.Constants.zero;for(;u>=0;){let d=Qd.divide(n[o],i[s]);for(let _=0;_<=s;_++)n[u+_]=Og.subtract(n[u+_],Qd.multiply(i[_],d));c=Og.add(c,Qd.multiply(d,Op.power(r,Ap.integer(u)))),o--,u--}return c}Os.divpoly=Tg});var Wn=A(Ts=>{"use strict";Object.defineProperty(Ts,"__esModule",{value:!0});Ts.sine=Ts.Eval_sin=void 0;var Pt=N(),ju=U(),Wd=ce(),zt=j(),Ng=Co(),Tp=G(),Sg=Q(),Ig=ee(),cn=X(),Ms=xt();function Np(e){return ml(Tp.Eval(Pt.cadr(e)))}Ts.Eval_sin=Np;function ml(e){return Pt.isadd(e)?Ip(e):Rg(e)}Ts.sine=ml;function Ip(e){let t=Pt.cdr(e);for(;Pt.iscons(t);){let r=Pt.car(t);if(Sg.isnpi(r)){let n=Wd.subtract(e,r);return Wd.add(cn.multiply(ml(n),Ng.cosine(r)),cn.multiply(Ng.cosine(n),ml(r)))}t=Pt.cdr(t)}return Rg(e)}function Rg(e){if(Pt.car(e)===ju.symbol(Pt.ARCSIN))return Pt.cadr(e);if(Pt.isdouble(e)){let r=Math.sin(e.d);return Math.abs(r)<1e-10&&(r=0),zt.double(r)}if(Sg.isnegative(e))return cn.negate(ml(cn.negate(e)));if(Pt.car(e)===ju.symbol(Pt.ARCTAN))return cn.multiply(Pt.cadr(e),Ms.power(Wd.add(Pt.Constants.one,Ms.power(Pt.cadr(e),zt.integer(2))),zt.rational(-1,2)));let t=zt.nativeInt(cn.divide(cn.multiply(e,zt.integer(180)),Pt.Constants.Pi()));if(t<0||isNaN(t))return Ig.makeList(ju.symbol(Pt.SIN),e);switch(t%360){case 0:case 180:return Pt.Constants.zero;case 30:case 150:return zt.rational(1,2);case 210:case 330:return zt.rational(-1,2);case 45:case 135:return cn.multiply(zt.rational(1,2),Ms.power(zt.integer(2),zt.rational(1,2)));case 225:case 315:return cn.multiply(zt.rational(-1,2),Ms.power(zt.integer(2),zt.rational(1,2)));case 60:case 120:return cn.multiply(zt.rational(1,2),Ms.power(zt.integer(3),zt.rational(1,2)));case 240:case 300:return cn.multiply(zt.rational(-1,2),Ms.power(zt.integer(3),zt.rational(1,2)));case 90:return Pt.Constants.one;case 270:return Pt.Constants.negOne;default:return Ig.makeList(ju.symbol(Pt.SIN),e)}}});var Co=A(Is=>{"use strict";Object.defineProperty(Is,"__esModule",{value:!0});Is.cosine=Is.Eval_cos=void 0;var ar=N(),zu=U(),Jd=ce(),Yt=j(),Sp=G(),Cg=Q(),wg=ee(),Jn=X(),Ns=xt(),Lg=Wn();function Rp(e){return Yu(Sp.Eval(ar.cadr(e)))}Is.Eval_cos=Rp;function Yu(e){return ar.isadd(e)?wp(e):Pg(e)}Is.cosine=Yu;function wp(e){if(ar.iscons(e)){for(let t of e.tail())if(Cg.isnpi(t)){let r=Jd.subtract(e,t);return Jd.subtract(Jn.multiply(Yu(r),Yu(t)),Jn.multiply(Lg.sine(r),Lg.sine(t)))}}return Pg(e)}function Pg(e){if(ar.car(e)===zu.symbol(ar.ARCCOS))return ar.cadr(e);if(ar.isdouble(e)){let r=Math.cos(e.d);return Math.abs(r)<1e-10&&(r=0),Yt.double(r)}if(Cg.isnegative(e)&&(e=Jn.negate(e)),ar.car(e)===zu.symbol(ar.ARCTAN)){let r=Jd.add(ar.Constants.one,Ns.power(ar.cadr(e),Yt.integer(2)));return Ns.power(r,Yt.rational(-1,2))}let t=Yt.nativeInt(Jn.divide(Jn.multiply(e,Yt.integer(180)),ar.Constants.Pi()));if(t<0||isNaN(t))return wg.makeList(zu.symbol(ar.COS),e);switch(t%360){case 90:case 270:return ar.Constants.zero;case 60:case 300:return Yt.rational(1,2);case 120:case 240:return Yt.rational(-1,2);case 45:case 315:return Jn.multiply(Yt.rational(1,2),Ns.power(Yt.integer(2),Yt.rational(1,2)));case 135:case 225:return Jn.multiply(Yt.rational(-1,2),Ns.power(Yt.integer(2),Yt.rational(1,2)));case 30:case 330:return Jn.multiply(Yt.rational(1,2),Ns.power(Yt.integer(3),Yt.rational(1,2)));case 150:case 210:return Jn.multiply(Yt.rational(-1,2),Ns.power(Yt.integer(3),Yt.rational(1,2)));case 0:return ar.Constants.one;case 180:return ar.Constants.negOne;default:return wg.makeList(zu.symbol(ar.COS),e)}}});var eo=A(Rs=>{"use strict";Object.defineProperty(Rs,"__esModule",{value:!0});Rs.rect=Rs.Eval_rect=void 0;var _r=N(),Ss=sr(),Kn=U(),Dg=sn(),Kd=ce(),qi=ms(),em=Co(),Lp=G(),Vu=Q(),Cp=ee(),Zu=X(),Xu=Wn(),_l=!1;function Pp(e){return tm(Lp.Eval(_r.cadr(e)))}Rs.Eval_rect=Pp;function tm(e){let t=e;if(_l&&(console.log(`RECT of ${t}`),console.log(`any clock forms in : ${t} ? ${Ss.findPossibleClockForm(t,e)}`)),_r.issymbol(e))return _l&&console.log(` rect: simple symbol: ${t}`),Vu.isZeroAtomOrTensor(Kn.get_binding(Kn.symbol(_r.ASSUME_REAL_VARIABLES)))?Cp.makeList(Kn.symbol(_r.YYRECT),e):e;if(!Vu.isZeroAtomOrTensor(Kn.get_binding(Kn.symbol(_r.ASSUME_REAL_VARIABLES)))&&!Ss.findPossibleExponentialForm(e)&&!Ss.findPossibleClockForm(e,e)&&!(Ss.Find(e,Kn.symbol(_r.SIN))&&Ss.Find(e,Kn.symbol(_r.COS))&&Ss.Find(e,_r.Constants.imaginaryunit)))return _l&&console.log(` rect: simple symbol: ${t}`),e;if(_r.ismultiply(e)&&Vu.isimaginaryunit(_r.cadr(e))&&!Vu.isZeroAtomOrTensor(Kn.get_binding(Kn.symbol(_r.ASSUME_REAL_VARIABLES))))return e;if(_r.isadd(e))return _l&&console.log(` rect - ${t} is a sum `),e.tail().reduce((n,o)=>Kd.add(n,tm(o)),_r.Constants.zero);let r=Zu.multiply(Dg.abs(e),Kd.add(em.cosine(qi.arg(e)),Zu.multiply(_r.Constants.imaginaryunit,Xu.sine(qi.arg(e)))));return _l&&(console.log(` rect - ${t} is NOT a sum `),console.log(` rect - ${t} abs: ${Dg.abs(e)}`),console.log(` rect - ${t} arg of ${e} : ${e}`),console.log(` rect - ${t} cosine: ${em.cosine(qi.arg(e))}`),console.log(` rect - ${t} sine: ${Xu.sine(qi.arg(e))}`),console.log(` rect - ${t} i * sine: ${Zu.multiply(_r.Constants.imaginaryunit,Xu.sine(qi.arg(e)))}`),console.log(` rect - ${t} cos + i * sine: ${Kd.add(em.cosine(qi.arg(e)),Zu.multiply(_r.Constants.imaginaryunit,Xu.sine(qi.arg(e))))}`),console.log(`rect of ${t} : ${r}`)),r}Rs.rect=tm});var xs=A(Hu=>{"use strict";Object.defineProperty(Hu,"__esModule",{value:!0});Hu.factorpoly=void 0;var Dp=kd(),Re=N(),kp=sr(),$p=xe(),Up=Ie(),On=ce(),Po=j(),kg=yi(),$g=gl(),Bp=vi(),Gp=Tn(),Ug=Xd(),Mn=Q(),Mt=X(),ws=xt(),Fp=to(),jp=Fu(),rm=eo();function zp(e,t){return!kp.Find(e,t)||!Mn.ispolyexpandedform(e,t)||!Re.issymbol(t)?e:Yp(e,t)}Hu.factorpoly=zp;function Yp(e,t){let r,n,o,i;Mn.isfloating(e)&&$p.stop("floating point numbers in polynomial");let s=kg.coeff(e,t),u=s.length-1,c=Vp(s),d="real",_=null;for(;u>0;){var R,T;if(Mn.isZeroAtomOrTensor(s[0])?(r=Re.Constants.one,n=Re.Constants.zero):d==="real"?[T,r,n]=Zp(s,u,t,r,n):d==="complex"&&([R,r]=Xp(_,s,u)),d==="real")if(T===!1){d="complex";continue}else{for(o=On.add(Mt.multiply(r,t),n),Re.DEBUG&&console.log(`success
FACTOR=${o}`),c=Mt.multiply_noexpand(c,o),Hp(r,n,s,u);u&&Mn.isZeroAtomOrTensor(s[u]);)u--;let Z=Re.Constants.zero;for(let Y=0;Y<=u;Y++)Z=On.add(Z,Mt.multiply(s[Y],ws.power(t,Po.integer(Y))));_=Z}else if(d==="complex"){if(R===!1)break;{let Z=On.subtract(r,t),Y=On.subtract(Bp.conjugate(r),t);o=Mt.multiply(Z,Y),Re.DEBUG&&console.log(`success
FACTOR=${o}`);let Oe=c;if(c=Mt.multiply_noexpand(c,o),_==null){let Me=Re.Constants.zero;for(let at=0;at<=u;at++)Me=On.add(Me,Mt.multiply(s[at],ws.power(t,Po.integer(at))));_=Me}let tt=t,Ze=o,ke=_;_=jp.divpoly(ke,Ze,tt);let st=Mt.multiply(_,o);if(!Up.equal(st,ke))return Re.DEBUG&&(console.log("we found a polynomial based on complex root and its conj but it doesn't divide the poly, quitting"),console.log(`so just returning previousFactorisation times dividend: ${Oe} * ${ke}`)),Mt.multiply_noexpand(Oe,Re.noexpand($g.yycondense,ke));for(let Me=0;Me<=u;Me++)s.pop();s.push(...kg.coeff(_,t)),u-=2}}}let k=Re.Constants.zero;for(let Z=0;Z<=u;Z++)k=On.add(k,Mt.multiply(s[Z],ws.power(t,Po.integer(Z))));return e=k,Re.DEBUG&&console.log(`POLY=${e}`),e=Re.noexpand($g.yycondense,e),u>0&&Mn.isnegativeterm(s[u])&&(e=Mt.negate(e),c=Mt.negate_noexpand(c)),c=Mt.multiply_noexpand(c,e),Re.DEBUG&&console.log(`RESULT=${c}`),c}function Vp(e){let t=Re.Constants.one;for(let r of e)t=Dp.lcm(Gp.denominator(r),t);for(let r=0;r<e.length;r++)e[r]=Mt.multiply(t,e[r]);return t=Mt.reciprocate(t),Re.DEBUG&&console.log("rationalize_coefficients result"),t}function Zp(e,t,r,n,o){let i,s,u;if(Re.DEBUG){let _=Re.Constants.zero;for(let R=0;R<=t;R++)_=On.add(_,Mt.multiply(e[R],ws.power(r,Po.integer(R))));i=_,console.log(`POLY=${i}`)}let c=Ug.ydivisors(e[t]),d=Ug.ydivisors(e[0]);if(Re.DEBUG){console.log("divisors of base term");for(let _=0;_<d.length;_++)console.log(`, ${d[_]}`);console.log("divisors of leading term");for(let _=0;_<c.length;_++)console.log(`, ${c[_]}`)}for(let _=0;_<c.length;_++)for(let R=0;R<d.length;R++){if(n=c[_],o=d[R],s=Mt.negate(Mt.divide(o,n)),u=bl(s,e,t),Re.DEBUG&&console.log(`try A=${n}
, B=${o}
, root ${r}
=-B/A=${s}
, POLY(${s}
)=${u}`),Mn.isZeroAtomOrTensor(u))return Re.DEBUG&&console.log("get_factor_from_real_root returning true"),[!0,n,o];if(o=Mt.negate(o),s=Mt.negate(s),u=bl(s,e,t),Re.DEBUG&&console.log(`try A=${n}
, B=${o}
, root ${r}
=-B/A=${s}
, POLY(${s}
)=${u}`),Mn.isZeroAtomOrTensor(u))return Re.DEBUG&&console.log("get_factor_from_real_root returning true"),[!0,n,o]}return Re.DEBUG&&console.log("get_factor_from_real_root returning false"),[!1,n,o]}function Xp(e,t,r){let n,o,i,s;if(r<=2)return Re.DEBUG&&console.log("no more factoring via complex roots to be found in polynomial of degree <= 2"),[!1,o];if(n=e,Re.DEBUG&&console.log(`complex root finding for POLY=${n}`),o=rm.rect(ws.power(Re.Constants.negOne,Po.rational(2,3))),Re.DEBUG&&console.log(`complex root finding: trying with ${o}`),i=o,s=bl(i,t,r),Re.DEBUG&&console.log(`complex root finding result: ${s}`),Mn.isZeroAtomOrTensor(s))return Re.DEBUG&&console.log("get_factor_from_complex_root returning true"),[!0,o];if(o=rm.rect(ws.power(Re.Constants.one,Po.rational(2,3))),Re.DEBUG&&console.log(`complex root finding: trying with ${o}`),i=o,s=bl(i,t,r),Re.DEBUG&&console.log(`complex root finding result: ${s}`),Mn.isZeroAtomOrTensor(s))return Re.DEBUG&&console.log("get_factor_from_complex_root returning true"),[!0,o];for(let u=-10;u<=10;u++)for(let c=1;c<=5;c++){o=rm.rect(On.add(Po.integer(u),Mt.multiply(Po.integer(c),Re.Constants.imaginaryunit)));let _=bl(o,t,r);if(Mn.isZeroAtomOrTensor(_))return Re.DEBUG&&console.log(`found complex root: ${_}`),[!0,o]}return Re.DEBUG&&console.log("get_factor_from_complex_root returning false"),[!1,o]}function Hp(e,t,r,n){let o=Re.Constants.zero;for(let i=n;i>0;i--){let s=Mt.divide(r[i],e);r[i]=o,o=s,r[i-1]=On.subtract(r[i-1],Mt.multiply(o,t))}r[0]=o,Re.DEBUG&&console.log("yydivpoly Q:")}function bl(e,t,r){let n=Re.Constants.zero;for(let o=r;o>=0;o--)Re.DEBUG&&(console.log("Evalpoly top of stack:"),console.log(Fp.print_list(n))),n=On.add(Mt.multiply(n,e),t[o]);return n}});var bi=A(ko=>{"use strict";Object.defineProperty(ko,"__esModule",{value:!0});ko.areunivarpolysfactoredorexpandedform=ko.gcd=ko.Eval_gcd=void 0;var H=N(),Bg=U(),Ei=Ie(),Qp=ce(),Wp=j(),Gg=G(),Fg=xs(),om=Q(),jg=ee(),Do=X(),nm=xt();function Jp(e){e=H.cdr(e);let t=Gg.Eval(H.car(e));return H.iscons(e)&&(t=e.tail().reduce((r,n)=>ro(r,Gg.Eval(n)),t)),t}ko.Eval_gcd=Jp;function ro(e,t){return H.doexpand(Kp,e,t)}ko.gcd=ro;function Kp(e,t){let r;return Ei.equal(e,t)?e:H.isrational(e)&&H.isrational(t)?Wp.gcd_numbers(e,t):(r=Yg(e,t))?eh(e,t,r):H.isadd(e)&&H.isadd(t)?th(e,t):(H.isadd(e)&&(e=zg(e)),H.isadd(t)&&(t=zg(t)),H.ismultiply(e)?rh(e,t):H.ismultiply(t)?nh(e,t):H.ismultiply(e)&&H.ismultiply(t)?Vg(e,t):Zg(e,t))}function Yg(e,t){let r;if((r=om.isunivarpolyfactoredorexpandedform(e))&&om.isunivarpolyfactoredorexpandedform(t,r))return r}ko.areunivarpolysfactoredorexpandedform=Yg;function eh(e,t,r){return e=Fg.factorpoly(e,r),t=Fg.factorpoly(t,r),(H.ismultiply(e)||H.ismultiply(t))&&(H.ismultiply(e)||(e=jg.makeList(Bg.symbol(H.MULTIPLY),e,H.Constants.one)),H.ismultiply(t)||(t=jg.makeList(Bg.symbol(H.MULTIPLY),t,H.Constants.one))),H.ismultiply(e)&&H.ismultiply(t)?Vg(e,t):Zg(e,t)}function Vg(e,t){let r=H.cdr(e),n=H.cdr(t);if(H.iscons(r))return[...r].reduce((o,i)=>{if(H.iscons(n))return Do.multiply(o,[...n].reduce((s,u)=>Do.multiply(s,ro(i,u)),H.Constants.one))},H.Constants.one)}function Zg(e,t){let r,n,o;if(H.ispower(e)?(r=H.caddr(e),e=H.cadr(e)):r=H.Constants.one,H.ispower(t)?(n=H.caddr(t),t=H.cadr(t)):n=H.Constants.one,!Ei.equal(e,t))return H.Constants.one;if(H.isNumericAtom(r)&&H.isNumericAtom(n)){let u=Ei.lessp(r,n)?r:n;return nm.power(e,u)}let i=Do.divide(r,n);if(H.isNumericAtom(i)){i=H.ismultiply(r)&&H.isNumericAtom(H.cadr(r))?H.cadr(r):H.Constants.one,o=H.ismultiply(n)&&H.isNumericAtom(H.cadr(n))?H.cadr(n):H.Constants.one;let u=Ei.lessp(i,o)?r:n;return nm.power(e,u)}if(i=Qp.subtract(r,n),!H.isNumericAtom(i))return H.Constants.one;let s=om.isnegativenumber(i)?r:n;return nm.power(e,s)}function th(e,t){let r,n,o,i;return Ei.length(e)!==Ei.length(t)?H.Constants.one:(r=H.iscons(e)?e.tail().reduce(ro):H.car(H.cdr(e)),n=H.iscons(t)?t.tail().reduce(ro):H.car(H.cdr(t)),o=Do.divide(e,r),i=Do.divide(t,n),Ei.equal(o,i)?Do.multiply(o,ro(r,n)):H.Constants.one)}function zg(e){return H.iscons(e)?e.tail().reduce(ro):H.car(H.cdr(e))}function rh(e,t){return H.iscons(e)?e.tail().reduce((r,n)=>Do.multiply(r,ro(n,t)),H.Constants.one):H.Constants.one}function nh(e,t){return H.iscons(t)?t.tail().reduce((r,n)=>Do.multiply(r,ro(e,n)),H.Constants.one):H.Constants.one}});var gl=A($o=>{"use strict";Object.defineProperty($o,"__esModule",{value:!0});$o.yycondense=$o.Condense=$o.Eval_condense=void 0;var Qu=N(),oh=Ie(),ih=ce(),sh=G(),ah=bi(),im=X();function lh(e){return Xg(sh.Eval(Qu.cadr(e)))}$o.Eval_condense=lh;function Xg(e){return Qu.noexpand(Hg,e)}$o.Condense=Xg;function Hg(e){if(!Qu.isadd(e))return e;let t=e.tail().reduce(ah.gcd),r=im.inverse(t),n=e.tail().reduce((i,s)=>ih.add(i,im.multiply_noexpand(r,s)),Qu.Constants.zero),o=oh.yyexpand(n);return im.divide(o,r)}$o.yycondense=Hg});var yl=A(Cs=>{"use strict";Object.defineProperty(Cs,"__esModule",{value:!0});Cs.rationalize=Cs.Eval_rationalize=void 0;var lr=N(),uh=ce(),ch=gl(),ey=G(),fh=bi(),Qg=Q(),Ls=X(),dh=Et();function mh(e){return sm(ey.Eval(lr.cadr(e)))}Cs.Eval_rationalize=mh;function sm(e){let t=lr.defs.expanding,r=_h(e);return lr.defs.expanding=t,r}Cs.rationalize=sm;function _h(e){if(lr.istensor(e))return gh(e);if(lr.defs.expanding=!1,!lr.isadd(e))return e;let t=bh(e),r=lr.Constants.zero;return lr.iscons(e)&&(r=e.tail().reduce((n,o)=>uh.add(n,Ls.multiply(t,o)),r)),Ls.divide(ch.Condense(r),t)}function bh(e){return lr.isadd(e)?e.tail().reduce((t,r)=>Wg(r,t),lr.Constants.one):Wg(e,lr.Constants.one)}function Wg(e,t){return lr.ismultiply(e)?e.tail().reduce((r,n)=>Jg(n,r),t):Jg(e,t)}function Jg(e,t){if(!lr.ispower(e))return t;let r=e;return e=lr.caddr(e),Qg.isnegativenumber(e)||lr.ismultiply(e)&&Qg.isnegativenumber(lr.cadr(e))?Kg(t,Ls.inverse(r)):t}function gh(e){return e=ey.Eval(e),lr.istensor(e)&&(e.tensor.elem=e.tensor.elem.map(sm),dh.check_tensor_dimensions(e)),e}function Kg(e,t){return Ls.divide(Ls.multiply(e,t),fh.gcd(e,t))}});var Tn=A(Ps=>{"use strict";Object.defineProperty(Ps,"__esModule",{value:!0});Ps.denominator=Ps.Eval_denominator=void 0;var no=N(),yh=j(),vh=G(),ty=Q(),ry=X(),qh=yl();function Eh(e){return am(vh.Eval(no.cadr(e)))}Ps.Eval_denominator=Eh;function am(e){return no.isadd(e)&&(e=qh.rationalize(e)),no.ismultiply(e)&&!ty.isplusone(no.car(no.cdr(e)))?ry.multiply_all(e.tail().map(am)):no.isrational(e)?yh.mp_denominator(e):no.ispower(e)&&ty.isnegativeterm(no.caddr(e))?ry.reciprocate(e):no.Constants.one}Ps.denominator=am});var io=A(Ds=>{"use strict";Object.defineProperty(Ds,"__esModule",{value:!0});Ds.numerator=Ds.Eval_numerator=void 0;var oo=N(),xh=j(),ph=G(),ny=Q(),hh=X(),Ah=yl();function Oh(e){return lm(ph.Eval(oo.cadr(e)))}Ds.Eval_numerator=Oh;function lm(e){return oo.isadd(e)&&(e=Ah.rationalize(e)),oo.ismultiply(e)&&!ny.isplusone(oo.car(oo.cdr(e)))?hh.multiply_all(e.tail().map(lm)):oo.isrational(e)?xh.mp_numerator(e):oo.ispower(e)&&ny.isnegativeterm(oo.caddr(e))?oo.Constants.one:e}Ds.numerator=lm});var cm=A(ks=>{"use strict";Object.defineProperty(ks,"__esModule",{value:!0});ks.arctan=ks.Eval_arctan=void 0;var he=N(),oy=sr(),xi=U(),Mh=Ie(),Wu=j(),Th=Tn(),Nh=G(),Nn=Q(),Ih=ee(),vl=X(),Sh=io();function Rh(e){return um(Nh.Eval(he.cadr(e)))}ks.Eval_arctan=Rh;function um(e){if(he.car(e)===xi.symbol(he.TAN))return he.cadr(e);if(he.isdouble(e))return Wu.double(Math.atan(e.d));if(Nn.isZeroAtomOrTensor(e))return he.Constants.zero;if(Nn.isnegative(e))return vl.negate(um(vl.negate(e)));if(oy.Find(e,xi.symbol(he.SIN))&&oy.Find(e,xi.symbol(he.COS))){let t=Sh.numerator(e),r=Th.denominator(e);if(he.car(t)===xi.symbol(he.SIN)&&he.car(r)===xi.symbol(he.COS)&&Mh.equal(he.cadr(t),he.cadr(r)))return he.cadr(t)}return he.ispower(e)&&Nn.equaln(he.cadr(e),3)&&Nn.equalq(he.caddr(e),-1,2)||he.ismultiply(e)&&Nn.equalq(he.car(he.cdr(e)),1,3)&&he.car(he.car(he.cdr(he.cdr(e))))===xi.symbol(he.POWER)&&Nn.equaln(he.car(he.cdr(he.car(he.cdr(he.cdr(e))))),3)&&Nn.equalq(he.car(he.cdr(he.cdr(he.car(he.cdr(he.cdr(e)))))),1,2)?vl.multiply(Wu.rational(1,6),he.Constants.Pi()):Nn.equaln(e,1)?vl.multiply(Wu.rational(1,4),he.Constants.Pi()):he.ispower(e)&&Nn.equaln(he.cadr(e),3)&&Nn.equalq(he.caddr(e),1,2)?vl.multiply(Wu.rational(1,3),he.Constants.Pi()):Ih.makeList(xi.symbol(he.ARCTAN),e)}ks.arctan=um});var ql=A($s=>{"use strict";Object.defineProperty($s,"__esModule",{value:!0});$s.imag=$s.Eval_imag=void 0;var sy=N(),wh=ce(),Lh=j(),Ch=vi(),Ph=G(),iy=X(),Dh=eo(),kh=!1;function $h(e){return ay(Ph.Eval(sy.cadr(e)))}$s.Eval_imag=$h;function ay(e){let t=Dh.rect(e),r=Ch.conjugate(t),n=iy.divide(wh.subtract(t,r),Lh.integer(2)),o=iy.divide(n,sy.Constants.imaginaryunit);return kh&&(console.log(`IMAGE of ${t}`),console.log(` image: conjugate result: ${r}`),console.log(` image: 1st divide result: ${n}`),console.log(` image: 2nd divide result: ${o}`)),o}$s.imag=ay});var Bs=A(Us=>{"use strict";Object.defineProperty(Us,"__esModule",{value:!0});Us.real=Us.Eval_real=void 0;var Uh=N(),Bh=ce(),Gh=j(),Fh=vi(),jh=G(),zh=X(),Yh=eo();function Vh(e){return ly(jh.Eval(Uh.cadr(e)))}Us.Eval_real=Vh;function ly(e){let t=Yh.rect(e);return zh.divide(Bh.add(t,Fh.conjugate(t)),Gh.integer(2))}Us.real=ly});var ms=A(Gs=>{"use strict";Object.defineProperty(Gs,"__esModule",{value:!0});Gs.arg=Gs.Eval_arg=void 0;var je=N(),pi=U(),Ju=ce(),Zh=cm(),Xh=Tn(),Hh=G(),uy=ql(),so=Q(),cy=ee(),El=X(),Qh=io(),Wh=Bs(),Jh=eo(),Kh=!1;function e2(e){return Ku(Hh.Eval(je.cadr(e)))}Gs.Eval_arg=e2;function Ku(e){return Ju.subtract(fy(Qh.numerator(e)),fy(Xh.denominator(e)))}Gs.arg=Ku;function fy(e){if(so.ispositivenumber(e)||e===pi.symbol(je.PI))return je.isdouble(e)||je.defs.evaluatingAsFloats?je.Constants.zeroAsDouble:je.Constants.zero;if(so.isnegativenumber(e)){let t=je.isdouble(e)||je.defs.evaluatingAsFloats?je.Constants.piAsDouble:pi.symbol(je.PI);return El.negate(t)}if(je.issymbol(e))return cy.makeList(pi.symbol(je.ARG),e);if(je.ispower(e)&&so.equaln(je.cadr(e),-1))return El.multiply(je.Constants.Pi(),je.caddr(e));if(je.ispower(e)&&je.cadr(e)===pi.symbol(je.E))return uy.imag(je.caddr(e));if(je.ispower(e)&&so.isoneovertwo(je.caddr(e))){let t=Ku(je.cadr(e));return Kh&&(console.log(`arg of a sqrt: ${e}`),je.breakpoint,console.log(` = 1/2 * ${t}`)),El.multiply(t,je.caddr(e))}if(je.ismultiply(e))return e.tail().map(Ku).reduce(Ju.add,je.Constants.zero);if(je.isadd(e)){e=Jh.rect(e);let t=Wh.real(e),r=uy.imag(e);if(so.isZeroAtomOrTensor(t))return so.isnegative(r)?El.negate(je.Constants.Pi()):je.Constants.Pi();{let n=Zh.arctan(El.divide(r,t));return so.isnegative(t)?so.isnegative(r)?Ju.subtract(n,je.Constants.Pi()):Ju.add(n,je.Constants.Pi()):n}}return so.isZeroAtomOrTensor(pi.get_binding(pi.symbol(je.ASSUME_REAL_VARIABLES)))?cy.makeList(pi.symbol(je.ARG),e):je.Constants.zero}});var dy=A(ec=>{"use strict";Object.defineProperty(ec,"__esModule",{value:!0});ec.dpow=void 0;var t2=N(),r2=xe(),n2=ce(),fm=j(),o2=X();function i2(e,t){if(e===0&&t<0&&r2.stop("divide by zero"),e>=0||t%1===0)return fm.double(Math.pow(e,t));let r=Math.pow(Math.abs(e),t),n=Math.PI*t,o=0,i=0;return t%.5===0?(o=0,i=Math.sin(n)):(o=Math.cos(n),i=Math.sin(n)),n2.add(fm.double(o*r),o2.multiply(fm.double(i*r),t2.Constants.imaginaryunit))}ec.dpow=i2});var hi=A(tc=>{"use strict";Object.defineProperty(tc,"__esModule",{value:!0});tc.factorial=void 0;var s2=N(),xB=Ie(),pB=ce(),my=j(),a2=ee(),hB=X(),AB=xt(),l2=U();function u2(e){let t=my.nativeInt(e);return t<0||isNaN(t)?a2.makeList(l2.symbol(s2.FACTORIAL),e):my.bignum_factorial(t)}tc.factorial=u2});var nc=A(rc=>{"use strict";Object.defineProperty(rc,"__esModule",{value:!0});rc.mpow=void 0;function c2(e,t){return e.pow(t)}rc.mpow=c2});var _y=A(Fs=>{"use strict";var f2=Fs&&Fs.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Fs,"__esModule",{value:!0});Fs.mroot=void 0;var oc=f2(No()),d2=Tu(),m2=xe(),_2=j(),b2=nc();function g2(e,t){e=e.abs(),t===0&&m2.stop("root index is zero");let r=0;for(;e.shiftRight(r).toJSNumber()>0;)r++;if(r===0)return _2.mint(0);r=Math.floor((r-1)/t);let n=Math.floor(r/32+1),o=oc.default(n);for(let i=0;i<n;i++)o=o.and(oc.default(1).shiftLeft(i).not());for(;r>=0;){o=o.or(oc.default(1).shiftLeft(r));let i=b2.mpow(o,t);switch(d2.mcmp(i,e)){case 0:return o;case 1:o=o.and(oc.default(1).shiftLeft(r).not());break}r--}return 0}Fs.mroot=g2});var Ey=A(js=>{"use strict";Object.defineProperty(js,"__esModule",{value:!0});js.quickpower=js.quickfactor=void 0;var by=N(),y2=ce(),ic=j(),v2=dl(),q2=Q(),gy=ee(),yy=X(),vy=U();function E2(e,t){let r=v2.factor_small_number(ic.nativeInt(e)),n=r.length;for(let o=0;o<n;o+=2)r.push(...qy(r[o],yy.multiply(r[o+1],t)));return yy.multiply_all(r.slice(n))}js.quickfactor=E2;function qy(e,t){let r=ic.bignum_truncate(t),n=y2.subtract(t,r),o;q2.isZeroAtomOrTensor(n)||(o=gy.makeList(vy.symbol(by.POWER),e,n));let i=ic.nativeInt(r);if(isNaN(i)){let u=gy.makeList(vy.symbol(by.POWER),e,r);return o?[o,u]:[u]}if(i===0)return[o];let s=ic.bignum_power_number(e,i);return o?[o,s]:[s]}js.quickpower=qy});var py=A(zs=>{"use strict";var x2=zs&&zs.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(zs,"__esModule",{value:!0});zs.qpow=void 0;var p2=x2(No()),Er=N(),h2=xe(),xy=ce(),ao=j(),Cr=Q(),sc=ee(),dm=nc(),A2=_y(),xl=X(),O2=Ey(),ac=U();function pl(e,t){return M2(e,t)}zs.qpow=pl;function M2(e,t){if(Cr.isplusone(e)||Cr.isZeroAtomOrTensor(t))return Er.Constants.one;if(Cr.isminusone(e)&&Cr.isoneovertwo(t))return Er.Constants.imaginaryunit;if(Cr.isZeroAtomOrTensor(e))return Cr.isnegativenumber(t)&&h2.stop("divide by zero"),Er.Constants.zero;if(Cr.isplusone(t))return e;let r=0,n,o;if(Cr.isinteger(t)){if(r=ao.nativeInt(t),isNaN(r))return sc.makeList(ac.symbol(Er.POWER),e,t);if(n=dm.mpow(e.q.a,Math.abs(r)),o=dm.mpow(e.q.b,Math.abs(r)),r<0){let u=n;n=o,o=u,n=ao.makeSignSameAs(n,o),o=ao.makePositive(o)}return new Er.Num(n,o)}if(Cr.isminusone(e))return T2(t);if(Cr.isnegativenumber(e))return xl.multiply(pl(xl.negate(e),t),pl(Er.Constants.negOne,t));if(!Cr.isinteger(e))return xl.multiply(pl(ao.mp_numerator(e),t),pl(ao.mp_denominator(e),xl.negate(t)));if(N2(e))return O2.quickfactor(e,t);if(!ao.isSmall(t.q.a)||!ao.isSmall(t.q.b))return sc.makeList(ac.symbol(Er.POWER),e,t);let{a:i,b:s}=t.q;return n=A2.mroot(e.q.a,s.toJSNumber()),n===0?sc.makeList(ac.symbol(Er.POWER),e,t):(o=dm.mpow(n,i),t.q.a.isNegative()?new Er.Num(p2.default.one,o):new Er.Num(o))}function T2(e){if(Cr.isinteger(e))return e.q.a.isOdd()?Er.Constants.negOne:Er.Constants.one;let t=ao.bignum_truncate(e);Cr.isnegativenumber(e)&&(t=xy.add(t,Er.Constants.negOne));let r=xy.subtract(e,t),n=sc.makeList(ac.symbol(Er.POWER),Er.Constants.negOne,r);return t.q.a.isOdd()&&(n=xl.negate(n)),n}function N2(e){return ao.isSmall(e.q.a)}});var xt=A(Vs=>{"use strict";Object.defineProperty(Vs,"__esModule",{value:!0});Vs.power=Vs.Eval_power=void 0;var B=N(),lc=sr(),Vt=U(),hl=Ie(),hy=sn(),uc=ce(),I2=ms(),Or=j(),S2=vi(),R2=Co(),w2=dy(),Ay=G(),My=hi(),pt=Q(),Ys=ee(),Qt=X(),L2=py(),Oy=eo(),C2=Wn(),P2=Et(),Je=!1;function D2(e){Je&&B.breakpoint;let t=Ay.Eval(B.cadr(e)),r=Ay.Eval(B.caddr(e));return Mr(t,r)}Vs.Eval_power=D2;function Mr(e,t){return k2(e,t)}Vs.power=Mr;function k2(e,t){Je&&B.breakpoint;let r=t,n=e;if(Je&&console.log(`POWER: ${e} ^ ${t}`),hl.equal(e,B.Constants.one)||pt.isZeroAtomOrTensor(t)){let d=B.Constants.One();return Je&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}if(hl.equal(t,B.Constants.one))return Je&&console.log(`   power of ${n} ^ ${r}: ${e}`),e;if(pt.isminusone(e)&&pt.isminusone(t)){let d=Qt.negate(B.Constants.One());return Je&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}if(pt.isminusone(e)&&pt.isoneovertwo(t)){let d=B.Constants.imaginaryunit;return Je&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}if(pt.isminusone(e)&&pt.isminusoneovertwo(t)){let d=Qt.negate(B.Constants.imaginaryunit);return Je&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}let o;if(pt.isminusone(e)&&!B.isdouble(e)&&B.isrational(t)&&!pt.isinteger(t)&&pt.ispositivenumber(t)&&!B.defs.evaluatingAsFloats){Je&&(console.log("   power: -1 ^ rational"),console.log(` trick: exponent.q.a , exponent.q.b ${t.q.a} , ${t.q.b}`)),t.q.a<t.q.b?o=Ys.makeList(Vt.symbol(B.POWER),e,t):(o=Ys.makeList(Vt.symbol(B.MULTIPLY),e,Ys.makeList(Vt.symbol(B.POWER),e,Or.rational(t.q.a.mod(t.q.b),t.q.b))),Je&&console.log(` trick applied : ${o}`));let d=Oy.rect(o);return Je&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}if(B.isrational(e)&&B.isrational(t)){Je&&console.log("   power: isrational(base) && isrational(exponent)");let d=L2.qpow(e,t);return Je&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}if(B.isNumericAtom(e)&&B.isNumericAtom(t)){let d=w2.dpow(Or.nativeDouble(e),Or.nativeDouble(t));return Je&&(console.log("   power: both base and exponent are either rational or double "),console.log("POWER - isNumericAtom(base) && isNumericAtom(exponent)"),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}if(B.istensor(e)){let d=P2.power_tensor(e,t);return Je&&(console.log("   power: istensor(base) "),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}if(B.car(e)===Vt.symbol(B.ABS)&&pt.iseveninteger(t)&&!pt.isZeroAtomOrTensor(Vt.get_binding(Vt.symbol(B.ASSUME_REAL_VARIABLES)))){let d=Mr(B.cadr(e),t);return Je&&(console.log("   power: even power of absolute of real value "),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}if(e===Vt.symbol(B.E)&&B.car(t)===Vt.symbol(B.LOG)){let d=B.cadr(t);return Je&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}if(e===Vt.symbol(B.E)&&B.isdouble(t)){let d=Or.double(Math.exp(t.d));return Je&&(console.log("   power: base == symbol(E) && isdouble(exponent) "),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}if(e===Vt.symbol(B.E)&&lc.Find(t,B.Constants.imaginaryunit)&&lc.Find(t,Vt.symbol(B.PI))&&!B.defs.evaluatingPolar){let d=Ys.makeList(Vt.symbol(B.POWER),e,t);Je&&console.log(`   power: turning complex exponential to rect: ${d}`);let _=Oy.rect(d);if(!lc.Find(_,Vt.symbol(B.PI)))return Je&&console.log(`   power: turned complex exponential to rect: ${_}`),_}if(B.ismultiply(e)&&pt.isinteger(t)){e=B.cdr(e);let d=Mr(B.car(e),t);return B.iscons(e)&&(d=e.tail().reduce((_,R)=>Qt.multiply(_,Mr(R,t)),d)),Je&&(console.log("   power: (a * b) ^ c  ->  (a ^ c) * (b ^ c) "),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}let i=!1;if(B.isNumericAtom(B.cadr(e))&&(i=hl.sign(Or.compare_numbers(B.cadr(e),B.Constants.zero))>0),B.ispower(e)&&(pt.isinteger(t)||i)){let d=Mr(B.cadr(e),Qt.multiply(B.caddr(e),t));return Je&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}let s=!1;if(pt.iseveninteger(B.caddr(e))){let d=Qt.multiply(B.caddr(e),t);pt.isone(d)&&(s=!0)}if(B.ispower(e)&&s){let d=hy.abs(B.cadr(e));return Je&&(console.log("   power: car(base) == symbol(POWER) && b_isEven_and_c_isItsInverse "),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}if(B.defs.expanding&&B.isadd(e)&&B.isNumericAtom(t)){let d=Or.nativeInt(t);if(d>1&&!isNaN(d)){Je&&console.log("   power: expanding && isadd(base) && isNumericAtom(exponent) ");let _=$2(d,e);return Je&&console.log(`   power of ${n} ^ ${r}: ${_}`),_}}if(B.defs.trigmode===1&&B.car(e)===Vt.symbol(B.SIN)&&pt.iseveninteger(t)){let d=Mr(uc.subtract(B.Constants.one,Mr(R2.cosine(B.cadr(e)),Or.integer(2))),Qt.multiply(t,Or.rational(1,2)));return Je&&(console.log("   power: trigmode == 1 && car(base) == symbol(SIN) && iseveninteger(exponent) "),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}if(B.defs.trigmode===2&&B.car(e)===Vt.symbol(B.COS)&&pt.iseveninteger(t)){let d=Mr(uc.subtract(B.Constants.one,Mr(C2.sine(B.cadr(e)),Or.integer(2))),Qt.multiply(t,Or.rational(1,2)));return Je&&(console.log("   power: trigmode == 2 && car(base) == symbol(COS) && iseveninteger(exponent) "),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}if(pt.iscomplexnumber(e)){if(Je&&console.log(" power - handling the case (a + ib) ^ n"),pt.isinteger(t)){let d=S2.conjugate(e),_=Qt.divide(d,Qt.multiply(d,e));return pt.isone(t)||(_=Mr(_,Qt.negate(t))),Je&&console.log(`   power of ${n} ^ ${r}: ${_}`),_}if(B.isNumericAtom(t)){let d=B.defs.evaluatingAsFloats||pt.iscomplexnumberdouble(e)&&B.isdouble(t)?Or.double(Math.PI):Vt.symbol(B.PI),_=Qt.multiply(Mr(hy.abs(e),t),Mr(B.Constants.negOne,Qt.divide(Qt.multiply(I2.arg(e),t),d)));return B.avoidCalculatingPowersIntoArctans&&lc.Find(_,Vt.symbol(B.ARCTAN))&&(_=Ys.makeList(Vt.symbol(B.POWER),e,t)),Je&&console.log(`   power of ${n} ^ ${r}: ${_}`),_}}let u=U2(t);if(u!==void 0)return Je&&console.log("   power: using simplify_polar"),u;let c=Ys.makeList(Vt.symbol(B.POWER),e,t);return Je&&(console.log("   power: nothing can be done "),console.log(`   power of ${n} ^ ${r}: ${c}`)),c}function $2(e,t){let r=[],n=hl.length(t)-1,o=[];t=B.cdr(t);for(let i=0;i<n;i++){for(let s=0;s<=e;s++)o[i*(e+1)+s]=Mr(B.car(t),Or.integer(s));t=B.cdr(t)}t=My.factorial(Or.integer(e));for(let i=0;i<n;i++)r[i]=0;return Ty(n,e,r,0,e,o,t,B.Constants.zero)}function Ty(e,t,r,n,o,i,s,u){if(n<e-1){for(let d=0;d<=o;d++)r[n]=d,u=Ty(e,t,r,n+1,o-d,i,s,u);return u}r[n]=o;let c=s;for(let d=0;d<e;d++)c=Qt.divide(c,My.factorial(Or.integer(r[d])));for(let d=0;d<e;d++)c=Qt.multiply(c,i[d*(t+1)+r[d]]);return uc.add(u,c)}function U2(e){let t=pt.isquarterturn(e);switch(t){case 0:break;case 1:return B.Constants.one;case 2:return B.Constants.negOne;case 3:return B.Constants.imaginaryunit;case 4:return Qt.negate(B.Constants.imaginaryunit)}if(B.isadd(e)){let r=B.cdr(e);for(;B.iscons(r)&&(t=pt.isquarterturn(B.car(r)),!t);)r=B.cdr(r);let n;switch(t){case 0:return;case 1:n=B.Constants.one;break;case 2:n=B.Constants.negOne;break;case 3:n=B.Constants.imaginaryunit;break;case 4:n=Qt.negate(B.Constants.imaginaryunit);break}return Qt.multiply(n,hl.exponential(uc.subtract(e,B.car(r))))}}});var X=A(Rt=>{"use strict";Object.defineProperty(Rt,"__esModule",{value:!0});Rt.negate_noexpand=Rt.negate=Rt.reciprocate=Rt.inverse=Rt.divide=Rt.multiply_all_noexpand=Rt.multiply_all=Rt.multiply_noexpand=Rt.multiply=Rt.Eval_multiply=void 0;var D=N(),B2=uo(),Sy=xe(),Uo=U(),G2=Ie(),Ol=ce(),lo=j(),Ny=G(),ur=Q(),Zs=ee(),Ry=xt(),Iy=Et();function F2(e){let t=Ny.Eval(D.cadr(e));return e=D.cddr(e),D.iscons(e)&&(t=[...e].reduce((r,n)=>Bo(r,Ny.Eval(n)),t)),t}Rt.Eval_multiply=F2;function Bo(e,t){return D.defs.esc_flag&&Sy.stop("escape key stop"),D.isNumericAtom(e)&&D.isNumericAtom(t)?lo.multiply_numbers(e,t):j2(e,t)}Rt.multiply=Bo;function j2(e,t){if(ur.isZeroAtom(e)||ur.isZeroAtom(t))return D.Constants.Zero();if(D.defs.expanding&&D.isadd(e))return e.tail().reduce((c,d)=>Ol.add(c,Bo(d,t)),D.Constants.Zero());if(D.defs.expanding&&D.isadd(t))return t.tail().reduce((c,d)=>Ol.add(c,Bo(e,d)),D.Constants.Zero());if(!D.istensor(e)&&D.istensor(t))return Iy.scalar_times_tensor(e,t);if(D.istensor(e)&&!D.istensor(t))return Iy.tensor_times_scalar(e,t);e=D.ismultiply(e)?D.cdr(e):Zs.makeList(e),t=D.ismultiply(t)?D.cdr(t):Zs.makeList(t);let r=[];if(D.isNumericAtom(D.car(e))&&D.isNumericAtom(D.car(t))){let c=D.car(e),d=D.car(t);r.push(lo.multiply_numbers(c,d)),e=D.cdr(e),t=D.cdr(t)}else D.isNumericAtom(D.car(e))?(r.push(D.car(e)),e=D.cdr(e)):D.isNumericAtom(D.car(t))?(r.push(D.car(t)),t=D.cdr(t)):r.push(D.Constants.One());let[n,o]=cc(e),[i,s]=fc(t);for(;D.iscons(e)&&D.iscons(t);){if(D.caar(e)===Uo.symbol(D.OPERATOR)&&D.caar(t)===Uo.symbol(D.OPERATOR)){r.push(new D.Cons(Uo.symbol(D.OPERATOR),B2.append(D.cdar(e),D.cdar(t)))),e=D.cdr(e),t=D.cdr(t),[n,o]=cc(e),[i,s]=fc(t);continue}switch(G2.cmp_expr(n,i)){case-1:r.push(D.car(e)),e=D.cdr(e),[n,o]=cc(e);break;case 1:r.push(D.car(t)),t=D.cdr(t),[i,s]=fc(t);break;case 0:z2(r,i,o,s),e=D.cdr(e),t=D.cdr(t),[n,o]=cc(e),[i,s]=fc(t);break;default:Sy.stop("internal error 2")}}if(D.iscons(e)&&r.push(...e),D.iscons(t)&&r.push(...t),H2(r),D.defs.expanding){for(let c=0;c<r.length;c++)if(D.isadd(r[c]))return _m(r)}let u=r.length;return u===1?r.pop():D.isrational(r[0])&&ur.equaln(r[0],1)?u===2?r.pop():(r[0]=Uo.symbol(D.MULTIPLY),Zs.makeList(...r)):new D.Cons(Uo.symbol(D.MULTIPLY),Zs.makeList(...r))}function cc(e){let t=D.car(e),r=D.Constants.One();return D.ispower(t)&&(r=D.caddr(t),t=D.cadr(t)),[t,r]}function fc(e){let t=D.car(e),r=D.Constants.One();return D.ispower(t)&&(r=D.caddr(t),t=D.cadr(t)),[t,r]}function z2(e,t,r,n){let o=Ry.power(t,Ol.add(r,n));if(D.isNumericAtom(o))e[0]=lo.multiply_numbers(e[0],o);else if(D.ismultiply(o))if(D.isNumericAtom(D.cadr(o))&&D.cdddr(o)===Uo.symbol(D.NIL)){let i=e[0],s=D.cadr(o);e[0]=lo.multiply_numbers(i,s),e.push(D.caddr(o))}else e.push(o);else e.push(o)}function Y2(e,t){return D.noexpand(Bo,e,t)}Rt.multiply_noexpand=Y2;function _m(e){if(e.length===1)return e[0];if(e.length===0)return D.Constants.One();let t=e[0];for(let r=1;r<e.length;r++)t=Bo(t,e[r]);return t}Rt.multiply_all=_m;function V2(e){return D.noexpand(_m,e)}Rt.multiply_all_noexpand=V2;function Al(e,t){return D.isNumericAtom(e)&&D.isNumericAtom(t)?lo.divide_numbers(e,t):Bo(e,bm(t))}Rt.divide=Al;function bm(e){return D.isNumericAtom(e)?lo.invert_number(e):Ry.power(e,D.Constants.negOne)}Rt.inverse=bm;function Z2(e){return bm(e)}Rt.reciprocate=Z2;function wy(e){return D.isNumericAtom(e)?lo.negate_number(e):Bo(e,D.Constants.NegOne())}Rt.negate=wy;function X2(e){return D.noexpand(wy,e)}Rt.negate_noexpand=X2;function H2(e){let t=0;if(ur.isplusone(e[0])||ur.isminusone(e[0])||D.isdouble(e[0]))return;for(t=1;t<e.length&&!mm(e[t]);t++);if(t===e.length)return;let r=lo.mp_numerator(e[0]);for(let o=1;o<e.length&&!(ur.isplusone(r)||ur.isminusone(r));o++){if(!mm(e[o]))continue;let i=D.cadr(e[o]),s=D.caddr(e[o]);if(!ur.isnegativenumber(s))continue;let u=Al(r,i);!ur.isinteger(u)||(r=u,e[o]=Zs.makeList(Uo.symbol(D.POWER),i,Ol.add(D.Constants.One(),s)))}let n=lo.mp_denominator(e[0]);for(let o=1;o<e.length&&!ur.isplusone(n);o++){if(!mm(e[o]))continue;let i=D.cadr(e[o]),s=D.caddr(e[o]);if(ur.isnegativenumber(s))continue;let u=Al(n,i);if(!ur.isinteger(u))continue;n=u;let c=Ol.subtract(s,D.Constants.one);if(D.dontCreateNewRadicalsInDenominatorWhenEvalingMultiplication&&ur.isinteger(i)&&!ur.isinteger(c)&&ur.isnegativenumber(c)){r=Al(r,i);break}e[o]=Zs.makeList(Uo.symbol(D.POWER),i,c)}e[0]=Al(r,n)}function mm(e){return D.ispower(e)&&D.isNumericAtom(D.cadr(e))&&ur.isfraction(D.caddr(e))&&!ur.isminusone(D.cadr(e))}});var mc=A(Xs=>{"use strict";Object.defineProperty(Xs,"__esModule",{value:!0});Xs.determinant=Xs.det=void 0;var Go=N(),Ly=Ie(),Cy=ce(),Q2=j(),W2=ee(),Ai=X(),J2=Et(),K2=U();function eA(e){if(!J2.is_square_matrix(e))return W2.makeList(K2.symbol(Go.DET),e);let t=e.tensor.elem;return t.every(n=>Go.isNumericAtom(n))?tA(e):Py(t,e.tensor.dim[0])}Xs.det=eA;function Py(e,t){let r=0,n=[];for(let s=0;s<t;s++)n[s]=s,n[s+t]=0,n[s+t+t]=1;let o=1,i=Go.Constants.zero;for(;;){let s=Q2.integer(o);for(let R=0;R<t;R++){let T=t*n[R]+R;s=Ai.multiply(s,e[T])}i=Cy.add(i,s);let u=t-1,c=0,d=!1;for(;;){if(r=n[t+u]+n[t+t+u],r<0){n[t+t+u]=-n[t+t+u],u--;continue}if(r===u+1){if(u===0){d=!0;break}c++,n[t+t+u]=-n[t+t+u],u--;continue}break}if(d)break;let _=n[u-n[t+u]+c];n[u-n[t+u]+c]=n[u-r+c],n[u-r+c]=_,n[t+u]=r,o=o===1?-1:1}return i}Xs.determinant=Py;function tA(e){let t=e.tensor.dim[0],r=[...e.tensor.elem];return rA(r,t)}function In(e,t,r,n){return e[t*r+n]}function dc(e,t,r,n,o){e[t*r+n]=o}function rA(e,t){let r=Go.Constants.one;for(let n=0;n<t-1;n++){if(Ly.equal(In(e,t,n,n),Go.Constants.zero)){let o=0;for(o=n+1;o<t&&Ly.equal(In(e,t,o,n),Go.Constants.zero);o++);if(o===t){r=Go.Constants.zero;break}for(let i=n;i<t;i++){let s=In(e,t,n,i);dc(e,t,n,i,In(e,t,o,i)),dc(e,t,o,i,s)}r=Ai.negate(r)}r=Ai.multiply(r,In(e,t,n,n));for(let o=n+1;o<t;o++){let i=Ai.negate(Ai.divide(In(e,t,o,n),In(e,t,n,n)));dc(e,t,o,n,Go.Constants.zero);for(let s=n+1;s<t;s++){let u=Cy.add(Ai.multiply(In(e,t,n,s),i),In(e,t,o,s));dc(e,t,o,s,u)}}}return Ai.multiply(r,In(e,t,t-1,t-1))}});var qm=A(_c=>{"use strict";Object.defineProperty(_c,"__esModule",{value:!0});_c.hermite=void 0;var Hs=N(),gm=U(),nA=ce(),vm=j(),oA=G(),iA=ee(),ym=X(),sA=Vr();function aA(e,t){return lA(e,t)}_c.hermite=aA;function lA(e,t){let r=vm.nativeInt(t);return r<0||isNaN(r)?iA.makeList(gm.symbol(Hs.HERMITE),e,t):Hs.issymbol(e)?Dy(r,e):oA.Eval(sA.subst(Dy(r,gm.symbol(Hs.SECRETX)),gm.symbol(Hs.SECRETX),e))}function Dy(e,t){let r=Hs.Constants.zero,n=Hs.Constants.one;for(let o=0;o<e;o++){let i=r;r=n,n=ym.multiply(nA.subtract(ym.multiply(t,r),ym.multiply(vm.integer(o),i)),vm.integer(2))}return n}});var $y=A(bc=>{"use strict";Object.defineProperty(bc,"__esModule",{value:!0});bc.hilbert=void 0;var uA=N(),cA=Ie(),ky=j(),fA=ee(),dA=X(),mA=U();function _A(e){let t=ky.nativeInt(e);if(t<2)return fA.makeList(mA.symbol(uA.HILBERT),e);let r=cA.zero_matrix(t,t);for(let n=0;n<t;n++)for(let o=0;o<t;o++)r.tensor.elem[n*t+o]=dA.inverse(ky.integer(n+o+1));return r}bc.hilbert=_A});var hm=A(Qs=>{"use strict";Object.defineProperty(Qs,"__esModule",{value:!0});Qs.cofactor=Qs.Eval_cofactor=void 0;var Em=N(),xm=xe(),bA=mc(),pm=G(),gA=X(),yA=Et();function vA(e){let t=pm.Eval(Em.cadr(e));yA.is_square_matrix(t)||xm.stop("cofactor: 1st arg: square matrix expected");let r=t.tensor.dim[0],n=pm.evaluate_integer(Em.caddr(e));(n<1||n>r)&&xm.stop("cofactor: 2nd arg: row index expected");let o=pm.evaluate_integer(Em.cadddr(e));return(o<1||o>r)&&xm.stop("cofactor: 3rd arg: column index expected"),Uy(t,r,n-1,o-1)}Qs.Eval_cofactor=vA;function Uy(e,t,r,n){let o=[];for(let s=0;s<t;s++)for(let u=0;u<t;u++)s!==r&&u!==n&&o.push(e.tensor.elem[t*s+u]);let i=bA.determinant(o,t-1);return(r+n)%2&&(i=gA.negate(i)),i}Qs.cofactor=Uy});var Am=A(Ws=>{"use strict";Object.defineProperty(Ws,"__esModule",{value:!0});Ws.adj=Ws.Eval_adj=void 0;var qA=St(),EA=N(),xA=xe(),pA=hm(),hA=G(),AA=Et();function OA(e){return By(hA.Eval(EA.cadr(e)))}Ws.Eval_adj=OA;function By(e){AA.is_square_matrix(e)||xA.stop("adj: square matrix expected");let t=e.tensor.dim[0],r=qA.alloc_tensor(t*t);r.tensor.ndim=2,r.tensor.dim[0]=t,r.tensor.dim[1]=t;for(let n=0;n<t;n++)for(let o=0;o<t;o++)r.tensor.elem[t*o+n]=pA.cofactor(e,t,n,o);return r}Ws.adj=By});var Fo=A(Js=>{"use strict";Object.defineProperty(Js,"__esModule",{value:!0});Js.inner=Js.Eval_inner=void 0;var MA=St(),fe=N(),Mm=xe(),Xr=U(),Ml=ce(),Om=G(),jy=Il(),Tl=Q(),Tm=ee(),gc=X(),Gy=Et();function zy(e){let t=[];t.push(fe.car(fe.cdr(e))),fe.car(fe.cdr(fe.cdr(e)))===Xr.symbol(fe.NIL)&&Mm.stop("pattern needs at least a template and a transformed version");let n=fe.cdr(fe.cdr(e));for(;n!==Xr.symbol(fe.NIL);)t.push(fe.car(n)),n=fe.cdr(n);if(t.length>2){let s=Tm.makeList(Xr.symbol(fe.INNER),t[t.length-2],t[t.length-1]);for(let u=2;u<t.length;u++)s=Tm.makeList(Xr.symbol(fe.INNER),t[t.length-u-1],s);return zy(s)}let o=[];yc(e,o);let i=[];for(let s=0;s<o.length;s++)o[s]!==Xr.symbol(fe.SYMBOL_IDENTITY_MATRIX)&&i.push(o[s]);if(o=i,i=[],o.length>1){let s=0;for(let u=0;u<o.length&&u+s+1<=o.length-1;u++){if(fe.isNumericAtomOrTensor(o[u+s])||fe.isNumericAtomOrTensor(o[u+s+1]))i.push(o[u+s]);else{let c=jy.inv(Om.Eval(o[u+s])),d=Om.Eval(o[u+s+1]),_=Ml.subtract(c,d);Tl.isZeroAtomOrTensor(_)?s+=1:i.push(o[u+s])}if(u+s===o.length-2&&i.push(o[o.length-1]),u+s>=o.length-1)break}o=i}return o.length==0?Xr.symbol(fe.SYMBOL_IDENTITY_MATRIX):(o=o.map(Om.Eval),o.reduce(Nl))}Js.Eval_inner=zy;function Nl(e,t){if(Tl.isnegativeterm(t)&&Tl.isnegativeterm(e)&&(t=gc.negate(t),e=gc.negate(e)),fe.isinnerordot(e)&&(t=Nl(fe.car(fe.cdr(fe.cdr(e))),t),e=fe.car(fe.cdr(e))),e===Xr.symbol(fe.SYMBOL_IDENTITY_MATRIX))return t;if(t===Xr.symbol(fe.SYMBOL_IDENTITY_MATRIX))return e;if(fe.istensor(e)&&fe.istensor(t))return TA(e,t);if(!(fe.isNumericAtomOrTensor(e)||fe.isNumericAtomOrTensor(t))){let r=Ml.subtract(e,jy.inv(t));if(Tl.isZeroAtomOrTensor(r))return Xr.symbol(fe.SYMBOL_IDENTITY_MATRIX)}return fe.defs.expanding&&fe.isadd(e)?e.tail().reduce((r,n)=>Ml.add(r,Nl(n,t)),fe.Constants.zero):fe.defs.expanding&&fe.isadd(t)?t.tail().reduce((r,n)=>Ml.add(r,Nl(e,n)),fe.Constants.zero):fe.istensor(e)&&fe.isNumericAtom(t)?Gy.tensor_times_scalar(e,t):fe.isNumericAtom(e)&&fe.istensor(t)?Gy.scalar_times_tensor(e,t):fe.isNumericAtom(e)||fe.isNumericAtom(t)?gc.multiply(e,t):Tm.makeList(Xr.symbol(fe.INNER),e,t)}Js.inner=Nl;function TA(e,t){let r=e.tensor.dim[e.tensor.ndim-1];r!==t.tensor.dim[0]&&(fe.breakpoint,Mm.stop("inner: tensor dimension check"));let n=e.tensor.ndim+t.tensor.ndim-2;n>fe.MAXDIM&&Mm.stop("inner: rank of result exceeds maximum");let o=e.tensor.elem,i=t.tensor.elem,s=e.tensor.dim.slice(0,e.tensor.dim.length-1).reduce((_,R)=>_*R,1),u=t.tensor.dim.slice(1).reduce((_,R)=>_*R,1),c=MA.alloc_tensor(s*u),d=c.tensor.elem;for(let _=0;_<s;_++)for(let R=0;R<r;R++)if(!Tl.isZeroAtomOrTensor(o[_*r+R]))for(let T=0;T<u;T++)d[_*u+T]=Ml.add(gc.multiply(o[_*r+R],i[R*u+T]),d[_*u+T]);return n===0?c.tensor.elem[0]:(c.tensor.ndim=n,c.tensor.dim=[...e.tensor.dim.slice(0,e.tensor.ndim-1),...t.tensor.dim.slice(1,t.tensor.ndim)],c)}function yc(e,t){if(!fe.iscons(e)){Fy(e,t);return}if(fe.cdr(e)===Xr.symbol(fe.NIL)){yc(fe.car(e),t);return}if(fe.isinnerordot(e)){yc(fe.car(fe.cdr(e)),t),yc(fe.cdr(fe.cdr(e)),t);return}Fy(e,t)}function Fy(e,t){e!==Xr.symbol(fe.NIL)&&t.push(e)}});var Il=A(Ks=>{"use strict";Object.defineProperty(Ks,"__esModule",{value:!0});Ks.invg=Ks.inv=void 0;var NA=St(),Tr=N(),Zy=xe(),Yy=Ie(),Vy=ce(),IA=Am(),SA=mc(),RA=Fo(),wA=Q(),Xy=ee(),Sl=X(),Hy=Et(),Qy=U();function Wy(e){if(Tr.isinv(e))return Tr.car(Tr.cdr(e));if(Tr.isidentitymatrix(e))return e;if(Tr.defs.expanding&&Tr.isinnerordot(e)){let n=(Tr.iscons(e)?e.tail():[]).map(Wy);for(let o=n.length-1;o>0;o--)n[o-1]=RA.inner(n[o],n[o-1]);return n[0]}if(!Hy.is_square_matrix(e))return Xy.makeList(Qy.symbol(Tr.INV),e);if(Tr.isNumericAtomOrTensor(e))return Jy(e);let t=SA.det(e);return wA.isZeroAtomOrTensor(t)&&Zy.stop("inverse of singular matrix"),Sl.divide(IA.adj(e),t)}Ks.inv=Wy;function LA(e){return Hy.is_square_matrix(e)?Jy(e):Xy.makeList(Qy.symbol(Tr.INVG),e)}Ks.invg=LA;function Jy(e){let t=e.tensor.dim[0],r=new Array(t*t);r.fill(Tr.Constants.zero);for(let i=0;i<t;i++)r[i*t+i]=Tr.Constants.one;let n=CA(r,e.tensor.elem,t),o=NA.alloc_tensor(t*t);return o.tensor.ndim=2,o.tensor.dim[0]=t,o.tensor.dim[1]=t,o.tensor.elem=n,o}function CA(e,t,r){for(let n=0;n<r;n++){if(Yy.equal(t[r*n+n],Tr.Constants.zero)){let i=0;for(i=n+1;i<r&&Yy.equal(t[r*i+n],Tr.Constants.zero);i++);i===r&&Zy.stop("inverse of singular matrix");for(let s=0;s<r;s++){let u=t[r*n+s];t[r*n+s]=t[r*i+s],t[r*i+s]=u,u=e[r*n+s],e[r*n+s]=e[r*i+s],e[r*i+s]=u}}let o=t[r*n+n];for(let i=0;i<r;i++)i>n&&(t[r*n+i]=Sl.divide(t[r*n+i],o)),e[r*n+i]=Sl.divide(e[r*n+i],o);for(let i=0;i<r;i++){if(i===n)continue;let s=t[r*i+n];for(let u=0;u<r;u++)u>n&&(t[r*i+u]=Vy.subtract(t[r*i+u],Sl.multiply(t[r*n+u],s))),e[r*i+u]=Vy.subtract(e[r*i+u],Sl.multiply(e[r*n+u],s))}}return e}});var Im=A(ea=>{"use strict";Object.defineProperty(ea,"__esModule",{value:!0});ea.besselj=ea.Eval_besselj=void 0;var Wt=N(),PA=uo(),Rl=U(),vc=ce(),fn=j(),DA=Co(),Ky=G(),wl=Q(),Nm=ee(),cr=X(),Ll=xt(),kA=Wn();function $A(e){return qc(Ky.Eval(Wt.cadr(e)),Ky.Eval(Wt.caddr(e)))}ea.Eval_besselj=$A;function qc(e,t){return UA(e,t)}ea.besselj=qc;function UA(e,t){let r=fn.nativeInt(t);if(Wt.isdouble(e)&&!isNaN(r)){let n=PA.jn(r,e.d);return fn.double(n)}if(wl.isZeroAtomOrTensor(e)&&wl.isZeroAtomOrTensor(t))return Wt.Constants.one;if(wl.isZeroAtomOrTensor(e)&&!isNaN(r))return Wt.Constants.zero;if(t.k===Wt.NUM&&Wt.MEQUAL(t.q.b,2)){if(Wt.MEQUAL(t.q.a,1)){let o=Wt.defs.evaluatingAsFloats?fn.double(2/Math.PI):cr.divide(fn.integer(2),Rl.symbol(Wt.PI));return cr.multiply(Ll.power(cr.divide(o,e),fn.rational(1,2)),kA.sine(e))}if(Wt.MEQUAL(t.q.a,-1)){let o=Wt.defs.evaluatingAsFloats?fn.double(2/Math.PI):cr.divide(fn.integer(2),Rl.symbol(Wt.PI));return cr.multiply(Ll.power(cr.divide(o,e),fn.rational(1,2)),DA.cosine(e))}let n=fn.integer(Wt.MSIGN(t.q.a));return vc.subtract(cr.multiply(cr.multiply(cr.divide(fn.integer(2),e),vc.subtract(t,n)),qc(e,vc.subtract(t,n))),qc(e,vc.subtract(t,cr.multiply(fn.integer(2),n))))}return wl.isnegativeterm(e)?cr.multiply(cr.multiply(Ll.power(cr.negate(e),t),Ll.power(e,cr.negate(t))),Nm.makeList(Rl.symbol(Wt.BESSELJ),cr.negate(e),t)):wl.isnegativeterm(t)?cr.multiply(Ll.power(Wt.Constants.negOne,t),Nm.makeList(Rl.symbol(Wt.BESSELJ),e,cr.negate(t))):Nm.makeList(Rl.symbol(Wt.BESSELJ),e,t)}});var Sm=A(ra=>{"use strict";Object.defineProperty(ra,"__esModule",{value:!0});ra.bessely=ra.Eval_bessely=void 0;var ta=N(),BA=uo(),ev=U(),tv=j(),rv=G(),GA=Q(),nv=ee(),ov=X(),FA=xt();function jA(e){return iv(rv.Eval(ta.cadr(e)),rv.Eval(ta.caddr(e)))}ra.Eval_bessely=jA;function iv(e,t){return zA(e,t)}ra.bessely=iv;function zA(e,t){let r=tv.nativeInt(t);if(ta.isdouble(e)&&!isNaN(r)){let n=BA.yn(r,e.d);return tv.double(n)}return GA.isnegativeterm(t)?ov.multiply(FA.power(ta.Constants.negOne,t),nv.makeList(ev.symbol(ta.BESSELY),e,ov.negate(t))):nv.makeList(ev.symbol(ta.BESSELY),e,t)}});var Rm=A(na=>{"use strict";Object.defineProperty(na,"__esModule",{value:!0});na.ycosh=na.Eval_cosh=void 0;var Oi=N(),sv=U(),YA=j(),VA=G(),ZA=Q(),XA=ee();function HA(e){return av(VA.Eval(Oi.cadr(e)))}na.Eval_cosh=HA;function av(e){if(Oi.car(e)===sv.symbol(Oi.ARCCOSH))return Oi.cadr(e);if(Oi.isdouble(e)){let t=Math.cosh(e.d);return Math.abs(t)<1e-10&&(t=0),YA.double(t)}return ZA.isZeroAtomOrTensor(e)?Oi.Constants.one:XA.makeList(sv.symbol(Oi.COSH),e)}na.ycosh=av});var Pm=A(oa=>{"use strict";Object.defineProperty(oa,"__esModule",{value:!0});oa.dirac=oa.Eval_dirac=void 0;var xr=N(),wm=U(),QA=G(),Lm=Q(),Cm=ee(),WA=un(),lv=X();function JA(e){return uv(QA.Eval(xr.cadr(e)))}oa.Eval_dirac=JA;function uv(e){return KA(e)}oa.dirac=uv;function KA(e){return xr.isdouble(e)?e.d===0?xr.Constants.one:xr.Constants.zero:xr.isrational(e)?xr.MZERO(WA.mmul(e.q.a,e.q.b))?xr.Constants.one:xr.Constants.zero:xr.ispower(e)?Cm.makeList(wm.symbol(xr.DIRAC),xr.cadr(e)):Lm.isnegativeterm(e)?Cm.makeList(wm.symbol(xr.DIRAC),lv.negate(e)):((Lm.isnegativeterm(e)||xr.isadd(e)&&Lm.isnegativeterm(xr.cadr(e)))&&(e=lv.negate(e)),Cm.makeList(wm.symbol(xr.DIRAC),e))}});var fv=A(Ec=>{"use strict";Object.defineProperty(Ec,"__esModule",{value:!0});Ec.partition=void 0;var Dm=N(),eO=sr(),cv=X();function tO(e,t){let r=Dm.Constants.one,n=r;if(e=Dm.cdr(e),!Dm.iscons(e))return[r,n];for(let o of e)eO.Find(o,t)?n=cv.multiply(n,o):r=cv.multiply(r,o);return[r,n]}Ec.partition=tO});var Vo=A(la=>{"use strict";Object.defineProperty(la,"__esModule",{value:!0});la.scan_meta=la.scan=void 0;var rO=St(),W=N(),jo=uo(),nO=xe(),mt=U(),dv=j(),oO=Q(),Zt=ee(),xc=X(),iO=Et(),jm=1001,zm=1002,pc=1003,Ym=1004,Um=1006,Vm=1007,_v=1008,bv=1009,gv=1010,yv=1011,Bm=1012,te="",Dl=0,Zm=0,Hr=0,J=0,sa=0,dt="",hc=null,Xe=null,Pl=null,Yo=null,aa=null,Ke=null,zo=!1,Gm=null,ye="";function sO(e){W.DEBUG&&console.log(`#### scanning ${e}`),hc=null,Xe=[],Pl=[],Yo=!0,aa=[],Ke=[""],Gm=!1,ye=e,Zm=0;let t=W.defs.expanding;if(W.defs.expanding=!0,Hr=0,J=0,Pe(),te==="")return W.defs.expanding=t,[0,mt.symbol(W.NIL)];let r=fo();return W.defs.expanding=t,Gm||(W.defs.symbolsInExpressionsWithoutAssignments=W.defs.symbolsInExpressionsWithoutAssignments.concat(Pl)),[sa-Hr,r]}la.scan=sO;function aO(e){ye=e,Zm=1;let t=W.defs.expanding;if(W.defs.expanding=!0,Hr=0,J=0,Pe(),te==="")return W.defs.expanding=t,mt.symbol(W.NIL);let r=fo();return W.defs.expanding=t,r}la.scan_meta=aO;function fo(){let e=mv(),t=!1;if(te===Bm&&(t=!0),te===Bm||te==="="){let r=hc;W.DEBUG&&console.log("assignment!"),Gm=!0,Yo=!1,Pe();let n=mv();if(t&&(n=Zt.makeList(mt.symbol(W.QUOTE),n)),e=Zt.makeList(mt.symbol(W.SETQ),e,n),Yo=!0,W.defs.codeGen){let o=Xe.indexOf(r);if(o!==-1&&(Xe.splice(o,1),W.defs.symbolsHavingReassignments.push(r)),W.DEBUG){console.log(`locally, ${r} depends on: `);for(let s of Array.from(Xe))console.log(`  ${s}`)}W.defs.symbolsDependencies[r]==null&&(W.defs.symbolsDependencies[r]=[]);let i=W.defs.symbolsDependencies[r];for(let s of Array.from(Xe))i.indexOf(s)===-1&&i.push(s);Xe=[]}}return e}function mv(){let e=co(),t;switch(te){case gv:return Pe(),t=co(),Zt.makeList(mt.symbol(W.TESTEQ),e,t);case yv:return Pe(),t=co(),Zt.makeList(mt.symbol(W.NOT),Zt.makeList(mt.symbol(W.TESTEQ),e,t));case bv:return Pe(),t=co(),Zt.makeList(mt.symbol(W.TESTLE),e,t);case _v:return Pe(),t=co(),Zt.makeList(mt.symbol(W.TESTGE),e,t);case"<":return Pe(),t=co(),Zt.makeList(mt.symbol(W.TESTLT),e,t);case">":return Pe(),t=co(),Zt.makeList(mt.symbol(W.TESTGT),e,t)}return e}function co(){let e=[mt.symbol(W.ADD)];switch(te){case"+":Pe(),e.push(Cl());break;case"-":Pe(),e.push(xc.negate(Cl()));break;default:e.push(Cl())}for(;Dl===0&&(te==="+"||te==="-");)te==="+"?(Pe(),e.push(Cl())):(Pe(),e.push(xc.negate(Cl())));return e.length===2?e[1]:Zt.makeList(...e)}function Xm(){if(typeof te=="string")return te.charCodeAt(0)}function lO(){if(Xm()===W.dotprod_unicode)return!0;switch(te){case"*":case"/":return!0;case"(":case pc:case Ym:case jm:case zm:case Vm:return Dl?(J=sa,!1):!0}return!1}function km(e){e.length>0&&W.isrational(e[e.length-1])&&oO.equaln(e[e.length-1],1)&&e.pop()}function uO(e){if(e.length>1&&W.isNumericAtom(e[e.length-2])&&W.isNumericAtom(e[e.length-1])){let t=e.pop(),r=e.pop();e.push(xc.multiply(r,t))}}function Cl(){let e=[ia()];for(W.parse_time_simplifications&&km(e);lO();)te==="*"?(Pe(),e.push(ia())):te==="/"?(km(e),Pe(),e.push(xc.inverse(ia()))):Xm()===W.dotprod_unicode?(Pe(),e.push(Zt.makeList(mt.symbol(W.INNER),e.pop(),ia()))):e.push(ia()),W.parse_time_simplifications&&(uO(e),km(e));return e.length===0?W.Constants.one:e.length==1?e[0]:Zt.makeList(mt.symbol(W.MULTIPLY),...e)}function cO(e){return te==="^"?(Pe(),Zt.makeList(mt.symbol(W.POWER),e,ia())):e}function fO(e){Pe();let t=[mt.symbol(W.INDEX),e,co()];for(;te===",";)Pe(),t.push(co());return te!=="]"&&Sn("] expected"),Pe(),Zt.makeList(...t)}function ia(){let e=!1,t;for(te==="("?t=yO():te===pc?t=mO():te===Ym?t=bO():te==="["?t=vO():te===jm?(e=!0,t=dv.bignum_scan_integer(dt),te=Pe()):te===zm?(e=!0,t=dv.bignum_scan_float(dt),te=Pe()):te===Vm?t=_O():Sn("syntax error");te==="["||te==="("&&Dl===0&&!e;)te==="["?t=fO(t):te==="("&&(t=gO(t));for(;te==="!";)Pe(),t=Zt.makeList(mt.symbol(W.FACTORIAL),t);for(;Xm()===W.transpose_unicode;)Pe(),t=Zt.makeList(mt.symbol(W.TRANSPOSE),t);return cO(t)}function Fm(e){if(W.predefinedSymbolsInGlobalScope_doNotTrackInDependencies.indexOf(e)===-1&&Xe.indexOf(e)===-1&&Xe.indexOf("'"+e)===-1&&!zo){W.DEBUG&&console.log(`... adding symbol: ${e} to the set of the symbols right of assignment`);let t="";for(let r=1;r<Ke.length;r++)Ke[r]!==""&&(t+=Ke[r]+"_"+r+"_");e=t+e,Xe.push(e)}}function dO(e){if(W.predefinedSymbolsInGlobalScope_doNotTrackInDependencies.indexOf(e)===-1&&Pl.indexOf(e)===-1&&Pl.indexOf("'"+e)===-1&&!zo){W.DEBUG&&console.log(`... adding symbol: ${e} to the set of the symbols left of assignment`);let t="";for(let r=1;r<Ke.length;r++)Ke[r]!==""&&(t+=Ke[r]+"_"+r+"_");e=t+e,Pl.push(e)}}function mO(){te!==pc&&Sn("symbol expected");let e;if(Zm&&typeof dt=="string"&&dt.length===1)switch(dt[0]){case"a":e=mt.symbol(W.METAA);break;case"b":e=mt.symbol(W.METAB);break;case"x":e=mt.symbol(W.METAX);break;default:e=mt.usr_symbol(dt)}else e=mt.usr_symbol(dt);return aa.length===0?(W.DEBUG&&console.log(`out of scanning parameters, processing ${dt}`),hc=dt,Yo&&dO(dt)):(W.DEBUG&&console.log(`still scanning parameters, skipping ${dt}`),Yo&&Fm("'"+dt)),W.DEBUG&&console.log(`found symbol: ${dt} left of assignment: ${Yo}`),Yo||Fm(dt),Pe(),e}function _O(){let e=new W.Str(dt);return Pe(),e}function bO(){W.DEBUG&&console.log("-- scan_function_call_with_function_name start");let e=1,r=[mt.usr_symbol(dt)],n=dt;if((n==="roots"||n==="defint"||n==="sum"||n==="product"||n==="for")&&Ke.push(dt),hc=dt,Yo||Fm(dt),Pe(),Pe(),aa.push(!0),te!==")"){for(r.push(fo()),e++;te===",";)Pe(),e===2&&Ke[Ke.length-1].indexOf("roots")!==-1&&(Xe=Xe.filter(o=>!new RegExp("roots_"+(Ke.length-1)+"_"+dt).test(o)),zo=!0),e===2&&Ke[Ke.length-1].indexOf("sum")!==-1&&(Xe=Xe.filter(o=>!new RegExp("sum_"+(Ke.length-1)+"_"+dt).test(o)),zo=!0),e===2&&Ke[Ke.length-1].indexOf("product")!==-1&&(Xe=Xe.filter(o=>!new RegExp("product_"+(Ke.length-1)+"_"+dt).test(o)),zo=!0),e===2&&Ke[Ke.length-1].indexOf("for")!==-1&&(Xe=Xe.filter(o=>!new RegExp("for_"+(Ke.length-1)+"_"+dt).test(o)),zo=!0),Ke[Ke.length-1].indexOf("defint")!==-1&&(e===2||e>2&&(e-2)%3===0)&&(Xe=Xe.filter(o=>!new RegExp("defint_"+(Ke.length-1)+"_"+dt).test(o)),zo=!0),r.push(fo()),zo=!1,e++;e===2&&Ke[Ke.length-1].indexOf("roots")!==-1&&(Xe=Xe.filter(o=>!new RegExp("roots_"+(Ke.length-1)+"_x").test(o)))}aa.pop();for(let o=0;o<=Xe.length;o++)Xe[o]!=null&&(n==="roots"&&(Xe[o]=Xe[o].replace(new RegExp("roots_"+(Ke.length-1)+"_"),"")),n==="defint"&&(Xe[o]=Xe[o].replace(new RegExp("defint_"+(Ke.length-1)+"_"),"")),n==="sum"&&(Xe[o]=Xe[o].replace(new RegExp("sum_"+(Ke.length-1)+"_"),"")),n==="product"&&(Xe[o]=Xe[o].replace(new RegExp("product_"+(Ke.length-1)+"_"),"")),n==="for"&&(Xe[o]=Xe[o].replace(new RegExp("for_"+(Ke.length-1)+"_"),"")));return te!==")"&&Sn(") expected"),Pe(),(n==="roots"||n==="defint"||n==="sum"||n==="product"||n==="for")&&Ke.pop(),n===mt.symbol(W.PATTERN).printname&&(W.defs.patternHasBeenFound=!0),W.DEBUG&&console.log("-- scan_function_call_with_function_name end"),Zt.makeList(...r)}function gO(e){W.DEBUG&&console.log("-- scan_function_call_without_function_name start");let r=[Zt.makeList(mt.symbol(W.EVAL),e)];if(Pe(),aa.push(!0),te!==")")for(r.push(fo());te===",";)Pe(),r.push(fo());return aa.pop(),te!==")"&&Sn(") expected"),Pe(),W.DEBUG&&console.log(`-- scan_function_call_without_function_name end: ${r[r.length-1]}`),Zt.makeList(...r)}function yO(){te!=="("&&Sn("( expected"),te=Pe();let t=fo();return te!==")"&&Sn(") expected"),Pe(),t}function vO(){te!=="["&&Sn("[ expected"),Pe();let e=[fo()];for(;te===",";)te=Pe(),e.push(fo());let t=qO(e);return te!=="]"&&Sn("] expected"),Pe(),t}function Sn(e){for(W.defs.errorMessage="";Hr!==J&&!((ye[Hr]===`
`||ye[Hr]==="\r")&&Hr+1===J);)W.defs.errorMessage+=ye[Hr++];for(W.defs.errorMessage+=" ? ";ye[Hr]&&ye[Hr]!==`
`&&ye[Hr]!=="\r";)W.defs.errorMessage+=ye[Hr++];W.defs.errorMessage+=`
`,nO.stop(e)}function qO(e){let t=rO.alloc_tensor(e.length);t.tensor.ndim=1,t.tensor.dim[0]=e.length;for(let r=0;r<e.length;r++)t.tensor.elem[r]=e[r];return iO.check_tensor_dimensions(t),t}function Pe(){for(Dl=0;EO(),te===Um;)Dl=1;return W.DEBUG&&console.log(`get_next_token token: ${te}`),te}function EO(){for(;jo.isspace(ye[J]);){if(ye[J]===`
`||ye[J]==="\r"){te=Um,J++;return}J++}if(sa=J,J===ye.length){te="";return}if(jo.isdigit(ye[J])||ye[J]==="."){for(;jo.isdigit(ye[J]);)J++;if(ye[J]==="."){for(J++;jo.isdigit(ye[J]);)J++;if(ye[J]==="e"&&(ye[J+1]==="+"||ye[J+1]==="-"||jo.isdigit(ye[J+1])))for(J+=2;jo.isdigit(ye[J]);)J++;te=zm}else te=jm;$m(sa,J);return}if(jo.isalpha(ye[J])){for(;jo.isalnumorunderscore(ye[J]);)J++;ye[J]==="("?te=Ym:te=pc,$m(sa,J);return}if(ye[J]==='"'){for(J++;ye[J]!=='"';)J===ye.length-1&&(J++,Sn("runaway string"),J--),J++;J++,te=Vm,$m(sa+1,J-1);return}if(ye[J]==="#"||ye[J]==="-"&&ye[J+1]==="-"){for(;ye[J]&&ye[J]!==`
`&&ye[J]!=="\r";)J++;ye[J]&&J++,te=Um;return}if(ye[J]===":"&&ye[J+1]==="="){J+=2,te=Bm;return}if(ye[J]==="="&&ye[J+1]==="="){J+=2,te=gv;return}if(ye[J]==="!"&&ye[J+1]==="="){J+=2,te=yv;return}if(ye[J]==="<"&&ye[J+1]==="="){J+=2,te=bv;return}if(ye[J]===">"&&ye[J+1]==="="){J+=2,te=_v;return}te=ye[J++]}function $m(e,t){dt=ye.substring(e,t)}});var wn=A(Zo=>{"use strict";Object.defineProperty(Zo,"__esModule",{value:!0});Zo.yyfloat=Zo.zzfloat=Zo.Eval_float=void 0;var YB=Oc(),Rn=N(),VB=xe(),vv=U(),qv=j(),Ac=G(),xO=ee(),pO=Et();function hO(e){return Rn.evalFloats(()=>Ac.Eval(Qm(Ac.Eval(Rn.cadr(e)))))}Zo.Eval_float=hO;function AO(e){return Rn.evalFloats(()=>{e=Ac.Eval(e),e=Qm(e),e=Ac.Eval(e)}),e}Zo.zzfloat=AO;function Qm(e){return Rn.evalFloats(Hm,e)}Zo.yyfloat=Qm;function Hm(e){return Rn.iscons(e)?xO.makeList(...e.map(Hm)):Rn.istensor(e)?(e=pO.copy_tensor(e),e.tensor.elem=e.tensor.elem.map(Hm),e):Rn.isrational(e)?qv.bignum_float(e):e===vv.symbol(Rn.PI)?Rn.Constants.piAsDouble:e===vv.symbol(Rn.E)?qv.double(Math.E):e}});var Wm=A(ca=>{"use strict";Object.defineProperty(ca,"__esModule",{value:!0});ca.roots=ca.Eval_roots=void 0;var OO=St(),Le=N(),pv=xe(),fr=U(),MO=Ie(),Mc=sn(),Ae=ce(),z=j(),TO=yi(),ua=G(),NO=xs(),IO=Zr(),br=Q(),M=X(),He=xt(),Jt=Xo(),ot={debug:e=>{Le.DEBUG&&console.log(e)}},SO=e=>[].concat(...e);function RO(e){let t=Le.cadr(e),r;Le.car(t)===fr.symbol(Le.SETQ)||Le.car(t)===fr.symbol(Le.TESTEQ)?r=Ae.subtract(ua.Eval(Le.cadr(t)),ua.Eval(Le.caddr(t))):(t=ua.Eval(t),Le.car(t)===fr.symbol(Le.SETQ)||Le.car(t)===fr.symbol(Le.TESTEQ)?r=Ae.subtract(ua.Eval(Le.cadr(t)),ua.Eval(Le.caddr(t))):r=t),t=ua.Eval(Le.caddr(e));let n=t===fr.symbol(Le.NIL)?IO.guess(r):t;return br.ispolyexpandedform(r,n)||pv.stop("roots: 1st argument is not a polynomial in the variable "+n),kl(r,n)}ca.Eval_roots=RO;function wO(e){return e.some(t=>br.iscomplexnumber(t))}function LO(e){return e.length<=2||br.isZeroAtomOrTensor(e[0])?!1:e.slice(1,e.length-1).every(t=>br.isZeroAtomOrTensor(t))}function Tc(e,t){let r=TO.coeff(e,t),n=r[r.length-1];return r.map(o=>M.divide(o,n))}function kl(e,t){if(Le.defs.recursionLevelNestedRadicalsRemoval>1)return fr.symbol(Le.NIL);ot.debug(`checking if ${e} is a case of simple roots`);let r=Tc(e,t),n=[];if(LO(r)){ot.debug(`yes, ${r[r.length-1]} is a case of simple roots`);let s=r.length,u=r[0],c=r.pop(),d=CO(s,c,u);n.push(...d)}else{let s=PO(e,t);n.push(...s)}let o=n.length;if(o===0&&pv.stop("roots: the polynomial is not factorable, try nroots"),o===1)return n[0];MO.sort(n);let i=OO.alloc_tensor(o);i.tensor.ndim=1,i.tensor.dim[0]=o;for(let s=0;s<o;s++)i.tensor.elem[s]=n[s];return console.log(`roots returning ${i}`),i}ca.roots=kl;function CO(e,t,r){ot.debug("getSimpleRoots"),e=e-1;let n=M.divide(He.power(r,z.rational(1,e)),He.power(t,z.rational(1,e))),o=[];if(e%2===0){for(let i=1;i<=e;i+=2){let s=M.multiply(n,He.power(Le.Constants.negOne,z.rational(i,e)));o.push(s),o.push(M.negate(s))}return o}for(let i=1;i<=e;i++){let s=M.multiply(n,He.power(Le.Constants.negOne,z.rational(i,e)));i%2===0&&(s=M.negate(s)),o.push(s)}return o}function PO(e,t){let r=Tc(e,t);if(wO(r)||(e=NO.factorpoly(e,t)),Le.ismultiply(e)){let n=e.tail().map(o=>Ev(o,t));return SO(n)}return Ev(e,t)}function Ev(e,t){if(Le.ispower(e)&&br.ispolyexpandedform(Le.cadr(e),t)&&br.isposint(Le.caddr(e))){let r=Tc(Le.cadr(e),t);return xv(r)}if(br.ispolyexpandedform(e,t)){let r=Tc(e,t);return xv(r)}return[]}function xv(e){let t=e.length;if(t===2){let r=e.pop(),n=e.pop();return DO(r,n)}if(t===3){let r=e.pop(),n=e.pop(),o=e.pop();return kO(r,n,o)}if(t===4){let r=e.pop(),n=e.pop(),o=e.pop(),i=e.pop();return $O(r,n,o,i)}if(t===5){let r=e.pop(),n=e.pop(),o=e.pop(),i=e.pop(),s=e.pop();return BO(r,n,o,i,s)}return[]}function DO(e,t){return[M.negate(M.divide(t,e))]}function kO(e,t,r){let n=He.power(Ae.subtract(He.power(t,z.integer(2)),M.multiply(M.multiply(z.integer(4),e),r)),z.rational(1,2)),o=M.divide(Ae.subtract(n,t),M.multiply(e,z.integer(2))),i=M.multiply(M.divide(M.negate(Ae.add(n,t)),e),z.rational(1,2));return[o,i]}function $O(e,t,r,n){let o=M.multiply(M.multiply(r,r),r),i=M.multiply(t,t),s=M.multiply(i,t),u=M.multiply(M.multiply(s,n),z.integer(-4)),c=M.multiply(s,z.integer(2)),d=M.multiply(z.integer(3),e),_=M.multiply(M.multiply(e,e),n),R=M.multiply(_,z.integer(27)),T=M.multiply(M.multiply(_,n),z.integer(-27)),k=M.multiply(M.multiply(e,r),t),Z=M.multiply(M.multiply(e,r),z.integer(3)),Y=M.multiply(z.integer(-4),M.multiply(e,o)),Oe=M.negate(M.multiply(k,z.integer(9))),tt=M.multiply(M.multiply(k,n),z.integer(18)),Ze=Ae.subtract(i,Z),ke=M.multiply(i,M.multiply(r,r)),st=M.divide(M.negate(t),d),Me=M.multiply(He.power(Ze,z.integer(3)),z.integer(4)),at=Mc.absValFloat(Jt.simplify(Ze)),ir=Mc.absValFloat(Jt.simplify(Ae.add_all([tt,u,ke,Y,T]))),Gt=Ae.add_all([c,Oe,R]),qr=Jt.simplify(He.power(Ae.subtract(He.power(Gt,z.integer(2)),Me),z.rational(1,2)));if(ot.debug(">>>>>>>>>>>>>>>> actually using cubic formula <<<<<<<<<<<<<<< "),ot.debug(`cubic: D0: ${Ze}`),ot.debug(`cubic: D0 as float: ${at}`),ot.debug(`cubic: DETERMINANT: ${ir}`),ot.debug(`cubic: D1: ${Gt}`),br.isZeroAtomOrTensor(ir))return UO(e,t,r,n,{R_DELTA0_toBeCheckedIfZero:at,R_m_b_over_3a:st,R_DELTA0:Ze,R_b3:s,R_a_b_c:k});let It=!1,fi=!1,Vn;for(;!It;){let il=fi?M.negate(qr):qr;Vn=Jt.simplify(He.power(M.multiply(Ae.add(il,Gt),z.rational(1,2)),z.rational(1,3)));let is=Mc.absValFloat(Jt.simplify(Vn));ot.debug(`cubic: C: ${Vn}`),ot.debug(`cubic: C as absval and float: ${is}`),br.isZeroAtomOrTensor(is)?(ot.debug(" cubic: C IS ZERO flipping the sign"),fi=!0):It=!0}let el=M.multiply(M.multiply(Vn,d),z.integer(2)),xu=M.multiply(Le.Constants.imaginaryunit,He.power(z.integer(3),z.rational(1,2))),pu=Ae.add(Le.Constants.one,xu),tl=Ae.subtract(Le.Constants.one,xu),nn=M.divide(Vn,d),Zn=st,hu=M.negate(nn),rl=M.negate(M.divide(Ze,M.multiply(Vn,d))),on=Jt.simplify(Ae.add_all([Zn,hu,rl])),di=st,Xn=M.divide(M.multiply(nn,pu),z.integer(2)),Au=M.divide(M.multiply(tl,Ze),el),nl=Jt.simplify(Ae.add_all([di,Xn,Au])),ol=st,Id=M.divide(M.multiply(nn,tl),z.integer(2)),os=M.divide(M.multiply(pu,Ze),el),Ou=Jt.simplify(Ae.add_all([ol,Id,os]));return[on,nl,Ou]}function UO(e,t,r,n,o){let{R_DELTA0_toBeCheckedIfZero:i,R_m_b_over_3a:s,R_DELTA0:u,R_b3:c,R_a_b_c:d}=o;if(br.isZeroAtomOrTensor(i))return ot.debug(" cubic: DETERMINANT IS ZERO and delta0 is zero"),[s];ot.debug(" cubic: DETERMINANT IS ZERO and delta0 is not zero");let _=M.divide(Ae.subtract(M.multiply(e,M.multiply(n,z.integer(9))),M.multiply(t,r)),M.multiply(u,z.integer(2))),R=M.negate(c),T=M.negate(M.multiply(e,M.multiply(e,M.multiply(n,z.integer(9))))),k=M.multiply(d,z.integer(4)),Z=M.divide(Ae.add_all([k,T,R]),M.multiply(e,u));return[_,_,Z]}function BO(e,t,r,n,o){return ot.debug(">>>>>>>>>>>>>>>> actually using quartic formula <<<<<<<<<<<<<<< "),br.isZeroAtomOrTensor(t)&&br.isZeroAtomOrTensor(n)&&!br.isZeroAtomOrTensor(r)&&!br.isZeroAtomOrTensor(o)?GO(e,t,r,n,o):br.isZeroAtomOrTensor(t)?FO(e,t,r,n,o):jO(e,t,r,n,o)}function GO(e,t,r,n,o){ot.debug("biquadratic case");let i=kl(Ae.add(M.multiply(e,He.power(fr.symbol(Le.SECRETX),z.integer(2))),Ae.add(M.multiply(r,fr.symbol(Le.SECRETX)),o)),fr.symbol(Le.SECRETX)),s=[];for(let u of i.tensor.elem)s.push(Jt.simplify(He.power(u,z.rational(1,2)))),s.push(Jt.simplify(M.negate(He.power(u,z.rational(1,2)))));return s}function FO(e,t,r,n,o){let i=r,s=n,u=o,c=M.multiply(z.rational(5,2),i),d=Ae.subtract(M.multiply(z.integer(2),He.power(i,z.integer(2))),u),_=Ae.add(M.multiply(z.rational(-1,2),M.multiply(i,u)),Ae.add(M.divide(He.power(i,z.integer(3)),z.integer(2)),M.multiply(z.rational(-1,8),He.power(s,z.integer(2))))),R=Ae.add(He.power(fr.symbol(Le.SECRETX),z.integer(3)),Ae.add(M.multiply(c,He.power(fr.symbol(Le.SECRETX),z.integer(2))),Ae.add(M.multiply(d,fr.symbol(Le.SECRETX)),_)));ot.debug(`resolventCubic: ${R}`);let T=kl(R,fr.symbol(Le.SECRETX));ot.debug(`resolventCubicSolutions: ${T}`);let k=null;for(let qr of T.tensor.elem){ot.debug(`examining solution: ${qr}`);let It=Mc.absValFloat(Ae.add(M.multiply(qr,z.integer(2)),i));if(ot.debug(`abs value is: ${qr}`),!br.isZeroAtomOrTensor(It)){k=qr;break}}ot.debug(`chosen solution: ${k}`);let Z=Jt.simplify(He.power(Ae.add(M.multiply(k,z.integer(2)),i),z.rational(1,2))),Y=Jt.simplify(M.divide(M.multiply(s,z.integer(2)),Z)),Oe=Ae.add(M.multiply(i,z.integer(3)),M.multiply(k,z.integer(2))),tt=Jt.simplify(He.power(M.negate(Ae.add(Oe,Y)),z.rational(1,2))),Ze=M.divide(Ae.add(Z,tt),z.integer(2)),ke=Jt.simplify(He.power(M.negate(Ae.add(Oe,Y)),z.rational(1,2))),st=M.divide(Ae.subtract(Z,ke),z.integer(2)),Me=Jt.simplify(He.power(M.negate(Ae.subtract(Oe,Y)),z.rational(1,2))),at=M.divide(Ae.add(M.negate(Z),Me),z.integer(2)),ir=Jt.simplify(He.power(M.negate(Ae.subtract(Oe,Y)),z.rational(1,2))),Gt=M.divide(Ae.subtract(M.negate(Z),ir),z.integer(2));return[Ze,st,at,Gt]}function jO(e,t,r,n,o){let i=M.divide(Ae.add(M.multiply(z.integer(8),M.multiply(r,e)),M.multiply(z.integer(-3),He.power(t,z.integer(2)))),M.multiply(z.integer(8),He.power(e,z.integer(2)))),s=M.divide(Ae.add(He.power(t,z.integer(3)),Ae.add(M.multiply(z.integer(-4),M.multiply(e,M.multiply(t,r))),M.multiply(z.integer(8),M.multiply(n,He.power(e,z.integer(2)))))),M.multiply(z.integer(8),He.power(e,z.integer(3)))),u=M.multiply(M.multiply(e,e),e),c=M.multiply(t,t),d=M.multiply(M.multiply(e,e),n),_=M.divide(Ae.add(M.multiply(He.power(t,z.integer(4)),z.integer(-3)),Ae.add(M.multiply(z.integer(256),M.multiply(u,o)),Ae.add(M.multiply(z.integer(-64),M.multiply(d,t)),M.multiply(z.integer(16),M.multiply(c,M.multiply(e,r)))))),M.multiply(z.integer(256),He.power(e,z.integer(4)))),R=He.power(fr.symbol(Le.SECRETX),z.integer(4)),T=M.multiply(i,He.power(fr.symbol(Le.SECRETX),z.integer(2))),k=M.multiply(s,fr.symbol(Le.SECRETX)),Z=Jt.simplify(Ae.add_all([R,T,k,_])),Y=kl(Z,fr.symbol(Le.SECRETX));return ot.debug(`p for depressed quartic: ${i}`),ot.debug(`q for depressed quartic: ${s}`),ot.debug(`r for depressed quartic: ${_}`),ot.debug(`4 * x^4: ${R}`),ot.debug(`R_p * x^2: ${T}`),ot.debug(`R_q * x: ${k}`),ot.debug(`R_r: ${_}`),ot.debug(`solving depressed quartic: ${Z}`),ot.debug(`depressedSolutions: ${Y}`),Y.tensor.elem.map(Oe=>{let tt=Jt.simplify(Ae.subtract(Oe,M.divide(t,M.multiply(z.integer(4),e))));return ot.debug(`solution from depressed: ${tt}`),tt})}});var Ov=A(Ic=>{"use strict";Object.defineProperty(Ic,"__esModule",{value:!0});Ic.simfac=void 0;var be=N(),Jm=U(),hv=Ie(),Ho=ce(),HB=G(),Nc=hi(),dn=Q(),fa=X();function zO(e){if(be.isadd(e)){let t=e.tail().map(Av);return Ho.add_all(t)}return Av(e)}Ic.simfac=zO;function Av(e){if(!be.ismultiply(e))return e;let t=e.tail();for(;YO(t););return fa.multiply_all_noexpand(t)}function YO(e){for(let t=0;t<e.length;t++){let r=e[t];for(let n=0;n<e.length;n++){if(t===n)continue;let o=e[n];if(be.isfactorial(r)&&be.ispower(o)&&dn.isminusone(be.caddr(o))&&hv.equal(be.cadr(r),be.cadr(o)))return e[t]=Nc.factorial(Ho.subtract(be.cadr(r),be.Constants.one)),e[n]=be.Constants.one,!0;if(be.ispower(o)&&dn.isminusone(be.caddr(o))&&be.caadr(o)===Jm.symbol(be.FACTORIAL)&&hv.equal(r,be.cadadr(o)))return e[t]=fa.reciprocate(Nc.factorial(Ho.add(r,be.Constants.negOne))),e[n]=be.Constants.one,!0;if(be.isfactorial(o)){let i=Ho.subtract(r,be.cadr(o));if(dn.isplusone(i))return e[t]=Nc.factorial(r),e[n]=be.Constants.one,!0}if(be.ispower(r)&&dn.isminusone(be.caddr(r))&&be.ispower(o)&&dn.isminusone(be.caddr(o))&&be.caadr(o)===Jm.symbol(be.FACTORIAL)){let i=Ho.subtract(be.cadr(r),be.cadr(be.cadr(o)));if(dn.isplusone(i))return e[t]=fa.reciprocate(Nc.factorial(be.cadr(r))),e[n]=be.Constants.one,!0}if(be.isfactorial(r)&&be.ispower(o)&&dn.isminusone(be.caddr(o))&&be.caadr(o)===Jm.symbol(be.FACTORIAL)){let i=Ho.subtract(be.cadr(r),be.cadr(be.cadr(o)));if(dn.isplusone(i))return e[t]=be.cadr(r),e[n]=be.Constants.one,!0;if(dn.isminusone(i))return e[t]=fa.reciprocate(be.cadr(be.cadr(o))),e[n]=be.Constants.one,!0;if(dn.equaln(i,2))return e[t]=be.cadr(r),e[n]=Ho.add(be.cadr(r),be.Constants.negOne),!0;if(dn.equaln(i,-2))return e[t]=fa.reciprocate(be.cadr(be.cadr(o))),e[n]=fa.reciprocate(Ho.add(be.cadr(be.cadr(o)),be.Constants.negOne)),!0}}}return!1}});var Km=A(da=>{"use strict";Object.defineProperty(da,"__esModule",{value:!0});da.decomp=da.Eval_decomp=void 0;var ze=N(),$l=sr(),Mv=U(),Nv=Ie(),VO=ce(),Tv=G(),ZO=Zr(),XO=ee(),Iv=X();function HO(e){console.log("Eval_decomp is being called!!!!!!!!!!!!!!!!!!!!");let t=Tv.Eval(ze.cadr(e));e=Tv.Eval(ze.caddr(e));let r=e===Mv.symbol(ze.NIL)?ZO.guess(t):e,n=Ul(!1,t,r);return XO.makeList(Mv.symbol(ze.NIL),...n)}da.Eval_decomp=HO;function QO(e,t){return e.length>0&&Nv.equal(t,e[e.length-1])?!1:(e.push(t),!0)}function Ul(e,t,r){if(ze.DEBUG&&console.log(`DECOMPOSING ${t}`),e){if(!ze.iscons(t))return ze.DEBUG&&console.log(` ground thing: ${t}`),[t]}else if(!$l.Find(t,r))return ze.DEBUG&&console.log(" entire expression is constant"),[t];if(ze.isadd(t))return WO(e,t,r);if(ze.ismultiply(t))return JO(e,t,r);let n=ze.cdr(t);ze.DEBUG&&(console.log(" naive decomp"),console.log(`startig p3: ${n}`));let o=[];for(;ze.iscons(n);)e&&o.push(ze.car(n)),ze.DEBUG&&(console.log("recursive decomposition"),console.log(`car(p3): ${ze.car(n)}`),console.log(`p2: ${r}`)),o.push(...Ul(e,ze.car(n),r)),n=ze.cdr(n);return o}da.decomp=Ul;function WO(e,t,r){ze.DEBUG&&console.log(" decomposing the sum ");let n=ze.cdr(t),o=[];for(;ze.iscons(n);)($l.Find(ze.car(n),r)||e)&&o.push(...Ul(e,ze.car(n),r)),n=ze.cdr(n);n=ze.cdr(t);let i=[...n].filter(s=>!$l.Find(s,r));return i.length&&(n=VO.add_all(i),QO(o,n),o.push(Iv.negate(n))),o}function JO(e,t,r){ze.DEBUG&&console.log(" decomposing the product ");let n=ze.cdr(t),o=[];for(;ze.iscons(n);)($l.Find(ze.car(n),r)||e)&&o.push(...Ul(e,ze.car(n),r)),n=ze.cdr(n);n=ze.cdr(t);let i=[];for(;ze.iscons(n);){let s=ze.car(n);$l.Find(s,r)||(i.length<1||!Nv.equal(s,i[i.length-1]))&&i.push(s),n=ze.cdr(n)}return i.length>0&&o.push(Iv.multiply_all(i)),o}});var t_=A(Rc=>{"use strict";Object.defineProperty(Rc,"__esModule",{value:!0});Rc.transform=void 0;var oe=N(),Ne=U(),KO=ce(),eM=r_(),tM=Km(),Sc=G(),Sv=Q(),rM=ee(),nM=Vo(),e_=Vr();function wv(e,t,r,n){oe.DEBUG&&console.log(`         !!!!!!!!!   transform on: ${e}`);let o=oM();Ne.set_binding(Ne.symbol(oe.METAX),t);let i=eM.polyform(e,t),s=tM.decomp(n,i,t);if(oe.DEBUG){console.log(`  ${s.length} decomposed elements ====== `);for(let _=0;_<s.length;_++)console.log(`  decomposition element ${_}: ${s[_]}`)}let u=!1,c;if(n){if(!oe.isNumericAtom(e)){let _=r;oe.DEBUG&&(console.log(`applying transform: ${_}`),console.log(`scanning table entry ${_}`));let R=e_.subst(_,Ne.symbol(oe.SYMBOL_A_UNDERSCORE),Ne.symbol(oe.METAA));R=e_.subst(R,Ne.symbol(oe.SYMBOL_B_UNDERSCORE),Ne.symbol(oe.METAB));let T=e_.subst(R,Ne.symbol(oe.SYMBOL_X_UNDERSCORE),Ne.symbol(oe.METAX)),k=oe.car(T);oe.DEBUG&&console.log(`template expression: ${k}`),c=oe.cadr(T);let Z=oe.cddr(T);if(Rv([oe.Constants.one,...s],n,e,k,Z))u=!0;else{oe.DEBUG&&(console.log(`p3 at this point: ${e}`),console.log(`car(p3): ${oe.car(e)}`));let Y=[],Oe=e;for(oe.iscons(Oe)&&(Y.push(oe.car(e)),Oe=oe.cdr(e));oe.iscons(Oe);){let tt=oe.car(Oe);Oe=oe.cdr(Oe),oe.DEBUG&&(console.log(`testing: ${tt}`),console.log(`about to try to simplify other term: ${tt}`));let[Ze,ke]=wv(tt,Ne.symbol(oe.NIL),r,n);u=u||ke,Y.push(Ze),oe.DEBUG&&console.log(`tried to simplify other term: ${tt} ...successful?: ${ke} ...transformed: ${Y[Y.length-1]}`)}Y.length!==0&&(c=rM.makeList(...Y))}}}else for(let _ of Array.from(r))if(oe.DEBUG&&(console.log(`scanning table entry ${_}`),(_+"").indexOf("f(sqrt(a+b*x),2/3*1/b*sqrt((a+b*x)^3))")!==-1&&oe.breakpoint),_){let R=nM.scan_meta(_),T=oe.cadr(R);c=oe.caddr(R);let k=oe.cdddr(R);if(Rv([oe.Constants.one,...s],n,e,T,k)){u=!0;break}}let d=u?Sc.Eval(c):n?e:Ne.symbol(oe.NIL);return iM(o),[d,u]}Rc.transform=wv;function oM(){return{METAA:Ne.get_binding(Ne.symbol(oe.METAA)),METAB:Ne.get_binding(Ne.symbol(oe.METAB)),METAX:Ne.get_binding(Ne.symbol(oe.METAX))}}function iM(e){Ne.set_binding(Ne.symbol(oe.METAX),e.METAX),Ne.set_binding(Ne.symbol(oe.METAB),e.METAB),Ne.set_binding(Ne.symbol(oe.METAA),e.METAA)}function Rv(e,t,r,n,o){for(let i of e){Ne.set_binding(Ne.symbol(oe.METAA),i),oe.DEBUG&&console.log(`  binding METAA to ${Ne.get_binding(Ne.symbol(oe.METAA))}`);for(let s of e){Ne.set_binding(Ne.symbol(oe.METAB),s),oe.DEBUG&&console.log(`  binding METAB to ${Ne.get_binding(Ne.symbol(oe.METAB))}`);let u=o;for(;oe.iscons(u);){let d=Sc.Eval(oe.car(u));if(Sv.isZeroAtomOrTensor(d))break;u=oe.cdr(u)}if(oe.iscons(u))continue;let c=t?oe.noexpand(Sc.Eval,n):Sc.Eval(n);if(oe.DEBUG&&(console.log(`about to evaluate template expression: ${n} binding METAA to ${Ne.get_binding(Ne.symbol(oe.METAA))} and binding METAB to ${Ne.get_binding(Ne.symbol(oe.METAB))} and binding METAX to ${Ne.get_binding(Ne.symbol(oe.METAX))}`),console.log(`  comparing ${c} to: ${r}`)),Sv.isZeroAtomOrTensor(KO.subtract(r,c)))return oe.DEBUG&&(console.log(`binding METAA to ${Ne.get_binding(Ne.symbol(oe.METAA))}`),console.log(`binding METAB to ${Ne.get_binding(Ne.symbol(oe.METAB))}`),console.log(`binding METAX to ${Ne.get_binding(Ne.symbol(oe.METAX))}`),console.log(`comparing ${r} to: ${n}`)),!0}}return!1}});var i_=A(ba=>{"use strict";Object.defineProperty(ba,"__esModule",{value:!0});ba.transpose=ba.Eval_transpose=void 0;var sM=St(),Ue=N(),aM=xe(),_a=U(),ma=Ie(),lM=ce(),o_=j(),n_=G(),uM=Fo(),Pr=Q(),Lv=ee(),cM=X();function fM(e){let t=n_.Eval(Ue.cadr(e)),r=Ue.Constants.one,n=o_.integer(2);return Ue.cddr(e)!==_a.symbol(Ue.NIL)&&(r=n_.Eval(Ue.caddr(e)),n=n_.Eval(Ue.cadddr(e))),Bl(t,r,n)}ba.Eval_transpose=fM;function Bl(e,t,r){let n=0,o=Array(Ue.MAXDIM).fill(0),i=Array(Ue.MAXDIM).fill(0);if(Ue.isNumericAtom(e)||(Pr.isplusone(t)&&Pr.isplustwo(r)||Pr.isplusone(r)&&Pr.isplustwo(t))&&Ue.isidentitymatrix(e))return e;if(Ue.istranspose(e)){let T=Ue.car(Ue.cdr(Ue.cdr(e))),k=Ue.car(Ue.cdr(Ue.cdr(Ue.cdr(e))));if(ma.equal(T,r)&&ma.equal(k,t)||ma.equal(k,r)&&ma.equal(T,t)||ma.equal(T,_a.symbol(Ue.NIL))&&ma.equal(k,_a.symbol(Ue.NIL))&&(Pr.isplusone(r)&&Pr.isplustwo(t)||Pr.isplusone(t)&&Pr.isplustwo(r)))return Ue.car(Ue.cdr(e))}if(Ue.defs.expanding&&Ue.isadd(e))return e.tail().reduce((T,k)=>lM.add(T,Bl(k,t,r)),Ue.Constants.zero);if(Ue.defs.expanding&&Ue.ismultiply(e))return e.tail().reduce((T,k)=>cM.multiply(T,Bl(k,t,r)),Ue.Constants.one);if(Ue.defs.expanding&&Ue.isinnerordot(e)){let T=[];return Ue.iscons(e)&&T.push(...e.tail().map(k=>[k,t,r])),T.reverse(),T.reduce((k,Z)=>uM.inner(k,Bl(Z[0],Z[1],Z[2])),_a.symbol(Ue.SYMBOL_IDENTITY_MATRIX))}if(!Ue.istensor(e))return Pr.isZeroAtomOrTensor(e)?Ue.Constants.zero:(!Pr.isplusone(t)||!Pr.isplustwo(r))&&(!Pr.isplusone(r)||!Pr.isplustwo(t))?Lv.makeList(_a.symbol(Ue.TRANSPOSE),e,t,r):Lv.makeList(_a.symbol(Ue.TRANSPOSE),e);let{ndim:s,nelem:u}=e.tensor;if(s===1)return e;let c=o_.nativeInt(t),d=o_.nativeInt(r);(c<1||c>s||d<1||d>s)&&aM.stop("transpose: index out of range"),c--,d--,t=sM.alloc_tensor(u),t.tensor.ndim=s,t.tensor.dim=[...e.tensor.dim],t.tensor.dim[c]=e.tensor.dim[d],t.tensor.dim[d]=e.tensor.dim[c];let _=e.tensor.elem,R=t.tensor.elem;for(let T=0;T<s;T++)o[T]=0,i[T]=e.tensor.dim[T];for(let T=0;T<u;T++){n=o[c],o[c]=o[d],o[d]=n,n=i[c],i[c]=i[d],i[d]=n;let k=0;for(let Z=0;Z<s;Z++)k=k*i[Z]+o[Z];n=o[c],o[c]=o[d],o[d]=n,n=i[c],i[c]=i[d],i[d]=n,R[k]=_[T];for(let Z=s-1;Z>=0&&!(++o[Z]<i[Z]);Z--)o[Z]=0}return t}ba.transpose=Bl});var Xo=A(Ln=>{"use strict";Object.defineProperty(Ln,"__esModule",{value:!0});Ln.simplify_trig=Ln.simplify=Ln.simplifyForCodeGeneration=Ln.Eval_simplify=void 0;var dM=St(),_t=Oc(),I=N(),Ni=sr(),a_=xe(),Qe=U(),mo=ce(),Dt=j(),mM=Du(),u_=gl(),Ii=G(),Mi=wn(),_M=Fo(),Ut=Q(),Dv=ee(),ga=Ie(),Be=X(),bM=ku(),mn=xt(),Qo=yl(),Ti=Bs(),gM=eo(),yM=Wm(),Cv=Ov(),vM=Et(),qM=t_(),EM=i_(),xM=Tn(),Pv=bi(),s_=dl(),pM=io();function hM(e){let t=kv(I.cadr(e));return Qr(Ii.Eval(t))}Ln.Eval_simplify=hM;function kv(e){if(I.defs.userSimplificationsInListForm.length===0||Ni.Find(e,Qe.symbol(I.INTEGRAL)))return e;I.DEBUG&&console.log(`runUserDefinedSimplifications passed: ${e}`);let t=I.noexpand(Ii.Eval,e);if(I.DEBUG){console.log(`runUserDefinedSimplifications after eval no expanding: ${t}`),console.log("patterns to be checked: ");for(let o of Array.from(I.defs.userSimplificationsInListForm))console.log(`...${o}`)}let r=!0,n=0;for(;r&&n<I.MAX_CONSECUTIVE_APPLICATIONS_OF_ALL_RULES;){r=!1,n++;for(let o of Array.from(I.defs.userSimplificationsInListForm)){let i=!0,s=0;for(;i&&s<I.MAX_CONSECUTIVE_APPLICATIONS_OF_SINGLE_RULE;)s++,I.DEBUG&&console.log(`simplify - checking pattern: ${o} on: ${t}`),[t,i]=qM.transform(t,Qe.symbol(I.NIL),o,!0),i&&(r=!0),I.DEBUG&&console.log(`p1 at this stage of simplification: ${t}`);s===I.MAX_CONSECUTIVE_APPLICATIONS_OF_SINGLE_RULE&&a_.stop(`maximum application of single transformation rule exceeded: ${o}`)}}return n===I.MAX_CONSECUTIVE_APPLICATIONS_OF_ALL_RULES&&a_.stop("maximum application of all transformation rules exceeded "),I.DEBUG&&(console.log(`METAX = ${Qe.get_binding(Qe.symbol(I.METAX))}`),console.log(`METAA = ${Qe.get_binding(Qe.symbol(I.METAA))}`),console.log(`METAB = ${Qe.get_binding(Qe.symbol(I.METAB))}`)),t}function AM(e){let t=kv(e);I.defs.codeGen=!0;let r=Qr(t);return I.defs.codeGen=!1,r}Ln.simplifyForCodeGeneration=AM;function Qr(e){if(I.defs.codeGen&&I.car(e)===Qe.symbol(I.FUNCTION)){let t=I.cadr(e),r=Qr(Ii.Eval(t)),n=I.caddr(e);e=Dv.makeList(Qe.symbol(I.FUNCTION),r,n)}if(I.istensor(e))return OM(e);if(Ni.Find(e,Qe.symbol(I.FACTORIAL))){let t=Cv.simfac(e),r=Cv.simfac(Qo.rationalize(e));e=_t.count(t)<_t.count(r)?t:r}if(e=IM(e),e=MM(e),e=TM(e),e=NM(e),e=SM(e),e=$v(e),e=wM(e),e=CM(e),I.do_simplify_nested_radicals){let t;if([t,e]=PM(e),t)return I.DEBUG&&console.log("de-nesting successful into: "+e.toString()),Qr(e)}return e=LM(e),e=Uv(e),e}Ln.simplify=Qr;function OM(e){let t=dM.alloc_tensor(e.tensor.nelem);return t.tensor.ndim=e.tensor.ndim,t.tensor.dim=Array.from(e.tensor.dim),t.tensor.elem=e.tensor.elem.map(Qr),vM.check_tensor_dimensions(t),Ut.isZeroAtomOrTensor(t)&&(t=I.Constants.zero),t}function MM(e){if(!I.isadd(e))return e;let t=Qo.rationalize(e);return _t.count(t)<_t.count(e)&&(e=t),e}function TM(e){if(!I.isadd(e))return e;let t=u_.Condense(e);return _t.count(t)<=_t.count(e)&&(e=t),e}function NM(e){let t=Qo.rationalize(Be.negate(Qo.rationalize(Be.negate(Qo.rationalize(e)))));return _t.count(t)<_t.count(e)&&(e=t),e}function IM(e){let t=I.car(e);if((t===Qe.symbol(I.MULTIPLY)||I.isinnerordot(e))&&I.car(I.car(I.cdr(e)))===Qe.symbol(I.TRANSPOSE)&&I.car(I.car(I.cdr(I.cdr(e))))===Qe.symbol(I.TRANSPOSE)){I.DEBUG&&console.log(`maybe collecting a transpose ${e}`);let r=I.cadr(I.car(I.cdr(e))),n=I.cadr(I.car(I.cdr(I.cdr(e)))),o;t===Qe.symbol(I.MULTIPLY)?o=Be.multiply(r,n):I.isinnerordot(e)?o=_M.inner(n,r):o=a_.stop("f10: nothing to pop.");let i=I.noexpand(()=>EM.transpose(o,I.Constants.one,Dt.integer(2)));_t.count(i)<_t.count(e)&&(e=i),I.DEBUG&&console.log(`collecting a transpose ${i}`)}return e}function SM(e){if(Ut.isZeroAtomOrTensor(e))return e;let t=Qo.rationalize(Be.inverse(Qo.rationalize(Be.inverse(Qo.rationalize(e)))));return _t.count(t)<_t.count(e)&&(e=t),e}function RM(e){return $v(e)}Ln.simplify_trig=RM;function $v(e){if(!Ni.Find(e,Qe.symbol(I.SIN))&&!Ni.Find(e,Qe.symbol(I.COS)))return e;let t=e;I.defs.trigmode=1;let r=Ii.Eval(t);I.defs.trigmode=2;let n=Ii.Eval(t);return I.defs.trigmode=0,(_t.count(n)<_t.count(r)||wc(n)<wc(r))&&(r=n),(_t.count(r)<_t.count(e)||wc(r)<wc(e))&&(e=r),e}function wM(e){if(!I.isadd(e))return e;let t=I.cdr(e);return I.iscons(t)&&(t=[...t].reduce((r,n)=>Uv(mo.add(r,Qr(n))),I.Constants.zero)),_t.count(t)<_t.count(e)&&(e=t),e}function Uv(e){var t,r,n,o,i;if(t=xM.denominator(e),Ut.isone(t)||(r=pM.numerator(e),Ut.isone(r))||!(o=Pv.areunivarpolysfactoredorexpandedform(r,t))||(i=s_.factor(Pv.gcd(r,t),o),Ut.isone(i)))return e;let s=s_.factor(r,o),u=Be.inverse(i),c=Be.multiply_noexpand(s,u),d=Qr(c),_=s_.factor(t,o),R=Be.multiply_noexpand(_,u),T=Qr(R),k=Be.divide(d,T);return n=u_.Condense(k),_t.count(n)<_t.count(e)?n:e}function LM(e){let t;return!Ni.Find(e,Qe.symbol(I.SIN))&&!Ni.Find(e,Qe.symbol(I.COS))||(t=mM.clockform(Ii.Eval(e)),I.DEBUG&&console.log(`before simplification clockform: ${e} after: ${t}`),_t.count(t)<_t.count(e)&&(e=t)),e}function CM(e){let t=l_(e),r=Ii.Eval(t);return _t.count(r)<_t.count(e)&&(e=r),e}function l_(e){if(Ut.isimaginaryunit(e))return e;if(ga.equal(I.car(e),Qe.symbol(I.POWER))&&Ut.isminusone(I.cadr(e))){let t=Be.negate(I.Constants.one),r=l_(I.caddr(e));return gM.rect(bM.polar(mn.power(t,r)))}else return I.iscons(e)?e.map(l_):e}function wc(e){return I.isadd(e)?ga.length(e)-1:1}function PM(e){if(I.defs.recursionLevelNestedRadicalsRemoval>0)return I.DEBUG&&console.log("denesting bailing out because of too much recursion"),[!1,e];let[t,r]=Lc(e),n=I.noexpand(u_.yycondense,t);return e=_t.countOccurrencesOfSymbol(Qe.symbol(I.POWER),t)<_t.countOccurrencesOfSymbol(Qe.symbol(I.POWER),n)?t:n,[r,e]}function Lc(e){return I.defs.recursionLevelNestedRadicalsRemoval>0?(I.DEBUG&&console.log("denesting bailing out because of too much recursion"),[e,!1]):ga.equal(I.car(e),Qe.symbol(I.POWER))?DM(e):I.iscons(e)?$M(e):[e,!1]}function DM(e){let t=I.cadr(e),r=I.caddr(e);if(Ut.isminusone(r)||!ga.equal(I.car(t),Qe.symbol(I.ADD))||!Ut.isfraction(r)||!Ut.equalq(r,1,3)&&!Ut.equalq(r,1,2))return[e,!1];let n=I.cadr(t);Lc(n);let o=I.caddr(t);Lc(o);let i=0,s=t;for(;I.cdr(s)!==Qe.symbol(I.NIL);)i++,s=I.cdr(s);if(i>2)return[e,!1];let{commonBases:u,termsThatAreNotPowers:c}=kM(o);if(u.length===0)return[e,!1];let d=n,_=u.reduce(Be.multiply,I.Constants.one),R=c.reduce(Be.multiply,I.Constants.one),T;if(Ut.equalq(r,1,3)){let ke=Be.divide(Be.multiply(Be.negate(d),_),R),st=Dt.nativeDouble(Mi.yyfloat(Ti.real(ke)));if(Math.abs(st)>Math.pow(2,32))return[e,!1];let Me=Be.multiply(Dt.integer(3),_),at=Dt.nativeDouble(Mi.yyfloat(Ti.real(Me)));if(Math.abs(at)>Math.pow(2,32))return[e,!1];let ir=Be.multiply(Me,Qe.symbol(I.SECRETX)),Gt=Be.divide(Be.multiply(Dt.integer(-3),d),R),qr=Dt.nativeDouble(Mi.yyfloat(Ti.real(Gt)));if(Math.abs(qr)>Math.pow(2,32))return[e,!1];T=mo.add_all([ke,ir,Be.multiply(Gt,mn.power(Qe.symbol(I.SECRETX),Dt.integer(2))),Be.multiply(I.Constants.one,mn.power(Qe.symbol(I.SECRETX),Dt.integer(3)))])}else if(Ut.equalq(r,1,2)){let ke=Dt.nativeDouble(Mi.yyfloat(Ti.real(_)));if(Math.abs(ke)>Math.pow(2,32))return[e,!1];let st=Be.divide(Be.multiply(Dt.integer(-2),d),R),Me=Dt.nativeDouble(Mi.yyfloat(Ti.real(st)));if(Math.abs(Me)>Math.pow(2,32))return[e,!1];T=mo.add(_,mo.add(Be.multiply(st,Qe.symbol(I.SECRETX)),Be.multiply(I.Constants.one,mn.power(Qe.symbol(I.SECRETX),Dt.integer(2)))))}I.defs.recursionLevelNestedRadicalsRemoval++;let k=yM.roots(T,Qe.symbol(I.SECRETX));if(I.defs.recursionLevelNestedRadicalsRemoval--,ga.equal(k,Qe.symbol(I.NIL)))return I.DEBUG&&console.log("roots bailed out because of too much recursion"),[e,!1];let Z=k.elem.filter(ke=>!Ni.Find(ke,Qe.symbol(I.POWER)));if(Z.length===0)return[e,!1];let Y=[],Oe=[];for(let ke of Array.from(Z)){let st=Dt.nativeDouble(Mi.yyfloat(Ti.real(ke)));Y.push(ke),Oe.push(st)}let tt=Oe.indexOf(Math.max.apply(Math,Oe)),Ze=Y[tt];if(!Ut.equalq(r,1,3)&&!Ut.equalq(r,1,2))return[e,!1];if(Ut.equalq(r,1,3)){let ke=mn.power(Be.divide(d,mo.add(mn.power(Ze,Dt.integer(3)),Be.multiply(Be.multiply(Dt.integer(3),_),Ze))),Dt.rational(1,3)),st=Be.multiply(ke,Ze);return[Qr(mo.add(Be.multiply(ke,mn.power(_,Dt.rational(1,2))),st)),!0]}if(Ut.equalq(r,1,2)){let ke=mn.power(Be.divide(d,mo.add(mn.power(Ze,Dt.integer(2)),_)),Dt.rational(1,2)),st=Be.multiply(ke,Ze),Me=Qr(mo.add(Be.multiply(ke,mn.power(_,Dt.rational(1,2))),st)),at=Mi.yyfloat(Ti.real(Me));return Ut.isnegativenumber(at)?[Qr(mo.add(Be.multiply(Be.negate(ke),mn.power(_,Dt.rational(1,2))),Be.negate(st))),!0]:[Me,!0]}return[null,!0]}function kM(e){let t=null,r=[],n=[];if(I.ismultiply(e)){let o=I.cdr(e);if(I.iscons(o))for(;I.iscons(o);){let i=I.car(o);if(I.ispower(i)){let s=I.cadr(i),u=I.caddr(i);Ut.equalq(u,1,2)&&(t==null?(t=u,r.push(s)):ga.equal(u,t)&&r.push(s))}else n.push(i);o=I.cdr(o)}}else if(I.ispower(e)){let o=I.cadr(e),i=I.caddr(e);t==null&&Ut.equalq(i,1,2)&&(t=i,r.push(o))}return{commonBases:r,termsThatAreNotPowers:n}}function $M(e){let t=!1,r=[];if(I.iscons(e)){let n=Array.from(e).map(o=>{if(!t){let i;return[i,t]=Lc(o),i}return o});r.push(...n)}return[Dv.makeList(...r),t]}});var Fl=A(Wo=>{"use strict";Object.defineProperty(Wo,"__esModule",{value:!0});Wo.make_hashed_itab=Wo.integral=Wo.Eval_integral=void 0;var me=N(),ya=sr(),Fv=xe(),Cn=U(),UM=Ie(),BM=ce(),jv=j(),GM=wi(),Si=G(),Bv=Zr(),Gl=Q(),Gv=ee(),FM=X(),jM=fv(),zM=Vo(),YM=Xo(),VM=t_(),ZM=["f(a,a*x)","f(1/x,log(x))","f(x^a,x^(a+1)/(a+1))","f(x^(-2),-x^(-1))","f(x^(-1/2),2*x^(1/2))","f(x^(1/2),2/3*x^(3/2))","f(x,x^2/2)","f(x^2,x^3/3)","f(exp(a*x),1/a*exp(a*x))","f(exp(a*x+b),1/a*exp(a*x+b))","f(x*exp(a*x^2),exp(a*x^2)/(2*a))","f(x*exp(a*x^2+b),exp(a*x^2+b)/(2*a))","f(log(a*x),x*log(a*x)-x)","f(a^x,a^x/log(a),or(not(number(a)),a>0))","f(1/(a+x^2),1/sqrt(a)*arctan(x/sqrt(a)),or(not(number(a)),a>0))","f(1/(a-x^2),1/sqrt(a)*arctanh(x/sqrt(a)))","f(1/sqrt(a-x^2),arcsin(x/(sqrt(a))))","f(1/sqrt(a+x^2),log(x+sqrt(a+x^2)))","f(1/(a+b*x),1/b*log(a+b*x))","f(1/(a+b*x)^2,-1/(b*(a+b*x)))","f(1/(a+b*x)^3,-1/(2*b)*1/(a+b*x)^2)","f(x/(a+b*x),x/b-a*log(a+b*x)/b/b)","f(x/(a+b*x)^2,1/b^2*(log(a+b*x)+a/(a+b*x)))","f(x^2/(a+b*x),1/b^2*(1/2*(a+b*x)^2-2*a*(a+b*x)+a^2*log(a+b*x)))","f(x^2/(a+b*x)^2,1/b^3*(a+b*x-2*a*log(a+b*x)-a^2/(a+b*x)))","f(x^2/(a+b*x)^3,1/b^3*(log(a+b*x)+2*a/(a+b*x)-1/2*a^2/(a+b*x)^2))","f(1/x*1/(a+b*x),-1/a*log((a+b*x)/x))","f(1/x*1/(a+b*x)^2,1/a*1/(a+b*x)-1/a^2*log((a+b*x)/x))","f(1/x*1/(a+b*x)^3,1/a^3*(1/2*((2*a+b*x)/(a+b*x))^2+log(x/(a+b*x))))","f(1/x^2*1/(a+b*x),-1/(a*x)+b/a^2*log((a+b*x)/x))","f(1/x^3*1/(a+b*x),(2*b*x-a)/(2*a^2*x^2)+b^2/a^3*log(x/(a+b*x)))","f(1/x^2*1/(a+b*x)^2,-(a+2*b*x)/(a^2*x*(a+b*x))+2*b/a^3*log((a+b*x)/x))","f(1/(a+b*x^2),1/sqrt(a*b)*arctan(x*sqrt(a*b)/a),or(not(number(a*b)),a*b>0))","f(1/(a+b*x^2),1/(2*sqrt(-a*b))*log((a+x*sqrt(-a*b))/(a-x*sqrt(-a*b))),or(not(number(a*b)),a*b<0))","f(x/(a+b*x^2),1/2*1/b*log(a+b*x^2))","f(x^2/(a+b*x^2),x/b-a/b*integral(1/(a+b*x^2),x))","f(1/(a+b*x^2)^2,x/(2*a*(a+b*x^2))+1/2*1/a*integral(1/(a+b*x^2),x))","f(1/x*1/(a+b*x^2),1/2*1/a*log(x^2/(a+b*x^2)))","f(1/x^2*1/(a+b*x^2),-1/(a*x)-b/a*integral(1/(a+b*x^2),x))","f(1/(a+b*x^3),1/3*1/a*(a/b)^(1/3)*(1/2*log(((a/b)^(1/3)+x)^3/(a+b*x^3))+sqrt(3)*arctan((2*x-(a/b)^(1/3))*(a/b)^(-1/3)/sqrt(3))))","f(x^2/(a+b*x^3),1/3*1/b*log(a+b*x^3))","f(x/(a+b*x^4),1/2*sqrt(b/a)/b*arctan(x^2*sqrt(b/a)),or(not(number(a*b)),a*b>0))","f(x/(a+b*x^4),1/4*sqrt(-b/a)/b*log((x^2-sqrt(-a/b))/(x^2+sqrt(-a/b))),or(not(number(a*b)),a*b<0))","f(x^3/(a+b*x^4),1/4*1/b*log(a+b*x^4))","f(sqrt(a+b*x),2/3*1/b*sqrt((a+b*x)^3))","f(x*sqrt(a+b*x),-2*(2*a-3*b*x)*sqrt((a+b*x)^3)/15/b^2)","f(x^2*sqrt(a+b*x),2*(8*a^2-12*a*b*x+15*b^2*x^2)*sqrt((a+b*x)^3)/105/b^3)","f(sqrt(a+b*x)/x,2*sqrt(a+b*x)+a*integral(1/x*1/sqrt(a+b*x),x))","f(sqrt(a+b*x)/x^2,-sqrt(a+b*x)/x+b/2*integral(1/x*1/sqrt(a+b*x),x))","f(1/sqrt(a+b*x),2*sqrt(a+b*x)/b)","f(x/sqrt(a+b*x),-2/3*(2*a-b*x)*sqrt(a+b*x)/b^2)","f(x^2/sqrt(a+b*x),2/15*(8*a^2-4*a*b*x+3*b^2*x^2)*sqrt(a+b*x)/b^3)","f(1/x*1/sqrt(a+b*x),1/sqrt(a)*log((sqrt(a+b*x)-sqrt(a))/(sqrt(a+b*x)+sqrt(a))),or(not(number(a)),a>0))","f(1/x*1/sqrt(a+b*x),2/sqrt(-a)*arctan(sqrt(-(a+b*x)/a)),or(not(number(a)),a<0))","f(1/x^2*1/sqrt(a+b*x),-sqrt(a+b*x)/a/x-1/2*b/a*integral(1/x*1/sqrt(a+b*x),x))","f(sqrt(x^2+a),1/2*(x*sqrt(x^2+a)+a*log(x+sqrt(x^2+a))))","f(1/sqrt(x^2+a),log(x+sqrt(x^2+a)))","f(1/x*1/sqrt(x^2+a),arcsec(x/sqrt(-a))/sqrt(-a),or(not(number(a)),a<0))","f(1/x*1/sqrt(x^2+a),-1/sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(-a)*arcsec(x/sqrt(-a)),or(not(number(a)),a<0))","f(x/sqrt(x^2+a),sqrt(x^2+a))","f(x*sqrt(x^2+a),1/3*sqrt((x^2+a)^3))","f(sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2+a^(1/3))^3)+3/2*a^(1/3)*x*sqrt(x^2+a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2+a^(1/3)))))","f(sqrt(-a+x^6-3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2-a^(1/3))^3)-3/2*a^(1/3)*x*sqrt(x^2-a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2-a^(1/3)))))","f(1/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),x/a^(1/3)/sqrt(x^2+a^(1/3)))","f(x/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),-1/sqrt(x^2+a^(1/3)))","f(x*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/5*sqrt((x^2+a^(1/3))^5))","f(x^2*sqrt(x^2+a),1/4*x*sqrt((x^2+a)^3)-1/8*a*x*sqrt(x^2+a)-1/8*a^2*log(x+sqrt(x^2+a)))","f(x^3*sqrt(x^2+a),(1/5*x^2-2/15*a)*sqrt((x^2+a)^3),and(number(a),a>0))","f(x^3*sqrt(x^2+a),sqrt((x^2+a)^5)/5-a*sqrt((x^2+a)^3)/3,and(number(a),a<0))","f(x^2/sqrt(x^2+a),1/2*x*sqrt(x^2+a)-1/2*a*log(x+sqrt(x^2+a)))","f(x^3/sqrt(x^2+a),1/3*sqrt((x^2+a)^3)-a*sqrt(x^2+a))","f(1/x^2*1/sqrt(x^2+a),-sqrt(x^2+a)/a/x)","f(1/x^3*1/sqrt(x^2+a),-1/2*sqrt(x^2+a)/a/x^2+1/2*log((sqrt(a)+sqrt(x^2+a))/x)/a^(3/2),or(not(number(a)),a>0))","f(1/x^3*1/sqrt(x^2-a),1/2*sqrt(x^2-a)/a/x^2+1/2*1/(a^(3/2))*arcsec(x/(a^(1/2))),or(not(number(a)),a>0))","f(x^2*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/6*x*sqrt((x^2+a^(1/3))^5)-1/24*a^(1/3)*x*sqrt((x^2+a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2+a^(1/3))-1/16*a*log(x+sqrt(x^2+a^(1/3))),or(not(number(a)),a>0))","f(x^2*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/6*x*sqrt((x^2-a^(1/3))^5)+1/24*a^(1/3)*x*sqrt((x^2-a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2-a^(1/3))+1/16*a*log(x+sqrt(x^2-a^(1/3))),or(not(number(a)),a>0))","f(x^3*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/7*sqrt((x^2+a^(1/3))^7)-1/5*a^(1/3)*sqrt((x^2+a^(1/3))^5),or(not(number(a)),a>0))","f(x^3*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/7*sqrt((x^2-a^(1/3))^7)+1/5*a^(1/3)*sqrt((x^2-a^(1/3))^5),or(not(number(a)),a>0))","f(1/(x-a)/sqrt(x^2-a^2),-sqrt(x^2-a^2)/a/(x-a))","f(1/(x+a)/sqrt(x^2-a^2),sqrt(x^2-a^2)/a/(x+a))","f(sqrt(a-x^2),1/2*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(abs(a)))))","f(1/x*1/sqrt(a-x^2),-1/sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x,sqrt(a-x^2)-sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))","f(x/sqrt(a-x^2),-sqrt(a-x^2))","f(x*sqrt(a-x^2),-1/3*sqrt((a-x^2)^3))","f(x^2*sqrt(a-x^2),-x/4*sqrt((a-x^2)^3)+1/8*a*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(a))),or(not(number(a)),a>0))","f(x^3*sqrt(a-x^2),(-1/5*x^2-2/15*a)*sqrt((a-x^2)^3),or(not(number(a)),a>0))","f(x^2/sqrt(a-x^2),-x/2*sqrt(a-x^2)+a/2*arcsin(x/sqrt(a)),or(not(number(a)),a>0))","f(1/x^2*1/sqrt(a-x^2),-sqrt(a-x^2)/a/x,or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^2,-sqrt(a-x^2)/x-arcsin(x/sqrt(a)),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^3,-1/2*sqrt(a-x^2)/x^2+1/2*log((sqrt(a)+sqrt(a-x^2))/x)/sqrt(a),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^4,-1/3*sqrt((a-x^2)^3)/a/x^3,or(not(number(a)),a>0))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*log(x*sqrt(a)+sqrt(a*x^2+b))/2/sqrt(a),and(number(a),a>0))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*arcsin(x*sqrt(-a/b))/2/sqrt(-a),and(number(a),a<0))","f(sin(a*x),-cos(a*x)/a)","f(cos(a*x),sin(a*x)/a)","f(tan(a*x),-log(cos(a*x))/a)","f(1/tan(a*x),log(sin(a*x))/a)","f(1/cos(a*x),log(tan(pi/4+a*x/2))/a)","f(1/sin(a*x),log(tan(a*x/2))/a)","f(sin(a*x)^2,x/2-sin(2*a*x)/(4*a))","f(sin(a*x)^3,-cos(a*x)*(sin(a*x)^2+2)/(3*a))","f(sin(a*x)^4,3/8*x-sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))","f(cos(a*x)^2,x/2+sin(2*a*x)/(4*a))","f(cos(a*x)^3,sin(a*x)*(cos(a*x)^2+2)/(3*a))","f(cos(a*x)^4,3/8*x+sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))","f(1/sin(a*x)^2,-1/(a*tan(a*x)))","f(1/cos(a*x)^2,tan(a*x)/a)","f(sin(a*x)*cos(a*x),sin(a*x)^2/(2*a))","f(sin(a*x)^2*cos(a*x)^2,-sin(4*a*x)/(32*a)+x/8)","f(sin(a*x)/cos(a*x)^2,1/(a*cos(a*x)))","f(sin(a*x)^2/cos(a*x),(log(tan(pi/4+a*x/2))-sin(a*x))/a)","f(cos(a*x)/sin(a*x)^2,-1/(a*sin(a*x)))","f(1/(sin(a*x)*cos(a*x)),log(tan(a*x))/a)","f(1/(sin(a*x)*cos(a*x)^2),(1/cos(a*x)+log(tan(a*x/2)))/a)","f(1/(sin(a*x)^2*cos(a*x)),(log(tan(pi/4+a*x/2))-1/sin(a*x))/a)","f(1/(sin(a*x)^2*cos(a*x)^2),-2/(a*tan(2*a*x)))","f(sin(a+b*x),-cos(a+b*x)/b)","f(cos(a+b*x),sin(a+b*x)/b)","f(1/(b+b*sin(a*x)),-tan(pi/4-a*x/2)/a/b)","f(1/(b-b*sin(a*x)),tan(pi/4+a*x/2)/a/b)","f(1/(b+b*cos(a*x)),tan(a*x/2)/a/b)","f(1/(b-b*cos(a*x)),-1/tan(a*x/2)/a/b)","f(1/(a+b*sin(x)),1/sqrt(b^2-a^2)*log((a*tan(x/2)+b-sqrt(b^2-a^2))/(a*tan(x/2)+b+sqrt(b^2-a^2))),b^2-a^2)","f(1/(a+b*cos(x)),1/sqrt(b^2-a^2)*log((sqrt(b^2-a^2)*tan(x/2)+a+b)/(sqrt(b^2-a^2)*tan(x/2)-a-b)),b^2-a^2)","f(x*sin(a*x),sin(a*x)/a^2-x*cos(a*x)/a)","f(x^2*sin(a*x),2*x*sin(a*x)/a^2-(a^2*x^2-2)*cos(a*x)/a^3)","f(x*cos(a*x),cos(a*x)/a^2+x*sin(a*x)/a)","f(x^2*cos(a*x),2*x*cos(a*x)/a^2+(a^2*x^2-2)*sin(a*x)/a^3)","f(arcsin(a*x),x*arcsin(a*x)+sqrt(1-a^2*x^2)/a)","f(arccos(a*x),x*arccos(a*x)-sqrt(1-a^2*x^2)/a)","f(arctan(a*x),x*arctan(a*x)-1/2*log(1+a^2*x^2)/a)","f(x*log(a*x),x^2*log(a*x)/2-x^2/4)","f(x^2*log(a*x),x^3*log(a*x)/3-1/9*x^3)","f(log(x)^2,x*log(x)^2-2*x*log(x)+2*x)","f(1/x*1/(a+log(x)),log(a+log(x)))","f(log(a*x+b),(a*x+b)*log(a*x+b)/a-x)","f(log(a*x+b)/x^2,a/b*log(x)-(a*x+b)*log(a*x+b)/b/x)","f(sinh(x),cosh(x))","f(cosh(x),sinh(x))","f(tanh(x),log(cosh(x)))","f(x*sinh(x),x*cosh(x)-sinh(x))","f(x*cosh(x),x*sinh(x)-cosh(x))","f(sinh(x)^2,sinh(2*x)/4-x/2)","f(tanh(x)^2,x-tanh(x))","f(cosh(x)^2,sinh(2*x)/4+x/2)","f(x^3*exp(a*x^2),exp(a*x^2)*(x^2/a-1/(a^2))/2)","f(x^3*exp(a*x^2+b),exp(a*x^2)*exp(b)*(x^2/a-1/(a^2))/2)","f(exp(a*x^2),-i*sqrt(pi)*erf(i*sqrt(a)*x)/sqrt(a)/2)","f(erf(a*x),x*erf(a*x)+exp(-a^2*x^2)/a/sqrt(pi))","f(x^2*(1-x^2)^(3/2),(x*sqrt(1-x^2)*(-8*x^4+14*x^2-3)+3*arcsin(x))/48)","f(x^2*(1-x^2)^(5/2),(x*sqrt(1-x^2)*(48*x^6-136*x^4+118*x^2-15)+15*arcsin(x))/384)","f(x^4*(1-x^2)^(3/2),(-x*sqrt(1-x^2)*(16*x^6-24*x^4+2*x^2+3)+3*arcsin(x))/128)","f(x*exp(a*x),exp(a*x)*(a*x-1)/(a^2))","f(x*exp(a*x+b),exp(a*x+b)*(a*x-1)/(a^2))","f(x^2*exp(a*x),exp(a*x)*(a^2*x^2-2*a*x+2)/(a^3))","f(x^2*exp(a*x+b),exp(a*x+b)*(a^2*x^2-2*a*x+2)/(a^3))","f(x^3*exp(a*x),exp(a*x)*x^3/a-3/a*integral(x^2*exp(a*x),x))","f(x^3*exp(a*x+b),exp(a*x+b)*x^3/a-3/a*integral(x^2*exp(a*x+b),x))"];function XM(e){let t=0;e=me.cdr(e);let r=Si.Eval(me.car(e));e=me.cdr(e);let n=Si.Eval(me.car(e)),o,i;for(n===Cn.symbol(me.NIL)?(i=Bv.guess(r),o=Cn.symbol(me.NIL)):me.isNumericAtom(n)?(i=Bv.guess(r),o=n):(i=n,e=me.cdr(e),o=Si.Eval(me.car(e)));;){me.isNumericAtom(o)?(t=jv.nativeInt(o),isNaN(t)&&Fv.stop("nth integral: check n")):t=1;let s=r;if(t>=0)for(let u=0;u<t;u++)s=Cc(s,i);else{t=-t;for(let u=0;u<t;u++)s=GM.derivative(s,i)}if(r=s,o===Cn.symbol(me.NIL))break;if(me.isNumericAtom(o)){if(e=me.cdr(e),o=Si.Eval(me.car(e)),o===Cn.symbol(me.NIL))break;me.isNumericAtom(o)||(i=o,e=me.cdr(e),o=Si.Eval(me.car(e)))}else i=o,e=me.cdr(e),o=Si.Eval(me.car(e))}return r}Wo.Eval_integral=XM;function Cc(e,t){let r;return me.isadd(e)?r=HM(e,t):me.ismultiply(e)?r=QM(e,t):r=zv(e,t),ya.Find(r,Cn.symbol(me.INTEGRAL))&&Fv.stop("integral: sorry, could not find a solution"),Si.Eval(YM.simplify(r))}Wo.integral=Cc;function HM(e,t){e=me.cdr(e);let r=Cc(me.car(e),t);return me.iscons(e)&&(r=e.tail().reduce((n,o)=>BM.add(n,Cc(o,t)),r)),r}function QM(e,t){let[r,n]=jM.partition(e,t);return FM.multiply(r,zv(n,t))}function zv(e,t){let r=Ri(e,t).toFixed(6),n=tT[r];if(!n)return Gv.makeList(Cn.symbol(me.INTEGRAL),e,t);let[o,i]=VM.transform(e,t,n,!1);return o===Cn.symbol(me.NIL)?Gv.makeList(Cn.symbol(me.INTEGRAL),e,t):o}var Pn={x:.95532,constexp:1.43762,constant:1.1441659362941434,constbase:1.2036412230421882,sin:1.7330548251830322,arcsin:1.6483368529465805,cos:1.0586721236863401,arccos:1.8405225918106694,tan:1.1224943776292506,arctan:1.1297397925394963,sinh:1.8176164926060079,cosh:1.9404934661708022,tanh:1.6421307715103122,log:1.477443701354924,erf:1.0825269225702916};function Ri(e,t){if(me.issymbol(e))return UM.equal(e,t)?Pn.x:Pn.constant;if(me.iscons(e)){let n=me.car(e);switch(me.issymbol(n)&&n.printname){case me.ADD:return JM(me.cdr(e),t);case me.MULTIPLY:return KM(me.cdr(e),t);case me.POWER:return c_(me.cadr(e),me.caddr(e),t);case me.EXP:return c_(Cn.symbol(me.E),me.cadr(e),t);case me.SQRT:var r=jv.double(.5);return c_(me.cadr(e),r,t);default:return WM(e,t)}}return Pn.constant}function WM(e,t){if(!ya.Find(me.cadr(e),t))return Pn.constant;let r=me.car(e),n=Ri(me.cadr(e),t),o=Pn[r.printname];if(!o)throw new Error("Unsupported function "+r.printname);return Math.pow(o,n)}function JM(e,t){let r={};for(;me.iscons(e);){let o=me.car(e);e=me.cdr(e);let i=0;ya.Find(o,t)?i=Ri(o,t):i=Pn.constant,r[i.toFixed(6)]=!0}let n=0;for(let o of Object.keys(r||{})){let i=r[o];n=n+Number(o)}return n}function KM(e,t){let r=1;return me.iscons(e)&&[...e].forEach(n=>{ya.Find(n,t)&&(r=r*Ri(n,t))}),r}function c_(e,t,r){let n=Pn.constant,o=Pn.constexp;if(ya.Find(e,r)&&(n=Ri(e,r)),ya.Find(t,r))o=Ri(t,r);else{if(n===Pn.constant)return Pn.constant;Gl.isminusone(t)?o=-1:Gl.isoneovertwo(t)?o=.5:Gl.isminusoneovertwo(t)?o=-.5:Gl.equalq(t,2,1)?o=2:Gl.equalq(t,-2,1)&&(o=-2)}return Math.pow(n,o)}function eT(){let e={};for(let t of Array.from(ZM)){let r=zM.scan_meta(t),n=me.cadr(r),i=Ri(n,Cn.symbol(me.METAX)).toFixed(6);e[i]||(e[i]=[]),e[i].push(t)}return console.log(`hashed_itab = ${JSON.stringify(e,null,2)}`),e}Wo.make_hashed_itab=eT;var tT={"1.144166":["f(a,a*x)"],"1.046770":["f(1/x,log(x))"],"0.936400":["f(x^a,x^(a+1)/(a+1))"],"1.095727":["f(x^(-2),-x^(-1))"],"1.023118":["f(x^(-1/2),2*x^(1/2))"],"0.977405":["f(x^(1/2),2/3*x^(3/2))"],"0.955320":["f(x,x^2/2)"],"0.912636":["f(x^2,x^3/3)"],"1.137302":["f(exp(a*x),1/a*exp(a*x))","f(a^x,a^x/log(a),or(not(number(a)),a>0))"],"1.326774":["f(exp(a*x+b),1/a*exp(a*x+b))"],"1.080259":["f(x*exp(a*x^2),exp(a*x^2)/(2*a))"],"1.260228":["f(x*exp(a*x^2+b),exp(a*x^2+b)/(2*a))"],"1.451902":["f(log(a*x),x*log(a*x)-x)"],"0.486192":["f(1/(a+x^2),1/sqrt(a)*arctan(x/sqrt(a)),or(not(number(a)),a>0))","f(1/(a-x^2),1/sqrt(a)*arctanh(x/sqrt(a)))","f(1/(a+b*x^2),1/sqrt(a*b)*arctan(x*sqrt(a*b)/a),or(not(number(a*b)),a*b>0))","f(1/(a+b*x^2),1/(2*sqrt(-a*b))*log((a+x*sqrt(-a*b))/(a-x*sqrt(-a*b))),or(not(number(a*b)),a*b<0))"],"0.697274":["f(1/sqrt(a-x^2),arcsin(x/(sqrt(a))))","f(1/sqrt(a+x^2),log(x+sqrt(a+x^2)))","f(1/sqrt(x^2+a),log(x+sqrt(x^2+a)))"],"0.476307":["f(1/(a+b*x),1/b*log(a+b*x))"],"0.226868":["f(1/(a+b*x)^2,-1/(b*(a+b*x)))"],"2.904531":["f(1/(a+b*x)^3,-1/(2*b)*1/(a+b*x)^2)"],"0.455026":["f(x/(a+b*x),x/b-a*log(a+b*x)/b/b)"],"0.216732":["f(x/(a+b*x)^2,1/b^2*(log(a+b*x)+a/(a+b*x)))"],"0.434695":["f(x^2/(a+b*x),1/b^2*(1/2*(a+b*x)^2-2*a*(a+b*x)+a^2*log(a+b*x)))"],"0.207048":["f(x^2/(a+b*x)^2,1/b^3*(a+b*x-2*a*log(a+b*x)-a^2/(a+b*x)))"],"2.650781":["f(x^2/(a+b*x)^3,1/b^3*(log(a+b*x)+2*a/(a+b*x)-1/2*a^2/(a+b*x)^2))"],"0.498584":["f(1/x*1/(a+b*x),-1/a*log((a+b*x)/x))"],"0.237479":["f(1/x*1/(a+b*x)^2,1/a*1/(a+b*x)-1/a^2*log((a+b*x)/x))"],"3.040375":["f(1/x*1/(a+b*x)^3,1/a^3*(1/2*((2*a+b*x)/(a+b*x))^2+log(x/(a+b*x))))"],"0.521902":["f(1/x^2*1/(a+b*x),-1/(a*x)+b/a^2*log((a+b*x)/x))"],"0.446014":["f(1/x^3*1/(a+b*x),(2*b*x-a)/(2*a^2*x^2)+b^2/a^3*log(x/(a+b*x)))"],"0.248586":["f(1/x^2*1/(a+b*x)^2,-(a+2*b*x)/(a^2*x*(a+b*x))+2*b/a^3*log((a+b*x)/x))"],"0.464469":["f(x/(a+b*x^2),1/2*1/b*log(a+b*x^2))"],"0.443716":["f(x^2/(a+b*x^2),x/b-a/b*integral(1/(a+b*x^2),x))"],"0.236382":["f(1/(a+b*x^2)^2,x/(2*a*(a+b*x^2))+1/2*1/a*integral(1/(a+b*x^2),x))"],"0.508931":["f(1/x*1/(a+b*x^2),1/2*1/a*log(x^2/(a+b*x^2)))"],"0.532733":["f(1/x^2*1/(a+b*x^2),-1/(a*x)-b/a*integral(1/(a+b*x^2),x))"],"0.480638":["f(1/(a+b*x^3),1/3*1/a*(a/b)^(1/3)*(1/2*log(((a/b)^(1/3)+x)^3/(a+b*x^3))+sqrt(3)*arctan((2*x-(a/b)^(1/3))*(a/b)^(-1/3)/sqrt(3))))"],"0.438648":["f(x^2/(a+b*x^3),1/3*1/b*log(a+b*x^3))"],"0.459164":["f(x/(a+b*x^4),1/2*sqrt(b/a)/b*arctan(x^2*sqrt(b/a)),or(not(number(a*b)),a*b>0))","f(x/(a+b*x^4),1/4*sqrt(-b/a)/b*log((x^2-sqrt(-a/b))/(x^2+sqrt(-a/b))),or(not(number(a*b)),a*b<0))"],"0.450070":["f(x^3/(a+b*x^4),1/4*1/b*log(a+b*x^4))"],"1.448960":["f(sqrt(a+b*x),2/3*1/b*sqrt((a+b*x)^3))"],"1.384221":["f(x*sqrt(a+b*x),-2*(2*a-3*b*x)*sqrt((a+b*x)^3)/15/b^2)"],"1.322374":["f(x^2*sqrt(a+b*x),2*(8*a^2-12*a*b*x+15*b^2*x^2)*sqrt((a+b*x)^3)/105/b^3)"],"1.516728":["f(sqrt(a+b*x)/x,2*sqrt(a+b*x)+a*integral(1/x*1/sqrt(a+b*x),x))"],"1.587665":["f(sqrt(a+b*x)/x^2,-sqrt(a+b*x)/x+b/2*integral(1/x*1/sqrt(a+b*x),x))"],"0.690150":["f(1/sqrt(a+b*x),2*sqrt(a+b*x)/b)"],"0.659314":["f(x/sqrt(a+b*x),-2/3*(2*a-b*x)*sqrt(a+b*x)/b^2)"],"0.629856":["f(x^2/sqrt(a+b*x),2/15*(8*a^2-4*a*b*x+3*b^2*x^2)*sqrt(a+b*x)/b^3)"],"0.722428":["f(1/x*1/sqrt(a+b*x),1/sqrt(a)*log((sqrt(a+b*x)-sqrt(a))/(sqrt(a+b*x)+sqrt(a))),or(not(number(a)),a>0))","f(1/x*1/sqrt(a+b*x),2/sqrt(-a)*arctan(sqrt(-(a+b*x)/a)),or(not(number(a)),a<0))"],"0.756216":["f(1/x^2*1/sqrt(a+b*x),-sqrt(a+b*x)/a/x-1/2*b/a*integral(1/x*1/sqrt(a+b*x),x))"],"1.434156":["f(sqrt(x^2+a),1/2*(x*sqrt(x^2+a)+a*log(x+sqrt(x^2+a))))","f(sqrt(a-x^2),1/2*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(abs(a)))))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*log(x*sqrt(a)+sqrt(a*x^2+b))/2/sqrt(a),and(number(a),a>0))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*arcsin(x*sqrt(-a/b))/2/sqrt(-a),and(number(a),a<0))"],"0.729886":["f(1/x*1/sqrt(x^2+a),arcsec(x/sqrt(-a))/sqrt(-a),or(not(number(a)),a<0))","f(1/x*1/sqrt(x^2+a),-1/sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(1/x*1/sqrt(a-x^2),-1/sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))"],"1.501230":["f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(-a)*arcsec(x/sqrt(-a)),or(not(number(a)),a<0))","f(sqrt(a-x^2)/x,sqrt(a-x^2)-sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))"],"0.666120":["f(x/sqrt(x^2+a),sqrt(x^2+a))","f(x/sqrt(a-x^2),-sqrt(a-x^2))"],"1.370077":["f(x*sqrt(x^2+a),1/3*sqrt((x^2+a)^3))","f(x*sqrt(a-x^2),-1/3*sqrt((a-x^2)^3))"],"1.730087":["f(sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2+a^(1/3))^3)+3/2*a^(1/3)*x*sqrt(x^2+a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2+a^(1/3)))))","f(sqrt(-a+x^6-3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2-a^(1/3))^3)-3/2*a^(1/3)*x*sqrt(x^2-a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2-a^(1/3)))))"],"0.578006":["f(1/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),x/a^(1/3)/sqrt(x^2+a^(1/3)))"],"0.552180":["f(x/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),-1/sqrt(x^2+a^(1/3)))"],"1.652787":["f(x*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/5*sqrt((x^2+a^(1/3))^5))"],"1.308862":["f(x^2*sqrt(x^2+a),1/4*x*sqrt((x^2+a)^3)-1/8*a*x*sqrt(x^2+a)-1/8*a^2*log(x+sqrt(x^2+a)))","f(x^2*sqrt(a-x^2),-x/4*sqrt((a-x^2)^3)+1/8*a*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(a))),or(not(number(a)),a>0))"],"1.342944":["f(x^3*sqrt(x^2+a),(1/5*x^2-2/15*a)*sqrt((x^2+a)^3),and(number(a),a>0))","f(x^3*sqrt(x^2+a),sqrt((x^2+a)^5)/5-a*sqrt((x^2+a)^3)/3,and(number(a),a<0))","f(x^3*sqrt(a-x^2),(-1/5*x^2-2/15*a)*sqrt((a-x^2)^3),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^3,-1/2*sqrt(a-x^2)/x^2+1/2*log((sqrt(a)+sqrt(a-x^2))/x)/sqrt(a),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^4,-1/3*sqrt((a-x^2)^3)/a/x^3,or(not(number(a)),a>0))"],"0.636358":["f(x^2/sqrt(x^2+a),1/2*x*sqrt(x^2+a)-1/2*a*log(x+sqrt(x^2+a)))","f(x^2/sqrt(a-x^2),-x/2*sqrt(a-x^2)+a/2*arcsin(x/sqrt(a)),or(not(number(a)),a>0))"],"0.652928":["f(x^3/sqrt(x^2+a),1/3*sqrt((x^2+a)^3)-a*sqrt(x^2+a))","f(1/x^3*1/sqrt(x^2+a),-1/2*sqrt(x^2+a)/a/x^2+1/2*log((sqrt(a)+sqrt(x^2+a))/x)/a^(3/2),or(not(number(a)),a>0))","f(1/x^3*1/sqrt(x^2-a),1/2*sqrt(x^2-a)/a/x^2+1/2*1/(a^(3/2))*arcsec(x/(a^(1/2))),or(not(number(a)),a>0))"],"0.764022":["f(1/x^2*1/sqrt(x^2+a),-sqrt(x^2+a)/a/x)","f(1/x^2*1/sqrt(a-x^2),-sqrt(a-x^2)/a/x,or(not(number(a)),a>0))"],"1.578940":["f(x^2*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/6*x*sqrt((x^2+a^(1/3))^5)-1/24*a^(1/3)*x*sqrt((x^2+a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2+a^(1/3))-1/16*a*log(x+sqrt(x^2+a^(1/3))),or(not(number(a)),a>0))","f(x^2*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/6*x*sqrt((x^2-a^(1/3))^5)+1/24*a^(1/3)*x*sqrt((x^2-a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2-a^(1/3))+1/16*a*log(x+sqrt(x^2-a^(1/3))),or(not(number(a)),a>0))"],"1.620055":["f(x^3*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/7*sqrt((x^2+a^(1/3))^7)-1/5*a^(1/3)*sqrt((x^2+a^(1/3))^5),or(not(number(a)),a>0))","f(x^3*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/7*sqrt((x^2-a^(1/3))^7)+1/5*a^(1/3)*sqrt((x^2-a^(1/3))^5),or(not(number(a)),a>0))"],"0.332117":["f(1/(x-a)/sqrt(x^2-a^2),-sqrt(x^2-a^2)/a/(x-a))","f(1/(x+a)/sqrt(x^2-a^2),sqrt(x^2-a^2)/a/(x+a))"],"1.571443":["f(sqrt(a-x^2)/x^2,-sqrt(a-x^2)/x-arcsin(x/sqrt(a)),or(not(number(a)),a>0))"],"1.690994":["f(sin(a*x),-cos(a*x)/a)"],"1.055979":["f(cos(a*x),sin(a*x)/a)"],"1.116714":["f(tan(a*x),-log(cos(a*x))/a)"],"0.895484":["f(1/tan(a*x),log(sin(a*x))/a)"],"0.946989":["f(1/cos(a*x),log(tan(pi/4+a*x/2))/a)"],"0.591368":["f(1/sin(a*x),log(tan(a*x/2))/a)"],"2.859462":["f(sin(a*x)^2,x/2-sin(2*a*x)/(4*a))"],"2.128050":["f(sin(a*x)^3,-cos(a*x)*(sin(a*x)^2+2)/(3*a))","f(sin(a*x)^4,3/8*x-sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))"],"1.115091":["f(cos(a*x)^2,x/2+sin(2*a*x)/(4*a))"],"1.081452":["f(cos(a*x)^3,sin(a*x)*(cos(a*x)^2+2)/(3*a))","f(cos(a*x)^4,3/8*x+sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))"],"0.349716":["f(1/sin(a*x)^2,-1/(a*tan(a*x)))"],"0.896788":["f(1/cos(a*x)^2,tan(a*x)/a)"],"1.785654":["f(sin(a*x)*cos(a*x),sin(a*x)^2/(2*a))"],"3.188560":["f(sin(a*x)^2*cos(a*x)^2,-sin(4*a*x)/(32*a)+x/8)"],"1.516463":["f(sin(a*x)/cos(a*x)^2,1/(a*cos(a*x)))"],"2.707879":["f(sin(a*x)^2/cos(a*x),(log(tan(pi/4+a*x/2))-sin(a*x))/a)"],"0.369293":["f(cos(a*x)/sin(a*x)^2,-1/(a*sin(a*x)))"],"0.560019":["f(1/(sin(a*x)*cos(a*x)),log(tan(a*x))/a)"],"0.530332":["f(1/(sin(a*x)*cos(a*x)^2),(1/cos(a*x)+log(tan(a*x/2)))/a)"],"0.331177":["f(1/(sin(a*x)^2*cos(a*x)),(log(tan(pi/4+a*x/2))-1/sin(a*x))/a)"],"0.313621":["f(1/(sin(a*x)^2*cos(a*x)^2),-2/(a*tan(2*a*x)))"],"3.172365":["f(sin(a+b*x),-cos(a+b*x)/b)"],"1.127162":["f(cos(a+b*x),sin(a+b*x)/b)"],"0.352714":["f(1/(b+b*sin(a*x)),-tan(pi/4-a*x/2)/a/b)","f(1/(b-b*sin(a*x)),tan(pi/4+a*x/2)/a/b)","f(1/(a+b*sin(x)),1/sqrt(b^2-a^2)*log((a*tan(x/2)+b-sqrt(b^2-a^2))/(a*tan(x/2)+b+sqrt(b^2-a^2))),b^2-a^2)"],"0.454515":["f(1/(b+b*cos(a*x)),tan(a*x/2)/a/b)","f(1/(b-b*cos(a*x)),-1/tan(a*x/2)/a/b)","f(1/(a+b*cos(x)),1/sqrt(b^2-a^2)*log((sqrt(b^2-a^2)*tan(x/2)+a+b)/(sqrt(b^2-a^2)*tan(x/2)-a-b)),b^2-a^2)"],"1.615441":["f(x*sin(a*x),sin(a*x)/a^2-x*cos(a*x)/a)"],"1.543263":["f(x^2*sin(a*x),2*x*sin(a*x)/a^2-(a^2*x^2-2)*cos(a*x)/a^3)"],"1.008798":["f(x*cos(a*x),cos(a*x)/a^2+x*sin(a*x)/a)"],"0.963724":["f(x^2*cos(a*x),2*x*cos(a*x)/a^2+(a^2*x^2-2)*sin(a*x)/a^3)"],"1.611938":["f(arcsin(a*x),x*arcsin(a*x)+sqrt(1-a^2*x^2)/a)"],"1.791033":["f(arccos(a*x),x*arccos(a*x)-sqrt(1-a^2*x^2)/a)"],"1.123599":["f(arctan(a*x),x*arctan(a*x)-1/2*log(1+a^2*x^2)/a)"],"1.387031":["f(x*log(a*x),x^2*log(a*x)/2-x^2/4)"],"1.325058":["f(x^2*log(a*x),x^3*log(a*x)/3-1/9*x^3)"],"2.108018":["f(log(x)^2,x*log(x)^2-2*x*log(x)+2*x)"],"0.403214":["f(1/x*1/(a+log(x)),log(a+log(x)))"],"2.269268":["f(log(a*x+b),(a*x+b)*log(a*x+b)/a-x)"],"2.486498":["f(log(a*x+b)/x^2,a/b*log(x)-(a*x+b)*log(a*x+b)/b/x)"],"1.769733":["f(sinh(x),cosh(x))"],"1.883858":["f(cosh(x),sinh(x))"],"1.606140":["f(tanh(x),log(cosh(x)))"],"1.690661":["f(x*sinh(x),x*cosh(x)-sinh(x))"],"1.799688":["f(x*cosh(x),x*sinh(x)-cosh(x))"],"3.131954":["f(sinh(x)^2,sinh(2*x)/4-x/2)"],"2.579685":["f(tanh(x)^2,x-tanh(x))"],"3.548923":["f(cosh(x)^2,sinh(2*x)/4+x/2)"],"1.058866":["f(x^3*exp(a*x^2),exp(a*x^2)*(x^2/a-1/(a^2))/2)"],"1.235270":["f(x^3*exp(a*x^2+b),exp(a*x^2)*exp(b)*(x^2/a-1/(a^2))/2)"],"1.130783":["f(exp(a*x^2),-i*sqrt(pi)*erf(i*sqrt(a)*x)/sqrt(a)/2)"],"1.078698":["f(erf(a*x),x*erf(a*x)+exp(-a^2*x^2)/a/sqrt(pi))"],"2.573650":["f(x^2*(1-x^2)^(3/2),(x*sqrt(1-x^2)*(-8*x^4+14*x^2-3)+3*arcsin(x))/48)","f(x^2*(1-x^2)^(5/2),(x*sqrt(1-x^2)*(48*x^6-136*x^4+118*x^2-15)+15*arcsin(x))/384)"],"2.640666":["f(x^4*(1-x^2)^(3/2),(-x*sqrt(1-x^2)*(16*x^6-24*x^4+2*x^2+3)+3*arcsin(x))/128)"],"1.086487":["f(x*exp(a*x),exp(a*x)*(a*x-1)/(a^2))"],"1.267493":["f(x*exp(a*x+b),exp(a*x+b)*(a*x-1)/(a^2))"],"1.037943":["f(x^2*exp(a*x),exp(a*x)*(a^2*x^2-2*a*x+2)/(a^3))"],"1.210862":["f(x^2*exp(a*x+b),exp(a*x+b)*(a^2*x^2-2*a*x+2)/(a^3))"],"1.064970":["f(x^3*exp(a*x),exp(a*x)*x^3/a-3/a*integral(x^2*exp(a*x),x))"],"1.242392":["f(x^3*exp(a*x+b),exp(a*x+b)*x^3/a-3/a*integral(x^2*exp(a*x+b),x))"]}});var __=A(va=>{"use strict";Object.defineProperty(va,"__esModule",{value:!0});va.logarithm=va.Eval_log=void 0;var Dr=N(),Yv=U(),f_=ce(),rT=j(),nT=Tn(),oT=G(),d_=Q(),iT=ee(),m_=X(),sT=io();function aT(e){return Li(oT.Eval(Dr.cadr(e)))}va.Eval_log=aT;function Li(e){return e===Yv.symbol(Dr.E)?Dr.Constants.one:d_.equaln(e,1)?Dr.Constants.zero:d_.isnegativenumber(e)?f_.add(Li(m_.negate(e)),m_.multiply(Dr.Constants.imaginaryunit,Dr.Constants.Pi())):Dr.isdouble(e)?rT.double(Math.log(e.d)):d_.isfraction(e)?f_.subtract(Li(sT.numerator(e)),Li(nT.denominator(e))):Dr.ispower(e)?m_.multiply(Dr.caddr(e),Li(Dr.cadr(e))):Dr.ismultiply(e)?e.tail().map(Li).reduce(f_.add,Dr.Constants.zero):iT.makeList(Yv.symbol(Dr.LOG),e)}va.logarithm=Li});var g_=A(qa=>{"use strict";Object.defineProperty(qa,"__esModule",{value:!0});qa.sgn=qa.Eval_sgn=void 0;var pr=N(),Vv=U(),lT=sn(),uT=G(),Zv=Q(),Xv=ee(),Hv=un(),b_=X(),cT=xt();function fT(e){return Qv(uT.Eval(pr.cadr(e)))}qa.Eval_sgn=fT;function Qv(e){return pr.isdouble(e)?e.d>0||e.d===0?pr.Constants.one:pr.Constants.negOne:pr.isrational(e)?pr.MSIGN(Hv.mmul(e.q.a,e.q.b))===-1?pr.Constants.negOne:pr.MZERO(Hv.mmul(e.q.a,e.q.b))?pr.Constants.zero:pr.Constants.one:Zv.iscomplexnumber(e)?b_.multiply(cT.power(pr.Constants.negOne,lT.absval(e)),e):Zv.isnegativeterm(e)?b_.multiply(Xv.makeList(Vv.symbol(pr.SGN),b_.negate(e)),pr.Constants.negOne):Xv.makeList(Vv.symbol(pr.SGN),e)}qa.sgn=Qv});var y_=A(Ea=>{"use strict";Object.defineProperty(Ea,"__esModule",{value:!0});Ea.ysinh=Ea.Eval_sinh=void 0;var Ci=N(),Wv=U(),dT=j(),mT=G(),_T=Q(),bT=ee();function gT(e){return Jv(mT.Eval(Ci.cadr(e)))}Ea.Eval_sinh=gT;function Jv(e){if(Ci.car(e)===Wv.symbol(Ci.ARCSINH))return Ci.cadr(e);if(Ci.isdouble(e)){let t=Math.sinh(e.d);return Math.abs(t)<1e-10&&(t=0),dT.double(t)}return _T.isZeroAtomOrTensor(e)?Ci.Constants.zero:bT.makeList(Wv.symbol(Ci.SINH),e)}Ea.ysinh=Jv});var wi=A(pa=>{"use strict";Object.defineProperty(pa,"__esModule",{value:!0});pa.derivative=pa.Eval_derivative=void 0;var E=N(),yT=sr(),r1=xe(),De=U(),zl=Ie(),Nr=ce(),Pc=Im(),Kv=Sm(),kt=j(),n1=Co(),o1=Rm(),vT=Pm(),xa=G(),e1=Zr(),qT=qm(),ET=Fl(),i1=Q(),jl=ee(),xT=__(),ve=X(),gr=xt(),pT=g_(),hT=Xo(),AT=Wn(),OT=y_(),t1=Vr(),v_=Et();function MT(e){e=E.cdr(e);let t=xa.Eval(E.car(e));e=E.cdr(e);let r,n,o=xa.Eval(E.car(e));for(o===De.symbol(E.NIL)?(r=e1.guess(t),n=De.symbol(E.NIL)):E.isNumericAtom(o)?(r=e1.guess(t),n=o):(r=o,e=E.cdr(e),n=xa.Eval(E.car(e)));;){let i;E.isNumericAtom(n)?(i=kt.nativeInt(n),isNaN(i)&&r1.stop("nth derivative: check n")):i=1;let s=t;if(i>=0)for(let u=0;u<i;u++)s=rt(s,r);else{i=-i;for(let u=0;u<i;u++)s=ET.integral(s,r)}if(t=s,n===De.symbol(E.NIL))break;if(E.isNumericAtom(n)){if(e=E.cdr(e),n=xa.Eval(E.car(e)),n===De.symbol(E.NIL))break;E.isNumericAtom(n)||(r=n,e=E.cdr(e),n=xa.Eval(E.car(e)))}else r=n,e=E.cdr(e),n=xa.Eval(E.car(e))}return t}pa.Eval_derivative=MT;function rt(e,t){return E.isNumericAtom(t)&&r1.stop("undefined function"),E.istensor(e)?E.istensor(t)?v_.d_tensor_tensor(e,t):v_.d_tensor_scalar(e,t):E.istensor(t)?v_.d_scalar_tensor(e,t):TT(e,t)}pa.derivative=rt;function TT(e,t){if(E.issymbol(t))return NT(e,t);let r=t1.subst(e,t,De.symbol(E.SECRETX));return t1.subst(rt(r,De.symbol(E.SECRETX)),De.symbol(E.SECRETX),t)}function NT(e,t){if(zl.equal(e,t))return E.Constants.one;if(!E.iscons(e))return E.Constants.zero;if(E.isadd(e))return IT(e,t);switch(E.car(e)){case De.symbol(E.MULTIPLY):return ST(e,t);case De.symbol(E.POWER):return RT(e,t);case De.symbol(E.DERIVATIVE):return LT(e,t);case De.symbol(E.LOG):return wT(e,t);case De.symbol(E.SIN):return PT(e,t);case De.symbol(E.COS):return DT(e,t);case De.symbol(E.TAN):return kT(e,t);case De.symbol(E.ARCSIN):return $T(e,t);case De.symbol(E.ARCCOS):return UT(e,t);case De.symbol(E.ARCTAN):return BT(e,t);case De.symbol(E.SINH):return GT(e,t);case De.symbol(E.COSH):return FT(e,t);case De.symbol(E.TANH):return jT(e,t);case De.symbol(E.ARCSINH):return zT(e,t);case De.symbol(E.ARCCOSH):return YT(e,t);case De.symbol(E.ARCTANH):return VT(e,t);case De.symbol(E.ABS):return ZT(e,t);case De.symbol(E.SGN):return XT(e,t);case De.symbol(E.HERMITE):return HT(e,t);case De.symbol(E.ERF):return QT(e,t);case De.symbol(E.ERFC):return WT(e,t);case De.symbol(E.BESSELJ):return JT(e,t);case De.symbol(E.BESSELY):return tN(e,t);default:}return E.car(e)===De.symbol(E.INTEGRAL)&&E.caddr(e)===t?oN(e):CT(e,t)}function IT(e,t){let r=E.iscons(e)?e.tail().map(n=>rt(n,t)):[];return Nr.add_all(r)}function ST(e,t){let r=zl.length(e)-1,n=[];for(let o=0;o<r;o++){let i=[],s=E.cdr(e);for(let u=0;u<r;u++){let c=E.car(s);o===u&&(c=rt(c,t)),i.push(c),s=E.cdr(s)}n.push(ve.multiply_all(i))}return Nr.add_all(n)}function RT(e,t){let r=ve.divide(E.caddr(e),E.cadr(e)),n=rt(E.cadr(e),t),o=xT.logarithm(E.cadr(e)),i=rt(E.caddr(e),t);return ve.multiply(Nr.add(ve.multiply(r,n),ve.multiply(o,i)),e)}function wT(e,t){let r=rt(E.cadr(e),t);return ve.divide(r,E.cadr(e))}function LT(e,t){let r=rt(E.cadr(e),t);return E.car(r)===De.symbol(E.DERIVATIVE)?zl.lessp(E.caddr(r),E.caddr(e))?jl.makeList(De.symbol(E.DERIVATIVE),jl.makeList(De.symbol(E.DERIVATIVE),E.cadr(r),E.caddr(r)),E.caddr(e)):jl.makeList(De.symbol(E.DERIVATIVE),jl.makeList(De.symbol(E.DERIVATIVE),E.cadr(r),E.caddr(e)),E.caddr(r)):rt(r,E.caddr(e))}function CT(e,t){let r=E.cdr(e);return r===De.symbol(E.NIL)||yT.Find(r,t)?jl.makeList(De.symbol(E.DERIVATIVE),e,t):E.Constants.zero}function PT(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,n1.cosine(E.cadr(e)))}function DT(e,t){let r=rt(E.cadr(e),t);return ve.negate(ve.multiply(r,AT.sine(E.cadr(e))))}function kT(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,gr.power(n1.cosine(E.cadr(e)),kt.integer(-2)))}function $T(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,gr.power(Nr.subtract(E.Constants.one,gr.power(E.cadr(e),kt.integer(2))),kt.rational(-1,2)))}function UT(e,t){let r=rt(E.cadr(e),t);return ve.negate(ve.multiply(r,gr.power(Nr.subtract(E.Constants.one,gr.power(E.cadr(e),kt.integer(2))),kt.rational(-1,2))))}function BT(e,t){let r=rt(E.cadr(e),t);return hT.simplify(ve.multiply(r,ve.inverse(Nr.add(E.Constants.one,gr.power(E.cadr(e),kt.integer(2))))))}function GT(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,o1.ycosh(E.cadr(e)))}function FT(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,OT.ysinh(E.cadr(e)))}function jT(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,gr.power(o1.ycosh(E.cadr(e)),kt.integer(-2)))}function zT(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,gr.power(Nr.add(gr.power(E.cadr(e),kt.integer(2)),E.Constants.one),kt.rational(-1,2)))}function YT(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,gr.power(Nr.add(gr.power(E.cadr(e),kt.integer(2)),E.Constants.negOne),kt.rational(-1,2)))}function VT(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,ve.inverse(Nr.subtract(E.Constants.one,gr.power(E.cadr(e),kt.integer(2)))))}function ZT(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,pT.sgn(E.cadr(e)))}function XT(e,t){let r=rt(E.cadr(e),t);return ve.multiply(ve.multiply(r,vT.dirac(E.cadr(e))),kt.integer(2))}function HT(e,t){let r=rt(E.cadr(e),t);return ve.multiply(ve.multiply(r,ve.multiply(kt.integer(2),E.caddr(e))),qT.hermite(E.cadr(e),Nr.add(E.caddr(e),E.Constants.negOne)))}function QT(e,t){let r=rt(E.cadr(e),t);return ve.multiply(ve.multiply(ve.multiply(zl.exponential(ve.multiply(gr.power(E.cadr(e),kt.integer(2)),E.Constants.negOne)),gr.power(E.Constants.Pi(),kt.rational(-1,2))),kt.integer(2)),r)}function WT(e,t){let r=rt(E.cadr(e),t);return ve.multiply(ve.multiply(ve.multiply(zl.exponential(ve.multiply(gr.power(E.cadr(e),kt.integer(2)),E.Constants.negOne)),gr.power(E.Constants.Pi(),kt.rational(-1,2))),kt.integer(-2)),r)}function JT(e,t){return i1.isZeroAtomOrTensor(E.caddr(e))?KT(e,t):eN(e,t)}function KT(e,t){let r=rt(E.cadr(e),t);return ve.multiply(ve.multiply(r,Pc.besselj(E.cadr(e),E.Constants.one)),E.Constants.negOne)}function eN(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,Nr.add(Pc.besselj(E.cadr(e),Nr.add(E.caddr(e),E.Constants.negOne)),ve.multiply(ve.divide(ve.multiply(E.caddr(e),E.Constants.negOne),E.cadr(e)),Pc.besselj(E.cadr(e),E.caddr(e)))))}function tN(e,t){return i1.isZeroAtomOrTensor(E.caddr(e))?rN(e,t):nN(e,t)}function rN(e,t){let r=rt(E.cadr(e),t);return ve.multiply(ve.multiply(r,Pc.besselj(E.cadr(e),E.Constants.one)),E.Constants.negOne)}function nN(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,Nr.add(Kv.bessely(E.cadr(e),Nr.add(E.caddr(e),E.Constants.negOne)),ve.multiply(ve.divide(ve.multiply(E.caddr(e),E.Constants.negOne),E.cadr(e)),Kv.bessely(E.cadr(e),E.caddr(e)))))}function oN(e){return E.cadr(e)}});var a1=A(kc=>{"use strict";Object.defineProperty(kc,"__esModule",{value:!0});kc.Eval_user_function=void 0;var Ye=N(),q_=xe(),Pi=U(),iN=wi(),E_=G(),x_=ee(),s1=Et();function sN(e){if(Ye.DEBUG&&console.log(`Eval_user_function evaluating: ${Ye.car(e)}`),Ye.car(e)===Pi.symbol(Ye.SYMBOL_D)&&Pi.get_binding(Pi.symbol(Ye.SYMBOL_D))===Pi.symbol(Ye.SYMBOL_D))return iN.Eval_derivative(e);let t=E_.Eval(Ye.car(e));Ye.isNumericAtom(t)?q_.stop("expected function invocation, found multiplication instead. Use '*' symbol explicitly for multiplication."):Ye.istensor(t)?q_.stop("expected function invocation, found tensor product instead. Use 'dot/inner' explicitly."):Ye.isstr(t)&&q_.stop("expected function, found string instead.");let r=Ye.car(Ye.cdr(t)),n=Ye.car(Ye.cdr(Ye.cdr(t))),o=Ye.cdr(e);if(Ye.car(t)!==Pi.symbol(Ye.FUNCTION)||t===Ye.car(e))return x_.makeList(t,...E_.evalList(o));e=n;let i=o,s=[];for(;Ye.iscons(e)&&Ye.iscons(i);)s.push(Ye.car(e)),s.push(Ye.car(i)),e=Ye.cdr(e),i=Ye.cdr(i);return s.length&&(r=Dc(r,s)),E_.Eval(r)}kc.Eval_user_function=sN;function Dc(e,t){if(Ye.istensor(e))return aN(e,t);if(Ye.iscons(e)){let n=[];for(Ye.car(e)===t[0]?n.push(x_.makeList(Pi.symbol(Ye.EVAL),t[1])):n.push(Ye.car(e)),e=Ye.cdr(e);Ye.iscons(e);)n.push(Dc(Ye.car(e),t)),e=Ye.cdr(e);return x_.makeList(...n)}if(!Ye.issymbol(e))return e;for(let n=0;n<t.length;n+=2)if(e===t[n])return t[n+1];let r=Pi.get_binding(e);return e!==r&&Dc(r,t)===r?e:r}function aN(e,t){return e=s1.copy_tensor(e),e.tensor.elem=e.tensor.elem.map(r=>Dc(r,t)),s1.check_tensor_dimensions(e),e}});var G=A(K=>{"use strict";Object.defineProperty(K,"__esModule",{value:!0});K.evalList=K.Eval_predicate=K.Eval_unit=K.Eval_subst=K.Eval_stop=K.Eval_sqrt=K.Eval_setq=K.Eval_rank=K.Eval_quote=K.Eval_operator=K.Eval_number=K.Eval_isinteger=K.Eval_invg=K.Eval_inv=K.Eval_index=K.Eval_hilbert=K.Eval_hermite=K.Eval_factorpoly=K.Eval_factorial=K.Eval_exp=K.Eval_Eval=K.Eval_dsolve=K.Eval_do=K.Eval_divisors=K.Eval_dim=K.Eval_det=K.Eval_check=K.Eval_binding=K.Eval_cons=K.Eval_sym=K.Eval=K.evaluate_integer=void 0;var c1=eg(),lN=St(),w=N(),_o=xe(),hr=U(),Di=j(),uN=Pd(),cN=mc(),fN=Xd(),dN=hi(),l1=xs(),mN=qm(),_N=$y(),f1=Il(),$c=Q(),Uc=ee(),bN=Ie(),gN=xt(),d1=Vr(),m1=Et(),u1=a1();function p_(e){return Di.nativeInt(we(e))}K.evaluate_integer=p_;function we(e){let t;_o.check_esc_flag(),e==null&&w.breakpoint,!w.defs.evaluatingAsFloats&&$c.isfloating(e)&&(t=!0,w.defs.evaluatingAsFloats=!0);try{switch(e.k){case w.CONS:return b1(e);case w.NUM:return w.defs.evaluatingAsFloats?Di.double(Di.convert_rational_to_double(e)):e;case w.DOUBLE:case w.STR:return e;case w.TENSOR:return m1.Eval_tensor(e);case w.SYM:return _1(e);default:_o.stop("atom?")}}finally{t&&(w.defs.evaluatingAsFloats=!1)}}K.Eval=we;function _1(e){if(hr.iskeyword(e))return we(Uc.makeList(e,hr.symbol(w.LAST)));if(e===hr.symbol(w.PI)&&w.defs.evaluatingAsFloats)return w.Constants.piAsDouble;let t=hr.get_binding(e);if(w.DEBUG&&console.log(`looked up: ${e} which contains: ${t}`),e!==t){let r=w.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated.indexOf(e);if(r!==-1){let n="";for(let o=r;o<w.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated.length;o++)n+=w.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated[o].printname+" -> ";n+=e.printname,_o.stop("recursive evaluation of symbols: "+n);return}w.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated.push(e),t=we(t),w.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated.pop()}return t}K.Eval_sym=_1;function b1(e){let t=w.car(e);return w.car(t)===hr.symbol(w.EVAL)?u1.Eval_user_function(e):(w.issymbol(t)||_o.stop("cons?"),t.keyword?t.keyword(e):u1.Eval_user_function(e))}K.Eval_cons=b1;function yN(e){return hr.get_binding(w.cadr(e))}K.Eval_binding=yN;function vN(e){let t=$c.isZeroLikeOrNonZeroLikeOrUndetermined(w.cadr(e));return t==null?e:Di.integer(Number(t))}K.Eval_check=vN;function qN(e){let t=we(w.cadr(e));return cN.det(t)}K.Eval_det=qN;function EN(e){let t=we(w.cadr(e)),r=w.iscons(w.cddr(e))?p_(w.caddr(e)):1;return w.istensor(t)?r<1||r>t.tensor.ndim?e:Di.integer(t.tensor.dim[r-1]):w.Constants.one}K.Eval_dim=EN;function xN(e){return fN.divisors(we(w.cadr(e)))}K.Eval_divisors=xN;function pN(e){let t=w.car(e);for(e=w.cdr(e);w.iscons(e);)t=we(w.car(e)),e=w.cdr(e);return t}K.Eval_do=pN;function hN(e){let t=we(w.cadr(e)),r=we(w.caddr(e)),n=we(w.cadddr(e));_o.stop("dsolve")}K.Eval_dsolve=hN;function AN(e){let t=we(w.cadr(e));for(e=w.cddr(e);w.iscons(e);)t=d1.subst(t,we(w.car(e)),we(w.cadr(e))),e=w.cddr(e);return we(t)}K.Eval_Eval=AN;function ON(e){return bN.exponential(we(w.cadr(e)))}K.Eval_exp=ON;function MN(e){return dN.factorial(we(w.cadr(e)))}K.Eval_factorial=MN;function TN(e){e=w.cdr(e);let t=we(w.car(e));e=w.cdr(e);let r=we(w.car(e)),n=l1.factorpoly(t,r);return w.iscons(e)&&(n=e.tail().reduce((o,i)=>l1.factorpoly(o,we(i)),n)),n}K.Eval_factorpoly=TN;function NN(e){let t=we(w.caddr(e)),r=we(w.cadr(e));return mN.hermite(r,t)}K.Eval_hermite=NN;function IN(e){return _N.hilbert(we(w.cadr(e)))}K.Eval_hilbert=IN;function SN(e){let t=e;e=w.cdr(e);let r=we(w.car(e));if(w.isNumericAtom(r)&&_o.stop("trying to access a scalar as a tensor"),!w.istensor(r))return t;let n=[];for(e=w.cdr(e);w.iscons(e);){if(n.push(we(w.car(e))),!$c.isintegerorintegerfloat(n[n.length-1]))return t;e=w.cdr(e)}return c1.index_function(r,n)}K.Eval_index=SN;function RN(e){let t=we(w.cadr(e));return f1.inv(t)}K.Eval_inv=RN;function wN(e){let t=we(w.cadr(e));return f1.invg(t)}K.Eval_invg=wN;function LN(e){return e=we(w.cadr(e)),w.isrational(e)?$c.isinteger(e)?w.Constants.one:w.Constants.zero:w.isdouble(e)?Math.floor(e.d)===e.d?w.Constants.one:w.Constants.zero:Uc.makeList(hr.symbol(w.ISINTEGER),e)}K.Eval_isinteger=LN;function CN(e){return e=we(w.cadr(e)),e.k===w.NUM||e.k===w.DOUBLE?w.Constants.one:w.Constants.zero}K.Eval_number=CN;function PN(e){return Uc.makeList(hr.symbol(w.OPERATOR),...g1(w.cdr(e)))}K.Eval_operator=PN;function DN(e){return w.cadr(e)}K.Eval_quote=DN;function kN(e){return e=we(w.cadr(e)),w.istensor(e)?Di.integer(e.tensor.ndim):w.Constants.zero}K.Eval_rank=kN;function $N(e){if(w.caadr(e)===hr.symbol(w.INDEX))return UN(e);if(w.iscons(w.cadr(e)))return uN.define_user_function(e);w.issymbol(w.cadr(e))||_o.stop("symbol assignment: error in symbol");let t=we(w.caddr(e));return hr.set_binding(w.cadr(e),t),hr.symbol(w.NIL)}K.Eval_setq=$N;function UN(e){let t=w.cadadr(e);console.log(`p4: ${t}`),w.issymbol(t)||_o.stop("indexed assignment: expected a symbol name");let r=we(w.caddr(e)),n=[],o=w.cdadr(e);w.iscons(o)&&(n=[...o].map(we));let i=c1.set_component(r,...n);return hr.set_binding(t,i),hr.symbol(w.NIL)}function BN(e){let t=we(w.cadr(e));return gN.power(t,Di.rational(1,2))}K.Eval_sqrt=BN;function GN(){_o.stop("user stop")}K.Eval_stop=GN;function FN(e){let t=we(w.cadr(e)),r=we(w.caddr(e)),n=we(w.cadddr(e));return we(d1.subst(n,r,t))}K.Eval_subst=FN;function jN(e){let t=p_(w.cadr(e));if(isNaN(t)||t<1)return e;e=lN.alloc_tensor(t*t),e.tensor.ndim=2,e.tensor.dim[0]=t,e.tensor.dim[1]=t;for(let r=0;r<t;r++)e.tensor.elem[t*r+r]=w.Constants.one;return m1.check_tensor_dimensions(e),e}K.Eval_unit=jN;function zN(e){return w.car(e)===hr.symbol(w.SETQ)&&(e=Uc.makeList(hr.symbol(w.TESTEQ),w.cadr(e),w.caddr(e))),we(e)}K.Eval_predicate=zN;function*g1(e){if(w.iscons(e))for(let t of e)yield we(t)}K.evalList=g1});var ce=A(Dn=>{"use strict";Object.defineProperty(Dn,"__esModule",{value:!0});Dn.subtract=Dn.add_all=Dn.add=Dn.Eval_add=void 0;var le=N(),YN=xe(),ki=U(),y1=j(),VN=G(),h_=Q(),ZN=ee(),v1=Ie(),q1=X(),XN=to(),HN=Et(),Yl=0;function QN(e){let t=[];e=le.cdr(e);for(let r of e){let n=VN.Eval(r);Bc(t,n)}return A_(t)}Dn.Eval_add=QN;function A_(e){if(le.DEBUG)for(let t of e)console.log(XN.print_list(t));for(let t=0;t<10&&!(e.length<2||(Yl=0,e.sort(JN),Yl===0));t++)KN(e);switch(e.length){case 0:return le.Constants.Zero();case 1:return e[0];default:return e.unshift(ki.symbol(le.ADD)),ZN.makeList(...e)}}var WN=0;function JN(e,t){if(WN++,le.isNumericAtom(e)&&le.isNumericAtom(t))return Yl=1,0;if(le.istensor(e)&&le.istensor(t)){if(e.tensor.ndim<t.tensor.ndim)return-1;if(e.tensor.ndim>t.tensor.ndim)return 1;for(let n=0;n<e.tensor.ndim;n++){if(e.tensor.dim[n]<t.tensor.dim[n])return-1;if(e.tensor.dim[n]>t.tensor.dim[n])return 1}return Yl=1,0}le.ismultiply(e)&&(e=le.cdr(e),le.isNumericAtom(le.car(e))&&(e=le.cdr(e),le.cdr(e)===ki.symbol(le.NIL)&&(e=le.car(e)))),le.ismultiply(t)&&(t=le.cdr(t),le.isNumericAtom(le.car(t))&&(t=le.cdr(t),le.cdr(t)===ki.symbol(le.NIL)&&(t=le.car(t))));let r=v1.cmp_expr(e,t);return r===0&&(Yl=1),r}function KN(e){let t=0;for(;t<e.length-1;){YN.check_esc_flag();let r,n,o=e[t],i=e[t+1];if(le.istensor(o)&&le.istensor(i)){r=HN.tensor_plus_tensor(o,i),r!==ki.symbol(le.NIL)&&(e.splice(t,2,r),t--),t++;continue}if(le.istensor(o)||le.istensor(i)){t++;continue}if(le.isNumericAtom(o)&&le.isNumericAtom(i)){r=y1.add_numbers(o,i),h_.isZeroAtomOrTensor(r)?e.splice(t,2):e.splice(t,2,r),t--,t++;continue}if(le.isNumericAtom(o)||le.isNumericAtom(i)){t++;continue}r=le.Constants.One(),n=le.Constants.One();let s=0;if(le.ismultiply(o)&&(o=le.cdr(o),s=1,le.isNumericAtom(le.car(o))&&(r=le.car(o),o=le.cdr(o),le.cdr(o)===ki.symbol(le.NIL)&&(o=le.car(o),s=0))),le.ismultiply(i)&&(i=le.cdr(i),le.isNumericAtom(le.car(i))&&(n=le.car(i),i=le.cdr(i),le.cdr(i)===ki.symbol(le.NIL)&&(i=le.car(i)))),!v1.equal(o,i)){t++;continue}if(r=y1.add_numbers(r,n),h_.isZeroAtomOrTensor(r)){e.splice(t,2),t--,t++;continue}let u=s?new le.Cons(ki.symbol(le.MULTIPLY),o):o;e.splice(t,2,q1.multiply(r,u)),t--,t++}}function Bc(e,t){le.isadd(t)?e.push(...t.tail()):h_.isZeroAtom(t)||e.push(t)}function E1(e,t){let r=[];return Bc(r,e),Bc(r,t),A_(r)}Dn.add=E1;function eI(e){let t=[];for(let r of e)Bc(t,r);return A_(t)}Dn.add_all=eI;function tI(e,t){return E1(e,q1.negate(t))}Dn.subtract=tI});var sn=A(kn=>{"use strict";Object.defineProperty(kn,"__esModule",{value:!0});kn.absval=kn.abs=kn.absValFloat=kn.Eval_abs=void 0;var ft=N(),O_=sr(),rI=xe(),Vl=U(),nI=Ie(),oI=ce(),Gc=j(),iI=vi(),sI=Tn(),jc=G(),aI=wn(),lI=ql(),uI=Fo(),$i=Q(),x1=ee(),Fc=X(),cI=io(),Zl=xt(),p1=Bs(),fI=eo(),h1=Xo(),Ir=!1;function dI(e){return M_(jc.Eval(ft.cadr(e)))}kn.Eval_abs=dI;function mI(e){return aI.zzfloat(jc.Eval(Xl(jc.Eval(e))))}kn.absValFloat=mI;function M_(e){let t=cI.numerator(e),r=Xl(t),n=sI.denominator(e),o=Xl(n),i=Fc.divide(r,o);return Ir&&(console.trace(">>>>  ABS of "+e),console.log(`ABS numerator ${t}`),console.log(`ABSVAL numerator: ${r}`),console.log(`ABS denominator: ${n}`),console.log(`ABSVAL denominator: ${o}`),console.log(`ABSVAL divided: ${i}`),console.log("<<<<<<<  ABS")),i}kn.abs=M_;function Xl(e){let t=e;if(Ir&&console.log(`ABS of ${e}`),$i.isZeroAtomOrTensor(e))return Ir&&(console.log(` abs: ${e} just zero`),console.log(" --> ABS of "+t+" : "+ft.Constants.zero)),ft.Constants.zero;if($i.isnegativenumber(e))return Ir&&console.log(` abs: ${e} just a negative`),Fc.negate(e);if($i.ispositivenumber(e))return Ir&&(console.log(` abs: ${e} just a positive`),console.log(` --> ABS of ${t} : ${e}`)),e;if(e===Vl.symbol(ft.PI))return Ir&&(console.log(` abs: ${e} of PI`),console.log(` --> ABS of ${t} : ${e}`)),e;if(ft.isadd(e)&&(O_.findPossibleClockForm(e,e)||O_.findPossibleExponentialForm(e)||O_.Find(e,ft.Constants.imaginaryunit))){Ir&&(console.log(` abs: ${e} is a sum`),console.log("abs of a sum")),e=fI.rect(e);let n=h1.simplify_trig(Zl.power(oI.add(Zl.power(p1.real(e),Gc.integer(2)),Zl.power(lI.imag(e),Gc.integer(2))),Gc.rational(1,2)));return Ir&&console.log(` --> ABS of ${t} : ${n}`),n}if(ft.ispower(e)&&$i.equaln(ft.cadr(e),-1)){let n=ft.Constants.One();if(Ir){console.log(` abs: ${e} is -1 to any power`);let o=ft.defs.evaluatingAsFloats?" abs: numeric, so result is 1.0":" abs: symbolic, so result is 1";console.log(o),console.log(` --> ABS of ${t} : ${n}`)}return n}if(ft.ispower(e)&&$i.ispositivenumber(ft.caddr(e))){let n=Zl.power(M_(ft.cadr(e)),ft.caddr(e));return Ir&&(console.log(` abs: ${e} is something to the power of a positive number`),console.log(` --> ABS of ${t} : ${n}`)),n}if(ft.ispower(e)&&ft.cadr(e)===Vl.symbol(ft.E)){let n=nI.exponential(p1.real(ft.caddr(e)));return Ir&&(console.log(` abs: ${e} is an exponential`),console.log(` --> ABS of ${t} : ${n}`)),n}if(ft.ismultiply(e)){let n=e.tail().map(Xl).reduce(Fc.multiply);return Ir&&(console.log(` abs: ${e} is a product`),console.log(` --> ABS of ${t} : ${n}`)),n}if(ft.car(e)===Vl.symbol(ft.ABS)){let n=x1.makeList(Vl.symbol(ft.ABS),ft.cadr(e));return Ir&&(console.log(` abs: ${e} is abs of a abs`),console.log(` --> ABS of ${t} : ${n}`)),n}if(ft.istensor(e))return _I(e);($i.isnegativeterm(e)||ft.isadd(e)&&$i.isnegativeterm(ft.cadr(e)))&&(e=Fc.negate(e));let r=x1.makeList(Vl.symbol(ft.ABS),e);return Ir&&(console.log(` abs: ${e} is nothing decomposable`),console.log(` --> ABS of ${t} : ${r}`)),r}kn.absval=Xl;function _I(e){return e.tensor.ndim!==1&&rI.stop("abs(tensor) with tensor rank > 1"),jc.Eval(h1.simplify(Zl.power(uI.inner(e,iI.conjugate(e)),Gc.rational(1,2))))}});var Q=A(V=>{"use strict";Object.defineProperty(V,"__esModule",{value:!0});V.isnpi=V.isquarterturn=V.isimaginaryunit=V.isfloating=V.isMinusSqrtThreeOverTwo=V.isSqrtThreeOverTwo=V.isminusoneoversqrttwo=V.isoneoversqrttwo=V.isminusoneovertwo=V.isoneovertwo=V.equalq=V.equaln=V.isfraction=V.isoneover=V.isNumberOneOverSomething=V.isintegerfactor=V.issymbolic=V.isnegative=V.iseveninteger=V.iscomplexnumber=V.iscomplexnumberdouble=V.isimaginarynumber=V.isnegativeterm=V.ispolyexpandedform=V.isunivarpolyfactoredorexpandedform=V.isposint=V.isnonnegativeinteger=V.isintegerorintegerfloat=V.isinteger=V.isone=V.isminusone=V.isplusone=V.isplustwo=V.ispositivenumber=V.isnegativenumber=V.isZeroLikeOrNonZeroLikeOrUndetermined=V.isZeroAtomOrTensor=V.isZeroAtom=void 0;var h=N(),ha=sr(),Jo=U(),Kt=Ie(),bI=sn(),Yc=j(),A1=G(),gI=wn(),yI=Zr(),I1=X(),Ql=!1;function S1(e){switch(e.k){case h.NUM:if(h.MZERO(e.q.a))return!0;break;case h.DOUBLE:if(e.d===0)return!0;break}return!1}V.isZeroAtom=S1;function vI(e){return h.istensor(e)?e.tensor.elem.every(t=>Hl(t)):!1}function Hl(e){return S1(e)||vI(e)}V.isZeroAtomOrTensor=Hl;function qI(e){let t=A1.Eval_predicate(e);if(Hl(t))return!1;if(h.isNumericAtomOrTensor(t))return!0;if(t=gI.zzfloat(t),Hl(t))return!1;if(h.isNumericAtomOrTensor(t))return!0;if(ha.Find(t,h.Constants.imaginaryunit)){if(t=A1.Eval_predicate(bI.absValFloat(t)),Hl(t))return!1;if(h.isNumericAtomOrTensor(t))return!0}return null}V.isZeroLikeOrNonZeroLikeOrUndetermined=qI;function Vc(e){switch(e.k){case h.NUM:if(h.MSIGN(e.q.a)===-1)return!0;break;case h.DOUBLE:if(e.d<0)return!0;break}return!1}V.isnegativenumber=Vc;function EI(e){switch(e.k){case h.NUM:if(h.MSIGN(e.q.a)===1)return!0;break;case h.DOUBLE:if(e.d>0)return!0;break}return!1}V.ispositivenumber=EI;function xI(e){switch(e.k){case h.NUM:if(h.MEQUAL(e.q.a,2)&&h.MEQUAL(e.q.b,1))return!0;break;case h.DOUBLE:if(e.d===2)return!0;break}return!1}V.isplustwo=xI;function R1(e){switch(e.k){case h.NUM:if(h.MEQUAL(e.q.a,1)&&h.MEQUAL(e.q.b,1))return!0;break;case h.DOUBLE:if(e.d===1)return!0;break}return!1}V.isplusone=R1;function I_(e){switch(e.k){case h.NUM:if(h.MEQUAL(e.q.a,-1)&&h.MEQUAL(e.q.b,1))return!0;break;case h.DOUBLE:if(e.d===-1)return!0;break}return!1}V.isminusone=I_;function pI(e){return R1(e)||I_(e)}V.isone=pI;function Ui(e){return e.k===h.NUM&&h.MEQUAL(e.q.b,1)}V.isinteger=Ui;function hI(e){return e.k===h.DOUBLE?e.d===Math.round(e.d):Ui(e)}V.isintegerorintegerfloat=hI;function AI(e){return h.isrational(e)&&h.MEQUAL(e.q.b,1)&&h.MSIGN(e.q.a)===1}V.isnonnegativeinteger=AI;function Zc(e){return Ui(e)&&h.MSIGN(e.q.a)===1}V.isposint=Zc;function OI(e,t){return t==null&&(t=yI.guess(e)),TI(e,t)&&MI(ha.Find(e,Jo.symbol(h.SYMBOL_X)),ha.Find(e,Jo.symbol(h.SYMBOL_Y)),ha.Find(e,Jo.symbol(h.SYMBOL_Z)))===1?t:!1}V.isunivarpolyfactoredorexpandedform=OI;function MI(...e){return e.reduce((t,r)=>t+Number(r),0)}function TI(e,t){return NI(e,t)}function NI(e,t){return h.ismultiply(e)?e.tail().every(r=>{let n=O1(r,t);return h.DEBUG&&(console.log(`ispolyfactoredorexpandedform_factor testing ${r}`),n&&console.log(`... tested negative:${r}`)),n}):O1(e,t)}function O1(e,t){return h.ispower(e)?(h.DEBUG&&console.log("ispolyfactoredorexpandedform_power (isposint(caddr(p)) "+(Zc(h.caddr(e)),h.DEBUG?console.log("ispolyfactoredorexpandedform_power ispolyexpandedform_expr(cadr(p), x)) "+zc(h.cadr(e),t)):void 0)),Zc(h.caddr(e))&&zc(h.cadr(e),t)):(h.DEBUG&&console.log(`ispolyfactoredorexpandedform_power not a power, testing if this is exp form: ${e}`),zc(e,t))}function II(e,t){return ha.Find(e,t)?zc(e,t):!1}V.ispolyexpandedform=II;function zc(e,t){return h.isadd(e)?e.tail().every(r=>M1(r,t)):M1(e,t)}function M1(e,t){return h.ismultiply(e)?e.tail().every(r=>T1(r,t)):T1(e,t)}function T1(e,t){return Kt.equal(e,t)?!0:h.ispower(e)&&Kt.equal(h.cadr(e),t)?Zc(h.caddr(e)):!ha.Find(e,t)}function T_(e){return Vc(e)||h.ismultiply(e)&&Vc(h.cadr(e))}V.isnegativeterm=T_;function w1(e){return h.ispower(e)&&h.isrational(h.car(h.cdr(h.cdr(e))))&&Vc(h.car(h.cdr(e)))?(Ql&&console.log(`hasNegativeRationalExponent: ${e} has imaginary component`),!0):(Ql&&console.log(`hasNegativeRationalExponent: ${e} has NO imaginary component`),!1)}function N1(e){return h.ismultiply(e)&&Kt.length(e)===3&&h.isdouble(h.cadr(e))&&w1(h.caddr(e))||Kt.equal(e,h.Constants.imaginaryunit)}function N_(e){return h.ismultiply(e)&&Kt.length(e)===3&&h.isNumericAtom(h.cadr(e))&&Kt.equal(h.caddr(e),h.Constants.imaginaryunit)||Kt.equal(e,h.Constants.imaginaryunit)||w1(h.caddr(e))?(Ql&&console.log(`isimaginarynumber: ${e} is imaginary number`),!0):(Ql&&console.log(`isimaginarynumber: ${e} isn't an imaginary number`),!1)}V.isimaginarynumber=N_;function SI(e){return h.isadd(e)&&Kt.length(e)===3&&h.isdouble(h.cadr(e))&&N1(h.caddr(e))||N1(e)}V.iscomplexnumberdouble=SI;function RI(e){return Ql&&h.breakpoint,h.isadd(e)&&Kt.length(e)===3&&h.isNumericAtom(h.cadr(e))&&N_(h.caddr(e))||N_(e)?(h.DEBUG&&console.log(`iscomplexnumber: ${e} is imaginary number`),!0):(h.DEBUG&&console.log(`iscomplexnumber: ${e} is imaginary number`),!1)}V.iscomplexnumber=RI;function wI(e){return Ui(e)&&e.q.a.isEven()}V.iseveninteger=wI;function LI(e){return h.isadd(e)&&T_(h.cadr(e))||T_(e)}V.isnegative=LI;function L1(e){return h.issymbol(e)?!0:h.iscons(e)?[...e].some(L1):!1}V.issymbolic=L1;function CI(e){return Ui(e)||h.ispower(e)&&Ui(h.cadr(e))&&Ui(h.caddr(e))}V.isintegerfactor=CI;function PI(e){return C1(e)&&h.MEQUAL(e.q.a.abs(),1)}V.isNumberOneOverSomething=PI;function DI(e){return h.ispower(e)&&I_(h.caddr(e))}V.isoneover=DI;function C1(e){return e.k===h.NUM&&!h.MEQUAL(e.q.b,1)}V.isfraction=C1;function Xc(e,t){switch(e.k){case h.NUM:return h.MEQUAL(e.q.a,t)&&h.MEQUAL(e.q.b,1);case h.DOUBLE:return e.d===t;default:return!1}}V.equaln=Xc;function Hc(e,t,r){switch(e.k){case h.NUM:return h.MEQUAL(e.q.a,t)&&h.MEQUAL(e.q.b,r);case h.DOUBLE:return e.d===t/r;default:return!1}}V.equalq=Hc;function S_(e){return Hc(e,1,2)}V.isoneovertwo=S_;function P1(e){return Hc(e,-1,2)}V.isminusoneovertwo=P1;function D1(e){return h.ispower(e)&&Xc(h.cadr(e),2)&&Hc(h.caddr(e),-1,2)}V.isoneoversqrttwo=D1;function kI(e){return h.ismultiply(e)&&Xc(h.cadr(e),-1)&&D1(h.caddr(e))&&Kt.length(e)===3}V.isminusoneoversqrttwo=kI;function $I(e){return h.ismultiply(e)&&S_(h.cadr(e))&&k1(h.caddr(e))&&Kt.length(e)===3}V.isSqrtThreeOverTwo=$I;function UI(e){return h.ismultiply(e)&&P1(h.cadr(e))&&k1(h.caddr(e))&&Kt.length(e)===3}V.isMinusSqrtThreeOverTwo=UI;function k1(e){return h.ispower(e)&&Xc(h.cadr(e),3)&&S_(h.caddr(e))}function $1(e){return e.k===h.DOUBLE||e===Jo.symbol(h.FLOATF)?!0:h.iscons(e)?[...e].some($1):!1}V.isfloating=$1;function BI(e){return Kt.equal(e,h.Constants.imaginaryunit)}V.isimaginaryunit=BI;function GI(e){let t=0;if(!h.ismultiply(e))return 0;if(Kt.equal(h.cadr(e),h.Constants.imaginaryunit))return h.caddr(e)!==Jo.symbol(h.PI)||Kt.length(e)!==3?0:2;if(!h.isNumericAtom(h.cadr(e))||!Kt.equal(h.caddr(e),h.Constants.imaginaryunit)||h.cadddr(e)!==Jo.symbol(h.PI)||Kt.length(e)!==4)return 0;let r=Yc.nativeInt(I1.multiply(h.cadr(e),Yc.integer(2)));if(isNaN(r))return 0;switch(r<1&&(t=1,r=-r),r%4){case 0:r=1;break;case 1:r=t?4:3;break;case 2:r=2;break;case 3:r=t?3:4}return r}V.isquarterturn=GI;function FI(e){let t=0;return e===Jo.symbol(h.PI)?2:!h.ismultiply(e)||!h.isNumericAtom(h.cadr(e))||h.caddr(e)!==Jo.symbol(h.PI)||Kt.length(e)!==3||(t=Yc.nativeInt(I1.multiply(h.cadr(e),Yc.integer(2))),isNaN(t))?0:(t<0?t=4- -t%4:t=1+(t-1)%4,t)}V.isnpi=FI});var uo=A(wt=>{"use strict";Object.defineProperty(wt,"__esModule",{value:!0});wt.yn=wt.jn=wt.append=wt.isalnumorunderscore=wt.isalpha=wt.isdigit=wt.isspace=wt.clear_term=wt.doubleToReasonableString=wt.strcmp=void 0;var jI=j(),zI=Q(),YI=ee(),Ko=N(),U1=xe(),Qc=U();function VI(e,t){return e===t?0:e>t?1:-1}wt.strcmp=VI;function ZI(e){let t;if(Ko.defs.codeGen||Ko.defs.fullDoubleOutput)return""+e;if(zI.isZeroAtomOrTensor(Qc.get_binding(Qc.symbol(Ko.FORCE_FIXED_PRINTOUT))))t=""+e,Ko.defs.printMode===Ko.PRINTMODE_LATEX?/\d*\.\d*e.*/gm.test(t)?t=t.replace(/e(.*)/gm,"\\mathrm{e}{$1}"):t=t.replace(/(\d+)e(.*)/gm,"$1.0\\mathrm{e}{$2}"):/\d*\.\d*e.*/gm.test(t)?t=t.replace(/e(.*)/gm,"*10^($1)"):t=t.replace(/(\d+)e(.*)/gm,"$1.0*10^($2)");else{let r=jI.nativeInt(Qc.get_binding(Qc.symbol(Ko.MAX_FIXED_PRINTOUT_DIGITS)));t=""+e.toFixed(r),t=t.replace(/(\.\d*?[1-9])0+$/gm,"$1"),t=t.replace(/\.0+$/gm,""),t.indexOf(".")===-1&&(t+=".0"),parseFloat(t)!==e&&(t=e.toFixed(r)+"...")}return t}wt.doubleToReasonableString=ZI;function XI(){}wt.clear_term=XI;function HI(e){return e==null?!1:e===" "||e==="	"||e===`
`||e==="\v"||e==="\f"||e==="\r"}wt.isspace=HI;function B1(e){return e==null?!1:/^\d+$/.test(e)}wt.isdigit=B1;function QI(e){return e==null?!1:e.search(/[^A-Za-z]/)===-1}wt.isalpha=QI;function WI(e){return e==null?!1:e.search(/[^A-Za-z_]/)===-1}function JI(e){return e==null?!1:WI(e)||B1(e)}wt.isalnumorunderscore=JI;function KI(e,t){let r=[];return Ko.iscons(e)&&r.push(...e),Ko.iscons(t)&&r.push(...t),YI.makeList(...r)}wt.append=KI;function eS(e,t){U1.stop("Not implemented")}wt.jn=eS;function tS(e,t){U1.stop("Not implemented")}wt.yn=tS});var G1=A(Wc=>{"use strict";Object.defineProperty(Wc,"__esModule",{value:!0});Wc.qadd=void 0;var R_=N(),rS=j(),nS=Fd(),oS=vs(),Wl=un();function iS(e,t){let r=Wl.mmul(e.q.a,t.q.b),n=Wl.mmul(e.q.b,t.q.a),o=nS.madd(r,n);if(R_.MZERO(o))return R_.Constants.zero;let i=Wl.mmul(e.q.b,t.q.b),s=oS.mgcd(o,i);s=rS.makeSignSameAs(s,i);let u=Wl.mdiv(o,s),c=Wl.mdiv(i,s);return new R_.Num(u,c)}Wc.qadd=iS});var F1=A(ef=>{"use strict";Object.defineProperty(ef,"__esModule",{value:!0});ef.qdiv=void 0;var Jc=N(),sS=xe(),aS=j(),lS=vs(),Kc=un();function uS(e,t){if(Jc.MZERO(t.q.a)&&sS.stop("divide by zero"),Jc.MZERO(e.q.a))return Jc.Constants.zero;let r=Kc.mmul(e.q.a,t.q.b),n=Kc.mmul(e.q.b,t.q.a),o=lS.mgcd(r,n);return o=aS.makeSignSameAs(o,n),new Jc.Num(Kc.mdiv(r,o),Kc.mdiv(n,o))}ef.qdiv=uS});var j1=A(nf=>{"use strict";Object.defineProperty(nf,"__esModule",{value:!0});nf.qmul=void 0;var tf=N(),cS=j(),fS=vs(),rf=un();function dS(e,t){if(tf.MZERO(e.q.a)||tf.MZERO(t.q.a))return tf.Constants.zero;let r=rf.mmul(e.q.a,t.q.a),n=rf.mmul(e.q.b,t.q.b),o=fS.mgcd(r,n);return o=cS.makeSignSameAs(o,n),new tf.Num(rf.mdiv(r,o),rf.mdiv(n,o))}nf.qmul=dS});var j=A(ie=>{"use strict";var mS=ie&&ie.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ie,"__esModule",{value:!0});ie.bignum_factorial=ie.bignum_float=ie.nativeDouble=ie.gcd_numbers=ie.print_number=ie.bignum_scan_float=ie.bignum_scan_integer=ie.nativeInt=ie.rational=ie.double=ie.integer=ie.convert_rational_to_double=ie.bignum_power_number=ie.mp_denominator=ie.mp_numerator=ie.bignum_truncate=ie.negate_number=ie.compare_numbers=ie.invert_number=ie.divide_numbers=ie.multiply_numbers=ie.add_numbers=ie.makePositive=ie.makeSignSameAs=ie.setSignTo=ie.isSmall=ie.mint=void 0;var $t=mS(No()),de=N(),_S=Tu(),bS=uo(),w_=xe(),Aa=Q(),z1=vs(),of=un(),Y1=nc(),gS=X(),yS=G1(),vS=F1(),qS=j1();function ES(e){return $t.default(e)}ie.mint=ES;function V1(e){return e.geq(Number.MIN_SAFE_INTEGER)&&e.leq(Number.MAX_SAFE_INTEGER)}ie.isSmall=V1;function sf(e,t){if(e.isPositive()){if(t<0)return e.multiply($t.default(-1))}else if(t>0)return e.multiply($t.default(-1));return e}ie.setSignTo=sf;function L_(e,t){if(e.isPositive()){if(t.isNegative())return e.multiply($t.default(-1))}else if(t.isPositive())return e.multiply($t.default(-1));return e}ie.makeSignSameAs=L_;function xS(e){return e.isNegative()?e.multiply($t.default(-1)):e}ie.makePositive=xS;function pS(e,t){if(de.isrational(e)&&de.isrational(t))return yS.qadd(e,t);let r=de.isdouble(e)?e.d:_n(e),n=de.isdouble(t)?t.d:_n(t);return C_(r+n)}ie.add_numbers=pS;function hS(e,t){if(de.isrational(e)&&de.isrational(t))return qS.qmul(e,t);let r=de.isdouble(e)?e.d:_n(e),n=de.isdouble(t)?t.d:_n(t);return new de.Double(r*n)}ie.multiply_numbers=hS;function AS(e,t){if(de.isrational(e)&&de.isrational(t))return vS.qdiv(e,t);Aa.isZeroAtomOrTensor(t)&&w_.stop("divide by zero");let r=de.isdouble(e)?e.d:_n(e),n=de.isdouble(t)?t.d:_n(t);return new de.Double(r/n)}ie.divide_numbers=AS;function OS(e){if(Aa.isZeroAtomOrTensor(e)&&w_.stop("divide by zero"),de.isdouble(e))return new de.Double(1/e.d);let t=$t.default(e.q.a),r=$t.default(e.q.b);return r=L_(r,t),t=sf(t,1),new de.Num(r,t)}ie.invert_number=OS;function MS(e,t){let r=of.mmul(e.q.a,t.q.b),n=of.mmul(e.q.b,t.q.a);return _S.mcmp(r,n)}function TS(e,t){if(de.isrational(e)&&de.isrational(t))return MS(e,t);let r=de.isdouble(e)?e.d:_n(e),n=de.isdouble(t)?t.d:_n(t);return r<n?-1:r>n?1:0}ie.compare_numbers=TS;function NS(e){if(Aa.isZeroAtomOrTensor(e))return e;switch(e.k){case de.NUM:return new de.Num($t.default(e.q.a.multiply($t.default.minusOne)),$t.default(e.q.b));case de.DOUBLE:return new de.Double(-e.d);default:w_.stop("bug caught in mp_negate_number")}}ie.negate_number=NS;function IS(e){let t=of.mdiv(e.q.a,e.q.b);return new de.Num(t)}ie.bignum_truncate=IS;function SS(e){return de.isrational(e)?new de.Num($t.default(e.q.a)):de.Constants.one}ie.mp_numerator=SS;function RS(e){return de.isrational(e)?new de.Num($t.default(e.q.b)):de.Constants.one}ie.mp_denominator=RS;function wS(e,t){let r=Y1.mpow(e.q.a,Math.abs(t)),n=Y1.mpow(e.q.b,Math.abs(t));if(t<0){let o=r;r=n,n=o,r=L_(r,n),n=sf(n,1)}return new de.Num(r,n)}ie.bignum_power_number=wS;function _n(e){e.q==null&&de.breakpoint;let t=e.q.a.divmod(e.q.b);return t.quotient.toJSNumber()+t.remainder.toJSNumber()/e.q.b.toJSNumber()}ie.convert_rational_to_double=_n;function LS(e){return new de.Num($t.default(e))}ie.integer=LS;function C_(e){return new de.Double(e)}ie.double=C_;function CS(e,t){return new de.Num($t.default(e),$t.default(t))}ie.rational=CS;function PS(e){let t=NaN;switch(e.k){case de.NUM:Aa.isinteger(e)&&V1(e.q.a)&&(t=e.q.a.toJSNumber());break;case de.DOUBLE:de.DEBUG&&console.log("popping integer but double is found"),Math.floor(e.d)===e.d&&(de.DEBUG&&console.log("...although it's an integer"),t=e.d);break}return t}ie.nativeInt=PS;function DS(e){let t=0,r=e[t];(r==="+"||r==="-")&&t++;let n=$t.default(e.substring(t)),o=new de.Num(n);return r==="-"&&(o=gS.negate(o)),o}ie.bignum_scan_integer=DS;function kS(e){return C_(parseFloat(e))}ie.bignum_scan_float=kS;function $S(e,t){let r="",n="",o="";switch(e.k){case de.NUM:var i=e.q.a.toString();t||i[0]==="-"&&(i=i.substring(1)),de.defs.printMode===de.PRINTMODE_LATEX&&Aa.isfraction(e)&&(i="\\frac{"+i+"}{"),r+=i,Aa.isfraction(e)&&(de.defs.printMode!==de.PRINTMODE_LATEX&&(r+="/"),n=e.q.b.toString(),de.defs.printMode===de.PRINTMODE_LATEX&&(n+="}"),r+=n);break;case de.DOUBLE:i=bS.doubleToReasonableString(e.d),t||i[0]==="-"&&(i=i.substring(1)),r+=i;break}return r}ie.print_number=$S;function US(e,t){let r=z1.mgcd(e.q.a,t.q.a),n=z1.mgcd(e.q.b,t.q.b);return new de.Num(sf(r,1),n)}ie.gcd_numbers=US;function BS(e){let t=0;switch(e.k){case de.NUM:t=_n(e);break;case de.DOUBLE:({d:t}=e);break;default:t=0}return t}ie.nativeDouble=BS;function GS(e){let t=_n(e);return new de.Double(t)}ie.bignum_float=GS;function FS(e){return new de.Num(jS(e))}ie.bignum_factorial=FS;function jS(e){let t;if(e===0||e===1)return t=$t.default(1),t;t=$t.default(2);let r=$t.default(0);if(3<=e)for(let n=3;n<=e;n++)r=$t.default(n),t=of.mmul(t,r);return t}});var r_=A(Ma=>{"use strict";Object.defineProperty(Ma,"__esModule",{value:!0});Ma.polyform=Ma.bake=void 0;var Tt=N(),zS=j(),YS=yi(),ei=Q(),Jl=ee(),Sr=U();function Z1(e){return Tt.doexpand(VS,e)}Ma.bake=Z1;function VS(e){let t=ei.ispolyexpandedform(e,Sr.symbol(Tt.SYMBOL_S)),r=ei.ispolyexpandedform(e,Sr.symbol(Tt.SYMBOL_T)),n=ei.ispolyexpandedform(e,Sr.symbol(Tt.SYMBOL_X)),o=ei.ispolyexpandedform(e,Sr.symbol(Tt.SYMBOL_Y)),i=ei.ispolyexpandedform(e,Sr.symbol(Tt.SYMBOL_Z)),s;return t&&!r&&!n&&!o&&!i?s=Oa(e,Sr.symbol(Tt.SYMBOL_S)):!t&&r&&!n&&!o&&!i?s=Oa(e,Sr.symbol(Tt.SYMBOL_T)):!t&&!r&&n&&!o&&!i?s=Oa(e,Sr.symbol(Tt.SYMBOL_X)):!t&&!r&&!n&&o&&!i?s=Oa(e,Sr.symbol(Tt.SYMBOL_Y)):!t&&!r&&!n&&!o&&i?s=Oa(e,Sr.symbol(Tt.SYMBOL_Z)):Tt.iscons(e)&&Tt.car(e)!==Sr.symbol(Tt.FOR)?s=Jl.makeList(Tt.car(e),...e.tail().map(Z1)):s=e,s}function X1(e,t){return ei.ispolyexpandedform(e,t)?Oa(e,t):Tt.iscons(e)?Jl.makeList(Tt.car(e),...e.tail().map(r=>X1(r,t))):e}Ma.polyform=X1;function Oa(e,t){let r=YS.coeff(e,t),n=[];for(let o=r.length-1;o>=0;o--){let i=r[o];n.push(...ZS(o,i,t))}return n.length>1?new Tt.Cons(Sr.symbol(Tt.ADD),Jl.makeList(...n)):n[0]}function ZS(e,t,r){if(ei.isZeroAtomOrTensor(t))return[];if(e===0)return Tt.isadd(t)?t.tail():[t];let n=[];return Tt.ismultiply(t)?n.push(...t.tail()):ei.equaln(t,1)||n.push(t),e===1?n.push(r):n.push(Jl.makeList(Sr.symbol(Tt.POWER),r,zS.integer(e))),n.length>1?[Jl.makeList(Sr.symbol(Tt.MULTIPLY),...n)]:n}});var k_=A(Wr=>{"use strict";Object.defineProperty(Wr,"__esModule",{value:!0});Wr.testApprox=Wr.approxAll=Wr.approxRationalsOfLogs=Wr.approxRadicals=Wr.Eval_approxratio=void 0;var XS=St(),bo=N(),HS=U(),H1=j(),QS=wn(),WS=ee(),JS=Et();function KS(e){return af(bo.cadr(e))}Wr.Eval_approxratio=KS;function af(e){if(bo.istensor(e)){let t=XS.alloc_tensor(e.tensor.nelem);return t.tensor.ndim=e.tensor.ndim,t.tensor.dim=Array.from(e.tensor.dim),t.tensor.elem=t.tensor.elem.map(r=>{let n=af(r);return JS.check_tensor_dimensions(t),n}),t}return e.k===bo.DOUBLE?eR(e):bo.iscons(e)?new bo.Cons(af(bo.car(e)),af(bo.cdr(e))):e}function eR(e){let t=QS.zzfloat(e);if(t.k===bo.DOUBLE){let r=t.d,n=r.toString().split(".");if(n.length===2){let o=n[1].length,i=1/Math.pow(10,o),s=tR(r,i);return H1.rational(s[0],s[1])}return H1.integer(r)}return WS.makeList(HS.symbol(bo.APPROXRATIO),t)}function tR(e,t){if(isNaN(e))return[0,0];if(e===1/0)return[1,0];if(e===-1/0)return[-1,0];let r=e<0?-1:1;if(e=Math.abs(e),Math.abs(e-Math.floor(e))<t)return[e*r,1];if(e<1e-19)return[r,1e19];if(e>1e19)return[1e19*r,1];let n=e,o=0,i=1,s;for(;;){n=1/(n-Math.floor(n));let u=i;if(i=i*Math.floor(n)+o,o=u,s=Math.floor(e*i+.5),!(Math.abs(e-s/i)>t)||n===Math.floor(n))break}return s=r*s,[s,i]}var Jr=0,rR=1,Q1=2,W1=3,P_=4,nR=6,J1=7,oR=8,iR=9;function sR(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),Jr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,o=Number.MAX_VALUE;for(let i of[2,3,5,6,7,8,10])for(let s=1;s<=10;s++){let u,c,d,_=Math.sqrt(i)/s;if(Math.abs(_)>1e-10?(d=e/_,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-_)),u<2*t){let R=kr(c,i,s);R<o&&(o=R,n=[`${c} * sqrt( ${i} ) / ${s}`,nR,c,i,s])}}return n}function aR(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),Jr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,o=Number.MAX_VALUE;for(let i of[1,2,3,5,6,7,8,10])for(let s of[1,2,3,5,6,7,8,10]){let u,c,d,_=Math.sqrt(i/s);if(Math.abs(_)>1e-10?(d=e/_,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-_)),u<2*t){let R=kr(c,i,s);R<o&&(o=R,n=[`${c} * (sqrt( ${i} / ${s} )`,P_,c,i,s])}}return n}function Bi(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),Jr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=sR(e);if(n!=null)return n;let o=aR(e);return o!=null?o:null}Wr.approxRadicals=Bi;function Kl(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),Jr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=K1(e);if(n!=null)return n;let o=lR(e);return o!=null?o:null}function K1(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),Jr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,o=Number.MAX_VALUE;for(let i=2;i<=5;i++)for(let s=1;s<=5;s++){let u,c,d,_=Math.log(i)/s;if(Math.abs(_)>1e-10?(d=e/_,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-_)),!(c!==1&&Math.abs(Math.floor(c/s))===Math.abs(c/s))&&u<2.2*t){let R=kr(c,i,s);R<o&&(o=R,n=[`${c} * log( ${i} ) / ${s}`,iR,c,i,s])}}return n}Wr.approxRationalsOfLogs=K1;function lR(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),Jr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,o=Number.MAX_VALUE;for(let i=1;i<=5;i++)for(let s=1;s<=5;s++){let u,c,d,_=Math.log(i/s);if(Math.abs(_)>1e-10?(d=e/_,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-_)),u<1.96*t){let R=kr(c,i,s);R<o&&(o=R,n=[`${c} * log( ${i} / ${s} )`,oR,c,i,s])}}return n}function eq(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),Jr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,o=Number.MAX_VALUE;for(let i=1;i<=2;i++)for(let s=1;s<=12;s++){let u,c,d,_=Math.pow(Math.E,i)/s;if(Math.abs(_)>1e-10?(d=e/_,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-_)),u<2*t){let R=kr(c,i,s);R<o&&(o=R,n=[`${c} * (e ^ ${i} ) / ${s}`,J1,c,i,s])}}return n}function D_(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),Jr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,o=Number.MAX_VALUE;for(let i=1;i<=5;i++)for(let s=1;s<=12;s++){let u,c,d,_=Math.pow(Math.PI,i)/s;if(Math.abs(_)>1e-10?(d=e/_,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-_)),u<2*t){let R=kr(c,i,s);R<o&&(o=R,n=[`${c} * (pi ^ ${i} ) / ${s} )`,W1,c,i,s])}}return n}function eu(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),Jr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=uR(e);if(n!=null)return n;let o=cR(e);return o!=null?o:null}function uR(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),Jr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,o=Number.MAX_VALUE;for(let i=1;i<=4;i++)for(let s=1;s<=4;s++){let u,c,d,_=i/s,R=Math.sin(_);if(Math.abs(R)>1e-10?(d=e/R,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-R)),u<2*t){let T=kr(c,i,s);T<o&&(o=T,n=[`${c} * sin( ${i}/${s} )`,rR,c,i,s])}}return n}function cR(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),Jr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,o=Number.MAX_VALUE;for(let i=1;i<=13;i++)for(let s=1;s<=13;s++){let u,c,d,_=i/s,R=Math.sin(Math.PI*_);if(Math.abs(R)>1e-10?(d=e/R,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-R)),u<23*t){let T=kr(c,i,s);T<o&&(o=T,n=[`${c} * sin( ${i}/${s} * pi )`,Q1,c,i,s])}}return n}function Se(e){let t,r=e.toString().split(".");if(r.length===2){let T=r[1].length;t=1/Math.pow(10,T)}else return[""+Math.floor(e),Jr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=Number.MAX_VALUE,o=0,i=null,s=!0,u=Bi(e);u!=null&&(o=kr(u),o<n?(s&&console.log(`better explanation by approxRadicals: ${u} complexity: ${o}`),n=o,i=u):s&&console.log(`subpar explanation by approxRadicals: ${u} complexity: ${o}`));let c=Kl(e);c!=null&&(o=kr(c),o<n?(s&&console.log(`better explanation by approxLogs: ${c} complexity: ${o}`),n=o,i=c):s&&console.log(`subpar explanation by approxLogs: ${c} complexity: ${o}`));let d=eq(e);d!=null&&(o=kr(d),o<n?(s&&console.log(`better explanation by approxRationalsOfPowersOfE: ${d} complexity: ${o}`),n=o,i=d):s&&console.log(`subpar explanation by approxRationalsOfPowersOfE: ${d} complexity: ${o}`));let _=D_(e);_!=null&&(o=kr(_),o<n?(s&&console.log(`better explanation by approxRationalsOfPowersOfPI: ${_} complexity: ${o}`),n=o,i=_):s&&console.log(`subpar explanation by approxRationalsOfPowersOfPI: ${_} complexity: ${o}`));let R=eu(e);return R!=null&&(o=kr(R),o<n?(s&&console.log(`better explanation by approxTrigonometric: ${R} complexity: ${o}`),n=o,i=R):s&&console.log(`subpar explanation by approxTrigonometric: ${R} complexity: ${o}`)),i}Wr.approxAll=Se;function kr(e,t,r){let n=0;if(e instanceof Array){switch(e[1]){case Q1:n=4;break;case W1:n=Math.pow(4,Math.abs(e[3]))*Math.abs(e[2]);break;case J1:n=Math.pow(3,Math.abs(e[3]))*Math.abs(e[2]);break;default:n=0}n+=Math.abs(e[2])*(Math.abs(e[3])+Math.abs(e[4]))}else n+=Math.abs(e)*(Math.abs(t)+Math.abs(r));return e[2]===1?n-=1:n+=1,e[3]===1?n-=1:n+=1,e[4]===1?n-=1:n+=1,n<0&&(n=0),n}function fR(){for(let t of[2,3,5,6,7,8,10])for(let r of[2,3,5,6,7,8,10]){if(t===r)continue;console.log(`testapproxRadicals testing: 1 * sqrt( ${t} ) / ${r}`);let n=t/r,o=Math.sqrt(t)/r,i=Bi(o),s=i[2]*Math.sqrt(i[3])/i[4];Math.abs(o-s)>1e-15&&console.log(`fail testapproxRadicals: 1 * sqrt( ${t} ) / ${r} . obtained: ${i}`)}for(let t of[2,3,5,6,7,8,10])for(let r of[2,3,5,6,7,8,10]){if(t===r)continue;console.log(`testapproxRadicals testing with 4 digits: 1 * sqrt( ${t} ) / ${r}`);let n=t/r,o=Math.sqrt(t)/r,i=o.toFixed(4),s=Bi(Number(i)),u=s[2]*Math.sqrt(s[3])/s[4];Math.abs(o-u)>1e-15&&console.log(`fail testapproxRadicals with 4 digits: 1 * sqrt( ${t} ) / ${r} . obtained: ${s}`)}for(let t of[2,3,5,6,7,8,10])for(let r of[2,3,5,6,7,8,10]){if(t===r)continue;console.log(`testapproxRadicals testing: 1 * sqrt( ${t} / ${r} )`);let n=t/r,o=Math.sqrt(t/r),i=Bi(o);if(i!=null){let s=i[2]*Math.sqrt(i[3]/i[4]);i[1]===P_&&Math.abs(o-s)>1e-15&&console.log(`fail testapproxRadicals: 1 * sqrt( ${t} / ${r} ) . obtained: ${i}`)}}for(let t of[1,2,3,5,6,7,8,10])for(let r of[1,2,3,5,6,7,8,10]){if(t===1&&r===1)continue;console.log(`testapproxRadicals testing with 4 digits:: 1 * sqrt( ${t} / ${r} )`);let n=t/r,o=Math.sqrt(t/r),i=o.toFixed(4),s=Bi(Number(i)),u=s[2]*Math.sqrt(s[3]/s[4]);s[1]===P_&&Math.abs(o-u)>1e-15&&console.log(`fail testapproxRadicals with 4 digits:: 1 * sqrt( ${t} / ${r} ) . obtained: ${s}`)}for(let t=1;t<=5;t++)for(let r=1;r<=5;r++){console.log(`testApproxAll testing: 1 * log(${t} ) / ${r}`);let n=t/r,o=Math.log(t)/r,i=Se(o),s=i[2]*Math.log(i[3])/i[4];Math.abs(o-s)>1e-15&&console.log(`fail testApproxAll: 1 * log(${t} ) / ${r} . obtained: ${i}`)}for(let t=1;t<=5;t++)for(let r=1;r<=5;r++){console.log(`testApproxAll testing with 4 digits: 1 * log(${t} ) / ${r}`);let n=t/r,o=Math.log(t)/r,i=o.toFixed(4),s=Se(Number(i)),u=s[2]*Math.log(s[3])/s[4];Math.abs(o-u)>1e-15&&console.log(`fail testApproxAll with 4 digits: 1 * log(${t} ) / ${r} . obtained: ${s}`)}for(let t=1;t<=5;t++)for(let r=1;r<=5;r++){console.log(`testApproxAll testing: 1 * log(${t} / ${r} )}`);let n=t/r,o=Math.log(t/r),i=Se(o),s=i[2]*Math.log(i[3]/i[4]);Math.abs(o-s)>1e-15&&console.log(`fail testApproxAll: 1 * log(${t} / ${r} ) . obtained: ${i}`)}for(let t=1;t<=5;t++)for(let r=1;r<=5;r++){console.log(`testApproxAll testing with 4 digits: 1 * log(${t} / ${r} )`);let n=t/r,o=Math.log(t/r),i=o.toFixed(4),s=Se(Number(i)),u=s[2]*Math.log(s[3]/s[4]);Math.abs(o-u)>1e-15&&console.log(`fail testApproxAll with 4 digits: 1 * log(${t} / ${r} ) . obtained: ${s}`)}for(let t=1;t<=2;t++)for(let r=1;r<=12;r++){console.log(`testApproxAll testing: 1 * (e ^ ${t} ) / ${r}`);let n=t/r,o=Math.pow(Math.E,t)/r,i=Se(o),s=i[2]*Math.pow(Math.E,i[3])/i[4];Math.abs(o-s)>1e-15&&console.log(`fail testApproxAll: 1 * (e ^ ${t} ) / ${r} . obtained: ${i}`)}for(let t=1;t<=2;t++)for(let r=1;r<=12;r++){console.log(`approxRationalsOfPowersOfE testing with 4 digits: 1 * (e ^ ${t} ) / ${r}`);let n=t/r,o=Math.pow(Math.E,t)/r,i=o.toFixed(4),s=eq(Number(i)),u=s[2]*Math.pow(Math.E,s[3])/s[4];Math.abs(o-u)>1e-15&&console.log(`fail approxRationalsOfPowersOfE with 4 digits: 1 * (e ^ ${t} ) / ${r} . obtained: ${s}`)}for(let t=1;t<=2;t++)for(let r=1;r<=12;r++){console.log(`testApproxAll testing: 1 * pi ^ ${t} / ${r}`);let n=t/r,o=Math.pow(Math.PI,t)/r,i=Se(o),s=i[2]*Math.pow(Math.PI,i[3])/i[4];Math.abs(o-s)>1e-15&&console.log(`fail testApproxAll: 1 * pi ^ ${t} / ${r} ) . obtained: ${i}`)}for(let t=1;t<=2;t++)for(let r=1;r<=12;r++){console.log(`approxRationalsOfPowersOfPI testing with 4 digits: 1 * pi ^ ${t} / ${r}`);let n=t/r,o=Math.pow(Math.PI,t)/r,i=o.toFixed(4),s=D_(Number(i)),u=s[2]*Math.pow(Math.PI,s[3])/s[4];Math.abs(o-u)>1e-15&&console.log(`fail approxRationalsOfPowersOfPI with 4 digits: 1 * pi ^ ${t} / ${r} ) . obtained: ${s}`)}for(let t=1;t<=4;t++)for(let r=1;r<=4;r++){console.log(`testApproxAll testing: 1 * sin( ${t}/${r} )}`);let n=t/r,o=Math.sin(n),i=Se(o),s=i[3]/i[4],u=i[2]*Math.sin(s);Math.abs(o-u)>1e-15&&console.log(`fail testApproxAll: 1 * sin( ${t}/${r} ) . obtained: ${i}`)}for(let t=1;t<=4;t++)for(let r=1;r<=4;r++){console.log(`testApproxAll testing with 5 digits: 1 * sin( ${t}/${r} )`);let n=t/r,o=Math.sin(n),i=o.toFixed(5),s=Se(Number(i));s==null&&console.log(`fail testApproxAll with 5 digits: 1 * sin( ${t}/${r} ) . obtained:  undefined `);let u=s[3]/s[4],c=s[2]*Math.sin(u),d=Math.abs(o-c);d>1e-14&&console.log(`fail testApproxAll with 5 digits: 1 * sin( ${t}/${r} ) . obtained: ${s} error: ${d}`)}for(let t=1;t<=4;t++)for(let r=1;r<=4;r++){console.log(`testApproxAll testing with 4 digits: 1 * sin( ${t}/${r} )`);let n=t/r,o=Math.sin(n),i=o.toFixed(4),s=Se(Number(i));s==null&&console.log(`fail testApproxAll with 4 digits: 1 * sin( ${t}/${r} ) . obtained:  undefined `);let u=s[3]/s[4],c=s[2]*Math.sin(u),d=Math.abs(o-c);d>1e-14&&console.log(`fail testApproxAll with 4 digits: 1 * sin( ${t}/${r} ) . obtained: ${s} error: ${d}`)}let e=0;Se(e)[0]!=="0"&&console.log("fail testApproxAll: 0"),e=0,Se(e)[0]!=="0"&&console.log("fail testApproxAll: 0.0"),e=0,Se(e)[0]!=="0"&&console.log("fail testApproxAll: 0.00"),e=0,Se(e)[0]!=="0"&&console.log("fail testApproxAll: 0.000"),e=0,Se(e)[0]!=="0"&&console.log("fail testApproxAll: 0.0000"),e=1,Se(e)[0]!=="1"&&console.log("fail testApproxAll: 1"),e=1,Se(e)[0]!=="1"&&console.log("fail testApproxAll: 1.0"),e=1,Se(e)[0]!=="1"&&console.log("fail testApproxAll: 1.00"),e=1,Se(e)[0]!=="1"&&console.log("fail testApproxAll: 1.000"),e=1,Se(e)[0]!=="1"&&console.log("fail testApproxAll: 1.0000"),e=1,Se(e)[0]!=="1"&&console.log("fail testApproxAll: 1.00000"),e=Math.sqrt(2),Se(e)[0]!=="1 * sqrt( 2 ) / 1"&&console.log("fail testApproxAll: Math.sqrt(2)"),e=1.41,Se(e)[0]!=="1 * sqrt( 2 ) / 1"&&console.log("fail testApproxAll: 1.41"),e=1.4,Bi(e)[0]!=="1 * sqrt( 2 ) / 1"&&console.log("fail approxRadicals: 1.4"),e=.6,Kl(e)[0]!=="1 * log( 2 ) / 1"&&console.log("fail approxLogs: 0.6"),e=.69,Kl(e)[0]!=="1 * log( 2 ) / 1"&&console.log("fail approxLogs: 0.69"),e=.7,Kl(e)[0]!=="1 * log( 2 ) / 1"&&console.log("fail approxLogs: 0.7"),e=1.09,Kl(e)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxLogs: 1.09"),e=1.09,Se(e)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.09"),e=1.098,Se(e)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.098"),e=1.1,Se(e)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.1"),e=1.11,Se(e)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.11"),e=Math.sqrt(3),Se(e)[0]!=="1 * sqrt( 3 ) / 1"&&console.log("fail testApproxAll: Math.sqrt(3)"),e=1,Se(e)[0]!=="1"&&console.log("fail testApproxAll: 1.0000"),e=3.141592,Se(e)[0]!=="1 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 3.141592"),e=31.41592,Se(e)[0]!=="10 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 31.41592"),e=314.1592,Se(e)[0]!=="100 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 314.1592"),e=3141592653589793e-8,Se(e)[0]!=="10000000 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 31415926.53589793"),e=Math.sqrt(2),eu(e)[0]!=="2 * sin( 1/4 * pi )"&&console.log("fail approxTrigonometric: Math.sqrt(2)"),e=Math.sqrt(3),eu(e)[0]!=="2 * sin( 1/3 * pi )"&&console.log("fail approxTrigonometric: Math.sqrt(3)"),e=(Math.sqrt(6)-Math.sqrt(2))/4,Se(e)[0]!=="1 * sin( 1/12 * pi )"&&console.log("fail testApproxAll: (Math.sqrt(6) - Math.sqrt(2))/4"),e=Math.sqrt(2-Math.sqrt(2))/2,Se(e)[0]!=="1 * sin( 1/8 * pi )"&&console.log("fail testApproxAll: Math.sqrt(2 - Math.sqrt(2))/2"),e=(Math.sqrt(6)+Math.sqrt(2))/4,Se(e)[0]!=="1 * sin( 5/12 * pi )"&&console.log("fail testApproxAll: (Math.sqrt(6) + Math.sqrt(2))/4"),e=Math.sqrt(2+Math.sqrt(3))/2,Se(e)[0]!=="1 * sin( 5/12 * pi )"&&console.log("fail testApproxAll: Math.sqrt(2 + Math.sqrt(3))/2"),e=(Math.sqrt(5)-1)/4,Se(e)[0]!=="1 * sin( 1/10 * pi )"&&console.log("fail testApproxAll: (Math.sqrt(5) - 1)/4"),e=Math.sqrt(10-2*Math.sqrt(5))/4,Se(e)[0]!=="1 * sin( 1/5 * pi )"&&console.log("fail testApproxAll: Math.sqrt(10 - 2*Math.sqrt(5))/4"),e=Math.sin(Math.PI/7),Se(e)[0]!=="1 * sin( 1/7 * pi )"&&console.log("fail testApproxAll: Math.sin(Math.PI/7)"),e=Math.sin(Math.PI/9),Se(e)[0]!=="1 * sin( 1/9 * pi )"&&console.log("fail testApproxAll: Math.sin(Math.PI/9)"),e=1836.15267,D_(e)[0]!=="6 * (pi ^ 5 ) / 1 )"&&console.log("fail approxRationalsOfPowersOfPI: 1836.15267");for(let t=1;t<=13;t++)for(let r=1;r<=13;r++){console.log(`approxTrigonometric testing: 1 * sin( ${t}/${r} * pi )`);let n=t/r;e=Math.sin(Math.PI*n);let o=eu(e),i=o[3]/o[4],s=o[2]*Math.sin(Math.PI*i);Math.abs(e-s)>1e-15&&console.log(`fail approxTrigonometric: 1 * sin( ${t}/${r} * pi ) . obtained: ${o}`)}for(let t=1;t<=13;t++)for(let r=1;r<=13;r++){if(t===5&&r===11||t===6&&r===11)continue;console.log(`approxTrigonometric testing with 4 digits: 1 * sin( ${t}/${r} * pi )`);let n=t/r,o=Math.sin(Math.PI*n),i=o.toFixed(4),s=eu(Number(i)),u=s[3]/s[4],c=s[2]*Math.sin(Math.PI*u),d=Math.abs(o-c);d>1e-14&&console.log(`fail approxTrigonometric with 4 digits: 1 * sin( ${t}/${r} * pi ) . obtained: ${s} error: ${d}`)}return console.log("testApprox done")}Wr.testApprox=fR});var rq=A(lf=>{"use strict";Object.defineProperty(lf,"__esModule",{value:!0});lf.Eval_arccos=void 0;var re=N(),Kr=U(),dr=j(),dR=G(),$n=Q(),tq=ee(),ti=X();function mR(e){return _R(dR.Eval(re.cadr(e)))}lf.Eval_arccos=mR;function _R(e){if(re.car(e)===Kr.symbol(re.COS))return re.cadr(e);if(re.isdouble(e))return dr.double(Math.acos(e.d));if($n.isoneoversqrttwo(e)||re.ismultiply(e)&&$n.equalq(re.car(re.cdr(e)),1,2)&&re.car(re.car(re.cdr(re.cdr(e))))===Kr.symbol(re.POWER)&&$n.equaln(re.car(re.cdr(re.car(re.cdr(re.cdr(e))))),2)&&$n.equalq(re.car(re.cdr(re.cdr(re.car(re.cdr(re.cdr(e)))))),1,2))return re.defs.evaluatingAsFloats?dr.double(Math.PI/4):ti.multiply(dr.rational(1,4),Kr.symbol(re.PI));if($n.isminusoneoversqrttwo(e)||re.ismultiply(e)&&$n.equalq(re.car(re.cdr(e)),-1,2)&&re.car(re.car(re.cdr(re.cdr(e))))===Kr.symbol(re.POWER)&&$n.equaln(re.car(re.cdr(re.car(re.cdr(re.cdr(e))))),2)&&$n.equalq(re.car(re.cdr(re.cdr(re.car(re.cdr(re.cdr(e)))))),1,2))return re.defs.evaluatingAsFloats?dr.double(Math.PI*3/4):ti.multiply(dr.rational(3,4),Kr.symbol(re.PI));if($n.isSqrtThreeOverTwo(e))return re.defs.evaluatingAsFloats?dr.double(Math.PI/6):ti.multiply(dr.rational(1,6),Kr.symbol(re.PI));if($n.isMinusSqrtThreeOverTwo(e))return re.defs.evaluatingAsFloats?dr.double(5*Math.PI/6):ti.multiply(dr.rational(5,6),Kr.symbol(re.PI));if(!re.isrational(e))return tq.makeList(Kr.symbol(re.ARCCOS),e);switch(dr.nativeInt(ti.multiply(e,dr.integer(2)))){case-2:return re.Constants.Pi();case-1:return re.defs.evaluatingAsFloats?dr.double(Math.PI*2/3):ti.multiply(dr.rational(2,3),Kr.symbol(re.PI));case 0:return re.defs.evaluatingAsFloats?dr.double(Math.PI/2):ti.multiply(dr.rational(1,2),Kr.symbol(re.PI));case 1:return re.defs.evaluatingAsFloats?dr.double(Math.PI/3):ti.multiply(dr.rational(1,3),Kr.symbol(re.PI));case 2:return re.Constants.Zero();default:return tq.makeList(Kr.symbol(re.ARCCOS),e)}}});var oq=A(uf=>{"use strict";Object.defineProperty(uf,"__esModule",{value:!0});uf.Eval_arccosh=void 0;var Gi=N(),bR=xe(),nq=U(),gR=j(),yR=G(),vR=Q(),qR=ee();function ER(e){return xR(yR.Eval(Gi.cadr(e)))}uf.Eval_arccosh=ER;function xR(e){if(Gi.car(e)===nq.symbol(Gi.COSH))return Gi.cadr(e);if(Gi.isdouble(e)){let{d:t}=e;return t<1&&bR.stop("arccosh function argument is less than 1.0"),t=Math.log(t+Math.sqrt(t*t-1)),gR.double(t)}return vR.isplusone(e)?Gi.Constants.zero:qR.makeList(nq.symbol(Gi.ARCCOSH),e)}});var sq=A(cf=>{"use strict";Object.defineProperty(cf,"__esModule",{value:!0});cf.Eval_arcsin=void 0;var ne=N(),$r=U(),er=j(),pR=G(),Un=Q(),iq=ee(),go=X();function hR(e){return AR(pR.Eval(ne.cadr(e)))}cf.Eval_arcsin=hR;function AR(e){if(ne.car(e)===$r.symbol(ne.SIN))return ne.cadr(e);if(ne.isdouble(e))return er.double(Math.asin(e.d));if(Un.isoneoversqrttwo(e)||ne.ismultiply(e)&&Un.equalq(ne.car(ne.cdr(e)),1,2)&&ne.car(ne.car(ne.cdr(ne.cdr(e))))===$r.symbol(ne.POWER)&&Un.equaln(ne.car(ne.cdr(ne.car(ne.cdr(ne.cdr(e))))),2)&&Un.equalq(ne.car(ne.cdr(ne.cdr(ne.car(ne.cdr(ne.cdr(e)))))),1,2))return go.multiply(er.rational(1,4),$r.symbol(ne.PI));if(Un.isminusoneoversqrttwo(e)||ne.ismultiply(e)&&Un.equalq(ne.car(ne.cdr(e)),-1,2)&&ne.car(ne.car(ne.cdr(ne.cdr(e))))===$r.symbol(ne.POWER)&&Un.equaln(ne.car(ne.cdr(ne.car(ne.cdr(ne.cdr(e))))),2)&&Un.equalq(ne.car(ne.cdr(ne.cdr(ne.car(ne.cdr(ne.cdr(e)))))),1,2))return ne.defs.evaluatingAsFloats?er.double(-Math.PI/4):go.multiply(er.rational(-1,4),$r.symbol(ne.PI));if(Un.isSqrtThreeOverTwo(e))return ne.defs.evaluatingAsFloats?er.double(Math.PI/3):go.multiply(er.rational(1,3),$r.symbol(ne.PI));if(Un.isMinusSqrtThreeOverTwo(e))return ne.defs.evaluatingAsFloats?er.double(-Math.PI/3):go.multiply(er.rational(-1,3),$r.symbol(ne.PI));if(!ne.isrational(e))return iq.makeList($r.symbol(ne.ARCSIN),e);switch(er.nativeInt(go.multiply(e,er.integer(2)))){case-2:return ne.defs.evaluatingAsFloats?er.double(-Math.PI/2):go.multiply(er.rational(-1,2),$r.symbol(ne.PI));case-1:return ne.defs.evaluatingAsFloats?er.double(-Math.PI/6):go.multiply(er.rational(-1,6),$r.symbol(ne.PI));case 0:return ne.Constants.Zero();case 1:return ne.defs.evaluatingAsFloats?er.double(Math.PI/6):go.multiply(er.rational(1,6),$r.symbol(ne.PI));case 2:return ne.defs.evaluatingAsFloats?er.double(Math.PI/2):go.multiply(er.rational(1,2),$r.symbol(ne.PI));default:return iq.makeList($r.symbol(ne.ARCSIN),e)}}});var lq=A(ff=>{"use strict";Object.defineProperty(ff,"__esModule",{value:!0});ff.Eval_arcsinh=void 0;var Fi=N(),aq=U(),OR=j(),MR=G(),TR=Q(),NR=ee();function IR(e){return SR(MR.Eval(Fi.cadr(e)))}ff.Eval_arcsinh=IR;function SR(e){if(Fi.car(e)===aq.symbol(Fi.SINH))return Fi.cadr(e);if(Fi.isdouble(e)){let{d:t}=e;return t=Math.log(t+Math.sqrt(t*t+1)),OR.double(t)}return TR.isZeroAtomOrTensor(e)?Fi.Constants.zero:NR.makeList(aq.symbol(Fi.ARCSINH),e)}});var cq=A(df=>{"use strict";Object.defineProperty(df,"__esModule",{value:!0});df.Eval_arctanh=void 0;var ji=N(),RR=xe(),uq=U(),wR=j(),LR=G(),CR=Q(),PR=ee();function DR(e){return kR(LR.Eval(ji.cadr(e)))}df.Eval_arctanh=DR;function kR(e){if(ji.car(e)===uq.symbol(ji.TANH))return ji.cadr(e);if(ji.isdouble(e)){let{d:t}=e;return(t<-1||t>1)&&RR.stop("arctanh function argument is not in the interval [-1,1]"),t=Math.log((1+t)/(1-t))/2,wR.double(t)}return CR.isZeroAtomOrTensor(e)?ji.Constants.zero:PR.makeList(uq.symbol(ji.ARCTANH),e)}});var mq=A(mf=>{"use strict";Object.defineProperty(mf,"__esModule",{value:!0});mf.Eval_binomial=void 0;var yo=N(),$_=Ie(),$R=ce(),fq=G(),U_=hi(),dq=X();function UR(e){let t=fq.Eval(yo.cadr(e)),r=fq.Eval(yo.caddr(e));return BR(t,r)}mf.Eval_binomial=UR;function BR(e,t){return GR(e,t)}function GR(e,t){return FR(e,t)?dq.divide(dq.divide(U_.factorial(e),U_.factorial(t)),U_.factorial($R.subtract(e,t))):yo.Constants.zero}function FR(e,t){return yo.isNumericAtom(e)&&$_.lessp(e,yo.Constants.zero)||yo.isNumericAtom(t)&&$_.lessp(t,yo.Constants.zero)?!1:!(yo.isNumericAtom(e)&&yo.isNumericAtom(t)&&$_.lessp(e,t))}});var bq=A(_f=>{"use strict";Object.defineProperty(_f,"__esModule",{value:!0});_f.Eval_ceiling=void 0;var Ta=N(),jR=U(),zR=ce(),YR=j(),VR=G(),_q=Q(),ZR=ee(),XR=un();function HR(e){return QR(VR.Eval(Ta.cadr(e)))}_f.Eval_ceiling=HR;function QR(e){return WR(e)}function WR(e){if(!Ta.isNumericAtom(e))return ZR.makeList(jR.symbol(Ta.CEILING),e);if(Ta.isdouble(e))return YR.double(Math.ceil(e.d));if(_q.isinteger(e))return e;let t=new Ta.Num(XR.mdiv(e.q.a,e.q.b));return _q.isnegativenumber(e)||(t=zR.add(t,Ta.Constants.one)),t}});var vq=A(bf=>{"use strict";Object.defineProperty(bf,"__esModule",{value:!0});bf.Eval_choose=void 0;var vo=N(),B_=Ie(),JR=ce(),gq=G(),G_=hi(),yq=X();function KR(e){let t=gq.Eval(vo.cadr(e)),r=gq.Eval(vo.caddr(e));return ew(t,r)}bf.Eval_choose=KR;function ew(e,t){return tw(e,t)?yq.divide(yq.divide(G_.factorial(e),G_.factorial(t)),G_.factorial(JR.subtract(e,t))):vo.Constants.zero}function tw(e,t){return vo.isNumericAtom(e)&&B_.lessp(e,vo.Constants.zero)||vo.isNumericAtom(t)&&B_.lessp(t,vo.Constants.zero)?!1:!(vo.isNumericAtom(e)&&vo.isNumericAtom(t)&&B_.lessp(e,t))}});var j_=A(Na=>{"use strict";Object.defineProperty(Na,"__esModule",{value:!0});Na.expcos=Na.Eval_expcos=void 0;var F_=N(),qq=Ie(),rw=ce(),Eq=j(),nw=G(),tu=X();function ow(e){return xq(nw.Eval(F_.cadr(e)))}Na.Eval_expcos=ow;function xq(e){return rw.add(tu.multiply(qq.exponential(tu.multiply(F_.Constants.imaginaryunit,e)),Eq.rational(1,2)),tu.multiply(qq.exponential(tu.multiply(tu.negate(F_.Constants.imaginaryunit),e)),Eq.rational(1,2)))}Na.expcos=xq});var z_=A(Ia=>{"use strict";Object.defineProperty(Ia,"__esModule",{value:!0});Ia.expsin=Ia.Eval_expsin=void 0;var ru=N(),pq=Ie(),iw=ce(),hq=j(),sw=G(),zi=X();function aw(e){return Aq(sw.Eval(ru.cadr(e)))}Ia.Eval_expsin=aw;function Aq(e){return iw.subtract(zi.multiply(zi.divide(pq.exponential(zi.multiply(ru.Constants.imaginaryunit,e)),ru.Constants.imaginaryunit),hq.rational(1,2)),zi.multiply(zi.divide(pq.exponential(zi.multiply(zi.negate(ru.Constants.imaginaryunit),e)),ru.Constants.imaginaryunit),hq.rational(1,2)))}Ia.expsin=Aq});var Mq=A(gf=>{"use strict";Object.defineProperty(gf,"__esModule",{value:!0});gf.Eval_circexp=void 0;var bt=N(),Sa=U(),Yi=Ie(),Ra=ce(),Y_=j(),Oq=G(),lw=j_(),uw=z_(),bn=X(),cw=Et();function fw(e){let t=V_(Oq.Eval(bt.cadr(e)));return Oq.Eval(t)}gf.Eval_circexp=fw;function V_(e){if(bt.car(e)===Sa.symbol(bt.COS))return lw.expcos(bt.cadr(e));if(bt.car(e)===Sa.symbol(bt.SIN))return uw.expsin(bt.cadr(e));if(bt.car(e)===Sa.symbol(bt.TAN)){e=bt.cadr(e);let t=Yi.exponential(bn.multiply(bt.Constants.imaginaryunit,e)),r=Yi.exponential(bn.negate(bn.multiply(bt.Constants.imaginaryunit,e)));return bn.divide(bn.multiply(Ra.subtract(r,t),bt.Constants.imaginaryunit),Ra.add(t,r))}return bt.car(e)===Sa.symbol(bt.COSH)?(e=bt.cadr(e),bn.multiply(Ra.add(Yi.exponential(e),Yi.exponential(bn.negate(e))),Y_.rational(1,2))):bt.car(e)===Sa.symbol(bt.SINH)?(e=bt.cadr(e),bn.multiply(Ra.subtract(Yi.exponential(e),Yi.exponential(bn.negate(e))),Y_.rational(1,2))):bt.car(e)===Sa.symbol(bt.TANH)?(e=Yi.exponential(bn.multiply(bt.cadr(e),Y_.integer(2))),bn.divide(Ra.subtract(e,bt.Constants.one),Ra.add(e,bt.Constants.one))):bt.iscons(e)?e.map(V_):(e.k===bt.TENSOR&&(e=cw.copy_tensor(e),e.tensor.elem=e.tensor.elem.map(V_)),e)}});var Nq=A(yf=>{"use strict";Object.defineProperty(yf,"__esModule",{value:!0});yf.Eval_contract=void 0;var dw=St(),qo=N(),Tq=xe(),mw=U(),_w=ce(),X_=j(),Z_=G(),bw=Q();function gw(e){let t=Z_.Eval(qo.cadr(e)),r,n;return qo.cddr(e)===mw.symbol(qo.NIL)?(r=qo.Constants.one,n=X_.integer(2)):(r=Z_.Eval(qo.caddr(e)),n=Z_.Eval(qo.cadddr(e))),yw(t,r,n)}yf.Eval_contract=gw;function yw(e,t,r){let n=[],o=[];if(!qo.istensor(e))return bw.isZeroAtomOrTensor(e)||Tq.stop("contract: tensor expected, 1st arg is not a tensor"),qo.Constants.zero;let i=X_.nativeInt(t),s=X_.nativeInt(r),{ndim:u}=e.tensor;(i<1||i>u||s<1||s>u||i===s||e.tensor.dim[i-1]!==e.tensor.dim[s-1])&&Tq.stop("contract: index out of range"),i--,s--;let c=e.tensor.dim[i],d=1;for(let k=0;k<u;k++)k!==i&&k!==s&&(d*=e.tensor.dim[k]);t=dw.alloc_tensor(d),t.tensor.ndim=u-2;let _=0;for(let k=0;k<u;k++)k!==i&&k!==s&&(t.tensor.dim[_++]=e.tensor.dim[k]);let R=e.tensor.elem,T=t.tensor.elem;for(let k=0;k<u;k++)n[k]=0,o[k]=e.tensor.dim[k];for(let k=0;k<d;k++){let Z=qo.Constants.zero;for(let Y=0;Y<c;Y++){n[i]=Y,n[s]=Y;let Oe=0;for(let tt=0;tt<u;tt++)Oe=Oe*o[tt]+n[tt];Z=_w.add(Z,R[Oe])}T[k]=Z;for(let Y=u-1;Y>=0;Y--)if(!(Y===i||Y===s)){if(++n[Y]<o[Y])break;n[Y]=0}}return d===1?T[0]:t}});var Sq=A(vf=>{"use strict";Object.defineProperty(vf,"__esModule",{value:!0});vf.Eval_defint=void 0;var Eo=N(),vw=ce(),wa=G(),qw=Fl(),Iq=Vr();function Ew(e){let t=wa.Eval(Eo.cadr(e));for(e=Eo.cddr(e);Eo.iscons(e);){let r=wa.Eval(Eo.car(e));e=Eo.cdr(e);let n=wa.Eval(Eo.car(e));e=Eo.cdr(e);let o=wa.Eval(Eo.car(e));e=Eo.cdr(e),t=qw.integral(t,r);let i=wa.Eval(Iq.subst(t,r,o)),s=wa.Eval(Iq.subst(t,r,n));t=vw.subtract(i,s)}return t}vf.Eval_defint=Ew});var qf=A(La=>{"use strict";Object.defineProperty(La,"__esModule",{value:!0});La.degree=La.Eval_degree=void 0;var en=N(),xw=U(),H_=Ie(),Rq=G(),pw=Zr(),hw=Q();function Aw(e){let t=Rq.Eval(en.cadr(e));e=Rq.Eval(en.caddr(e));let r=e===xw.symbol(en.NIL)?pw.guess(t):e;return wq(t,r)}La.Eval_degree=Aw;function wq(e,t){return Lq(e,t,en.Constants.zero)}La.degree=wq;function Lq(e,t,r){return H_.equal(e,t)?hw.isZeroAtomOrTensor(r)&&(r=en.Constants.one):en.ispower(e)?H_.equal(en.cadr(e),t)&&en.isNumericAtom(en.caddr(e))&&H_.lessp(r,en.caddr(e))&&(r=en.caddr(e)):en.iscons(e)&&(r=e.tail().reduce((n,o)=>Lq(o,t,n),r)),r}});var $q=A(ri=>{"use strict";Object.defineProperty(ri,"__esModule",{value:!0});ri.Eval_eigenvec=ri.Eval_eigenval=ri.Eval_eigen=void 0;var Ur=N(),Ef=xe(),Vi=U(),Cq=j(),Pq=G(),Ow=wn(),kq=ee(),Mw=to(),Dq=Et(),ue=0,Xt=[],xo=[];function Tw(e){let{arg:t}=Q_(e);t||Ef.stop("eigen: argument is not a square matrix");let[r,n]=W_(Ur.EIGEN,t);return e=Vi.usr_symbol("D"),Vi.set_binding(e,r),e=Vi.usr_symbol("Q"),Vi.set_binding(e,n),Vi.symbol(Ur.NIL)}ri.Eval_eigen=Tw;function Nw(e){let{arg:t,invalid:r}=Q_(e);if(r)return kq.makeList(Vi.symbol(Ur.EIGENVAL),r);let[n,o]=W_(Ur.EIGENVAL,t);return n}ri.Eval_eigenval=Nw;function Iw(e){let{arg:t,invalid:r}=Q_(e);if(r)return kq.makeList(Vi.symbol(Ur.EIGENVEC),r);let[n,o]=W_(Ur.EIGENVEC,t);return o}ri.Eval_eigenvec=Iw;function Q_(e){if(e=Pq.Eval(Ow.yyfloat(Pq.Eval(Ur.cadr(e)))),!Ur.istensor(e))return{invalid:e};(e.tensor.ndim!==2||e.tensor.dim[0]!==e.tensor.dim[1])&&Ef.stop("eigen: argument is not a square matrix"),ue=e.tensor.dim[0],Sw(e)||Ef.stop("eigen: matrix is not numerical");for(let t=0;t<ue-1;t++)for(let r=t+1;r<ue;r++){let n=e.tensor.elem[ue*t+r],o=e.tensor.elem[ue*r+t];Math.abs(n.d-o.d)>1e-10&&Ef.stop("eigen: matrix is not symmetrical")}return{arg:e}}function Sw(e){for(let t=0;t<ue;t++)for(let r=0;r<ue;r++)if(!Ur.isdouble(e.tensor.elem[ue*t+r]))return!1;return!0}function W_(e,t){for(let i=0;i<ue*ue;i++)Xt[i]=0;for(let i=0;i<ue*ue;i++)xo[i]=0;for(let i=0;i<ue;i++){Xt[ue*i+i]=t.tensor.elem[ue*i+i].d;for(let s=i+1;s<ue;s++)Xt[ue*i+s]=t.tensor.elem[ue*i+s].d,Xt[ue*s+i]=t.tensor.elem[ue*i+s].d}for(let i=0;i<ue;i++){xo[ue*i+i]=1;for(let s=i+1;s<ue;s++)xo[ue*i+s]=0,xo[ue*s+i]=0}let r=0;for(r=0;r<100&&Rw()!==0;r++);r===100&&Mw.print_str(`
note: eigen did not converge
`);let n;if(e===Ur.EIGEN||e===Ur.EIGENVAL){n=Dq.copy_tensor(t);for(let i=0;i<ue;i++)for(let s=0;s<ue;s++)n.tensor.elem[ue*i+s]=Cq.double(Xt[ue*i+s])}let o;if(e===Ur.EIGEN||e===Ur.EIGENVEC){o=Dq.copy_tensor(t);for(let i=0;i<ue;i++)for(let s=0;s<ue;s++)o.tensor.elem[ue*i+s]=Cq.double(xo[ue*i+s])}return[n,o]}function Rw(){let e=0;for(let t=0;t<ue-1;t++)for(let r=t+1;r<ue;r++)Xt[ue*t+r]!==0&&(ww(t,r),e++);return e}function ww(e,t){let r=.5*(Xt[ue*e+e]-Xt[ue*t+t])/Xt[ue*e+t],n=1/(Math.abs(r)+Math.sqrt(r*r+1));r<0&&(n=-n);let o=1/Math.sqrt(n*n+1),i=n*o;for(let s=0;s<ue;s++){let u=Xt[ue*e+s],c=Xt[ue*t+s];Xt[ue*e+s]=o*u+i*c,Xt[ue*t+s]=o*c-i*u}for(let s=0;s<ue;s++){let u=Xt[ue*s+e],c=Xt[ue*s+t];Xt[ue*s+e]=o*u+i*c,Xt[ue*s+t]=o*c-i*u}for(let s=0;s<ue;s++){let u=xo[ue*e+s],c=xo[ue*t+s];xo[ue*e+s]=o*u+i*c,xo[ue*t+s]=o*c-i*u}Xt[ue*e+t]=0,Xt[ue*t+e]=0}});var J_=A(Ca=>{"use strict";Object.defineProperty(Ca,"__esModule",{value:!0});Ca.erfc=Ca.Eval_erfc=void 0;var xf=N(),Lw=U(),Cw=j(),Pw=G(),Dw=Q(),kw=ee();function $w(e){return Uw(Pw.Eval(xf.cadr(e)))}Ca.Eval_erfc=$w;function Uw(e){if(xf.isdouble(e)){let t=Uq(e.d);return Cw.double(t)}return Dw.isZeroAtomOrTensor(e)?xf.Constants.one:kw.makeList(Lw.symbol(xf.ERFC),e)}function Uq(e){if(e===0)return 1;let t=Math.abs(e),r=1/(1+.5*t),n=r*Math.exp(-t*t-1.26551223+r*(1.00002368+r*(.37409196+r*(.09678418+r*(-.18628806+r*(.27886807+r*(-1.13520398+r*(1.48851587+r*(-.82215223+r*.17087277)))))))));return e>=0?n:2-n}Ca.erfc=Uq});var zq=A(pf=>{"use strict";Object.defineProperty(pf,"__esModule",{value:!0});pf.Eval_erf=void 0;var nu=N(),Bq=U(),Bw=j(),Gw=J_(),Fw=G(),Gq=Q(),Fq=ee(),jq=X();function jw(e){return zw(Fw.Eval(nu.cadr(e)))}pf.Eval_erf=jw;function zw(e){return nu.isdouble(e)?Bw.double(1-Gw.erfc(e.d)):Gq.isZeroAtomOrTensor(e)?nu.Constants.zero:Gq.isnegativeterm(e)?jq.negate(Fq.makeList(Bq.symbol(nu.ERF),jq.negate(e))):Fq.makeList(Bq.symbol(nu.ERF),e)}});var Zq=A(hf=>{"use strict";Object.defineProperty(hf,"__esModule",{value:!0});hf.factors=void 0;var Vq=N();function Yw(e){let t=[];return Vq.isadd(e)?e.tail().forEach(r=>t.push(...Yq(r))):t.push(...Yq(e)),t}hf.factors=Yw;function Yq(e){return Vq.ismultiply(e)?e.tail():[e]}});var tE=A(Af=>{"use strict";Object.defineProperty(Af,"__esModule",{value:!0});Af.Eval_expand=void 0;var tb=St(),lt=N(),Jq=sr(),Vw=U(),Zw=Ie(),K_=ce(),Br=j(),Kq=qf(),Xw=Tn(),eb=G(),Hw=xs(),Xq=Zq(),eE=ll(),Qw=Zr(),Hq=Fo(),Ww=Il(),ou=Q(),Gr=X(),Jw=io(),ni=xt(),Kw=Fu(),eL=Et();function tL(e){let t=eb.Eval(lt.cadr(e)),r=eb.Eval(lt.caddr(e)),n=r===Vw.symbol(lt.NIL)?Qw.guess(t):r;return rb(t,n)}Af.Eval_expand=tL;function rb(e,t){if(lt.istensor(e))return rL(e,t);if(lt.isadd(e))return e.tail().reduce((u,c)=>K_.add(u,rb(c,t)),lt.Constants.zero);let r=Jw.numerator(e),n=Xw.denominator(e);if([n,r]=nL(n,r,t),(ou.isone(r)||ou.isone(n))&&(!ou.ispolyexpandedform(n,t)||ou.isone(n)))return e;let o=Kw.divpoly(r,n,t);if(r=K_.subtract(r,Gr.multiply(n,o)),ou.isZeroAtomOrTensor(r))return o;n=Hw.factorpoly(n,t);let i=oL(n,t);r=sL(r,i,t),n=aL(n,i,t);let s;if(lt.istensor(i)){let u=lt.doexpand(Ww.inv,i);s=Hq.inner(Hq.inner(u,r),n)}else{let u=lt.doexpand(Gr.divide,r,i);s=Gr.multiply(u,n)}return K_.add(s,o)}function rL(e,t){return e=eL.copy_tensor(e),e.tensor.elem=e.tensor.elem.map(r=>rb(r,t)),e}function nL(e,t,r){let n=[...Xq.factors(e),...Xq.factors(t)],o=0;for(let i=0;i<n.length;i++){let s=n[i];if(!lt.ispower(s)||lt.cadr(s)!==r)continue;let u=Br.nativeInt(lt.caddr(s));isNaN(u)||u<o&&(o=u)}return o===0?[e,t]:(e=Gr.multiply(e,ni.power(r,Br.integer(-o))),t=Gr.multiply(t,ni.power(r,Br.integer(-o))),[e,t])}function oL(e,t){let r=[];lt.ismultiply(e)?e.tail().forEach(i=>r.push(...Qq(e,i,t))):r.push(...Qq(e,e,t));let n=r.length;if(n===1)return r[0];let o=tb.alloc_tensor(n*n);o.tensor.ndim=2,o.tensor.dim[0]=n,o.tensor.dim[1]=n;for(let i=0;i<n;i++)for(let s=0;s<n;s++){let u=ni.power(t,Br.integer(i)),c=lt.doexpand(Gr.divide,r[s],u);o.tensor.elem[n*i+s]=eE.filter(c,t)}return o}function Qq(e,t,r){let n,o=0;if(!Jq.Find(t,r))return[];let i=lt.doexpand(iL,e,t);lt.ispower(t)?(o=Br.nativeInt(lt.caddr(t)),n=lt.cadr(t)):(o=1,n=t);let s=[],u=Br.nativeInt(Kq.degree(n,r));for(let c=0;c<o;c++)for(let d=0;d<u;d++){let _=ni.power(n,Br.integer(c)),R=lt.doexpand(Gr.multiply,i,_);_=ni.power(r,Br.integer(d));let T=lt.doexpand(Gr.multiply,R,_);s.push(T)}return s}function iL(e,t){let r=lt.Constants.one;if(lt.ismultiply(e)){let n=[];e.tail().forEach(o=>{Zw.equal(o,t)||n.push(eb.Eval(o))}),r=Gr.multiply_all(n)}return r}function sL(e,t,r){if(!lt.istensor(t))return e;let n=t.tensor.dim[0],o=tb.alloc_tensor(n);o.tensor.ndim=1,o.tensor.dim[0]=n;for(let i=0;i<n;i++){let s=ni.power(r,Br.integer(i)),u=lt.doexpand(Gr.divide,e,s);o.tensor.elem[i]=eE.filter(u,r)}return o}function aL(e,t,r){if(!lt.istensor(t))return Gr.reciprocate(e);let n=[];lt.ismultiply(e)?e.tail().forEach(s=>{n.push(...Wq(s,r))}):n=Wq(e,r);let o=n.length,i=tb.alloc_tensor(o);return i.tensor.ndim=1,i.tensor.dim[0]=o,i.tensor.elem=n,i}function Wq(e,t){let r=1;if(!Jq.Find(e,t))return[];lt.ispower(e)&&(r=Br.nativeInt(lt.caddr(e)),e=lt.cadr(e));let n=[],o=Br.nativeInt(Kq.degree(e,t));for(let i=r;i>0;i--)for(let s=0;s<o;s++)n.push(Gr.multiply(Gr.reciprocate(ni.power(e,Br.integer(i))),ni.power(t,Br.integer(s))));return n}});var nE=A(Of=>{"use strict";Object.defineProperty(Of,"__esModule",{value:!0});Of.Eval_floor=void 0;var Pa=N(),lL=U(),uL=ce(),cL=j(),fL=G(),rE=Q(),dL=ee(),mL=un();function _L(e){return bL(fL.Eval(Pa.cadr(e)))}Of.Eval_floor=_L;function bL(e){return gL(e)}function gL(e){if(!Pa.isNumericAtom(e))return dL.makeList(lL.symbol(Pa.FLOOR),e);if(Pa.isdouble(e))return cL.double(Math.floor(e.d));if(rE.isinteger(e))return e;let t=new Pa.Num(mL.mdiv(e.q.a,e.q.b));return rE.isnegativenumber(e)&&(t=uL.add(t,Pa.Constants.negOne)),t}});var oE=A(Tf=>{"use strict";Object.defineProperty(Tf,"__esModule",{value:!0});Tf.Eval_for=void 0;var Da=N(),yL=xe(),Mf=U(),vL=j(),nb=G();function qL(e){let t=Da.caddr(e);Da.issymbol(t)||yL.stop("for: 2nd arg should be the variable to loop over");let r=nb.evaluate_integer(Da.cadddr(e));if(isNaN(r))return e;let n=nb.evaluate_integer(Da.caddddr(e));if(isNaN(n))return e;let o=Mf.get_binding(t);for(let i=r;i<=n;i++)Mf.set_binding(t,vL.integer(i)),nb.Eval(Da.cadr(e));return Mf.set_binding(t,o),Mf.symbol(Da.NIL)}Tf.Eval_for=qL});var lE=A(If=>{"use strict";Object.defineProperty(If,"__esModule",{value:!0});If.Eval_gamma=void 0;var We=N(),sE=U(),EL=ce(),ob=j(),xL=G(),pL=Q(),aE=ee(),po=X(),iE=xt(),hL=Wn();function AL(e){return Nf(xL.Eval(We.cadr(e)))}If.Eval_gamma=AL;function Nf(e){return OL(e)}function OL(e){return We.isrational(e)&&We.MEQUAL(e.q.a,1)&&We.MEQUAL(e.q.b,2)?iE.power(We.Constants.Pi(),ob.rational(1,2)):We.isrational(e)&&We.MEQUAL(e.q.a,3)&&We.MEQUAL(e.q.b,2)?po.multiply(iE.power(We.Constants.Pi(),ob.rational(1,2)),ob.rational(1,2)):pL.isnegativeterm(e)?po.divide(po.multiply(We.Constants.Pi(),We.Constants.negOne),po.multiply(po.multiply(hL.sine(po.multiply(We.Constants.Pi(),e)),e),Nf(po.negate(e)))):We.isadd(e)?ML(e):aE.makeList(sE.symbol(We.GAMMA),e)}function ML(e){let t=We.cdr(e);return We.isrational(We.car(t))&&We.MEQUAL(We.car(t).q.a,1)&&We.MEQUAL(We.car(t).q.b,1)?po.multiply(We.cadr(t),Nf(We.cadr(t))):We.isrational(We.car(t))&&We.MEQUAL(We.car(t).q.a,-1)&&We.MEQUAL(We.car(t).q.b,1)?po.divide(Nf(We.cadr(t)),EL.add(We.cadr(t),We.Constants.negOne)):aE.makeList(sE.symbol(We.GAMMA),e)}});var uE=A(Sf=>{"use strict";Object.defineProperty(Sf,"__esModule",{value:!0});Sf.Eval_isprime=void 0;var ib=N(),TL=G(),NL=Q(),IL=jd();function SL(e){return RL(TL.Eval(ib.cadr(e)))}Sf.Eval_isprime=SL;function RL(e){return NL.isnonnegativeinteger(e)&&IL.mprime(e.q.a)?ib.Constants.one:ib.Constants.zero}});var fE=A(Pf=>{"use strict";Object.defineProperty(Pf,"__esModule",{value:!0});Pf.Eval_laguerre=void 0;var gn=N(),wf=U(),Rf=ce(),Lf=j(),Cf=G(),wL=ee(),sb=X(),LL=Vr();function CL(e){let t=Cf.Eval(gn.cadr(e)),r=Cf.Eval(gn.caddr(e)),n=Cf.Eval(gn.cadddr(e)),o=n===wf.symbol(gn.NIL)?gn.Constants.zero:n;return PL(t,r,o)}Pf.Eval_laguerre=CL;function PL(e,t,r){let n=Lf.nativeInt(t);return n<0||isNaN(n)?wL.makeList(wf.symbol(gn.LAGUERRE),e,t,r):gn.issymbol(e)?cE(n,e,r):Cf.Eval(LL.subst(cE(n,wf.symbol(gn.SECRETX),r),wf.symbol(gn.SECRETX),e))}function cE(e,t,r){let n=gn.Constants.zero,o=gn.Constants.one;for(let i=0;i<e;i++){let s=sb.divide(Rf.subtract(sb.multiply(Rf.add(Rf.subtract(Lf.integer(2*i+1),t),r),o),sb.multiply(Rf.add(Lf.integer(i),r),n)),Lf.integer(i+1));n=o,o=s}return o}});var mE=A(Df=>{"use strict";Object.defineProperty(Df,"__esModule",{value:!0});Df.Eval_leading=void 0;var ab=N(),DL=U(),kL=qf(),dE=G(),$L=ll(),UL=Zr(),BL=X(),GL=xt();function FL(e){let t=dE.Eval(ab.cadr(e));e=dE.Eval(ab.caddr(e));let r=e===DL.symbol(ab.NIL)?UL.guess(t):e;return jL(t,r)}Df.Eval_leading=FL;function jL(e,t){let r=kL.degree(e,t);return $L.filter(BL.divide(e,GL.power(t,r)),t)}});var gE=A($f=>{"use strict";Object.defineProperty($f,"__esModule",{value:!0});$f.Eval_legendre=void 0;var tr=N(),ka=U(),lb=Ie(),bE=ce(),Xi=j(),zL=Co(),YL=wi(),kf=G(),VL=ee(),Zi=X(),ZL=xt(),XL=Wn(),HL=Vr();function QL(e){let t=kf.Eval(tr.cadr(e)),r=kf.Eval(tr.caddr(e)),n=kf.Eval(tr.cadddr(e)),o=n===ka.symbol(tr.NIL)?tr.Constants.zero:n;return WL(t,r,o)}$f.Eval_legendre=QL;function WL(e,t,r){return JL(e,t,r)}function JL(e,t,r){let n=Xi.nativeInt(t),o=Xi.nativeInt(r);if(n<0||isNaN(n)||o<0||isNaN(o))return VL.makeList(ka.symbol(tr.LEGENDRE),e,t,r);let i;if(tr.issymbol(e))i=_E(n,o,e);else{let s=_E(n,o,ka.symbol(tr.SECRETX));i=kf.Eval(HL.subst(s,ka.symbol(tr.SECRETX),e))}return i=KL(i,o,e)||i,i}function _E(e,t,r){let n=tr.Constants.zero,o=tr.Constants.one;for(let i=0;i<e;i++){let s=Zi.divide(bE.subtract(Zi.multiply(Zi.multiply(Xi.integer(2*i+1),r),o),Zi.multiply(Xi.integer(i),n)),Xi.integer(i+1));n=o,o=s}for(let i=0;i<t;i++)o=YL.derivative(o,r);return o}function KL(e,t,r){if(t===0)return;let n=bE.subtract(tr.Constants.one,lb.square(r));tr.car(r)===ka.symbol(tr.COS)?n=lb.square(XL.sine(tr.cadr(r))):tr.car(r)===ka.symbol(tr.SIN)&&(n=lb.square(zL.cosine(tr.cadr(r))));let o=Zi.multiply(e,ZL.power(n,Zi.multiply(Xi.integer(t),Xi.rational(1,2))));return t%2&&(o=Zi.negate(o)),o}});var yE=A(Bf=>{"use strict";Object.defineProperty(Bf,"__esModule",{value:!0});Bf.Eval_lookup=void 0;var Uf=N(),eC=U();function tC(e){return e=Uf.cadr(e),!Uf.iscons(e)&&Uf.cadr(e).k===Uf.SYM&&(e=eC.get_binding(e)),e}Bf.Eval_lookup=tC});var qE=A(jf=>{"use strict";Object.defineProperty(jf,"__esModule",{value:!0});jf.Eval_mod=void 0;var oi=N(),Gf=xe(),rC=U(),Ff=j(),vE=G(),ub=Q(),nC=ee(),oC=un();function iC(e){let t=vE.Eval(oi.cadr(e)),r=vE.Eval(oi.caddr(e));return sC(t,r)}jf.Eval_mod=iC;function sC(e,t){if(ub.isZeroAtomOrTensor(t)&&Gf.stop("mod function: divide by zero"),!oi.isNumericAtom(e)||!oi.isNumericAtom(t))return nC.makeList(rC.symbol(oi.MOD),e,t);if(oi.isdouble(e)){let r=Ff.nativeInt(e);isNaN(r)&&Gf.stop("mod function: cannot convert float value to integer"),e=Ff.integer(r)}if(oi.isdouble(t)){let r=Ff.nativeInt(t);isNaN(r)&&Gf.stop("mod function: cannot convert float value to integer"),t=Ff.integer(r)}return(!ub.isinteger(e)||!ub.isinteger(t))&&Gf.stop("mod function: integer arguments expected"),new oi.Num(oC.mmod(e.q.a,t.q.a))}});var AE=A(Zf=>{"use strict";Object.defineProperty(Zf,"__esModule",{value:!0});Zf.Eval_nroots=void 0;var aC=St(),Hi=N(),su=xe(),lC=U(),uC=Ie(),cC=ce(),EE=j(),fC=yi(),zf=G(),xE=wn(),dC=Zr(),mC=ql(),_C=Q(),bC=X(),gC=Bs(),hE=101,Vf=1e-6,yC=1e-9;function iu(e){return Math.sqrt(e.r*e.r+e.i*e.i)}function Yf(){return 4*Math.random()-2}var yn=class{constructor(){this.r=0,this.i=0}},et=new yn,Bn=new yn,ht=new yn,yr=new yn,Rr=new yn,Fr=new yn,$a=new yn,Gn=new yn,Ve=[];for(let e=0;e<hE;e++)Ve[e]=new yn;function vC(e){let t=zf.Eval(Hi.caddr(e));e=zf.Eval(Hi.cadr(e)),t=t===lC.symbol(Hi.NIL)?dC.guess(e):t,_C.ispolyexpandedform(e,t)||su.stop("nroots: polynomial?");let r=fC.coeff(e,t),n=r.length;n>hE&&su.stop("nroots: degree?");for(let i=0;i<n;i++)e=zf.Eval(xE.yyfloat(gC.real(r[i]))),t=zf.Eval(xE.yyfloat(mC.imag(r[i]))),(!Hi.isdouble(e)||!Hi.isdouble(t))&&su.stop("nroots: coefficients?"),Ve[i].r=e.d,Ve[i].i=t.d;qC(n);let o=[];for(let i=n;i>1;i--)EC(i),Math.abs(et.r)<Vf&&(et.r=0),Math.abs(et.i)<Vf&&(et.i=0),o.push(cC.add(EE.double(et.r),bC.multiply(EE.double(et.i),Hi.Constants.imaginaryunit))),xC(i);if(n=o.length,n==1)return o[0];if(n>1)return o.sort(uC.cmp_expr),e=aC.alloc_tensor(n),e.tensor.ndim=1,e.tensor.dim[0]=n,e.tensor.elem=o,e}Zf.Eval_nroots=vC;function qC(e){yr.r=Ve[e-1].r,yr.i=Ve[e-1].i;let t=yr.r*yr.r+yr.i*yr.i;for(let r=0;r<e-1;r++)Ve[r].r=(Ve[r].r*yr.r+Ve[r].i*yr.i)/t,Ve[r].i=(Ve[r].i*yr.r-Ve[r].r*yr.i)/t;Ve[e-1].r=1,Ve[e-1].i=0}function EC(e){if(iu(Ve[0])<Vf){et.r=0,et.i=0;return}for(let t=0;t<100;t++){et.r=Yf(),et.i=Yf(),pE(e),Bn.r=et.r,Bn.i=et.i,Fr.r=Rr.r,Fr.i=Rr.i,et.r=Yf(),et.i=Yf();for(let r=0;r<1e3;r++){pE(e);let n=iu(Rr);if(Hi.DEBUG&&console.log(`nrabs: ${n}`),n<yC)return;iu(Rr)<iu(Fr)&&(ht.r=et.r,ht.i=et.i,et.r=Bn.r,et.i=Bn.i,Bn.r=ht.r,Bn.i=ht.i,ht.r=Rr.r,ht.i=Rr.i,Rr.r=Fr.r,Rr.i=Fr.i,Fr.r=ht.r,Fr.i=ht.i),$a.r=Bn.r-et.r,$a.i=Bn.i-et.i,Gn.r=Fr.r-Rr.r,Gn.i=Fr.i-Rr.i;let o=Gn.r*Gn.r+Gn.i*Gn.i;if(o===0)break;yr.r=($a.r*Gn.r+$a.i*Gn.i)/o,yr.i=($a.i*Gn.r-$a.r*Gn.i)/o,et.r=Bn.r-(yr.r*Fr.r-yr.i*Fr.i),et.i=Bn.i-(yr.r*Fr.i+yr.i*Fr.r)}}su.stop("nroots: convergence error")}function pE(e){ht.r=et.r,ht.i=et.i,Rr.r=Ve[0].r+Ve[1].r*ht.r-Ve[1].i*ht.i,Rr.i=Ve[0].i+Ve[1].r*ht.i+Ve[1].i*ht.r;for(let t=2;t<e;t++){let r=et.r*ht.r-et.i*ht.i;ht.i=et.r*ht.i+et.i*ht.r,ht.r=r,Rr.r+=Ve[t].r*ht.r-Ve[t].i*ht.i,Rr.i+=Ve[t].r*ht.i+Ve[t].i*ht.r}}function xC(e){for(let t=e-1;t>0;t--)Ve[t-1].r+=Ve[t].r*et.r-Ve[t].i*et.i,Ve[t-1].i+=Ve[t].i*et.r+Ve[t].r*et.i;iu(Ve[0])>Vf&&su.stop("nroots: residual error");for(let t=0;t<e-1;t++)Ve[t].r=Ve[t+1].r,Ve[t].i=Ve[t+1].i}});var NE=A(Xf=>{"use strict";Object.defineProperty(Xf,"__esModule",{value:!0});Xf.Eval_outer=void 0;var pC=St(),ii=N(),hC=xe(),OE=G(),TE=X(),ME=Et();function AC(e){e=ii.cdr(e);let t=OE.Eval(ii.car(e));return ii.iscons(e)?e.tail().reduce((n,o)=>OC(n,OE.Eval(o)),t):t}Xf.Eval_outer=AC;function OC(e,t){return ii.istensor(e)&&ii.istensor(t)?MC(e,t):ii.istensor(e)?ME.tensor_times_scalar(e,t):ii.istensor(t)?ME.scalar_times_tensor(e,t):TE.multiply(e,t)}function MC(e,t){let r=e.tensor.ndim+t.tensor.ndim;r>ii.MAXDIM&&hC.stop("outer: rank of result exceeds maximum");let n=e.tensor.nelem*t.tensor.nelem,o=pC.alloc_tensor(n);o.tensor.ndim=r,o.tensor.dim=[...e.tensor.dim,...t.tensor.dim];let i=0;for(let s=0;s<e.tensor.nelem;s++)for(let u=0;u<t.tensor.nelem;u++)o.tensor.elem[i++]=TE.multiply(e.tensor.elem[s],t.tensor.elem[u]);return o}});var fb=A(tn=>{"use strict";Object.defineProperty(tn,"__esModule",{value:!0});tn.Eval_patternsinfo=tn.Eval_clearpatterns=tn.do_clearPatterns=tn.Eval_pattern=tn.Eval_silentpattern=void 0;var Ge=N(),cb=xe(),Ua=U(),TC=Ie(),NC=ee(),IE=to();function IC(e){return SE(e),Ua.symbol(Ge.NIL)}tn.Eval_silentpattern=IC;function SE(e){let t;Ge.iscons(Ge.cdr(e))||cb.stop("pattern needs at least a template and a transformed version");let r=Ge.car(Ge.cdr(e)),n=Ge.car(Ge.cdr(Ge.cdr(e)));n===Ua.symbol(Ge.NIL)&&cb.stop("pattern needs at least a template and a transformed version"),Ge.iscons(Ge.cdr(Ge.cdr(e)))?t=Ge.car(Ge.cdr(Ge.cdr(Ge.cdr(e)))):t=Ua.symbol(Ge.NIL),TC.equal(r,n)&&cb.stop("recursive pattern");let o="template: "+IE.print_list(r);o+=" tests: "+IE.print_list(t),Ge.DEBUG&&console.log(`pattern stringkey: ${o}`);let i=Ge.defs.userSimplificationsInStringForm.indexOf(o);return i===-1?(Ge.defs.userSimplificationsInStringForm.push(o),Ge.defs.userSimplificationsInListForm.push(Ge.cdr(e))):(Ge.DEBUG&&console.log(`pattern already exists, replacing. ${Ge.cdr(e)}`),Ge.defs.userSimplificationsInStringForm[i]=o,Ge.defs.userSimplificationsInListForm[i]=Ge.cdr(e)),NC.makeList(Ua.symbol(Ge.PATTERN),Ge.cdr(e))}tn.Eval_pattern=SE;function RE(){Ge.defs.userSimplificationsInListForm=[],Ge.defs.userSimplificationsInStringForm=[]}tn.do_clearPatterns=RE;function SC(){return RE(),Ua.symbol(Ge.NIL)}tn.Eval_clearpatterns=SC;function RC(){let e=wC();return e!==""?new Ge.Str(e):Ua.symbol(Ge.NIL)}tn.Eval_patternsinfo=RC;function wC(){let e="";for(let t of Array.from(Ge.defs.userSimplificationsInListForm))e+=Ge.defs.userSimplificationsInListForm+`
`;return e}});var LE=A(Hf=>{"use strict";Object.defineProperty(Hf,"__esModule",{value:!0});Hf.Eval_prime=void 0;var db=N(),LC=xe(),wE=j(),CC=G();function PC(e){return DC(CC.Eval(db.cadr(e)))}Hf.Eval_prime=PC;function DC(e){let t=wE.nativeInt(e);return(t<1||t>db.MAXPRIMETAB)&&LC.stop("prime: Argument out of range."),t=db.primetab[t-1],wE.integer(t)}});var CE=A(Qf=>{"use strict";Object.defineProperty(Qf,"__esModule",{value:!0});Qf.Eval_product=void 0;var Qi=N(),kC=xe(),mb=U(),$C=j(),_b=G(),UC=X();function BC(e){let t=Qi.cadr(e),r=Qi.caddr(e);Qi.issymbol(r)||kC.stop("sum: 2nd arg?");let n=_b.evaluate_integer(Qi.cadddr(e));if(isNaN(n))return e;let o=_b.evaluate_integer(Qi.caddddr(e));if(isNaN(o))return e;let i=mb.get_binding(r),s=Qi.Constants.one;for(let u=n;u<=o;u++){mb.set_binding(r,$C.integer(u));let c=_b.Eval(t),d=UC.multiply(s,c);Qi.DEBUG&&(console.log(`product - factor 1: ${c}`),console.log(`product - factor 2: ${s}`),console.log(`product - result: ${d}`)),s=d}return mb.set_binding(r,i),s}Qf.Eval_product=BC});var DE=A(Jf=>{"use strict";Object.defineProperty(Jf,"__esModule",{value:!0});Jf.Eval_round=void 0;var Wf=N(),GC=U(),PE=j(),FC=G(),jC=wn(),zC=Q(),YC=ee();function VC(e){return ZC(FC.Eval(Wf.cadr(e)))}Jf.Eval_round=VC;function ZC(e){return Wf.isNumericAtom(e)?Wf.isdouble(e)?PE.double(Math.round(e.d)):zC.isinteger(e)?e:(e=jC.yyfloat(e),PE.integer(Math.round(e.d))):YC.makeList(GC.symbol(Wf.ROUND),e)}});var kE=A(Kf=>{"use strict";Object.defineProperty(Kf,"__esModule",{value:!0});Kf.Eval_shape=void 0;var XC=St(),bb=N(),HC=xe(),QC=j(),WC=G(),JC=Q();function KC(e){return e3(WC.Eval(bb.cadr(e)))}Kf.Eval_shape=KC;function e3(e){if(!bb.istensor(e))return JC.isZeroAtomOrTensor(e)||HC.stop("transpose: tensor expected, 1st arg is not a tensor"),bb.Constants.zero;let{ndim:t}=e.tensor,r=XC.alloc_tensor(t);r.tensor.ndim=1,r.tensor.dim[0]=t;for(let n=0;n<t;n++)r.tensor.elem[n]=QC.integer(e.tensor.dim[n]);return r}});var $E=A(ed=>{"use strict";Object.defineProperty(ed,"__esModule",{value:!0});ed.Eval_sum=void 0;var Ba=N(),t3=xe(),gb=U(),r3=ce(),n3=j(),yb=G();function o3(e){let t=Ba.cadr(e),r=Ba.caddr(e);Ba.issymbol(r)||t3.stop("sum: 2nd arg?");let n=yb.evaluate_integer(Ba.cadddr(e));if(isNaN(n))return e;let o=yb.evaluate_integer(Ba.caddddr(e));if(isNaN(o))return e;let i=gb.get_binding(r),s=Ba.Constants.zero;for(let u=n;u<=o;u++)gb.set_binding(r,n3.integer(u)),s=r3.add(s,yb.Eval(t));return gb.set_binding(r,i),s}ed.Eval_sum=o3});var GE=A(rd=>{"use strict";Object.defineProperty(rd,"__esModule",{value:!0});rd.Eval_tan=void 0;var vn=N(),vb=U(),jr=j(),i3=G(),s3=Q(),UE=ee(),Wi=X(),td=xt();function a3(e){return BE(i3.Eval(vn.cadr(e)))}rd.Eval_tan=a3;function BE(e){if(vn.car(e)===vb.symbol(vn.ARCTAN))return vn.cadr(e);if(vn.isdouble(e)){let r=Math.tan(e.d);return Math.abs(r)<1e-10&&(r=0),jr.double(r)}if(s3.isnegative(e))return Wi.negate(BE(Wi.negate(e)));let t=jr.nativeInt(Wi.divide(Wi.multiply(e,jr.integer(180)),vn.Constants.Pi()));if(t<0||isNaN(t))return UE.makeList(vb.symbol(vn.TAN),e);switch(t%360){case 0:case 180:return vn.Constants.zero;case 30:case 210:return Wi.multiply(jr.rational(1,3),td.power(jr.integer(3),jr.rational(1,2)));case 150:case 330:return Wi.multiply(jr.rational(-1,3),td.power(jr.integer(3),jr.rational(1,2)));case 45:case 225:return vn.Constants.one;case 135:case 315:return vn.Constants.negOne;case 60:case 240:return td.power(jr.integer(3),jr.rational(1,2));case 120:case 300:return Wi.negate(td.power(jr.integer(3),jr.rational(1,2)));default:return UE.makeList(vb.symbol(vn.TAN),e)}}});var jE=A(nd=>{"use strict";Object.defineProperty(nd,"__esModule",{value:!0});nd.Eval_tanh=void 0;var Ji=N(),FE=U(),l3=j(),u3=G(),c3=Q(),f3=ee();function d3(e){return m3(u3.Eval(Ji.cadr(e)))}nd.Eval_tanh=d3;function m3(e){if(Ji.car(e)===FE.symbol(Ji.ARCTANH))return Ji.cadr(e);if(Ji.isdouble(e)){let t=Math.tanh(e.d);return Math.abs(t)<1e-10&&(t=0),l3.double(t)}return c3.isZeroAtomOrTensor(e)?Ji.Constants.zero:f3.makeList(FE.symbol(Ji.TANH),e)}});var VE=A(id=>{"use strict";Object.defineProperty(id,"__esModule",{value:!0});id.Eval_taylor=void 0;var wr=N(),od=U(),zE=ce(),Eb=j(),_3=wi(),Ga=G(),b3=hi(),g3=Zr(),y3=Q(),v3=ee(),qb=X(),YE=Vr();function q3(e){e=wr.cdr(e);let t=Ga.Eval(wr.car(e));e=wr.cdr(e);let r=Ga.Eval(wr.car(e)),n=r===od.symbol(wr.NIL)?g3.guess(t):r;e=wr.cdr(e),r=Ga.Eval(wr.car(e));let o=r===od.symbol(wr.NIL)?Eb.integer(24):r;e=wr.cdr(e),r=Ga.Eval(wr.car(e));let i=r===od.symbol(wr.NIL)?wr.Constants.zero:r;return E3(t,n,o,i)}id.Eval_taylor=q3;function E3(e,t,r,n){let o=Eb.nativeInt(r);if(isNaN(o))return v3.makeList(od.symbol(wr.TAYLOR),e,t,r,n);let i=wr.Constants.one,s=Ga.Eval(YE.subst(e,t,n));for(let u=1;u<=o&&(e=_3.derivative(e,t),!y3.isZeroAtomOrTensor(e));u++){i=qb.multiply(i,zE.subtract(t,n));let c=Ga.Eval(YE.subst(e,t,n));s=zE.add(s,qb.divide(qb.multiply(c,i),b3.factorial(Eb.integer(u))))}return s}});var ZE=A(Bt=>{"use strict";Object.defineProperty(Bt,"__esModule",{value:!0});Bt.Eval_or=Bt.Eval_and=Bt.Eval_not=Bt.Eval_testlt=Bt.Eval_testle=Bt.Eval_testgt=Bt.Eval_testge=Bt.Eval_testeq=Bt.Eval_test=void 0;var ge=N(),x3=U(),xb=ce(),ho=G(),p3=wn(),Ki=Q(),sd=Xo();function h3(e){let t=e;for(e=ge.cdr(e);ge.iscons(e);){if(ge.cdr(e)===x3.symbol(ge.NIL))return ho.Eval(ge.car(e));let r=Ki.isZeroLikeOrNonZeroLikeOrUndetermined(ge.car(e));if(r==null)return t;if(r)return ho.Eval(ge.cadr(e));e=ge.cddr(e)}return ge.Constants.zero}Bt.Eval_test=h3;function A3(e){let t=e,r=xb.subtract(ho.Eval(ge.cadr(e)),ho.Eval(ge.caddr(e))),n=Ki.isZeroLikeOrNonZeroLikeOrUndetermined(r);if(n)return ge.Constants.zero;if(n!=null&&!n)return ge.Constants.one;let o=sd.simplify(ho.Eval(ge.cadr(e))),i=sd.simplify(ho.Eval(ge.caddr(e)));return r=xb.subtract(o,i),n=Ki.isZeroLikeOrNonZeroLikeOrUndetermined(r),n?ge.Constants.zero:n!=null&&!n?ge.Constants.one:t}Bt.Eval_testeq=A3;function O3(e){let t=e,r=ad(e);return r==null?t:r>=0?ge.Constants.one:ge.Constants.zero}Bt.Eval_testge=O3;function M3(e){let t=e,r=ad(e);return r==null?t:r>0?ge.Constants.one:ge.Constants.zero}Bt.Eval_testgt=M3;function T3(e){let t=e,r=ad(e);return r==null?t:r<=0?ge.Constants.one:ge.Constants.zero}Bt.Eval_testle=T3;function N3(e){let t=e,r=ad(e);return r==null?t:r<0?ge.Constants.one:ge.Constants.zero}Bt.Eval_testlt=N3;function I3(e){let t=e,r=Ki.isZeroLikeOrNonZeroLikeOrUndetermined(ge.cadr(e));return r==null?t:r?ge.Constants.zero:ge.Constants.one}Bt.Eval_not=I3;function S3(e){let t=e,r=ge.cdr(t),n=!1;for(;ge.iscons(r);){let o=Ki.isZeroLikeOrNonZeroLikeOrUndetermined(ge.car(r));if(o==null)n=!0,r=ge.cdr(r);else if(o)r=ge.cdr(r);else if(!o)return ge.Constants.zero}return n?t:ge.Constants.one}Bt.Eval_and=S3;function R3(e){let t=e,r=ge.cdr(t),n=!1;for(;ge.iscons(r);){let o=Ki.isZeroLikeOrNonZeroLikeOrUndetermined(ge.car(r));if(o==null)n=!0,r=ge.cdr(r);else{if(o)return ge.Constants.one;o||(r=ge.cdr(r))}}return n?t:ge.Constants.zero}Bt.Eval_or=R3;function ad(e){let t=0,r=sd.simplify(ho.Eval(ge.cadr(e))),n=sd.simplify(ho.Eval(ge.caddr(e)));if(e=xb.subtract(r,n),e.k!==ge.NUM&&e.k!==ge.DOUBLE&&(e=ho.Eval(p3.yyfloat(e))),Ki.isZeroAtomOrTensor(e))return 0;switch(e.k){case ge.NUM:ge.MSIGN(e.q.a)===-1?t=-1:t=1;break;case ge.DOUBLE:e.d<0?t=-1:t=1;break;default:t=null}return t}});var XE=A(ud=>{"use strict";Object.defineProperty(ud,"__esModule",{value:!0});ud.Eval_zero=void 0;var w3=St(),ld=N(),L3=G();function C3(e){let t=Array(ld.MAXDIM).fill(0),r=1,n=0;if(ld.iscons(e))for(let o of e.tail()){let i=L3.evaluate_integer(o);if(i<1||isNaN(i))return ld.Constants.zero;r*=i,t[n++]=i}if(n===0)return ld.Constants.zero;e=w3.alloc_tensor(r),e.tensor.ndim=n;for(let o=0;o<n;o++)e.tensor.dim[o]=t[o];return e}ud.Eval_zero=C3});var au=A(Fa=>{"use strict";Object.defineProperty(Fa,"__esModule",{value:!0});Fa.defn=Fa.init=void 0;var P3=sn(),D3=ce(),k3=Am(),$3=k_(),U3=rq(),B3=oq(),G3=sq(),F3=lq(),j3=cm(),z3=cq(),Y3=ms(),V3=Im(),Z3=Sm(),HE=j(),X3=mq(),H3=bq(),Q3=vq(),W3=Mq(),QE=Ab(),J3=Du(),K3=yi(),eP=hm(),tP=gl(),rP=vi(),nP=Nq(),oP=Co(),iP=Rm(),sP=Km(),aP=Pd(),lP=Sq(),uP=qf(),cP=Tn(),fP=wi(),dP=Pm(),pb=$q(),mP=zq(),_P=J_(),gt=G(),bP=tE(),gP=j_(),yP=z_(),vP=dl(),qP=ll(),EP=wn(),xP=nE(),pP=oE(),hP=lE(),AP=bi(),OP=ql(),WE=Fo(),MP=Fl(),TP=uE(),NP=fE(),IP=kd(),SP=mE(),RP=gE(),wP=ee(),LP=__(),CP=yE(),PP=qE(),DP=X(),kP=AE(),$P=io(),UP=NE(),cd=fb(),BP=ku(),GP=xt(),FP=LE(),si=to(),jP=CE(),zP=Fu(),YP=yl(),VP=Bs(),ZP=eo(),XP=Wm(),HP=DE(),QP=Vo(),WP=g_(),JP=kE(),KP=Xo(),eD=Wn(),tD=y_(),rD=$E(),nD=GE(),oD=jE(),iD=VE(),Ao=ZE(),sD=i_(),aD=XE(),g=N(),y=U(),hb=0;function lD(){hb=0,g.reset_after_error(),g.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated=[],!hb&&(hb=1,y.reset_symbols(),KE())}Fa.init=lD;var JE=['version="'+g.version+'"',"e=exp(1)","i=sqrt(-1)","autoexpand=1","assumeRealVariables=1","trange=[-pi,pi]","xrange=[-10,10]","yrange=[-10,10]","last=0","trace=0","forceFixedPrintout=1","maxFixedPrintoutDigits=6","printLeaveEAlone=1","printLeaveXAlone=0","cross(u,v)=[u[2]*v[3]-u[3]*v[2],u[3]*v[1]-u[1]*v[3],u[1]*v[2]-u[2]*v[1]]","curl(v)=[d(v[3],y)-d(v[2],z),d(v[1],z)-d(v[3],x),d(v[2],x)-d(v[1],y)]","div(v)=d(v[1],x)+d(v[2],y)+d(v[3],z)","ln(x)=log(x)"];function KE(){y.std_symbol(g.ABS,P3.Eval_abs),y.std_symbol(g.ADD,D3.Eval_add),y.std_symbol(g.ADJ,k3.Eval_adj),y.std_symbol(g.AND,Ao.Eval_and),y.std_symbol(g.APPROXRATIO,$3.Eval_approxratio),y.std_symbol(g.ARCCOS,U3.Eval_arccos),y.std_symbol(g.ARCCOSH,B3.Eval_arccosh),y.std_symbol(g.ARCSIN,G3.Eval_arcsin),y.std_symbol(g.ARCSINH,F3.Eval_arcsinh),y.std_symbol(g.ARCTAN,j3.Eval_arctan),y.std_symbol(g.ARCTANH,z3.Eval_arctanh),y.std_symbol(g.ARG,Y3.Eval_arg),y.std_symbol(g.ATOMIZE),y.std_symbol(g.BESSELJ,V3.Eval_besselj),y.std_symbol(g.BESSELY,Z3.Eval_bessely),y.std_symbol(g.BINDING,gt.Eval_binding),y.std_symbol(g.BINOMIAL,X3.Eval_binomial),y.std_symbol(g.CEILING,H3.Eval_ceiling),y.std_symbol(g.CHECK,gt.Eval_check),y.std_symbol(g.CHOOSE,Q3.Eval_choose),y.std_symbol(g.CIRCEXP,W3.Eval_circexp),y.std_symbol(g.CLEAR,QE.Eval_clear),y.std_symbol(g.CLEARALL,QE.Eval_clearall),y.std_symbol(g.CLEARPATTERNS,cd.Eval_clearpatterns),y.std_symbol(g.CLOCK,J3.Eval_clock),y.std_symbol(g.COEFF,K3.Eval_coeff),y.std_symbol(g.COFACTOR,eP.Eval_cofactor),y.std_symbol(g.CONDENSE,tP.Eval_condense),y.std_symbol(g.CONJ,rP.Eval_conj),y.std_symbol(g.CONTRACT,nP.Eval_contract),y.std_symbol(g.COS,oP.Eval_cos),y.std_symbol(g.COSH,iP.Eval_cosh),y.std_symbol(g.DECOMP,sP.Eval_decomp),y.std_symbol(g.DEFINT,lP.Eval_defint),y.std_symbol(g.DEGREE,uP.Eval_degree),y.std_symbol(g.DENOMINATOR,cP.Eval_denominator),y.std_symbol(g.DET,gt.Eval_det),y.std_symbol(g.DERIVATIVE,fP.Eval_derivative),y.std_symbol(g.DIM,gt.Eval_dim),y.std_symbol(g.DIRAC,dP.Eval_dirac),y.std_symbol(g.DIVISORS,gt.Eval_divisors),y.std_symbol(g.DO,gt.Eval_do),y.std_symbol(g.DOT,WE.Eval_inner),y.std_symbol(g.DRAW),y.std_symbol(g.DSOLVE),y.std_symbol(g.ERF,mP.Eval_erf),y.std_symbol(g.ERFC,_P.Eval_erfc),y.std_symbol(g.EIGEN,pb.Eval_eigen),y.std_symbol(g.EIGENVAL,pb.Eval_eigenval),y.std_symbol(g.EIGENVEC,pb.Eval_eigenvec),y.std_symbol(g.EVAL,gt.Eval_Eval),y.std_symbol(g.EXP,gt.Eval_exp),y.std_symbol(g.EXPAND,bP.Eval_expand),y.std_symbol(g.EXPCOS,gP.Eval_expcos),y.std_symbol(g.EXPSIN,yP.Eval_expsin),y.std_symbol(g.FACTOR,vP.Eval_factor),y.std_symbol(g.FACTORIAL,gt.Eval_factorial),y.std_symbol(g.FACTORPOLY,gt.Eval_factorpoly),y.std_symbol(g.FILTER,qP.Eval_filter),y.std_symbol(g.FLOATF,EP.Eval_float),y.std_symbol(g.FLOOR,xP.Eval_floor),y.std_symbol(g.FOR,pP.Eval_for),y.std_symbol(g.FUNCTION,aP.Eval_function_reference),y.std_symbol(g.GAMMA,hP.Eval_gamma),y.std_symbol(g.GCD,AP.Eval_gcd),y.std_symbol(g.HERMITE,gt.Eval_hermite),y.std_symbol(g.HILBERT,gt.Eval_hilbert),y.std_symbol(g.IMAG,OP.Eval_imag),y.std_symbol(g.INDEX,gt.Eval_index),y.std_symbol(g.INNER,WE.Eval_inner),y.std_symbol(g.INTEGRAL,MP.Eval_integral),y.std_symbol(g.INV,gt.Eval_inv),y.std_symbol(g.INVG,gt.Eval_invg),y.std_symbol(g.ISINTEGER,gt.Eval_isinteger),y.std_symbol(g.ISPRIME,TP.Eval_isprime),y.std_symbol(g.LAGUERRE,NP.Eval_laguerre),y.std_symbol(g.LCM,IP.Eval_lcm),y.std_symbol(g.LEADING,SP.Eval_leading),y.std_symbol(g.LEGENDRE,RP.Eval_legendre),y.std_symbol(g.LOG,LP.Eval_log),y.std_symbol(g.LOOKUP,CP.Eval_lookup),y.std_symbol(g.MOD,PP.Eval_mod),y.std_symbol(g.MULTIPLY,DP.Eval_multiply),y.std_symbol(g.NOT,Ao.Eval_not),y.std_symbol(g.NROOTS,kP.Eval_nroots),y.std_symbol(g.NUMBER,gt.Eval_number),y.std_symbol(g.NUMERATOR,$P.Eval_numerator),y.std_symbol(g.OPERATOR,gt.Eval_operator),y.std_symbol(g.OR,Ao.Eval_or),y.std_symbol(g.OUTER,UP.Eval_outer),y.std_symbol(g.PATTERN,cd.Eval_pattern),y.std_symbol(g.PATTERNSINFO,cd.Eval_patternsinfo),y.std_symbol(g.POLAR,BP.Eval_polar),y.std_symbol(g.POWER,GP.Eval_power),y.std_symbol(g.PRIME,FP.Eval_prime),y.std_symbol(g.PRINT,si.Eval_print),y.std_symbol(g.PRINT2DASCII,si.Eval_print2dascii),y.std_symbol(g.PRINTFULL,si.Eval_printcomputer),y.std_symbol(g.PRINTLATEX,si.Eval_printlatex),y.std_symbol(g.PRINTLIST,si.Eval_printlist),y.std_symbol(g.PRINTPLAIN,si.Eval_printhuman),y.std_symbol(g.PRINT_LEAVE_E_ALONE),y.std_symbol(g.PRINT_LEAVE_X_ALONE),y.std_symbol(g.PRODUCT,jP.Eval_product),y.std_symbol(g.QUOTE,gt.Eval_quote),y.std_symbol(g.QUOTIENT,zP.Eval_quotient),y.std_symbol(g.RANK,gt.Eval_rank),y.std_symbol(g.RATIONALIZE,YP.Eval_rationalize),y.std_symbol(g.REAL,VP.Eval_real),y.std_symbol(g.YYRECT,ZP.Eval_rect),y.std_symbol(g.ROOTS,XP.Eval_roots),y.std_symbol(g.ROUND,HP.Eval_round),y.std_symbol(g.SETQ,gt.Eval_setq),y.std_symbol(g.SGN,WP.Eval_sgn),y.std_symbol(g.SILENTPATTERN,cd.Eval_silentpattern),y.std_symbol(g.SIMPLIFY,KP.Eval_simplify),y.std_symbol(g.SIN,eD.Eval_sin),y.std_symbol(g.SINH,tD.Eval_sinh),y.std_symbol(g.SHAPE,JP.Eval_shape),y.std_symbol(g.SQRT,gt.Eval_sqrt),y.std_symbol(g.STOP,gt.Eval_stop),y.std_symbol(g.SUBST,gt.Eval_subst),y.std_symbol(g.SUM,rD.Eval_sum),y.std_symbol(g.SYMBOLSINFO,y.Eval_symbolsinfo),y.std_symbol(g.TAN,nD.Eval_tan),y.std_symbol(g.TANH,oD.Eval_tanh),y.std_symbol(g.TAYLOR,iD.Eval_taylor),y.std_symbol(g.TEST,Ao.Eval_test),y.std_symbol(g.TESTEQ,Ao.Eval_testeq),y.std_symbol(g.TESTGE,Ao.Eval_testge),y.std_symbol(g.TESTGT,Ao.Eval_testgt),y.std_symbol(g.TESTLE,Ao.Eval_testle),y.std_symbol(g.TESTLT,Ao.Eval_testlt),y.std_symbol(g.TRANSPOSE,sD.Eval_transpose),y.std_symbol(g.UNIT,gt.Eval_unit),y.std_symbol(g.ZERO,aD.Eval_zero),y.std_symbol(g.NIL),y.std_symbol(g.AUTOEXPAND),y.std_symbol(g.BAKE),y.std_symbol(g.ASSUME_REAL_VARIABLES),y.std_symbol(g.LAST),y.std_symbol(g.LAST_PRINT),y.std_symbol(g.LAST_2DASCII_PRINT),y.std_symbol(g.LAST_FULL_PRINT),y.std_symbol(g.LAST_LATEX_PRINT),y.std_symbol(g.LAST_LIST_PRINT),y.std_symbol(g.LAST_PLAIN_PRINT),y.std_symbol(g.TRACE),y.std_symbol(g.FORCE_FIXED_PRINTOUT),y.std_symbol(g.MAX_FIXED_PRINTOUT_DIGITS),y.std_symbol(g.YYE),y.std_symbol(g.DRAWX),y.std_symbol(g.METAA),y.std_symbol(g.METAB),y.std_symbol(g.METAX),y.std_symbol(g.SECRETX),y.std_symbol(g.VERSION),y.std_symbol(g.PI),y.std_symbol(g.SYMBOL_A),y.std_symbol(g.SYMBOL_B),y.std_symbol(g.SYMBOL_C),y.std_symbol(g.SYMBOL_D),y.std_symbol(g.SYMBOL_I),y.std_symbol(g.SYMBOL_J),y.std_symbol(g.SYMBOL_N),y.std_symbol(g.SYMBOL_R),y.std_symbol(g.SYMBOL_S),y.std_symbol(g.SYMBOL_T),y.std_symbol(g.SYMBOL_X),y.std_symbol(g.SYMBOL_Y),y.std_symbol(g.SYMBOL_Z),y.std_symbol(g.SYMBOL_IDENTITY_MATRIX),y.std_symbol(g.SYMBOL_A_UNDERSCORE),y.std_symbol(g.SYMBOL_B_UNDERSCORE),y.std_symbol(g.SYMBOL_X_UNDERSCORE),y.std_symbol(g.C1),y.std_symbol(g.C2),y.std_symbol(g.C3),y.std_symbol(g.C4),y.std_symbol(g.C5),y.std_symbol(g.C6),uD();let e=g.defs.codeGen;g.defs.codeGen=!1;for(let t=0;t<JE.length;t++){let r=JE[t],[,n]=QP.scan(r);g.DEBUG&&(console.log(`... evaling ${r}`),console.log("top of stack:"),console.log(si.print_list(n))),gt.Eval(n)}g.defs.codeGen=e}Fa.defn=KE;function uD(){let e=wP.makeList(y.symbol(g.POWER),HE.integer(-1),HE.rational(1,2));g.DEBUG&&console.log(si.print_list(e)),g.Constants.imaginaryunit=e}});var Ab=A(ai=>{"use strict";Object.defineProperty(ai,"__esModule",{value:!0});ai.Eval_clear=ai.do_clearall=ai.Eval_clearall=void 0;var Oo=N(),cD=au(),fD=uo(),dD=xe(),fd=U(),mD=fb();function _D(){return ex(),fd.symbol(Oo.NIL)}ai.Eval_clearall=_D;function ex(){return Oo.defs.test_flag||fD.clear_term(),mD.do_clearPatterns(),fd.clear_symbols(),cD.defn(),Oo.defs.codeGen=!1}ai.do_clearall=ex;function bD(e){let t;for(t=Oo.cdr(e);Oo.iscons(t);){let r=Oo.car(t);r.k!==Oo.SYM&&dD.stop("symbol error"),fd.clear_symbol(r),t=Oo.cdr(t)}return fd.symbol(Oo.NIL)}ai.Eval_clear=bD});var Rb=A(md=>{"use strict";Object.defineProperty(md,"__esModule",{value:!0});md.print2dascii=void 0;var v=N(),gD=uo(),qn=U(),uu=sn(),Ya=j(),rr=Q(),yD=to(),sx=1e4,Ob=class{constructor(){this.c=0,this.x=0,this.y=0}},yt=[];for(let e=0;e<sx;e++)yt[e]=new Ob;var ct=0,Fn=0,jn=0,tx=0;function Mb(e){let t="";return t+=e,t}function vD(e){return Mb(e)}function qD(e){ct=0,Fn=0,jn=0,ED(e);let[t,r,n]=Array.from(Va(0,ct));if(r>100){yD.printline(e);return}return LD()}md.print2dascii=qD;function ED(e){if(v.car(e)===qn.symbol(v.SETQ)){vr(v.cadr(e)),Sb(" = "),vr(v.caddr(e));return}v.istensor(e)?PD(e):vr(e)}function rx(e){if(Fn>0)return!1;if(rr.isfraction(e))return!0;if(!v.ismultiply(e))return!1;if(rr.isfraction(v.cadr(e)))return!0;for(;v.iscons(e);){if(es(v.car(e)))return!0;e=v.cdr(e)}return!1}function vr(e){if(tx++,v.isadd(e))for(e=v.cdr(e),ja(v.car(e))&&(_e("-"),rx(v.car(e))&&_e(" ")),za(v.car(e)),e=v.cdr(e);v.iscons(e);)ja(v.car(e))?(_e(" "),_e("-"),_e(" ")):(_e(" "),_e("+"),_e(" ")),za(v.car(e)),e=v.cdr(e);else ja(e)&&(_e("-"),rx(e)&&_e(" ")),za(e);tx--}function xD(e){if(v.isadd(e))for(e=v.cdr(e),za(v.car(e)),e=v.cdr(e);v.iscons(e);)ja(v.car(e))?(_e(" "),_e("-"),_e(" ")):(_e(" "),_e("+"),_e(" ")),za(v.car(e)),e=v.cdr(e);else za(e)}function ja(e){return!!(rr.isnegativenumber(e)||v.ismultiply(e)&&rr.isnegativenumber(v.cadr(e)))}function za(e){if(v.ismultiply(e)){let t=pD(e);t&&Fn===0?AD(e,t):hD(e,t)}else En(e)}function es(e){return v.ispower(e)&&v.cadr(e)!==qn.symbol(v.E)&&ja(v.caddr(e))}function pD(e){let t=0;for(e=v.cdr(e);v.iscons(e);){let r=v.car(e);es(r)&&t++,e=v.cdr(e)}return t}function hD(e,t){if(t===0)for(e=v.cdr(e),(rr.isplusone(v.car(e))||rr.isminusone(v.car(e)))&&(e=v.cdr(e)),En(v.car(e)),e=v.cdr(e);v.iscons(e);)_e(" "),En(v.car(e)),e=v.cdr(e);else OD(e),_e("/"),t>1||rr.isfraction(v.cadr(e))?(_e("("),nx(e),_e(")")):nx(e)}function AD(e,t){let r,n,o=0,i=0,s=0,u=0,c=0,d=v.Constants.one,_=v.Constants.one;for(v.isrational(v.cadr(e))&&(d=uu.absval(Ya.mp_numerator(v.cadr(e))),_=Ya.mp_denominator(v.cadr(e))),v.isdouble(v.cadr(e))&&(d=uu.absval(v.cadr(e))),u=rr.isplusone(d)?0:1,r=v.cdr(e),v.isNumericAtom(v.car(r))&&(r=v.cdr(r));v.iscons(r);)n=v.car(r),es(n)||u++,r=v.cdr(r);for(c=jn,i=ct,o=0,rr.isplusone(d)||(Mo(d,0),o++),r=v.cdr(e),v.isNumericAtom(v.car(r))&&(r=v.cdr(r));v.iscons(r);)n=v.car(r),es(n)||(o>0&&_e(" "),u===1?vr(n):En(n),o++),r=v.cdr(r);for(o===0&&_e("1"),s=ct,o=0,rr.isplusone(_)||(Mo(_,0),o++,t++),r=v.cdr(e),v.isrational(v.car(r))&&(r=v.cdr(r));v.iscons(r);)n=v.car(r),es(n)&&(o>0&&_e(" "),Nb(n,t),o++),r=v.cdr(r);Ib(c,i,s)}function OD(e){let t=v.Constants.one;e=v.cdr(e),v.isrational(v.car(e))?(t=uu.absval(Ya.mp_numerator(v.car(e))),e=v.cdr(e)):v.isdouble(v.car(e))&&(t=uu.absval(v.car(e)),e=v.cdr(e));let r=0;for(rr.isplusone(t)||(Mo(t,0),r++);v.iscons(e);)es(v.car(e))||(r>0&&_e(" "),En(v.car(e)),r++),e=v.cdr(e);r===0&&_e("1")}function nx(e){let t=0;if(e=v.cdr(e),rr.isfraction(v.car(e))){let r=Ya.mp_denominator(v.car(e));Mo(r,0),t++,e=v.cdr(e)}for(;v.iscons(e);)es(v.car(e))&&(t>0&&_e(" "),Nb(v.car(e),0),t++),e=v.cdr(e)}function En(e){if(v.istensor(e)){dd(e);return}if(v.isdouble(e)){Mo(e,0);return}if(v.isadd(e)||v.ismultiply(e)){li(e);return}if(v.ispower(e)){TD(e);return}if(v.iscons(e)){ND(e);return}if(v.isNumericAtom(e)){Fn===0?MD(e):Mo(e,0);return}if(v.issymbol(e)){ax(e);return}v.isstr(e)&&RD(e)}function MD(e){let t=uu.absval(Ya.mp_numerator(e)),r=Ya.mp_denominator(e);if(rr.isplusone(r)){Mo(t,0);return}let n=jn,o=ct;Mo(t,0);let i=ct;Mo(r,0),Ib(n,o,i)}function lu(e){return v.iscons(e)&&!v.isadd(e)&&!v.ismultiply(e)&&!v.ispower(e)||v.issymbol(e)?!0:rr.isfraction(e)||rr.isnegativenumber(e)?!1:!!v.isNumericAtom(e)}function TD(e){let t=0,r=0,n=0;if(v.cadr(e)===qn.symbol(v.E)){Sb("exp("),vr(v.caddr(e)),_e(")");return}if(Fn>0){rr.isminusone(v.caddr(e))?(_e("1"),_e("/"),lu(v.cadr(e))?En(v.cadr(e)):li(v.cadr(e))):(lu(v.cadr(e))?En(v.cadr(e)):li(v.cadr(e)),_e("^"),lu(v.caddr(e))?En(v.caddr(e)):li(v.caddr(e)));return}if(ja(v.caddr(e))){n=jn,t=ct,_e("1"),r=ct,Nb(e,1),Ib(n,t,r);return}t=ct,lu(v.cadr(e))?En(v.cadr(e)):li(v.cadr(e)),r=ct,Fn++,vr(v.caddr(e)),Fn--,lx(t,r)}function Nb(e,t){let r=0,n=0;if(rr.isminusone(v.caddr(e))){t===1?vr(v.cadr(e)):En(v.cadr(e));return}r=ct,lu(v.cadr(e))?En(v.cadr(e)):li(v.cadr(e)),n=ct,Fn++,xD(v.caddr(e)),Fn--,lx(r,n)}function ND(e){if(v.car(e)===qn.symbol(v.INDEX)&&v.issymbol(v.cadr(e))){ID(e);return}if(v.isfactorial(e)){SD(e);return}if(v.car(e)===qn.symbol(v.DERIVATIVE)?_e("d"):ax(v.car(e)),_e("("),e=v.cdr(e),v.iscons(e))for(vr(v.car(e)),e=v.cdr(e);v.iscons(e);)_e(","),vr(v.car(e)),e=v.cdr(e);_e(")")}function ID(e){if(e=v.cdr(e),v.caar(e)===qn.symbol(v.ADD)||v.caar(e)===qn.symbol(v.MULTIPLY)||v.caar(e)===qn.symbol(v.POWER)||v.caar(e)===qn.symbol(v.FACTORIAL)?li(v.car(e)):vr(v.car(e)),_e("["),e=v.cdr(e),v.iscons(e))for(vr(v.car(e)),e=v.cdr(e);v.iscons(e);)_e(","),vr(v.car(e)),e=v.cdr(e);_e("]")}function SD(e){e=v.cadr(e),rr.isfraction(e)||v.isadd(e)||v.ismultiply(e)||v.ispower(e)||v.isfactorial(e)?li(e):vr(e),_e("!")}function li(e){_e("("),vr(e),_e(")")}function ax(e){if(e===qn.symbol(v.E)){Sb("exp(1)");return}let t=qn.get_printname(e);for(let r=0;r<t.length;r++)_e(t[r])}function RD(e){let t=e.str;_e('"');for(let r=0;r<t.length;r++)_e(t[r]);_e('"')}function Ib(e,t,r){let n=0,o=0,[i,s,u]=Array.from(Va(t,r)),[c,d,_]=Array.from(Va(r,ct));d>s?n=(d-s)/2:n=0,n++,o=-(u+i-1)-1,cu(t,r,n,o),d>s?n=-s:n=-s+(s-d)/2,n++,o=-_+1,cu(r,ct,n,o);let T=0;d>s?T=d:T=s,T+=2,jn=e;for(let k=0;k<T;k++)_e("-")}function lx(e,t){let r=0,n=0,o=0,i=0,s=0,u=0,c=0;[n,o,i]=Array.from(Va(e,t)),[s,u,c]=Array.from(Va(t,ct)),r=-c-s+1,r+=i-1,cu(t,ct,0,r)}function cu(e,t,r,n){for(let o=e;o<t;o++)yt[o].x+=r,yt[o].y+=n}function Va(e,t){let r=yt[e].x,n=yt[e].x,o=yt[e].y,i=yt[e].y;for(let d=e+1;d<t;d++)yt[d].x<r&&(r=yt[d].x),yt[d].x>n&&(n=yt[d].x),yt[d].y<o&&(o=yt[d].y),yt[d].y>i&&(i=yt[d].y);let s=i-o+1,u=n-r+1;return[s,u,o]}function _e(e){if(ct!==sx)return yt[ct]==null&&v.breakpoint,yt[ct].c=e,yt[ct].x=jn,yt[ct].y=0,ct++,jn++}function Sb(e){for(let t=0;t<e.length;t++)_e(e[t])}function Mo(e,t){let r="";switch(e.k){case v.NUM:r=e.q.a.toString(),r[0]==="-"&&t===0&&(r=r.substring(1));for(let n=0;n<r.length;n++)_e(r[n]);if(r=e.q.b.toString(),r==="1")break;_e("/");for(let n=0;n<r.length;n++)_e(r[n]);break;case v.DOUBLE:r=gD.doubleToReasonableString(e.d),r[0]==="-"&&t===0&&(r=r.substring(1));for(let n=0;n<r.length;n++)_e(r[n]);break}}function wD(e,t){return e.y<t.y?-1:e.y>t.y?1:e.x<t.x?-1:e.x>t.x?1:0}function LD(){let e="",t=yt.slice(0,ct);t.sort(wD),yt=[].concat(t).concat(yt.slice(ct));let r=0,{y:n}=yt[0];for(let o=0;o<ct;o++){for(;yt[o].y>n;)e+=vD(`
`),r=0,n++;for(;yt[o].x>r;)e+=Mb(" "),r++;e+=Mb(yt[o].c),r++}return e}var CD=100,Tb=class{constructor(){this.x=0,this.y=0,this.h=0,this.w=0,this.index=0,this.count=0}},Nt=[];for(let e=0;e<1e4;e++)Nt[e]=new Tb;var ox=3,ix=1;function PD(e){let t=0,r=0,n=0;if(e.tensor.ndim>2){dd(e);return}let o=e.tensor.dim[0];e.tensor.ndim===2?t=e.tensor.dim[1]:t=1;let i=o*t;if(i>CD){dd(e);return}let s=jn;for(let T=0;T<i;T++)Nt[T].index=ct,Nt[T].x=jn,vr(e.tensor.elem[T]),Nt[T].count=ct-Nt[T].index,[Nt[T].h,Nt[T].w,Nt[T].y]=Array.from(Va(Nt[T].index,ct));let u=0,c=0;for(let T=0;T<i;T++)Nt[T].h>u&&(u=Nt[T].h),Nt[T].w>c&&(c=Nt[T].w);let d=o*u+(o-1)*ix,_=t*c+(t-1)*ox,R=-(d/2);for(let T=0;T<o;T++)for(let k=0;k<t;k++){let Z=T*t+k;r=s-Nt[Z].x,n=R-Nt[Z].y,cu(Nt[Z].index,Nt[Z].index+Nt[Z].count,r,n),r=0,k>0&&(r=k*(c+ox)),n=0,T>0&&(n=T*(u+ix)),r+=(c-Nt[Z].w)/2,n+=(u-Nt[Z].h)/2,cu(Nt[Z].index,Nt[Z].index+Nt[Z].count,r,n)}jn=s+_}function dd(e){ux(e,0,0)}function ux(e,t,r){_e("(");for(let n=0;n<e.tensor.dim[t];n++)t+1===e.tensor.ndim?(vr(e.tensor.elem[r]),r=r+1):r=ux(e,t+1,r),n+1<e.tensor.dim[t]&&_e(",");return _e(")"),r}});var xe=A(nr=>{"use strict";Object.defineProperty(nr,"__esModule",{value:!0});nr.computeResultsAndJavaScriptFromAlgebra=nr.computeDependenciesFromAlgebra=nr.check_esc_flag=nr.top_level_eval=nr.check_stack=nr.run=nr.findDependenciesInScript=nr.stop=void 0;var DD=r_(),fx=Ab(),kD=G(),fu=Q(),cx=to(),$D=Rb(),dx=Vo(),UD=Xo(),_d=Vr(),p=N(),bd=au(),vt=U();function du(e){p.defs.errorMessage+="Stop: ",p.defs.errorMessage+=e;let t=p.defs.errorMessage;throw p.defs.errorMessage="",new Error(t)}nr.stop=du;function Lb(e,t=!1){p.DEBUG&&console.log(`stringToBeParsed: ${e}`);let r=new Date().getTime(),n=!0;p.defs.codeGen=!0,p.defs.symbolsDependencies={},p.defs.symbolsHavingReassignments=[],p.defs.symbolsInExpressionsWithoutAssignments=[],p.defs.patternHasBeenFound=!1;let o=0,i="",s="",u=0,c={affectsVariables:[],affectedBy:[]},d=e;for(;;){try{p.defs.errorMessage="",Za(),p.DEBUG&&console.log("findDependenciesInScript: scanning"),[u]=dx.scan(e.substring(o)),p.DEBUG&&console.log("scanned"),Za()}catch(Y){p.PRINTOUTRESULT&&console.log(Y),p.defs.errorMessage=Y+"",p.reset_after_error();break}if(u===0)break;o+=u}let _="";p.DEBUG&&console.log("all local dependencies ----------------"),_+="All local dependencies: ";for(let Y in p.defs.symbolsDependencies){let Oe=p.defs.symbolsDependencies[Y];p.DEBUG&&console.log(`variable ${Y} depends on: `),c.affectsVariables.push(Y),_+=" variable "+Y+" depends on: ";for(let tt of Array.from(Oe))p.DEBUG&&console.log(`    ${tt}`),tt[0]!=="'"&&c.affectedBy.push(tt),_+=tt+", ";_+="; "}_+=". ",p.DEBUG&&console.log("Symbols with reassignments ----------------"),_+="Symbols with reassignments: ";for(let Y of Array.from(p.defs.symbolsHavingReassignments))c.affectedBy.indexOf(Y)===-1&&(c.affectedBy.push(Y),_+=Y+", ");_+=". ",p.DEBUG&&console.log("Symbols in expressions without assignments ----------------"),_+="Symbols in expressions without assignments: ";for(let Y of Array.from(p.defs.symbolsInExpressionsWithoutAssignments))c.affectedBy.indexOf(Y)===-1&&(c.affectedBy.push(Y),_+=Y+", ");_+=". ",c.affectedBy.push("PATTERN_DEPENDENCY"),p.defs.patternHasBeenFound&&(c.affectsVariables.push("PATTERN_DEPENDENCY"),_+=" - PATTERN_DEPENDENCY inserted - "),p.DEBUG&&console.log("All dependencies recursively ----------------"),_+="All dependencies recursively: ";let R=["",""],T="",k="";if(p.defs.errorMessage===""&&!t){try{i="",s="",R=_x(e,!0),i="",s=""}catch(Y){let Oe=Y;p.PRINTOUTRESULT&&console.log(Oe),p.defs.errorMessage=Oe.toString(),bd.init()}if(p.defs.errorMessage==="")for(let Y in p.defs.symbolsDependencies){p.defs.codeGen=!0,p.DEBUG&&console.log("  variable "+Y+" is: "+vt.get_binding(vt.usr_symbol(Y)).toString()),p.defs.codeGen=!1,p.DEBUG&&console.log(`  variable ${Y} depends on: `),_+=" variable "+Y+" depends on: ";var Z=[];let Oe=[],tt=[];mx(Y,Z,[],Oe,[],tt);for(let Me of Array.from(Oe))p.DEBUG&&console.log(`    --> cycle through ${Me}`);for(let Me of Array.from(Z))p.DEBUG&&console.log(`    ${Me}`),_+=Me+", ";_+="; ";for(let Me of Array.from(tt))_+=" "+Me+", ";p.DEBUG&&console.log(`  code generation:${Y} is: ${vt.get_binding(vt.usr_symbol(Y))}`);let Ze=vt.get_binding(vt.usr_symbol(Y)),ke=[],st=[];for(let Me of Array.from(Z))if(Me[0]==="'"){let at=Me.substring(1),ir=vt.usr_symbol(at),Gt=vt.usr_symbol("AVOID_BINDING_TO_EXTERNAL_SCOPE_VALUE"+at);ke.push(ir),st.push(Gt),Ze=_d.subst(Ze,ir,Gt),p.DEBUG&&console.log(`after substitution: ${Ze}`)}try{Ze=UD.simplifyForCodeGeneration(Ze)}catch(Me){p.PRINTOUTRESULT&&console.log(Me),p.defs.errorMessage=Me+"",bd.init()}for(let Me=0;Me<ke.length;Me++)Ze=_d.subst(Ze,st[Me],ke[Me]);if(vt.clearRenamedVariablesToAvoidBindingToExternalScope(),p.defs.errorMessage===""){let Me=Ze,at=[];vt.collectUserSymbols(Me,at),i="",s="",p.defs.codeGen=!0;let ir=Me.toString();p.defs.codeGen=!1;let Gt=p.defs.printMode;p.defs.printMode=p.PRINTMODE_LATEX;let qr=Me.toString();if(p.defs.printMode=Gt,Oe.indexOf(Y)!==-1)T+="// "+Y+" is part of a cyclic dependency, no code generated.",k+="#"+Y+" is part of a cyclic dependency, no code generated.";else if(at=at.filter(It=>p.predefinedSymbolsInGlobalScope_doNotTrackInDependencies.indexOf(It+"")===-1),at=at.filter(It=>Z.indexOf(It+"")!==-1||Z.indexOf("'"+It)!==-1),at.length!==0){let It="(";for(let fi of Array.from(at))fi.printname!==Y&&(It+=fi.printname+", ");It=It.replace(/, $/gm,""),It+=")",T+=Y+" = function "+It+" { return ( "+ir+" ); }",k+=Y+It+" = "+qr}else T+=Y+" = "+ir+";",k+=Y+" = "+qr;T+=`
`,k+=`
`,p.DEBUG&&console.log(`    ${T}`)}}}return T=T.replace(/\n$/gm,""),k=k.replace(/\n$/gm,""),p.defs.symbolsDependencies={},p.defs.symbolsHavingReassignments=[],p.defs.patternHasBeenFound=!1,p.defs.symbolsInExpressionsWithoutAssignments=[],p.DEBUG&&console.log(`testable string: ${_}`),gd&&console.log(`findDependenciesInScript time for: ${d} : ${new Date().getTime()-r}ms`),[_,R[0],T,k,R[1],p.defs.errorMessage,c]}nr.findDependenciesInScript=Lb;function mx(e,t,r,n,o,i){if(r.push(e),p.defs.symbolsDependencies[o[o.length-1]]!=null&&p.defs.symbolsDependencies[o[o.length-1]].indexOf("'"+e)!==-1){p.DEBUG&&console.log("can't keep following the chain of "+e+" because it's actually a variable bound to a parameter"),t.indexOf("'"+e)===-1&&t.indexOf(e)===-1&&t.push(e);return}if(o.push(e),p.defs.symbolsDependencies[e]==null)t.indexOf(e)===-1&&t.push(e);else for(let s of Array.from(p.defs.symbolsDependencies[e]))if(o.indexOf(s)!==-1){p.DEBUG&&console.log("  found cycle:");let u="";for(let c of Array.from(o))n.indexOf(c)===-1&&n.push(c),p.DEBUG&&console.log(c+" --> "),u+=c+" --> ";p.DEBUG&&console.log(` ... then ${s} again`),u+=" ... then "+s+" again",i.push(u),n.indexOf(s)===-1&&n.push(s)}else mx(s,t,r,n,o,i),o.pop()}var BD="\\rlap{\\large\\color{red}\\bigtriangleup}{\\ \\ \\tiny\\color{red}!}";function wb(e){return e=e.replace(/\n/g,""),e=e.replace(/_/g,"} \\_ \\text{"),e=e.replace(new RegExp(String.fromCharCode(p.transpose_unicode),"g"),"}{}^{T}\\text{"),e=e.replace(new RegExp(String.fromCharCode(p.dotprod_unicode),"g"),"}\\cdot \\text{"),e=e.replace("Stop:","}  \\quad \\text{Stop:"),e=e.replace("->","}  \\rightarrow \\text{"),e=e.replace("?","}\\enspace "+BD+" \\enspace  \\text{"),e="$$\\text{"+e.replace(/\n/g,"")+"}$$",e}function Cb(e){return e=e.replace(new RegExp(String.fromCharCode(8901),"g"),String.fromCharCode(p.dotprod_unicode)),e=e.replace(new RegExp(String.fromCharCode(8226),"g"),String.fromCharCode(p.dotprod_unicode)),e=e.replace(new RegExp(String.fromCharCode(12539),"g"),String.fromCharCode(p.dotprod_unicode)),e=e.replace(new RegExp(String.fromCharCode(55296),"g"),String.fromCharCode(p.dotprod_unicode)),e=e.replace(new RegExp(String.fromCharCode(65381),"g"),String.fromCharCode(p.dotprod_unicode)),e}var gd=!1;function _x(e,t=!1){let r,n,o,i=new Date().getTime();e=Cb(e),p.defs.inited||(p.defs.inited=!0,bd.init());let s=0,u=0,c="",d="",_,R;for(;;){try{p.defs.errorMessage="",Za(),[s,r]=dx.scan(e.substring(u)),Za()}catch(k){p.PRINTOUTRESULT&&console.log(k),c+=k.message,t&&(d+=wb(k.message)),p.reset_after_error();break}if(s===0)break;u+=s;let T=!1;try{p.defs.stringsEmittedByUserPrintouts="",n=bx(r),Za(),p.isstr(n)&&(p.DEBUG&&console.log(n.str),p.DEBUG&&console.log(`
`)),n===vt.symbol(p.NIL)?(R=p.defs.stringsEmittedByUserPrintouts,t&&(_="$$"+p.defs.stringsEmittedByUserPrintouts+"$$")):(R=cx.print_expr(n),R+=`
`,t&&(_="$$"+cx.collectLatexStringFromReturnValue(n)+"$$",p.DEBUG&&console.log(`collectedLatexResult: ${_}`))),c+=R,t&&(d+=_),p.PRINTOUTRESULT&&(p.DEBUG&&console.log("printline"),p.DEBUG&&console.log(R)),p.PRINTOUTRESULT&&(p.DEBUG&&console.log("display:"),$D.print2dascii(n)),t&&(d+=`
`)}catch(k){T=!0,R=k.message,t&&(_=wb(k.message)),p.PRINTOUTRESULT&&console.log(R),c+=R,R!==""&&(c+=`
`),t&&(d+=_,d+=`
`),bd.init()}}if(c[c.length-1]===`
`&&(c=c.substring(0,c.length-1)),t&&d[d.length-1]===`
`&&(d=d.substring(0,d.length-1)),t?(p.DEBUG&&console.log(`allReturnedLatexStrings: ${d}`),o=[c,d]):o=c,gd){let T="run time on: "+e+" : "+(new Date().getTime()-i)+"ms";console.log(T)}return c="",d="",o}nr.run=_x;function Za(){p.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated.length!==0&&(p.breakpoint,du("symbols evaluation still ongoing?")),p.defs.evaluatingAsFloats&&(p.breakpoint,du("numeric evaluation still ongoing?")),p.defs.evaluatingPolar&&(p.breakpoint,du("evaluation of polar still ongoing?"))}nr.check_stack=Za;function bx(e){p.DEBUG&&console.log("#### top level eval"),p.defs.trigmode=0;let t=vt.symbol(p.AUTOEXPAND);p.defs.expanding=!fu.isZeroAtomOrTensor(vt.get_binding(t));let r=e,n=kD.Eval(e);return n===vt.symbol(p.NIL)||(vt.set_binding(vt.symbol(p.LAST),n),fu.isZeroAtomOrTensor(vt.get_binding(vt.symbol(p.BAKE)))||(n=DD.bake(n)),(r===vt.symbol(p.SYMBOL_I)||r===vt.symbol(p.SYMBOL_J))&&fu.isimaginaryunit(n))?n:fu.isimaginaryunit(vt.get_binding(vt.symbol(p.SYMBOL_J)))?_d.subst(n,p.Constants.imaginaryunit,vt.symbol(p.SYMBOL_J)):fu.isimaginaryunit(vt.get_binding(vt.symbol(p.SYMBOL_I)))?_d.subst(n,p.Constants.imaginaryunit,vt.symbol(p.SYMBOL_I)):n}nr.top_level_eval=bx;function GD(){p.defs.esc_flag&&du("esc key")}nr.check_esc_flag=GD;function FD(e){let t,r;p.DEBUG&&console.log("computeDependenciesFromAlgebra!!!");let n=e,o=!0;if(p.defs.called_from_Algebra_block=!0,e=Cb(e),!o){p.defs.userSimplificationsInListForm=[];let i="";for(let s of Array.from(p.defs.userSimplificationsInListForm))i+="silentpattern("+p.car(s)+","+p.car(p.cdr(s))+","+p.car(p.cdr(p.cdr(s)))+`)
`;fx.do_clearall(),e=i+e,p.DEBUG&&console.log("codeFromAlgebraBlock including patterns: "+e)}if(p.DEBUG){console.log("computeDependenciesFromAlgebra: patterns in the list --------------- ");for(let i of Array.from(p.defs.userSimplificationsInListForm))console.log(p.car(i)+","+p.cdr(i)+")");console.log("...end of list --------------- ")}return p.defs.called_from_Algebra_block=!1,Lb(e,!0)[6]}nr.computeDependenciesFromAlgebra=FD;function jD(e){let t,r,n,o,i,s,u,c,d,_=e,R=!0;p.defs.called_from_Algebra_block=!0;let T=new Date().getTime();gd&&console.log(" --------- computeResultsAndJavaScriptFromAlgebra input: "+e+" at: "+new Date),e=Cb(e);let k=e;if(p.DEBUG){console.log("computeResultsAndJavaScriptFromAlgebra: patterns in the list --------------- ");for(i of Array.from(p.defs.userSimplificationsInListForm))console.log(p.car(i)+","+p.cdr(i)+")");console.log("...end of list --------------- ")}if(!R){p.defs.userSimplificationsInListForm=[];let Z="";for(i of Array.from(p.defs.userSimplificationsInListForm))Z+="silentpattern("+p.car(i)+","+p.car(p.cdr(i))+","+p.car(p.cdr(p.cdr(i)))+`)
`;fx.do_clearall(),e=Z+e,p.DEBUG&&console.log("codeFromAlgebraBlock including patterns: "+e)}return[d,c,n,u,s,p.defs.errorMessage,o]=Lb(e),p.defs.called_from_Algebra_block=!1,(u!==""||p.defs.errorMessage!=="")&&(c+=`
`+u,p.defs.errorMessage!==""&&(c+=`
`+p.defs.errorMessage),c=c.replace(/\n/g,`

`),s+=`
$$`+u+"$$",p.defs.errorMessage!==""&&(s+=wb(p.defs.errorMessage)),s=s.replace(/\n/g,`

`)),s=s.replace(/\n*/,""),s=s.replace(/\$\$\$\$\n*/g,""),n=n.replace(/Math\./g,""),n=n.replace(/\n/g,`

`),gd&&console.log("computeResultsAndJavaScriptFromAlgebra time (total time from notebook and back) for: "+k+" : "+(new Date().getTime()-T)+"ms"),{code:n,result:s,latexResult:s,dependencyInfo:o}}nr.computeResultsAndJavaScriptFromAlgebra=jD});var Et=A(qt=>{"use strict";Object.defineProperty(qt,"__esModule",{value:!0});qt.copy_tensor=qt.power_tensor=qt.compare_tensors=qt.d_tensor_scalar=qt.d_scalar_tensor=qt.d_tensor_tensor=qt.is_square_matrix=qt.check_tensor_dimensions=qt.scalar_times_tensor=qt.tensor_times_scalar=qt.tensor_plus_tensor=qt.Eval_tensor=void 0;var Yn=St(),mr=N(),Pb=xe(),mu=U(),gx=Ie(),zD=ce(),YD=j(),kb=wi(),VD=G(),ZD=Fo(),XD=Il(),HD=Q(),Db=ee(),yx=X();function QD(e){zn(e);let{nelem:t,ndim:r}=e.tensor,n=Yn.alloc_tensor(t);return n.tensor.ndim=r,n.tensor.dim=Array.from(e.tensor.dim),zn(n),n.tensor.elem=e.tensor.elem.map(VD.Eval),zn(e),zn(n),ak(n)}qt.Eval_tensor=QD;function WD(e,t){if(e.tensor.ndim!==t.tensor.ndim||e.tensor.dim.some((c,d)=>c!==t.tensor.dim[d]))return mu.symbol(mr.NIL);let{nelem:r,ndim:n}=e.tensor,o=Yn.alloc_tensor(r);o.tensor.ndim=n,o.tensor.dim=Array.from(e.tensor.dim);let i=e.tensor.elem,s=t.tensor.elem,u=o.tensor.elem;for(let c=0;c<r;c++)u[c]=zD.add(i[c],s[c]);return o}qt.tensor_plus_tensor=WD;function JD(e,t){let{ndim:r,nelem:n}=e.tensor,o=Yn.alloc_tensor(n);return o.tensor.ndim=r,o.tensor.dim=Array.from(e.tensor.dim),o.tensor.elem=e.tensor.elem.map(i=>yx.multiply(i,t)),o}qt.tensor_times_scalar=JD;function KD(e,t){let{ndim:r,nelem:n}=t.tensor,o=Yn.alloc_tensor(n);return o.tensor.ndim=r,o.tensor.dim=Array.from(t.tensor.dim),o.tensor.elem=t.tensor.elem.map(i=>yx.multiply(e,i)),o}qt.scalar_times_tensor=KD;function zn(e){if(e.tensor.nelem!==e.tensor.elem.length)return console.log("something wrong in tensor dimensions"),mr.breakpoint}qt.check_tensor_dimensions=zn;function ek(e){return mr.istensor(e)&&e.tensor.ndim===2&&e.tensor.dim[0]===e.tensor.dim[1]}qt.is_square_matrix=ek;function tk(e,t){let{ndim:r,nelem:n}=e.tensor;if(r+1>=mr.MAXDIM)return Db.makeList(mu.symbol(mr.DERIVATIVE),e,t);let o=Yn.alloc_tensor(n*t.tensor.nelem);o.tensor.ndim=r+1,o.tensor.dim=[...e.tensor.dim,t.tensor.dim[0]];let i=e.tensor.elem,s=t.tensor.elem,u=o.tensor.elem;for(let c=0;c<n;c++)for(let d=0;d<t.tensor.nelem;d++)u[c*t.tensor.nelem+d]=kb.derivative(i[c],s[d]);return o}qt.d_tensor_tensor=tk;function rk(e,t){let r=Yn.alloc_tensor(t.tensor.nelem);return r.tensor.ndim=1,r.tensor.dim[0]=t.tensor.dim[0],r.tensor.elem=t.tensor.elem.map(n=>kb.derivative(e,n)),r}qt.d_scalar_tensor=rk;function nk(e,t){let r=Yn.alloc_tensor(e.tensor.nelem);return r.tensor.ndim=e.tensor.ndim,r.tensor.dim=[...e.tensor.dim],r.tensor.elem=e.tensor.elem.map(n=>kb.derivative(n,t)),r}qt.d_tensor_scalar=nk;function ok(e,t){if(e.tensor.ndim<t.tensor.ndim)return-1;if(e.tensor.ndim>t.tensor.ndim)return 1;for(let r=0;r<e.tensor.ndim;r++){if(e.tensor.dim[r]<t.tensor.dim[r])return-1;if(e.tensor.dim[r]>t.tensor.dim[r])return 1}for(let r=0;r<e.tensor.nelem;r++)if(!gx.equal(e.tensor.elem[r],t.tensor.elem[r]))return gx.lessp(e.tensor.elem[r],t.tensor.elem[r])?-1:1;return 0}qt.compare_tensors=ok;function ik(e,t){let r=e.tensor.ndim-1;if(e.tensor.dim[0]!==e.tensor.dim[r])return Db.makeList(mu.symbol(mr.POWER),e,t);let n=YD.nativeInt(t);if(isNaN(n))return Db.makeList(mu.symbol(mr.POWER),e,t);if(n===0){e.tensor.ndim!==2&&Pb.stop("power(tensor,0) with tensor rank not equal to 2"),n=e.tensor.dim[0],e=Yn.alloc_tensor(n*n),e.tensor.ndim=2,e.tensor.dim[0]=n,e.tensor.dim[1]=n;for(let s=0;s<n;s++)e.tensor.elem[n*s+s]=mr.Constants.one;return zn(e),e}let o=e;n<0&&(n=-n,o=XD.inv(o));let i=o;for(let s=1;s<n&&(i=ZD.inner(i,o),!HD.isZeroAtomOrTensor(i));s++);return i}qt.power_tensor=ik;function sk(e){let t=Yn.alloc_tensor(e.tensor.nelem);return t.tensor.ndim=e.tensor.ndim,t.tensor.dim=[...e.tensor.dim],t.tensor.elem=[...e.tensor.elem],zn(e),zn(t),t}qt.copy_tensor=sk;function ak(e){if(!mr.istensor(e))return e;let t=e.tensor.elem[0];if(e.tensor.elem.some(i=>!lk(t,i))&&Pb.stop("Cannot promote tensor due to inconsistent tensor components."),!mr.istensor(t))return e;let r=e.tensor.ndim+t.tensor.ndim;r>mr.MAXDIM&&Pb.stop("tensor rank > "+mr.MAXDIM);let n=e.tensor.nelem*t.tensor.nelem,o=Yn.alloc_tensor(n);return o.tensor.ndim=r,o.tensor.dim=[...e.tensor.dim,...t.tensor.dim],o.tensor.elem=[].concat(...e.tensor.elem.map(i=>i.tensor.elem)),zn(t),zn(o),o}function lk(e,t){if(!mr.istensor(e)&&!mr.istensor(t))return!0;if(!mr.istensor(e)||!mr.istensor(t)||e.tensor.ndim!==t.tensor.ndim)return!1;for(let r=0;r<e.tensor.ndim;r++)if(e.tensor.dim[r]!==t.tensor.dim[r])return!1;return!0}});var St=A(yd=>{"use strict";Object.defineProperty(yd,"__esModule",{value:!0});yd.alloc_tensor=void 0;var uk=Et(),vx=N();function ck(e){let t=new vx.Tensor;for(let r=0;r<e;r++)t.tensor.elem[r]=vx.Constants.zero;return uk.check_tensor_dimensions(t),t}yd.alloc_tensor=ck});var Ie=A(Lt=>{"use strict";Object.defineProperty(Lt,"__esModule",{value:!0});Lt.sort=Lt.square=Lt.exponential=Lt.yyexpand=Lt.length=Lt.cmp_expr=Lt.sign=Lt.lessp=Lt.equal=Lt.zero_matrix=void 0;var fk=St(),ut=N(),qx=uo(),_u=U(),Ex=j(),dk=G(),xx=xt(),mk=Et();function _k(e,t){let r=fk.alloc_tensor(e*t);return r.ndim=2,r.dim[0]=e,r.dim[1]=t,r}Lt.zero_matrix=_k;function bk(e,t){return bu(e,t)===0}Lt.equal=bk;function gk(e,t){return bu(e,t)<0}Lt.lessp=gk;function vd(e){return e<0?-1:e>0?1:0}Lt.sign=vd;function bu(e,t){let r=0;if(e===t)return 0;if(e===_u.symbol(ut.NIL))return-1;if(t===_u.symbol(ut.NIL))return 1;if(ut.isNumericAtom(e)&&ut.isNumericAtom(t))return vd(Ex.compare_numbers(e,t));if(ut.isNumericAtom(e))return-1;if(ut.isNumericAtom(t))return 1;if(ut.isstr(e)&&ut.isstr(t))return vd(qx.strcmp(e.str,t.str));if(ut.isstr(e))return-1;if(ut.isstr(t))return 1;if(ut.issymbol(e)&&ut.issymbol(t))return vd(qx.strcmp(_u.get_printname(e),_u.get_printname(t)));if(ut.issymbol(e))return-1;if(ut.issymbol(t))return 1;if(ut.istensor(e)&&ut.istensor(t))return mk.compare_tensors(e,t);if(ut.istensor(e))return-1;if(ut.istensor(t))return 1;for(;ut.iscons(e)&&ut.iscons(t);){if(r=bu(ut.car(e),ut.car(t)),r!==0)return r;e=ut.cdr(e),t=ut.cdr(t)}return ut.iscons(t)?-1:ut.iscons(e)?1:0}Lt.cmp_expr=bu;function yk(e){return ut.iscons(e)?[...e].length:0}Lt.length=yk;function vk(e){return ut.doexpand(dk.Eval,e)}Lt.yyexpand=vk;function qk(e){return xx.power(_u.symbol(ut.E),e)}Lt.exponential=qk;function Ek(e){return xx.power(e,Ex.integer(2))}Lt.square=Ek;function xk(e){e.sort(bu)}Lt.sort=xk});var Oc=A(ui=>{"use strict";Object.defineProperty(ui,"__esModule",{value:!0});ui.countsize=ui.countOccurrencesOfSymbol=ui.count=void 0;var pk=Ie(),qd=N(),$b=e=>e.reduce((t,r)=>t+r,0);function Ed(e){let t;if(qd.iscons(e)){let r=[...e];t=$b(r.map(Ed))+r.length}else t=1;return t}ui.count=Ed;function px(e,t){let r=0;return qd.iscons(t)?r=$b([...t].map(n=>px(e,n))):pk.equal(e,t)&&(r=1),r}ui.countOccurrencesOfSymbol=px;function hk(e){let t=0;if(qd.istensor(e))for(let r=0;r<e.tensor.nelem;r++)t+=Ed(e.tensor.elem[r]);else if(qd.iscons(e)){let r=[...e];t=$b(r.map(Ed))+r.length}else t=1;return t}ui.countsize=hk});var U=A(it=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0});it.clear_symbol=it.clearRenamedVariablesToAvoidBindingToExternalScope=it.iskeyword=it.symbol=it.collectUserSymbols=it.clear_symbols=it.reset_symbols=it.get_binding=it.set_binding=it.get_printname=it.usr_symbol=it.std_symbol=it.inChildScope=it.Eval_symbolsinfo=void 0;var Ak=Oc(),rn=N(),xd=xe();function Ok(){let e=Mk();return e!==""?new rn.Str(e):hx(rn.NIL)}it.Eval_symbolsinfo=Ok;function Mk(){return[...zr.symbolinfo()].join(`
`)}var ci=class{constructor(t){this.parent=t,this.symbols=new Map,this.bindings=new Map}getOrCreate(t){let r=this.getExisting(t);if(r)return r;let n=new rn.Sym(t);return this.symbols.set(t,n),n}getExisting(t){var r;return((r=this.parent)===null||r===void 0?void 0:r.getExisting(t))||this.symbols.get(t)}mustGet(t){var r;return this.symbols.get(t)||((r=this.parent)===null||r===void 0?void 0:r.mustGet(t))||xd.stop(`${t} not defined`)}has(t){return this.symbols.has(t.printname)}binding(t){var r;return this.bindings.get(t.printname)||((r=this.parent)===null||r===void 0?void 0:r.binding(t))||t}set(t,r){this.bindings.set(t.printname,r)}clear(){this.bindings.clear()}delete(t){var r;this.symbols.delete(t.printname),this.bindings.delete(t.printname),(r=this.parent)===null||r===void 0||r.delete(t)}*symbolinfo(){this.parent&&(yield*this.parent.symbolinfo());for(let[t,r]of this.symbols.entries()){let n=this.bindings.get(t)||r,o=(n+"").substring(0,4);yield`symbol: ${r} size: ${Ak.countsize(n)} value: ${o}...`}}clearRenamedVariablesToAvoidBindingToExternalScope(){var t;for(let r of this.symbols.keys())r.indexOf("AVOID_BINDING_TO_EXTERNAL_SCOPE_VALUE")!==-1&&this.symbols.delete(r);for(let r of this.bindings.keys())r.indexOf("AVOID_BINDING_TO_EXTERNAL_SCOPE_VALUE")!==-1&&this.bindings.delete(r);(t=this.parent)===null||t===void 0||t.clearRenamedVariablesToAvoidBindingToExternalScope()}},ts=new ci,zr=new ci(ts);function Tk(e){let t=zr;try{return zr=new ci(zr),e()}finally{zr=t}}it.inChildScope=Tk;function Nk(e,t){let r=ts.getOrCreate(e);r.latexPrint=e,r.keyword=t}it.std_symbol=Nk;function Ik(e){return zr.getOrCreate(e)}it.usr_symbol=Ik;function Sk(e){return e.k!==rn.SYM&&xd.stop("symbol error"),e.printname}it.get_printname=Sk;function Rk(e,t){e.k!==rn.SYM&&xd.stop("symbol error"),zr.set(e,t)}it.set_binding=Rk;function wk(e){return e.k!==rn.SYM&&xd.stop("symbol error"),zr.binding(e)}it.get_binding=wk;function Lk(e){return e.k!==rn.SYM?!1:/^[abcdjnrstxyz]_?$/.test(e.printname)||!ts.has(e)}function Ck(){ts=new ci,zr=new ci(ts)}it.reset_symbols=Ck;function Pk(){zr=new ci(ts),ts.clear()}it.clear_symbols=Pk;function Ub(e,t){if(t==null&&(t=[]),Lk(e)&&t.indexOf(e)===-1){t.push(e);return}if(rn.istensor(e)){for(let r=0;r<e.tensor.nelem;r++)Ub(e.tensor.elem[r],t);return}for(;rn.iscons(e);)Ub(rn.car(e),t),e=rn.cdr(e)}it.collectUserSymbols=Ub;function hx(e){return zr.mustGet(e)}it.symbol=hx;function Dk(e){return rn.issymbol(e)&&e.keyword!=null}it.iskeyword=Dk;function kk(){zr.clearRenamedVariablesToAvoidBindingToExternalScope()}it.clearRenamedVariablesToAvoidBindingToExternalScope=kk;function $k(e){zr.delete(e)}it.clear_symbol=$k});var to=A(Ot=>{"use strict";Object.defineProperty(Ot,"__esModule",{value:!0});Ot.print_list=Ot.print_expr=Ot.printline=Ot.collectLatexStringFromReturnValue=Ot.print_str=Ot.Eval_printlist=Ot.Eval_printhuman=Ot.Eval_printlatex=Ot.Eval_printcomputer=Ot.Eval_print2dascii=Ot.Eval_print=void 0;var l=N(),se=U(),rs=Ie(),Uk=sn(),Ad=j(),Bk=Tn(),Gk=G(),At=Q(),Ox=X(),Fk=io(),jk=Rb(),zk=Vo(),Yk="^";function Vk(e){return l.defs.stringsEmittedByUserPrintouts+=Ha(l.cdr(e),l.defs.printMode),se.symbol(l.NIL)}Ot.Eval_print=Vk;function Zk(e){return l.defs.stringsEmittedByUserPrintouts+=Ha(l.cdr(e),l.PRINTMODE_2DASCII),se.symbol(l.NIL)}Ot.Eval_print2dascii=Zk;function Xk(e){return l.defs.stringsEmittedByUserPrintouts+=Ha(l.cdr(e),l.PRINTMODE_COMPUTER),se.symbol(l.NIL)}Ot.Eval_printcomputer=Xk;function Hk(e){return l.defs.stringsEmittedByUserPrintouts+=Ha(l.cdr(e),l.PRINTMODE_LATEX),se.symbol(l.NIL)}Ot.Eval_printlatex=Hk;function Qk(e){let t=l.defs.test_flag;return l.defs.test_flag=!1,l.defs.stringsEmittedByUserPrintouts+=Ha(l.cdr(e),l.PRINTMODE_HUMAN),l.defs.test_flag=t,se.symbol(l.NIL)}Ot.Eval_printhuman=Qk;function Wk(e){let t=Ha(l.cdr(e),l.PRINTMODE_LIST);return l.defs.stringsEmittedByUserPrintouts+=t,se.symbol(l.NIL)}Ot.Eval_printlist=Wk;function Ha(e,t){let r="";for(;l.iscons(e);){let n=Gk.Eval(l.car(e)),o=l.defs.printMode;t===l.PRINTMODE_COMPUTER?(l.defs.printMode=l.PRINTMODE_COMPUTER,r=pd(n),gu(r,l.LAST_FULL_PRINT)):t===l.PRINTMODE_HUMAN?(l.defs.printMode=l.PRINTMODE_HUMAN,r=pd(n),gu(r,l.LAST_PLAIN_PRINT)):t===l.PRINTMODE_2DASCII?(l.defs.printMode=l.PRINTMODE_2DASCII,r=jk.print2dascii(n),gu(r,l.LAST_2DASCII_PRINT)):t===l.PRINTMODE_LATEX?(l.defs.printMode=l.PRINTMODE_LATEX,r=pd(n),gu(r,l.LAST_LATEX_PRINT)):t===l.PRINTMODE_LIST&&(l.defs.printMode=l.PRINTMODE_LIST,r=Xa(n),gu(r,l.LAST_LIST_PRINT)),l.defs.printMode=o,e=l.cdr(e)}return l.DEBUG&&console.log(`emttedString from display: ${l.defs.stringsEmittedByUserPrintouts}`),r}function gu(e,t){let[,r]=zk.scan('"'+e+'"');se.set_binding(se.symbol(t),r)}function S(e){return l.DEBUG&&console.log(`emttedString from print_str: ${l.defs.stringsEmittedByUserPrintouts}`),e}Ot.print_str=S;function Jk(e){let t=l.defs.printMode;l.defs.printMode=l.PRINTMODE_LATEX;let r=l.defs.codeGen;l.defs.codeGen=!1;let n=C(e);return n=n.replace(/_/g,"\\_"),l.defs.printMode=t,l.defs.codeGen=r,l.DEBUG&&console.log(`emttedString from collectLatexStringFromReturnValue: ${l.defs.stringsEmittedByUserPrintouts}`),n}Ot.collectLatexStringFromReturnValue=Jk;function pd(e){let t="";return t+=C(e),t}Ot.printline=pd;function Mx(e){let t="";return At.isfraction(e)||l.isadd(e)||l.ismultiply(e)||l.ispower(e)||rs.lessp(e,l.Constants.zero)?(t+="(",t+=C(e),t+=")"):t+=C(e),t}function Ax(e){let t="";return At.isfraction(e)||l.isadd(e)||l.ismultiply(e)||l.ispower(e)?(t+="(",t+=C(e),t+=")"):t+=C(e),t}function Kk(e,t){let r="",n=l.cadr(e),o=l.caddr(e);return At.isminusone(o)?(r+=Mx(n),r):(t===1&&(r+="("),o=Ox.negate(o),r+=vu(n,o),t===1&&(r+=")"),r)}function e$(e){let t,r,n="",o=0,i=0,s=0,u=l.cdr(e),c=l.car(u);for(l.isrational(c)?(t=Uk.absval(Ad.mp_numerator(c)),r=Ad.mp_denominator(c),At.isplusone(t)||i++,At.isplusone(r)||s++,u=l.cdr(u)):(t=l.Constants.one,r=l.Constants.one);l.iscons(u);)c=l.car(u),hd(c)?s++:i++,u=l.cdr(u);if(l.defs.printMode===l.PRINTMODE_LATEX&&(n+=S("\\frac{")),i===0)n+="1";else for(o=0,u=l.cdr(e),l.isrational(l.car(u))&&(u=l.cdr(u)),At.isplusone(t)||(n+=xn(t),o=1);l.iscons(u);)c=l.car(u),hd(c)||(o&&(n+=Gb()),n+=xn(c),o=1),u=l.cdr(u);for(l.defs.printMode===l.PRINTMODE_LATEX?n+=S("}{"):l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag?n+=S(" / "):n+=S("/"),s>1&&l.defs.printMode!==l.PRINTMODE_LATEX&&(n+="("),o=0,u=l.cdr(e),l.isrational(l.car(u))&&(u=l.cdr(u)),At.isplusone(r)||(n+=xn(r),o=1);l.iscons(u);)c=l.car(u),hd(c)&&(o&&(n+=Gb()),n+=Kk(c,s),o=1),u=l.cdr(u);return s>1&&l.defs.printMode!==l.PRINTMODE_LATEX&&(n+=")"),l.defs.printMode===l.PRINTMODE_LATEX&&(n+=S("}")),n}function C(e){let t="";if(l.isadd(e))for(e=l.cdr(e),yu(l.car(e))==="-"&&(t+=S("-")),t+=Bb(l.car(e)),e=l.cdr(e);l.iscons(e);)yu(l.car(e))==="+"?l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag?t+=S(" + "):t+=S("+"):l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag?t+=S(" - "):t+=S("-"),t+=Bb(l.car(e)),e=l.cdr(e);else yu(e)==="-"&&(t+=S("-")),t+=Bb(e);return t}Ot.print_expr=C;function yu(e){let t="";return l.ismultiply(e)&&l.isNumericAtom(l.cadr(e))&&rs.lessp(l.cadr(e),l.Constants.zero)||l.isNumericAtom(e)&&rs.lessp(e,l.Constants.zero)?t+="-":t+="+",t}function Bb(e){let t="";if(l.ismultiply(e)&&D$(e))return t+=e$(e),t;if(l.ismultiply(e)){let r,n;e=l.cdr(e),At.isminusone(l.car(e))&&(e=l.cdr(e));let o=!1;l.isNumericAtom(l.car(e))&&(o=!0);let i=!1;for(l.defs.printMode===l.PRINTMODE_LATEX&&l.iscons(l.cdr(e))&&At.isNumberOneOverSomething(l.car(e))&&(i=!0,r=l.car(e).q.b.toString()),i?(n=t,t=""):t+=xn(l.car(e)),e=l.cdr(e);l.iscons(e);)l.defs.printMode===l.PRINTMODE_LATEX&&o&&l.caar(e)===se.symbol(l.POWER)&&l.isNumericAtom(l.car(l.cdr(l.car(e))))&&(At.isfraction(l.car(l.cdr(l.cdr(l.car(e)))))||(t+=" \\cdot ")),t+=Gb(),t+=xn(l.car(e),!1,!0),o=!1,l.isNumericAtom(l.car(e))&&(o=!0),e=l.cdr(e);i&&(t=n+"\\frac{"+t+"}{"+r+"}")}else t+=xn(e);return t}function Tx(e){let t="";return t+="(",t+=C(e),t+=")",t}function t$(e){let t="";return e=l.cadr(e),At.isfraction(e)||l.isadd(e)||l.ismultiply(e)||l.ispower(e)||l.isfactorial(e)?t+=Tx(e):t+=C(e),t+="!",t}function r$(e){let t="";return t+=S("\\left |"),t+=C(l.cadr(e)),t+=S(" \\right |"),t}function n$(e){let t="";return t+=S("\\binom{"),t+=C(l.cadr(e)),t+=S("}{"),t+=C(l.caddr(e)),t+=S("} "),t}function o$(e){let t="";return t+=C(l.cadr(e)),t+=S(" \\cdot "),t+=C(l.caddr(e)),t}function i$(e){let t="dot(";return t+=C(l.cadr(e)),t+=", ",t+=C(l.caddr(e)),t+=")",t}function s$(e){let t="Math.sin(";return t+=C(l.cadr(e)),t+=")",t}function a$(e){let t="Math.cos(";return t+=C(l.cadr(e)),t+=")",t}function l$(e){let t="Math.tan(";return t+=C(l.cadr(e)),t+=")",t}function u$(e){let t="Math.asin(";return t+=C(l.cadr(e)),t+=")",t}function c$(e){let t="Math.acos(";return t+=C(l.cadr(e)),t+=")",t}function f$(e){let t="Math.atan(";return t+=C(l.cadr(e)),t+=")",t}function d$(e){let t="";return t+=S("\\sqrt{"),t+=C(l.cadr(e)),t+=S("} "),t}function m$(e){let t="";return t+=S("{"),l.iscons(l.cadr(e))&&(t+=S("(")),t+=C(l.cadr(e)),l.iscons(l.cadr(e))&&(t+=S(")")),t+=S("}"),t+=S("^T"),t}function _$(e){let t="";return t+=S("transpose("),t+=C(l.cadr(e)),t+=S(")"),t}function b$(e){let t="";return t+=S("identity("),t+=C(l.cadr(e)),t+=S(")"),t}function g$(e){let t="";return t+=S("{"),l.iscons(l.cadr(e))&&(t+=S("(")),t+=C(l.cadr(e)),l.iscons(l.cadr(e))&&(t+=S(")")),t+=S("}"),t+=S("^{-1}"),t}function y$(e){let t="";return t+=S("inv("),t+=C(l.cadr(e)),t+=S(")"),t}function v$(e){let t="",r=l.car(l.cdr(e));e=l.cdr(e);let n=e,o=0;for(;l.iscons(l.cdr(l.cdr(e)));){o++;let i=l.cdr(l.cdr(e));t+=S("\\int^{"),t+=C(l.car(l.cdr(i))),t+=S("}_{"),t+=C(l.car(i)),t+=S("} \\! "),e=l.cdr(i)}t+=C(r),t+=S(" \\,"),e=n;for(let i=1;i<=o;i++){let s=l.cdr(e);t+=S(" \\mathrm{d} "),t+=C(l.car(s)),i<o&&(t+=S(" \\, ")),e=l.cdr(l.cdr(s))}return t}function q$(e){let t="";return t+=Nx(e,0,0)[1],t}function Nx(e,t,r){let n="";if(n+=S("["),t<e.tensor.ndim-1)for(let o=0;o<e.tensor.dim[t];o++){let i;[r,i]=Array.from(Nx(e,t+1,r)),n+=i,o!==e.tensor.dim[t]-1&&(n+=S(","))}else for(let o=0;o<e.tensor.dim[t];o++)n+=C(e.tensor.elem[r]),o!==e.tensor.dim[t]-1&&(n+=S(",")),r++;return n+=S("]"),[r,n]}function E$(e){let t="";return e.tensor.ndim<=2&&(t+=Ix(!0,e,0,0)[1]),t}function Ix(e,t,r,n){let o="";if(e&&(o+="\\begin{bmatrix} "),r<t.tensor.ndim-1)for(let i=0;i<t.tensor.dim[r];i++){let s;[n,s]=Array.from(Ix(!1,t,r+1,n)),o+=s,i!==t.tensor.dim[r]-1&&(o+=S(" \\\\ "))}else for(let i=0;i<t.tensor.dim[r];i++)o+=C(t.tensor.elem[n]),i!==t.tensor.dim[r]-1&&(o+=S(" & ")),n++;return e&&(o+=" \\end{bmatrix}"),[n,o]}function x$(e){let t="\\sum_{";return t+=C(l.caddr(e)),t+="=",t+=C(l.cadddr(e)),t+="}^{",t+=C(l.caddddr(e)),t+="}{",t+=C(l.cadr(e)),t+="}",t}function p$(e){let t=l.cadr(e),r=l.caddr(e),n=l.cadddr(e),o=l.caddddr(e);return"(function(){ var "+r+";  var holderSum = 0;  var lowerlimit = "+C(n)+";  var upperlimit = "+C(o)+";  for ("+r+" = lowerlimit; "+r+" < upperlimit; "+r+"++) {    holderSum += "+C(t)+"; }  return holderSum;})()"}function h$(e){let t="\\left\\{ \\begin{array}{ll}";for(e=l.cdr(e);l.iscons(e);){if(l.cdr(e)===se.symbol(l.NIL)){t+="{",t+=C(l.car(e)),t+="} & otherwise ",t+=" \\\\\\\\";break}t+="{",t+=C(l.cadr(e)),t+="} & if & ",t+=C(l.car(e)),t+=" \\\\\\\\",e=l.cddr(e)}return t=t.substring(0,t.length-4),t+="\\end{array} \\right."}function A$(e){let t="(function(){";e=l.cdr(e);let r=0;for(;l.iscons(e);){if(l.cdr(e)===se.symbol(l.NIL)){t+="else {",t+="return ("+C(l.car(e))+");",t+="}";break}r&&(t+=" else "),t+="if ("+C(l.car(e))+"){",t+="return ("+C(l.cadr(e))+");",t+="}",r++,e=l.cddr(e)}return t+="})()",t}function O$(e){let t="{";return t+=C(l.cadr(e)),t+="}",t+=" < ",t+="{",t+=C(l.caddr(e)),t+="}"}function M$(e){let t="{";return t+=C(l.cadr(e)),t+="}",t+=" \\leq ",t+="{",t+=C(l.caddr(e)),t+="}"}function T$(e){let t="{";return t+=C(l.cadr(e)),t+="}",t+=" > ",t+="{",t+=C(l.caddr(e)),t+="}"}function N$(e){let t="{";return t+=C(l.cadr(e)),t+="}",t+=" \\geq ",t+="{",t+=C(l.caddr(e)),t+="}"}function I$(e){let t="{";return t+=C(l.cadr(e)),t+="}",t+=" = ",t+="{",t+=C(l.caddr(e)),t+="}"}function S$(e){let t=l.cadr(e),r=l.caddr(e),n=l.cadddr(e),o=l.caddddr(e);return"(function(){ var "+r+";  var lowerlimit = "+C(n)+";  var upperlimit = "+C(o)+";  for ("+r+" = lowerlimit; "+r+" < upperlimit; "+r+"++) {    "+C(t)+" } })()"}function R$(e){let t="";for(e=l.cdr(e);l.iscons(e);)t+=C(l.car(e)),e=l.cdr(e);return t}function w$(e){let t="";return t+=C(l.cadr(e)),t+=" = ",t+=C(l.caddr(e)),t+="; ",t}function L$(e){let t="\\prod_{";return t+=C(l.caddr(e)),t+="=",t+=C(l.cadddr(e)),t+="}^{",t+=C(l.caddddr(e)),t+="}{",t+=C(l.cadr(e)),t+="}",t}function C$(e){let t=l.cadr(e),r=l.caddr(e),n=l.cadddr(e),o=l.caddddr(e);return"(function(){ var "+r+";  var holderProduct = 1;  var lowerlimit = "+C(n)+";  var upperlimit = "+C(o)+";  for ("+r+" = lowerlimit; "+r+" < upperlimit; "+r+"++) {    holderProduct *= "+C(t)+"; }  return holderProduct;})()"}function vu(e,t){let r="";if(l.DEBUG&&console.log("power base: "+e+"  exponent: "+t),At.isoneovertwo(t))if(At.equaln(e,2)){if(l.defs.codeGen)return r+=S("Math.SQRT2"),r}else{if(l.defs.printMode===l.PRINTMODE_LATEX)return r+=S("\\sqrt{"),r+=C(e),r+=S("}"),r;if(l.defs.codeGen)return r+=S("Math.sqrt("),r+=C(e),r+=S(")"),r}if(At.equaln(se.get_binding(se.symbol(l.PRINT_LEAVE_E_ALONE)),1)&&e===se.symbol(l.E))return l.defs.codeGen?(r+=S("Math.exp("),r+=Ax(t),r+=S(")"),r):(l.defs.printMode===l.PRINTMODE_LATEX?(r+=S("e^{"),r+=C(t),r+=S("}")):(r+=S("exp("),r+=C(t),r+=S(")")),r);if(l.defs.codeGen)return r+=S("Math.pow("),r+=Mx(e),r+=S(", "),r+=Ax(t),r+=S(")"),r;if(At.equaln(se.get_binding(se.symbol(l.PRINT_LEAVE_X_ALONE)),0)||e.printname!=="x"){if(e!==se.symbol(l.E)){if(At.isminusone(t))return l.defs.printMode===l.PRINTMODE_LATEX?r+=S("\\frac{1}{"):l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag?r+=S("1 / "):r+=S("1/"),l.iscons(e)&&l.defs.printMode!==l.PRINTMODE_LATEX?(r+=S("("),r+=C(e),r+=S(")")):r+=C(e),l.defs.printMode===l.PRINTMODE_LATEX&&(r+=S("}")),r;if(At.isnegativeterm(t)){l.defs.printMode===l.PRINTMODE_LATEX?r+=S("\\frac{1}{"):l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag?r+=S("1 / "):r+=S("1/");let n=Ox.multiply(t,l.Constants.negOne);return l.iscons(e)&&l.defs.printMode!==l.PRINTMODE_LATEX?(r+=S("("),r+=vu(e,n),r+=S(")")):r+=vu(e,n),l.defs.printMode===l.PRINTMODE_LATEX&&(r+=S("}")),r}}if(At.isfraction(t)&&l.defs.printMode===l.PRINTMODE_LATEX){r+=S("\\sqrt");let n=Bk.denominator(t);return At.isplustwo(n)||(r+=S("["),r+=C(n),r+=S("]")),r+=S("{"),t=Fk.numerator(t),r+=vu(e,t),r+=S("}"),r}}return l.defs.printMode===l.PRINTMODE_LATEX&&At.isplusone(t)?r+=C(e):(l.isadd(e)||At.isnegativenumber(e)?(r+=S("("),r+=C(e),r+=S(")")):l.ismultiply(e)||l.ispower(e)?(l.defs.printMode!==l.PRINTMODE_LATEX&&(r+=S("(")),r+=xn(e,!0),l.defs.printMode!==l.PRINTMODE_LATEX&&(r+=S(")"))):l.isNumericAtom(e)&&(rs.lessp(e,l.Constants.zero)||At.isfraction(e))?(r+=S("("),r+=xn(e),r+=S(")")):r+=xn(e),l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag?r+=S(Yk):r+=S("^"),l.defs.printMode===l.PRINTMODE_LATEX?C(t).length>1?(r+=S("{"),r+=C(t),r+=S("}")):r+=C(t):l.iscons(t)||At.isfraction(t)||l.isNumericAtom(t)&&rs.lessp(t,l.Constants.zero)?(r+=S("("),r+=C(t),r+=S(")")):r+=xn(t)),r}function P$(e){let t="";if(e=l.cdr(e),l.caar(e)===se.symbol(l.ADD)||l.caar(e)===se.symbol(l.MULTIPLY)||l.caar(e)===se.symbol(l.POWER)||l.caar(e)===se.symbol(l.FACTORIAL)?t+=Tx(l.car(e)):t+=C(l.car(e)),t+=S("["),e=l.cdr(e),l.iscons(e))for(t+=C(l.car(e)),e=l.cdr(e);l.iscons(e);)t+=S(","),t+=C(l.car(e)),e=l.cdr(e);return t+=S("]"),t}function xn(e,t=!1,r=!1){let n="";if(l.isNumericAtom(e))return r&&rs.lessp(e,l.Constants.zero)&&(n+="("),n+=Ad.print_number(e,r),r&&rs.lessp(e,l.Constants.zero)&&(n+=")"),n;if(l.isstr(e))return n+=S('"'),n+=S(e.str),n+=S('"'),n;if(l.istensor(e))return l.defs.printMode===l.PRINTMODE_LATEX?n+=E$(e):n+=q$(e),n;if(l.ismultiply(e))return t||(yu(e)==="-"||l.defs.printMode!==l.PRINTMODE_LATEX)&&(l.defs.printMode===l.PRINTMODE_LATEX?n+=S(" \\left ("):n+=S("(")),n+=C(e),t||(yu(e)==="-"||l.defs.printMode!==l.PRINTMODE_LATEX)&&(l.defs.printMode===l.PRINTMODE_LATEX?n+=S(" \\right ) "):n+=S(")")),n;if(l.isadd(e))return t||(n+=S("(")),n+=C(e),t||(n+=S(")")),n;if(l.ispower(e)){let o=l.cadr(e),i=l.caddr(e);return n+=vu(o,i),n}if(l.car(e)===se.symbol(l.FUNCTION)){let o=l.cadr(e);if(!l.defs.codeGen){let i=l.caddr(e);n+=S("function "),l.DEBUG&&console.log(`emittedString from print_factor ${l.defs.stringsEmittedByUserPrintouts}`),n+=Xa(i),n+=S(" -> ")}return n+=C(o),n}if(l.car(e)===se.symbol(l.PATTERN))return n+=C(l.caadr(e)),l.defs.printMode===l.PRINTMODE_LATEX?n+=S(" \\rightarrow "):l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag?n+=S(" -> "):n+=S("->"),n+=C(l.car(l.cdr(l.cadr(e)))),n;if(l.car(e)===se.symbol(l.INDEX)&&l.issymbol(l.cadr(e)))return n+=P$(e),n;if(l.isfactorial(e))return n+=t$(e),n;if(l.car(e)===se.symbol(l.ABS)&&l.defs.printMode===l.PRINTMODE_LATEX)return n+=r$(e),n;if(l.car(e)===se.symbol(l.SQRT)&&l.defs.printMode===l.PRINTMODE_LATEX)return n+=d$(e),n;if(l.isfactorial(e)){if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=m$(e),n;if(l.defs.codeGen)return n+=_$(e),n}else if(l.car(e)===se.symbol(l.UNIT)){if(l.defs.codeGen)return n+=b$(e),n}else if(l.isinv(e)){if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=g$(e),n;if(l.defs.codeGen)return n+=y$(e),n}else{if(l.car(e)===se.symbol(l.BINOMIAL)&&l.defs.printMode===l.PRINTMODE_LATEX)return n+=n$(e),n;if(l.car(e)===se.symbol(l.DEFINT)&&l.defs.printMode===l.PRINTMODE_LATEX)return n+=v$(e),n;if(l.isinnerordot(e)){if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=o$(e),n;if(l.defs.codeGen)return n+=i$(e),n}else if(l.car(e)===se.symbol(l.SIN)){if(l.defs.codeGen)return n+=s$(e),n}else if(l.car(e)===se.symbol(l.COS)){if(l.defs.codeGen)return n+=a$(e),n}else if(l.car(e)===se.symbol(l.TAN)){if(l.defs.codeGen)return n+=l$(e),n}else if(l.car(e)===se.symbol(l.ARCSIN)){if(l.defs.codeGen)return n+=u$(e),n}else if(l.car(e)===se.symbol(l.ARCCOS)){if(l.defs.codeGen)return n+=c$(e),n}else if(l.car(e)===se.symbol(l.ARCTAN)){if(l.defs.codeGen)return n+=f$(e),n}else if(l.car(e)===se.symbol(l.SUM)){if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=x$(e),n;if(l.defs.codeGen)return n+=p$(e),n}else if(l.car(e)===se.symbol(l.PRODUCT)){if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=L$(e),n;if(l.defs.codeGen)return n+=C$(e),n}else if(l.car(e)===se.symbol(l.FOR)){if(l.defs.codeGen)return n+=S$(e),n}else if(l.car(e)===se.symbol(l.DO)){if(l.defs.codeGen)return n+=R$(e),n}else if(l.car(e)===se.symbol(l.TEST)){if(l.defs.codeGen)return n+=A$(e),n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=h$(e),n}else if(l.car(e)===se.symbol(l.TESTLT)){if(l.defs.codeGen)return n+="(("+C(l.cadr(e))+") < ("+C(l.caddr(e))+"))",n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=O$(e),n}else if(l.car(e)===se.symbol(l.TESTLE)){if(l.defs.codeGen)return n+="(("+C(l.cadr(e))+") <= ("+C(l.caddr(e))+"))",n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=M$(e),n}else if(l.car(e)===se.symbol(l.TESTGT)){if(l.defs.codeGen)return n+="(("+C(l.cadr(e))+") > ("+C(l.caddr(e))+"))",n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=T$(e),n}else if(l.car(e)===se.symbol(l.TESTGE)){if(l.defs.codeGen)return n+="(("+C(l.cadr(e))+") >= ("+C(l.caddr(e))+"))",n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=N$(e),n}else if(l.car(e)===se.symbol(l.TESTEQ)){if(l.defs.codeGen)return n+="(("+C(l.cadr(e))+") === ("+C(l.caddr(e))+"))",n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=I$(e),n}else if(l.car(e)===se.symbol(l.FLOOR)){if(l.defs.codeGen)return n+="Math.floor("+C(l.cadr(e))+")",n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=" \\lfloor {"+C(l.cadr(e))+"} \\rfloor ",n}else if(l.car(e)===se.symbol(l.CEILING)){if(l.defs.codeGen)return n+="Math.ceiling("+C(l.cadr(e))+")",n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=" \\lceil {"+C(l.cadr(e))+"} \\rceil ",n}else if(l.car(e)===se.symbol(l.ROUND)){if(l.defs.codeGen)return n+="Math.round("+C(l.cadr(e))+")",n}else if(l.car(e)===se.symbol(l.SETQ))return l.defs.codeGen?(n+=w$(e),n):(n+=C(l.cadr(e)),n+=S("="),n+=C(l.caddr(e)),n)}if(l.iscons(e)){if(n+=xn(l.car(e)),e=l.cdr(e),t||(n+=S("(")),l.iscons(e))for(n+=C(l.car(e)),e=l.cdr(e);l.iscons(e);)n+=S(","),n+=C(l.car(e)),e=l.cdr(e);return t||(n+=S(")")),n}return e===se.symbol(l.DERIVATIVE)?n+="d":e===se.symbol(l.E)?l.defs.codeGen?n+=S("Math.E"):n+=S("e"):e===se.symbol(l.PI)?l.defs.printMode===l.PRINTMODE_LATEX?n+=S("\\pi"):n+=S("pi"):n+=S(se.get_printname(e)),n}function Xa(e){let t="";switch(e.k){case l.CONS:for(t+="(",t+=Xa(l.car(e)),e===l.cdr(e)&&(console.log("oh no recursive!"),l.breakpoint),e=l.cdr(e);l.iscons(e);)t+=" ",t+=Xa(l.car(e)),e=l.cdr(e),e===l.cdr(e)&&e!==se.symbol(l.NIL)&&(console.log("oh no recursive!"),l.breakpoint);e!==se.symbol(l.NIL)&&(t+=" . ",t+=Xa(e)),t+=")";break;case l.STR:t+=e.str;break;case l.NUM:case l.DOUBLE:t+=Ad.print_number(e,!0);break;case l.SYM:t+=se.get_printname(e);break;default:t+="<tensor>"}return t}Ot.print_list=Xa;function Gb(){let e="";return l.defs.printMode===l.PRINTMODE_LATEX||(l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag&&!l.defs.codeGen?e+=S(" "):e+=S("*")),e}function hd(e){return l.ispower(e)&&l.cadr(e)!==se.symbol(l.E)&&At.isnegativeterm(l.caddr(e))}function D$(e){for(e=l.cdr(e);l.iscons(e);){let t=l.car(e);if(hd(t))return!0;e=l.cdr(e)}return!1}});var N=A(a=>{"use strict";var k$=a&&a.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(a,"__esModule",{value:!0});a.evalFloats=a.evalPolar=a.doexpand=a.noexpand=a.Constants=a.$=a.reset_after_error=a.MEQUAL=a.MZERO=a.MSIGN=a.isidentitymatrix=a.isinv=a.istranspose=a.isinnerordot=a.isfactorial=a.ispower=a.ismultiply=a.isadd=a.caddaddr=a.cdddaddr=a.caddadr=a.cddaddr=a.cadaddr=a.caddddr=a.cddddr=a.cadddr=a.cdaddr=a.caddar=a.cadadr=a.caaddr=a.cdddr=a.cddar=a.cdadr=a.cadar=a.caddr=a.caadr=a.cddr=a.cdar=a.cadr=a.caar=a.cdr=a.car=a.issymbol=a.isNumericAtomOrTensor=a.istensor=a.isstr=a.isNumericAtom=a.isdouble=a.isrational=a.iscons=a.dotprod_unicode=a.transpose_unicode=a.logbuf=a.mtotal=a.primetab=a.parse_time_simplifications=a.predefinedSymbolsInGlobalScope_doNotTrackInDependencies=a.MAXDIM=a.MAX_CONSECUTIVE_APPLICATIONS_OF_SINGLE_RULE=a.MAX_CONSECUTIVE_APPLICATIONS_OF_ALL_RULES=a.MAXPRIMETAB=a.E=a.C6=a.C5=a.C4=a.C3=a.C2=a.C1=a.SYMBOL_X_UNDERSCORE=a.SYMBOL_B_UNDERSCORE=a.SYMBOL_A_UNDERSCORE=a.SYMBOL_IDENTITY_MATRIX=a.SYMBOL_Z=a.SYMBOL_Y=a.SYMBOL_X=a.SYMBOL_T=a.SYMBOL_S=a.SYMBOL_R=a.SYMBOL_N=a.SYMBOL_J=a.SYMBOL_I=a.SYMBOL_D=a.SYMBOL_C=a.SYMBOL_B=a.SYMBOL_A=a.PI=a.VERSION=a.SECRETX=a.METAX=a.METAB=a.METAA=a.DRAWX=a.YYE=a.MAX_FIXED_PRINTOUT_DIGITS=a.FORCE_FIXED_PRINTOUT=a.TRACE=a.ASSUME_REAL_VARIABLES=a.BAKE=a.AUTOEXPAND=a.LAST_PLAIN_PRINT=a.LAST_LIST_PRINT=a.LAST_LATEX_PRINT=a.LAST_FULL_PRINT=a.LAST_2DASCII_PRINT=a.LAST_PRINT=a.LAST=a.NIL=a.ZERO=a.UNIT=a.TRANSPOSE=a.TESTLT=a.TESTLE=a.TESTGT=a.TESTGE=a.TESTEQ=a.TEST=a.TAYLOR=a.TANH=a.TAN=a.SYMBOLSINFO=a.SUM=a.SUBST=a.STOP=a.SQRT=a.SHAPE=a.SINH=a.SIN=a.SIMPLIFY=a.SILENTPATTERN=a.SGN=a.SETQ=a.ROOTS=a.YYRECT=a.ROUND=a.REAL=a.RATIONALIZE=a.RANK=a.QUOTIENT=a.QUOTE=a.PRODUCT=a.PRINTPLAIN=a.PRINTLIST=a.PRINTLATEX=a.PRINTFULL=a.PRINT2DASCII=a.PRINT=a.PRINT_LEAVE_X_ALONE=a.PRINT_LEAVE_E_ALONE=a.PRIME=a.POWER=a.POLAR=a.PATTERNSINFO=a.PATTERN=a.OUTER=a.OR=a.OPERATOR=a.NUMERATOR=a.NUMBER=a.NROOTS=a.NOT=a.MULTIPLY=a.MOD=a.LOOKUP=a.LOG=a.LEGENDRE=a.LEADING=a.LCM=a.LAGUERRE=a.ISPRIME=a.ISINTEGER=a.INVG=a.INV=a.INTEGRAL=a.INNER=a.INDEX=a.IMAG=a.HILBERT=a.HERMITE=a.GCD=a.GAMMA=a.FUNCTION=a.FOR=a.FLOOR=a.FLOATF=a.FILTER=a.FACTORPOLY=a.FACTORIAL=a.FACTOR=a.EXPSIN=a.EXPCOS=a.EXPAND=a.EXP=a.EVAL=a.ERFC=a.ERF=a.EIGENVEC=a.EIGENVAL=a.EIGEN=a.DSOLVE=a.DRAW=a.DOT=a.DO=a.DIVISORS=a.DIRAC=a.DIM=a.DET=a.DERIVATIVE=a.DENOMINATOR=a.DEGREE=a.DEFINT=a.DECOMP=a.COSH=a.COS=a.CONTRACT=a.CONJ=a.CONDENSE=a.COFACTOR=a.COEFF=a.CLOCK=a.CLEARPATTERNS=a.CLEARALL=a.CLEAR=a.CIRCEXP=a.CHOOSE=a.CHECK=a.CEILING=a.BINOMIAL=a.BINDING=a.BESSELY=a.BESSELJ=a.ATOMIZE=a.ARG=a.ARCTANH=a.ARCTAN=a.ARCSINH=a.ARCSIN=a.ARCCOSH=a.ARCCOS=a.APPROXRATIO=a.AND=a.ADJ=a.ADD=a.ABS=a.SYM=a.TENSOR=a.STR=a.DOUBLE=a.NUM=a.CONS=a.Sym=a.Tensor=a.Str=a.Double=a.Num=a.Cons=a.BaseAtom=a.avoidCalculatingPowersIntoArctans=a.do_simplify_nested_radicals=a.dontCreateNewRadicalsInDenominatorWhenEvalingMultiplication=a.defs=a.PRINTMODE_LIST=a.PRINTMODE_HUMAN=a.PRINTMODE_COMPUTER=a.PRINTMODE_2DASCII=a.PRINTMODE_LATEX=a.PRINTOUTRESULT=a.DEBUG=a.NSYM=a.version=a.breakpoint=void 0;var Od=k$(No()),Sx=to(),Yr=U();function Rx(){}a.breakpoint=Rx;a.version="2.0.1";a.NSYM=1e3;a.DEBUG=!1;a.PRINTOUTRESULT=!1;a.PRINTMODE_LATEX="PRINTMODE_LATEX";a.PRINTMODE_2DASCII="PRINTMODE_2DASCII";a.PRINTMODE_COMPUTER="PRINTMODE_COMPUTER";a.PRINTMODE_HUMAN="PRINTMODE_HUMAN";a.PRINTMODE_LIST="PRINTMODE_LIST";var Fb=class{constructor(){this.printMode=a.PRINTMODE_COMPUTER,this.recursionLevelNestedRadicalsRemoval=0,this.errorMessage="",this.symbolsDependencies={},this.symbolsHavingReassignments=[],this.symbolsInExpressionsWithoutAssignments=[],this.patternHasBeenFound=!1,this.inited=!1,this.chainOfUserSymbolsNotFunctionsBeingEvaluated=[],this.stringsEmittedByUserPrintouts="",this.called_from_Algebra_block=!1,this.expanding=!1,this.evaluatingAsFloats=!1,this.evaluatingPolar=!1,this.esc_flag=!1,this.trigmode=0,this.out_count=0,this.test_flag=!1,this.codeGen=!1,this.userSimplificationsInListForm=[],this.userSimplificationsInStringForm=[],this.fullDoubleOutput=!1}};a.defs=new Fb;a.dontCreateNewRadicalsInDenominatorWhenEvalingMultiplication=!0;a.do_simplify_nested_radicals=!0;a.avoidCalculatingPowersIntoArctans=!0;var To=class{toString(){return Sx.print_expr(this)}toLatexString(){return Sx.collectLatexStringFromReturnValue(this)}};a.BaseAtom=To;var qu=class extends To{constructor(t,r){super(),this.k=a.CONS,this.cons={car:t,cdr:r}}*[Symbol.iterator](){let t=this;for(;Qa(t);)yield Ce(t),t=ae(t)}tail(){return Qa(this.cons.cdr)?[...this.cons.cdr]:[]}map(t){let r=Ce(this),n=ae(this);return Qa(n)&&(n=n.map(t)),new qu(t(r),n)}};a.Cons=qu;var Wa=class extends To{constructor(t,r=Od.default.one){super(),this.a=t,this.b=r,this.q=this,this.k=a.NUM}};a.Num=Wa;var ns=class extends To{constructor(t){super(),this.d=t,this.k=a.DOUBLE}};a.Double=ns;var jb=class extends To{constructor(t){super(),this.str=t,this.k=a.STR}};a.Str=jb;var zb=class extends To{constructor(){super(...arguments),this.tensor=this,this.k=a.TENSOR,this.ndim=0,this.dim=[],this.elem=[]}get nelem(){return this.elem.length}};a.Tensor=zb;var Yb=class extends To{constructor(t){super(),this.printname=t,this.k=a.SYM}};a.Sym=Yb;a.CONS=0;a.NUM=1;a.DOUBLE=2;a.STR=3;a.TENSOR=4;a.SYM=5;a.ABS="abs";a.ADD="add";a.ADJ="adj";a.AND="and";a.APPROXRATIO="approxratio";a.ARCCOS="arccos";a.ARCCOSH="arccosh";a.ARCSIN="arcsin";a.ARCSINH="arcsinh";a.ARCTAN="arctan";a.ARCTANH="arctanh";a.ARG="arg";a.ATOMIZE="atomize";a.BESSELJ="besselj";a.BESSELY="bessely";a.BINDING="binding";a.BINOMIAL="binomial";a.CEILING="ceiling";a.CHECK="check";a.CHOOSE="choose";a.CIRCEXP="circexp";a.CLEAR="clear";a.CLEARALL="clearall";a.CLEARPATTERNS="clearpatterns";a.CLOCK="clock";a.COEFF="coeff";a.COFACTOR="cofactor";a.CONDENSE="condense";a.CONJ="conj";a.CONTRACT="contract";a.COS="cos";a.COSH="cosh";a.DECOMP="decomp";a.DEFINT="defint";a.DEGREE="deg";a.DENOMINATOR="denominator";a.DERIVATIVE="derivative";a.DET="det";a.DIM="dim";a.DIRAC="dirac";a.DIVISORS="divisors";a.DO="do";a.DOT="dot";a.DRAW="draw";a.DSOLVE="dsolve";a.EIGEN="eigen";a.EIGENVAL="eigenval";a.EIGENVEC="eigenvec";a.ERF="erf";a.ERFC="erfc";a.EVAL="eval";a.EXP="exp";a.EXPAND="expand";a.EXPCOS="expcos";a.EXPSIN="expsin";a.FACTOR="factor";a.FACTORIAL="factorial";a.FACTORPOLY="factorpoly";a.FILTER="filter";a.FLOATF="float";a.FLOOR="floor";a.FOR="for";a.FUNCTION="function";a.GAMMA="Gamma";a.GCD="gcd";a.HERMITE="hermite";a.HILBERT="hilbert";a.IMAG="imag";a.INDEX="component";a.INNER="inner";a.INTEGRAL="integral";a.INV="inv";a.INVG="invg";a.ISINTEGER="isinteger";a.ISPRIME="isprime";a.LAGUERRE="laguerre";a.LCM="lcm";a.LEADING="leading";a.LEGENDRE="legendre";a.LOG="log";a.LOOKUP="lookup";a.MOD="mod";a.MULTIPLY="multiply";a.NOT="not";a.NROOTS="nroots";a.NUMBER="number";a.NUMERATOR="numerator";a.OPERATOR="operator";a.OR="or";a.OUTER="outer";a.PATTERN="pattern";a.PATTERNSINFO="patternsinfo";a.POLAR="polar";a.POWER="power";a.PRIME="prime";a.PRINT_LEAVE_E_ALONE="printLeaveEAlone";a.PRINT_LEAVE_X_ALONE="printLeaveXAlone";a.PRINT="print";a.PRINT2DASCII="print2dascii";a.PRINTFULL="printcomputer";a.PRINTLATEX="printlatex";a.PRINTLIST="printlist";a.PRINTPLAIN="printhuman";a.PRODUCT="product";a.QUOTE="quote";a.QUOTIENT="quotient";a.RANK="rank";a.RATIONALIZE="rationalize";a.REAL="real";a.ROUND="round";a.YYRECT="rect";a.ROOTS="roots";a.SETQ="equals";a.SGN="sgn";a.SILENTPATTERN="silentpattern";a.SIMPLIFY="simplify";a.SIN="sin";a.SINH="sinh";a.SHAPE="shape";a.SQRT="sqrt";a.STOP="stop";a.SUBST="subst";a.SUM="sum";a.SYMBOLSINFO="symbolsinfo";a.TAN="tan";a.TANH="tanh";a.TAYLOR="taylor";a.TEST="test";a.TESTEQ="testeq";a.TESTGE="testge";a.TESTGT="testgt";a.TESTLE="testle";a.TESTLT="testlt";a.TRANSPOSE="transpose";a.UNIT="unit";a.ZERO="zero";a.NIL="nil";a.LAST="last";a.LAST_PRINT="lastprint";a.LAST_2DASCII_PRINT="last2dasciiprint";a.LAST_FULL_PRINT="lastfullprint";a.LAST_LATEX_PRINT="lastlatexprint";a.LAST_LIST_PRINT="lastlistprint";a.LAST_PLAIN_PRINT="lastplainprint";a.AUTOEXPAND="autoexpand";a.BAKE="bake";a.ASSUME_REAL_VARIABLES="assumeRealVariables";a.TRACE="trace";a.FORCE_FIXED_PRINTOUT="forceFixedPrintout";a.MAX_FIXED_PRINTOUT_DIGITS="maxFixedPrintoutDigits";a.YYE="~";a.DRAWX="$DRAWX";a.METAA="$METAA";a.METAB="$METAB";a.METAX="$METAX";a.SECRETX="$SECRETX";a.VERSION="version";a.PI="pi";a.SYMBOL_A="a";a.SYMBOL_B="b";a.SYMBOL_C="c";a.SYMBOL_D="d";a.SYMBOL_I="i";a.SYMBOL_J="j";a.SYMBOL_N="n";a.SYMBOL_R="r";a.SYMBOL_S="s";a.SYMBOL_T="t";a.SYMBOL_X="x";a.SYMBOL_Y="y";a.SYMBOL_Z="z";a.SYMBOL_IDENTITY_MATRIX="I";a.SYMBOL_A_UNDERSCORE="a_";a.SYMBOL_B_UNDERSCORE="b_";a.SYMBOL_X_UNDERSCORE="x_";a.C1="$C1";a.C2="$C2";a.C3="$C3";a.C4="$C4";a.C5="$C5";a.C6="$C6";a.E=a.YYE;a.MAXPRIMETAB=1e4;a.MAX_CONSECUTIVE_APPLICATIONS_OF_ALL_RULES=5;a.MAX_CONSECUTIVE_APPLICATIONS_OF_SINGLE_RULE=10;a.MAXDIM=24;a.predefinedSymbolsInGlobalScope_doNotTrackInDependencies=["rationalize","abs","e","i","pi","sin","ceiling","cos","roots","integral","derivative","defint","sqrt","eig","cov","deig","dcov","float","floor","product","root","round","sum","test","unit"];a.parse_time_simplifications=!0;a.primetab=function(){let e=[2],t=3;for(;e.length<a.MAXPRIMETAB;){let r=0,n=Math.sqrt(t);for(;r<e.length&&e[r]<=n;){if(t%e[r]===0){r=-1;break}r++}r!==-1&&e.push(t),t+=2}return e[a.MAXPRIMETAB]=0,e}();var $$=!1;a.mtotal=0;a.logbuf="";a.transpose_unicode=7488;a.dotprod_unicode=183;function Qa(e){return e.k===a.CONS}a.iscons=Qa;function wx(e){return e.k===a.NUM}a.isrational=wx;function Lx(e){return e.k===a.DOUBLE}a.isdouble=Lx;function Cx(e){return wx(e)||Lx(e)}a.isNumericAtom=Cx;function U$(e){return e.k===a.STR}a.isstr=U$;function Px(e){return e.k===a.TENSOR}a.istensor=Px;function Dx(e){if(Cx(e)||e===Yr.symbol(a.SYMBOL_IDENTITY_MATRIX))return!0;if(!Px(e))return!1;let t=e.tensor.nelem,r=e.tensor.elem;for(let n=0;n<t;n++)if(!Dx(r[n]))return!1;return!0}a.isNumericAtomOrTensor=Dx;function B$(e){return e.k===a.SYM}a.issymbol=B$;function Ce(e){return Qa(e)?e.cons.car:Yr.symbol(a.NIL)}a.car=Ce;function ae(e){return Qa(e)?e.cons.cdr:Yr.symbol(a.NIL)}a.cdr=ae;function G$(e){return Ce(Ce(e))}a.caar=G$;function F$(e){return Ce(ae(e))}a.cadr=F$;function j$(e){return ae(Ce(e))}a.cdar=j$;function z$(e){return ae(ae(e))}a.cddr=z$;function Y$(e){return Ce(Ce(ae(e)))}a.caadr=Y$;function V$(e){return Ce(ae(ae(e)))}a.caddr=V$;function Z$(e){return Ce(ae(Ce(e)))}a.cadar=Z$;function X$(e){return ae(Ce(ae(e)))}a.cdadr=X$;function H$(e){return ae(ae(Ce(e)))}a.cddar=H$;function Q$(e){return ae(ae(ae(e)))}a.cdddr=Q$;function W$(e){return Ce(Ce(ae(ae(e))))}a.caaddr=W$;function J$(e){return Ce(ae(Ce(ae(e))))}a.cadadr=J$;function K$(e){return Ce(ae(ae(Ce(e))))}a.caddar=K$;function eU(e){return ae(Ce(ae(ae(e))))}a.cdaddr=eU;function tU(e){return Ce(ae(ae(ae(e))))}a.cadddr=tU;function rU(e){return ae(ae(ae(ae(e))))}a.cddddr=rU;function nU(e){return Ce(ae(ae(ae(ae(e)))))}a.caddddr=nU;function oU(e){return Ce(ae(Ce(ae(ae(e)))))}a.cadaddr=oU;function iU(e){return ae(ae(Ce(ae(ae(e)))))}a.cddaddr=iU;function sU(e){return Ce(ae(ae(Ce(ae(e)))))}a.caddadr=sU;function aU(e){return ae(ae(ae(Ce(ae(ae(e))))))}a.cdddaddr=aU;function lU(e){return Ce(ae(ae(Ce(ae(ae(e))))))}a.caddaddr=lU;function uU(e){return Ce(e)===Yr.symbol(a.ADD)}a.isadd=uU;function cU(e){return Ce(e)===Yr.symbol(a.MULTIPLY)}a.ismultiply=cU;function fU(e){return Ce(e)===Yr.symbol(a.POWER)}a.ispower=fU;function dU(e){return Ce(e)===Yr.symbol(a.FACTORIAL)}a.isfactorial=dU;function mU(e){return Ce(e)===Yr.symbol(a.INNER)||Ce(e)===Yr.symbol(a.DOT)}a.isinnerordot=mU;function _U(e){return Ce(e)===Yr.symbol(a.TRANSPOSE)}a.istranspose=_U;function bU(e){return Ce(e)===Yr.symbol(a.INV)}a.isinv=bU;function gU(e){return e===Yr.symbol(a.SYMBOL_IDENTITY_MATRIX)}a.isidentitymatrix=gU;function yU(e){return e.isPositive()?1:e.isZero()?0:-1}a.MSIGN=yU;function vU(e){return e.isZero()}a.MZERO=vU;function qU(e,t){return e==null,e.equals(t)}a.MEQUAL=qU;function EU(){a.defs.esc_flag=!1,$$=!1,a.defs.evaluatingAsFloats=!1,a.defs.evaluatingPolar=!1}a.reset_after_error=EU;a.$={};var or=class{static One(){return a.defs.evaluatingAsFloats?or.oneAsDouble:or.one}static NegOne(){return a.defs.evaluatingAsFloats?or.negOneAsDouble:or.negOne}static Zero(){return a.defs.evaluatingAsFloats?or.zeroAsDouble:or.zero}static Pi(){return a.defs.evaluatingAsFloats?or.piAsDouble:Yr.symbol(a.PI)}};a.Constants=or;or.one=new Wa(Od.default(1));or.oneAsDouble=new ns(1);or.negOne=new Wa(Od.default(-1));or.negOneAsDouble=new ns(-1);or.zero=new Wa(Od.default(0));or.zeroAsDouble=new ns(0);or.piAsDouble=new ns(Math.PI);function xU(e,...t){let r=a.defs.expanding;a.defs.expanding=!1;try{return e(...t)}finally{a.defs.expanding=r}}a.noexpand=xU;function pU(e,...t){let r=a.defs.expanding;a.defs.expanding=!0;try{return e(...t)}finally{a.defs.expanding=r}}a.doexpand=pU;function hU(e,...t){let r=a.defs.evaluatingPolar;a.defs.evaluatingPolar=!0;try{return e(...t)}finally{a.defs.evaluatingPolar=r}}a.evalPolar=hU;function AU(e,...t){let r=a.defs.evaluatingAsFloats;a.defs.evaluatingAsFloats=!0;try{return e(...t)}finally{a.defs.evaluatingAsFloats=r}}a.evalFloats=AU});var Ux=A(Ja=>{"use strict";Object.defineProperty(Ja,"__esModule",{value:!0});Ja.exec=Ja.parse=void 0;var Md=xe(),kx=j(),OU=ee(),MU=Vo(),Eu=N(),TU=au(),Vb=U();Eu.defs.inited||(Eu.defs.inited=!0,TU.init());function $x(e){if(typeof e=="string"){let[,t]=MU.scan(e);return t}else return typeof e=="number"?e%1===0?kx.integer(e):kx.double(e):typeof e.k=="number"?e:(console.warn("unknown argument type",e),Vb.symbol(Eu.NIL))}function NU(e){let t;try{t=$x(e),Md.check_stack()}catch(r){throw Eu.reset_after_error(),r}return t}Ja.parse=NU;function IU(e,...t){let r,n=Vb.get_binding(Vb.usr_symbol(e));Md.check_stack();let o=OU.makeList(n,...t.map($x));try{r=Md.top_level_eval(o),Md.check_stack()}catch(i){throw Eu.reset_after_error(),i}return r}Ja.exec=IU});var DU=A(Nd=>{Object.defineProperty(Nd,"__esModule",{value:!0});var qe=N(),SU=sr(),RU=au(),Ka=U(),Zb=Ux(),Ct=Q(),Bx=Ie(),wU=Vo(),Td=k_(),LU=Fl(),CU=xe(),F={};F.version=qe.version;F.isadd=qe.isadd;F.ismultiply=qe.ismultiply;F.ispower=qe.ispower;F.isfactorial=qe.isfactorial;F.car=qe.car;F.cdr=qe.cdr;F.caar=qe.caar;F.cadr=qe.cadr;F.cdar=qe.cdar;F.cddr=qe.cddr;F.caadr=qe.caadr;F.caddr=qe.caddr;F.cadar=qe.cadar;F.cdadr=qe.cdadr;F.cddar=qe.cddar;F.cdddr=qe.cdddr;F.caaddr=qe.caaddr;F.cadadr=qe.cadadr;F.caddar=qe.caddar;F.cdaddr=qe.cdaddr;F.cadddr=qe.cadddr;F.cddddr=qe.cddddr;F.caddddr=qe.caddddr;F.cadaddr=qe.cadaddr;F.cddaddr=qe.cddaddr;F.caddadr=qe.caddadr;F.cdddaddr=qe.cdddaddr;F.caddaddr=qe.caddaddr;F.symbol=Ka.symbol;F.iscons=qe.iscons;F.isrational=qe.isrational;F.isdouble=qe.isdouble;F.isNumericAtom=qe.isNumericAtom;F.isstr=qe.isstr;F.istensor=qe.istensor;F.issymbol=qe.issymbol;F.iskeyword=Ka.iskeyword;F.CONS=qe.CONS;F.Cons=qe.Cons;F.NUM=qe.NUM;F.Num=qe.Num;F.DOUBLE=qe.DOUBLE;F.Double=qe.Double;F.STR=qe.STR;F.Str=qe.Str;F.TENSOR=qe.TENSOR;F.Tensor=qe.Tensor;F.SYM=qe.SYM;F.Sym=qe.Sym;F.approxRadicals=Td.approxRadicals;F.approxRationalsOfLogs=Td.approxRationalsOfLogs;F.approxAll=Td.approxAll;F.testApprox=Td.testApprox;F.make_hashed_itab=LU.make_hashed_itab;F.isZeroAtomOrTensor=Ct.isZeroAtomOrTensor;F.isnegativenumber=Ct.isnegativenumber;F.isplusone=Ct.isplusone;F.isminusone=Ct.isminusone;F.isinteger=Ct.isinteger;F.isnonnegativeinteger=Ct.isnonnegativeinteger;F.isposint=Ct.isposint;F.isnegativeterm=Ct.isnegativeterm;F.isimaginarynumber=Ct.isimaginarynumber;F.iscomplexnumber=Ct.iscomplexnumber;F.iseveninteger=Ct.iseveninteger;F.isnegative=Ct.isnegative;F.issymbolic=Ct.issymbolic;F.isintegerfactor=Ct.isintegerfactor;F.isoneover=Ct.isoneover;F.isfraction=Ct.isfraction;F.isoneoversqrttwo=Ct.isoneoversqrttwo;F.isminusoneoversqrttwo=Ct.isminusoneoversqrttwo;F.isfloating=Ct.isfloating;F.isimaginaryunit=Ct.isimaginaryunit;F.isquarterturn=Ct.isquarterturn;F.isnpi=Ct.isnpi;F.equal=Bx.equal;F.length=Bx.length;F.scan=wU.scan;F.Find=SU.Find;F.get_binding=Ka.get_binding;F.set_binding=Ka.set_binding;F.usr_symbol=Ka.usr_symbol;F.collectUserSymbols=Ka.collectUserSymbols;F.init=RU.init;F.exec=Zb.exec;F.parse=Zb.parse;F.run=CU.run;var PU=["abs","add","adj","and","approxratio","arccos","arccosh","arcsin","arcsinh","arctan","arctanh","arg","atomize","besselj","bessely","binding","binomial","ceiling","check","choose","circexp","clear","clearall","clearpatterns","clock","coeff","cofactor","condense","conj","contract","cos","cosh","decomp","defint","deg","denominator","det","derivative","dim","dirac","divisors","do","dot","draw","dsolve","eigen","eigenval","eigenvec","erf","erfc","eval","exp","expand","expcos","expsin","factor","factorial","factorpoly","filter","float","floor","for","Gamma","gcd","hermite","hilbert","imag","component","inner","integral","inv","invg","isinteger","isprime","laguerre","lcm","leading","legendre","log","mod","multiply","not","nroots","number","numerator","operator","or","outer","pattern","patternsinfo","polar","power","prime","print","print2dascii","printcomputer","printlatex","printlist","printhuman","product","quote","quotient","rank","rationalize","real","rect","roots","round","equals","shape","sgn","silentpattern","simplify","sin","sinh","sqrt","stop","subst","sum","symbolsinfo","tan","tanh","taylor","test","testeq","testge","testgt","testle","testlt","transpose","unit","zero"];Array.from(PU).map(e=>F[e]=Zb.exec.bind(Nd,e));Nd.default=F});DU();})();
