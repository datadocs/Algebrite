(()=>{var lg=Object.create;var gl=Object.defineProperty;var fg=Object.getOwnPropertyDescriptor;var ug=Object.getOwnPropertyNames;var mg=Object.getPrototypeOf,cg=Object.prototype.hasOwnProperty;var dg=t=>gl(t,"__esModule",{value:!0});var pg=(t,r)=>()=>(r||t((r={exports:{}}).exports,r),r.exports);var xg=(t,r,e)=>{if(r&&typeof r=="object"||typeof r=="function")for(let o of ug(r))!cg.call(t,o)&&o!=="default"&&gl(t,o,{get:()=>r[o],enumerable:!(e=fg(r,o))||e.enumerable});return t},bn=t=>xg(dg(gl(t!=null?lg(mg(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var Vo=pg((vv,$s)=>{var qr=function(t){"use strict";var r=1e7,e=7,o=9007199254740992,n=B(o),i="0123456789abcdefghijklmnopqrstuvwxyz",a=typeof BigInt=="function";function m(d,b,E,S){return typeof d=="undefined"?m[0]:typeof b!="undefined"?+b==10&&!E?bt(d):ig(d,b,E,S):bt(d)}function p(d,b){this.value=d,this.sign=b,this.isSmall=!1}p.prototype=Object.create(m.prototype);function g(d){this.value=d,this.sign=d<0,this.isSmall=!0}g.prototype=Object.create(m.prototype);function v(d){this.value=d}v.prototype=Object.create(m.prototype);function F(d){return-o<d&&d<o}function B(d){return d<1e7?[d]:d<1e14?[d%1e7,Math.floor(d/1e7)]:[d%1e7,Math.floor(d/1e7)%1e7,Math.floor(d/1e14)]}function J(d){nt(d);var b=d.length;if(b<4&&Io(d,n)<0)switch(b){case 0:return 0;case 1:return d[0];case 2:return d[0]+d[1]*r;default:return d[0]+(d[1]+d[2]*r)*r}return d}function nt(d){for(var b=d.length;d[--b]===0;);d.length=b+1}function ht(d){for(var b=new Array(d),E=-1;++E<d;)b[E]=0;return b}function $t(d){return d>0?Math.floor(d):Math.ceil(d)}function pr(d,b){var E=d.length,S=b.length,R=new Array(E),O=0,Z=r,z,j;for(j=0;j<S;j++)z=d[j]+b[j]+O,O=z>=Z?1:0,R[j]=z-O*Z;for(;j<E;)z=d[j]+O,O=z===Z?1:0,R[j++]=z-O*Z;return O>0&&R.push(O),R}function ar(d,b){return d.length>=b.length?pr(d,b):pr(b,d)}function kt(d,b){var E=d.length,S=new Array(E),R=r,O,Z;for(Z=0;Z<E;Z++)O=d[Z]-R+b,b=Math.floor(O/R),S[Z]=O-b*R,b+=1;for(;b>0;)S[Z++]=b%R,b=Math.floor(b/R);return S}p.prototype.add=function(d){var b=bt(d);if(this.sign!==b.sign)return this.subtract(b.negate());var E=this.value,S=b.value;return b.isSmall?new p(kt(E,Math.abs(S)),this.sign):new p(ar(E,S),this.sign)},p.prototype.plus=p.prototype.add,g.prototype.add=function(d){var b=bt(d),E=this.value;if(E<0!==b.sign)return this.subtract(b.negate());var S=b.value;if(b.isSmall){if(F(E+S))return new g(E+S);S=B(Math.abs(S))}return new p(kt(S,Math.abs(E)),E<0)},g.prototype.plus=g.prototype.add,v.prototype.add=function(d){return new v(this.value+bt(d).value)},v.prototype.plus=v.prototype.add;function nr(d,b){var E=d.length,S=b.length,R=new Array(E),O=0,Z=r,z,j;for(z=0;z<S;z++)j=d[z]-O-b[z],j<0?(j+=Z,O=1):O=0,R[z]=j;for(z=S;z<E;z++){if(j=d[z]-O,j<0)j+=Z;else{R[z++]=j;break}R[z]=j}for(;z<E;z++)R[z]=d[z];return nt(R),R}function vr(d,b,E){var S;return Io(d,b)>=0?S=nr(d,b):(S=nr(b,d),E=!E),S=J(S),typeof S=="number"?(E&&(S=-S),new g(S)):new p(S,E)}function Ir(d,b,E){var S=d.length,R=new Array(S),O=-b,Z=r,z,j;for(z=0;z<S;z++)j=d[z]+O,O=Math.floor(j/Z),j%=Z,R[z]=j<0?j+Z:j;return R=J(R),typeof R=="number"?(E&&(R=-R),new g(R)):new p(R,E)}p.prototype.subtract=function(d){var b=bt(d);if(this.sign!==b.sign)return this.add(b.negate());var E=this.value,S=b.value;return b.isSmall?Ir(E,Math.abs(S),this.sign):vr(E,S,this.sign)},p.prototype.minus=p.prototype.subtract,g.prototype.subtract=function(d){var b=bt(d),E=this.value;if(E<0!==b.sign)return this.add(b.negate());var S=b.value;return b.isSmall?new g(E-S):Ir(S,Math.abs(E),E>=0)},g.prototype.minus=g.prototype.subtract,v.prototype.subtract=function(d){return new v(this.value-bt(d).value)},v.prototype.minus=v.prototype.subtract,p.prototype.negate=function(){return new p(this.value,!this.sign)},g.prototype.negate=function(){var d=this.sign,b=new g(-this.value);return b.sign=!d,b},v.prototype.negate=function(){return new v(-this.value)},p.prototype.abs=function(){return new p(this.value,!1)},g.prototype.abs=function(){return new g(Math.abs(this.value))},v.prototype.abs=function(){return new v(this.value>=0?this.value:-this.value)};function Ze(d,b){var E=d.length,S=b.length,R=E+S,O=ht(R),Z=r,z,j,_t,Rt,yt;for(_t=0;_t<E;++_t){Rt=d[_t];for(var Qt=0;Qt<S;++Qt)yt=b[Qt],z=Rt*yt+O[_t+Qt],j=Math.floor(z/Z),O[_t+Qt]=z-j*Z,O[_t+Qt+1]+=j}return nt(O),O}function oe(d,b){var E=d.length,S=new Array(E),R=r,O=0,Z,z;for(z=0;z<E;z++)Z=d[z]*b+O,O=Math.floor(Z/R),S[z]=Z-O*R;for(;O>0;)S[z++]=O%R,O=Math.floor(O/R);return S}function we(d,b){for(var E=[];b-- >0;)E.push(0);return E.concat(d)}function no(d,b){var E=Math.max(d.length,b.length);if(E<=30)return Ze(d,b);E=Math.ceil(E/2);var S=d.slice(E),R=d.slice(0,E),O=b.slice(E),Z=b.slice(0,E),z=no(R,Z),j=no(S,O),_t=no(ar(R,S),ar(Z,O)),Rt=ar(ar(z,we(nr(nr(_t,z),j),E)),we(j,2*E));return nt(Rt),Rt}function Os(d,b){return-.012*d-.012*b+15e-6*d*b>0}p.prototype.multiply=function(d){var b=bt(d),E=this.value,S=b.value,R=this.sign!==b.sign,O;if(b.isSmall){if(S===0)return m[0];if(S===1)return this;if(S===-1)return this.negate();if(O=Math.abs(S),O<r)return new p(oe(E,O),R);S=B(O)}return Os(E.length,S.length)?new p(no(E,S),R):new p(Ze(E,S),R)},p.prototype.times=p.prototype.multiply;function No(d,b,E){return d<r?new p(oe(b,d),E):new p(Ze(b,B(d)),E)}g.prototype._multiplyBySmall=function(d){return F(d.value*this.value)?new g(d.value*this.value):No(Math.abs(d.value),B(Math.abs(this.value)),this.sign!==d.sign)},p.prototype._multiplyBySmall=function(d){return d.value===0?m[0]:d.value===1?this:d.value===-1?this.negate():No(Math.abs(d.value),this.value,this.sign!==d.sign)},g.prototype.multiply=function(d){return bt(d)._multiplyBySmall(this)},g.prototype.times=g.prototype.multiply,v.prototype.multiply=function(d){return new v(this.value*bt(d).value)},v.prototype.times=v.prototype.multiply;function ki(d){var b=d.length,E=ht(b+b),S=r,R,O,Z,z,j;for(Z=0;Z<b;Z++){z=d[Z],O=0-z*z;for(var _t=Z;_t<b;_t++)j=d[_t],R=2*(z*j)+E[Z+_t]+O,O=Math.floor(R/S),E[Z+_t]=R-O*S;E[Z+b]=O}return nt(E),E}p.prototype.square=function(){return new p(ki(this.value),!1)},g.prototype.square=function(){var d=this.value*this.value;return F(d)?new g(d):new p(ki(B(Math.abs(this.value))),!1)},v.prototype.square=function(d){return new v(this.value*this.value)};function Ts(d,b){var E=d.length,S=b.length,R=r,O=ht(b.length),Z=b[S-1],z=Math.ceil(R/(2*Z)),j=oe(d,z),_t=oe(b,z),Rt,yt,Qt,ge,ne,pl,xl;for(j.length<=E&&j.push(0),_t.push(0),Z=_t[S-1],yt=E-S;yt>=0;yt--){for(Rt=R-1,j[yt+S]!==Z&&(Rt=Math.floor((j[yt+S]*R+j[yt+S-1])/Z)),Qt=0,ge=0,pl=_t.length,ne=0;ne<pl;ne++)Qt+=Rt*_t[ne],xl=Math.floor(Qt/R),ge+=j[yt+ne]-(Qt-xl*R),Qt=xl,ge<0?(j[yt+ne]=ge+R,ge=-1):(j[yt+ne]=ge,ge=0);for(;ge!==0;){for(Rt-=1,Qt=0,ne=0;ne<pl;ne++)Qt+=j[yt+ne]-R+_t[ne],Qt<0?(j[yt+ne]=Qt+R,Qt=0):(j[yt+ne]=Qt,Qt=1);ge+=Qt}O[yt]=Rt}return j=Di(j,z)[0],[J(O),J(j)]}function Ns(d,b){for(var E=d.length,S=b.length,R=[],O=[],Z=r,z,j,_t,Rt,yt;E;){if(O.unshift(d[--E]),nt(O),Io(O,b)<0){R.push(0);continue}j=O.length,_t=O[j-1]*Z+O[j-2],Rt=b[S-1]*Z+b[S-2],j>S&&(_t=(_t+1)*Z),z=Math.ceil(_t/Rt);do{if(yt=oe(b,z),Io(yt,O)<=0)break;z--}while(z);R.push(z),O=nr(O,yt)}return R.reverse(),[J(R),J(O)]}function Di(d,b){var E=d.length,S=ht(E),R=r,O,Z,z,j;for(z=0,O=E-1;O>=0;--O)j=z*R+d[O],Z=$t(j/b),z=j-Z*b,S[O]=Z|0;return[S,z|0]}function Ye(d,b){var E,S=bt(b);if(a)return[new v(d.value/S.value),new v(d.value%S.value)];var R=d.value,O=S.value,Z;if(O===0)throw new Error("Cannot divide by zero");if(d.isSmall)return S.isSmall?[new g($t(R/O)),new g(R%O)]:[m[0],d];if(S.isSmall){if(O===1)return[d,m[0]];if(O==-1)return[d.negate(),m[0]];var z=Math.abs(O);if(z<r){E=Di(R,z),Z=J(E[0]);var j=E[1];return d.sign&&(j=-j),typeof Z=="number"?(d.sign!==S.sign&&(Z=-Z),[new g(Z),new g(j)]):[new p(Z,d.sign!==S.sign),new g(j)]}O=B(z)}var _t=Io(R,O);if(_t===-1)return[m[0],d];if(_t===0)return[m[d.sign===S.sign?1:-1],m[0]];R.length+O.length<=200?E=Ts(R,O):E=Ns(R,O),Z=E[0];var Rt=d.sign!==S.sign,yt=E[1],Qt=d.sign;return typeof Z=="number"?(Rt&&(Z=-Z),Z=new g(Z)):Z=new p(Z,Rt),typeof yt=="number"?(Qt&&(yt=-yt),yt=new g(yt)):yt=new p(yt,Qt),[Z,yt]}p.prototype.divmod=function(d){var b=Ye(this,d);return{quotient:b[0],remainder:b[1]}},v.prototype.divmod=g.prototype.divmod=p.prototype.divmod,p.prototype.divide=function(d){return Ye(this,d)[0]},v.prototype.over=v.prototype.divide=function(d){return new v(this.value/bt(d).value)},g.prototype.over=g.prototype.divide=p.prototype.over=p.prototype.divide,p.prototype.mod=function(d){return Ye(this,d)[1]},v.prototype.mod=v.prototype.remainder=function(d){return new v(this.value%bt(d).value)},g.prototype.remainder=g.prototype.mod=p.prototype.remainder=p.prototype.mod,p.prototype.pow=function(d){var b=bt(d),E=this.value,S=b.value,R,O,Z;if(S===0)return m[1];if(E===0)return m[0];if(E===1)return m[1];if(E===-1)return b.isEven()?m[1]:m[-1];if(b.sign)return m[0];if(!b.isSmall)throw new Error("The exponent "+b.toString()+" is too large.");if(this.isSmall&&F(R=Math.pow(E,S)))return new g($t(R));for(O=this,Z=m[1];S&!0&&(Z=Z.times(O),--S),S!==0;)S/=2,O=O.square();return Z},g.prototype.pow=p.prototype.pow,v.prototype.pow=function(d){var b=bt(d),E=this.value,S=b.value,R=BigInt(0),O=BigInt(1),Z=BigInt(2);if(S===R)return m[1];if(E===R)return m[0];if(E===O)return m[1];if(E===BigInt(-1))return b.isEven()?m[1]:m[-1];if(b.isNegative())return new v(R);for(var z=this,j=m[1];(S&O)===O&&(j=j.times(z),--S),S!==R;)S/=Z,z=z.square();return j},p.prototype.modPow=function(d,b){if(d=bt(d),b=bt(b),b.isZero())throw new Error("Cannot take modPow with modulus 0");var E=m[1],S=this.mod(b);for(d.isNegative()&&(d=d.multiply(m[-1]),S=S.modInv(b));d.isPositive();){if(S.isZero())return m[0];d.isOdd()&&(E=E.multiply(S).mod(b)),d=d.divide(2),S=S.square().mod(b)}return E},v.prototype.modPow=g.prototype.modPow=p.prototype.modPow;function Io(d,b){if(d.length!==b.length)return d.length>b.length?1:-1;for(var E=d.length-1;E>=0;E--)if(d[E]!==b[E])return d[E]>b[E]?1:-1;return 0}p.prototype.compareAbs=function(d){var b=bt(d),E=this.value,S=b.value;return b.isSmall?1:Io(E,S)},g.prototype.compareAbs=function(d){var b=bt(d),E=Math.abs(this.value),S=b.value;return b.isSmall?(S=Math.abs(S),E===S?0:E>S?1:-1):-1},v.prototype.compareAbs=function(d){var b=this.value,E=bt(d).value;return b=b>=0?b:-b,E=E>=0?E:-E,b===E?0:b>E?1:-1},p.prototype.compare=function(d){if(d===1/0)return-1;if(d===-1/0)return 1;var b=bt(d),E=this.value,S=b.value;return this.sign!==b.sign?b.sign?1:-1:b.isSmall?this.sign?-1:1:Io(E,S)*(this.sign?-1:1)},p.prototype.compareTo=p.prototype.compare,g.prototype.compare=function(d){if(d===1/0)return-1;if(d===-1/0)return 1;var b=bt(d),E=this.value,S=b.value;return b.isSmall?E==S?0:E>S?1:-1:E<0!==b.sign?E<0?-1:1:E<0?1:-1},g.prototype.compareTo=g.prototype.compare,v.prototype.compare=function(d){if(d===1/0)return-1;if(d===-1/0)return 1;var b=this.value,E=bt(d).value;return b===E?0:b>E?1:-1},v.prototype.compareTo=v.prototype.compare,p.prototype.equals=function(d){return this.compare(d)===0},v.prototype.eq=v.prototype.equals=g.prototype.eq=g.prototype.equals=p.prototype.eq=p.prototype.equals,p.prototype.notEquals=function(d){return this.compare(d)!==0},v.prototype.neq=v.prototype.notEquals=g.prototype.neq=g.prototype.notEquals=p.prototype.neq=p.prototype.notEquals,p.prototype.greater=function(d){return this.compare(d)>0},v.prototype.gt=v.prototype.greater=g.prototype.gt=g.prototype.greater=p.prototype.gt=p.prototype.greater,p.prototype.lesser=function(d){return this.compare(d)<0},v.prototype.lt=v.prototype.lesser=g.prototype.lt=g.prototype.lesser=p.prototype.lt=p.prototype.lesser,p.prototype.greaterOrEquals=function(d){return this.compare(d)>=0},v.prototype.geq=v.prototype.greaterOrEquals=g.prototype.geq=g.prototype.greaterOrEquals=p.prototype.geq=p.prototype.greaterOrEquals,p.prototype.lesserOrEquals=function(d){return this.compare(d)<=0},v.prototype.leq=v.prototype.lesserOrEquals=g.prototype.leq=g.prototype.lesserOrEquals=p.prototype.leq=p.prototype.lesserOrEquals,p.prototype.isEven=function(){return(this.value[0]&1)==0},g.prototype.isEven=function(){return(this.value&1)==0},v.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},p.prototype.isOdd=function(){return(this.value[0]&1)==1},g.prototype.isOdd=function(){return(this.value&1)==1},v.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},p.prototype.isPositive=function(){return!this.sign},g.prototype.isPositive=function(){return this.value>0},v.prototype.isPositive=g.prototype.isPositive,p.prototype.isNegative=function(){return this.sign},g.prototype.isNegative=function(){return this.value<0},v.prototype.isNegative=g.prototype.isNegative,p.prototype.isUnit=function(){return!1},g.prototype.isUnit=function(){return Math.abs(this.value)===1},v.prototype.isUnit=function(){return this.abs().value===BigInt(1)},p.prototype.isZero=function(){return!1},g.prototype.isZero=function(){return this.value===0},v.prototype.isZero=function(){return this.value===BigInt(0)},p.prototype.isDivisibleBy=function(d){var b=bt(d);return b.isZero()?!1:b.isUnit()?!0:b.compareAbs(2)===0?this.isEven():this.mod(b).isZero()},v.prototype.isDivisibleBy=g.prototype.isDivisibleBy=p.prototype.isDivisibleBy;function Is(d){var b=d.abs();if(b.isUnit())return!1;if(b.equals(2)||b.equals(3)||b.equals(5))return!0;if(b.isEven()||b.isDivisibleBy(3)||b.isDivisibleBy(5))return!1;if(b.lesser(49))return!0}function Bi(d,b){for(var E=d.prev(),S=E,R=0,O,Z,z,j;S.isEven();)S=S.divide(2),R++;t:for(z=0;z<b.length;z++)if(!d.lesser(b[z])&&(j=qr(b[z]).modPow(S,d),!(j.isUnit()||j.equals(E)))){for(O=R-1;O!=0;O--){if(j=j.square().mod(d),j.isUnit())return!1;if(j.equals(E))continue t}return!1}return!0}p.prototype.isPrime=function(d){var b=Is(this);if(b!==t)return b;var E=this.abs(),S=E.bitLength();if(S<=64)return Bi(E,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var R=Math.log(2)*S.toJSNumber(),O=Math.ceil(d===!0?2*Math.pow(R,2):R),Z=[],z=0;z<O;z++)Z.push(qr(z+2));return Bi(E,Z)},v.prototype.isPrime=g.prototype.isPrime=p.prototype.isPrime,p.prototype.isProbablePrime=function(d,b){var E=Is(this);if(E!==t)return E;for(var S=this.abs(),R=d===t?5:d,O=[],Z=0;Z<R;Z++)O.push(qr.randBetween(2,S.minus(2),b));return Bi(S,O)},v.prototype.isProbablePrime=g.prototype.isProbablePrime=p.prototype.isProbablePrime,p.prototype.modInv=function(d){for(var b=qr.zero,E=qr.one,S=bt(d),R=this.abs(),O,Z,z;!R.isZero();)O=S.divide(R),Z=b,z=S,b=E,S=R,E=Z.subtract(O.multiply(E)),R=z.subtract(O.multiply(R));if(!S.isUnit())throw new Error(this.toString()+" and "+d.toString()+" are not co-prime");return b.compare(0)===-1&&(b=b.add(d)),this.isNegative()?b.negate():b},v.prototype.modInv=g.prototype.modInv=p.prototype.modInv,p.prototype.next=function(){var d=this.value;return this.sign?Ir(d,1,this.sign):new p(kt(d,1),this.sign)},g.prototype.next=function(){var d=this.value;return d+1<o?new g(d+1):new p(n,!1)},v.prototype.next=function(){return new v(this.value+BigInt(1))},p.prototype.prev=function(){var d=this.value;return this.sign?new p(kt(d,1),!0):Ir(d,1,this.sign)},g.prototype.prev=function(){var d=this.value;return d-1>-o?new g(d-1):new p(n,!0)},v.prototype.prev=function(){return new v(this.value-BigInt(1))};for(var je=[1];2*je[je.length-1]<=r;)je.push(2*je[je.length-1]);var xn=je.length,Ro=je[xn-1];function Rs(d){return Math.abs(d)<=r}p.prototype.shiftLeft=function(d){var b=bt(d).toJSNumber();if(!Rs(b))throw new Error(String(b)+" is too large for shifting.");if(b<0)return this.shiftRight(-b);var E=this;if(E.isZero())return E;for(;b>=xn;)E=E.multiply(Ro),b-=xn-1;return E.multiply(je[b])},v.prototype.shiftLeft=g.prototype.shiftLeft=p.prototype.shiftLeft,p.prototype.shiftRight=function(d){var b,E=bt(d).toJSNumber();if(!Rs(E))throw new Error(String(E)+" is too large for shifting.");if(E<0)return this.shiftLeft(-E);for(var S=this;E>=xn;){if(S.isZero()||S.isNegative()&&S.isUnit())return S;b=Ye(S,Ro),S=b[1].isNegative()?b[0].prev():b[0],E-=xn-1}return b=Ye(S,je[E]),b[1].isNegative()?b[0].prev():b[0]},v.prototype.shiftRight=g.prototype.shiftRight=p.prototype.shiftRight;function Ui(d,b,E){b=bt(b);for(var S=d.isNegative(),R=b.isNegative(),O=S?d.not():d,Z=R?b.not():b,z=0,j=0,_t=null,Rt=null,yt=[];!O.isZero()||!Z.isZero();)_t=Ye(O,Ro),z=_t[1].toJSNumber(),S&&(z=Ro-1-z),Rt=Ye(Z,Ro),j=Rt[1].toJSNumber(),R&&(j=Ro-1-j),O=_t[0],Z=Rt[0],yt.push(E(z,j));for(var Qt=E(S?1:0,R?1:0)!==0?qr(-1):qr(0),ge=yt.length-1;ge>=0;ge-=1)Qt=Qt.multiply(Ro).add(qr(yt[ge]));return Qt}p.prototype.not=function(){return this.negate().prev()},v.prototype.not=g.prototype.not=p.prototype.not,p.prototype.and=function(d){return Ui(this,d,function(b,E){return b&E})},v.prototype.and=g.prototype.and=p.prototype.and,p.prototype.or=function(d){return Ui(this,d,function(b,E){return b|E})},v.prototype.or=g.prototype.or=p.prototype.or,p.prototype.xor=function(d){return Ui(this,d,function(b,E){return b^E})},v.prototype.xor=g.prototype.xor=p.prototype.xor;var Gi=1<<30,dl=(r&-r)*(r&-r)|Gi;function Un(d){var b=d.value,E=typeof b=="number"?b|Gi:typeof b=="bigint"?b|BigInt(Gi):b[0]+b[1]*r|dl;return E&-E}function Ls(d,b){if(b.compareTo(d)<=0){var E=Ls(d,b.square(b)),S=E.p,R=E.e,O=S.multiply(b);return O.compareTo(d)<=0?{p:O,e:R*2+1}:{p:S,e:R*2}}return{p:qr(1),e:0}}p.prototype.bitLength=function(){var d=this;return d.compareTo(qr(0))<0&&(d=d.negate().subtract(qr(1))),d.compareTo(qr(0))===0?qr(0):qr(Ls(d,qr(2)).e).add(qr(1))},v.prototype.bitLength=g.prototype.bitLength=p.prototype.bitLength;function Fi(d,b){return d=bt(d),b=bt(b),d.greater(b)?d:b}function Gn(d,b){return d=bt(d),b=bt(b),d.lesser(b)?d:b}function If(d,b){if(d=bt(d).abs(),b=bt(b).abs(),d.equals(b))return d;if(d.isZero())return b;if(b.isZero())return d;for(var E=m[1],S,R;d.isEven()&&b.isEven();)S=Gn(Un(d),Un(b)),d=d.divide(S),b=b.divide(S),E=E.multiply(S);for(;d.isEven();)d=d.divide(Un(d));do{for(;b.isEven();)b=b.divide(Un(b));d.greater(b)&&(R=b,b=d,d=R),b=b.subtract(d)}while(!b.isZero());return E.isUnit()?d:d.multiply(E)}function og(d,b){return d=bt(d).abs(),b=bt(b).abs(),d.divide(If(d,b)).multiply(b)}function ng(d,b,E){d=bt(d),b=bt(b);var S=E||Math.random,R=Gn(d,b),O=Fi(d,b),Z=O.subtract(R).add(1);if(Z.isSmall)return R.add(Math.floor(S()*Z));for(var z=zi(Z,r).value,j=[],_t=!0,Rt=0;Rt<z.length;Rt++){var yt=_t?z[Rt]+(Rt+1<z.length?z[Rt+1]/r:0):r,Qt=$t(S()*yt);j.push(Qt),Qt<z[Rt]&&(_t=!1)}return R.add(m.fromArray(j,r,!1))}var ig=function(d,b,E,S){E=E||i,d=String(d),S||(d=d.toLowerCase(),E=E.toLowerCase());var R=d.length,O,Z=Math.abs(b),z={};for(O=0;O<E.length;O++)z[E[O]]=O;for(O=0;O<R;O++){var j=d[O];if(j!=="-"&&j in z&&z[j]>=Z){if(j==="1"&&Z===1)continue;throw new Error(j+" is not a valid digit in base "+b+".")}}b=bt(b);var _t=[],Rt=d[0]==="-";for(O=Rt?1:0;O<d.length;O++){var j=d[O];if(j in z)_t.push(bt(z[j]));else if(j==="<"){var yt=O;do O++;while(d[O]!==">"&&O<d.length);_t.push(bt(d.slice(yt+1,O)))}else throw new Error(j+" is not a valid character")}return Rf(_t,b,Rt)};function Rf(d,b,E){var S=m[0],R=m[1],O;for(O=d.length-1;O>=0;O--)S=S.add(d[O].times(R)),R=R.times(b);return E?S.negate():S}function sg(d,b){return b=b||i,d<b.length?b[d]:"<"+d+">"}function zi(d,b){if(b=qr(b),b.isZero()){if(d.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(b.equals(-1)){if(d.isZero())return{value:[0],isNegative:!1};if(d.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-d.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var E=Array.apply(null,Array(d.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return E.unshift([1]),{value:[].concat.apply([],E),isNegative:!1}}var S=!1;if(d.isNegative()&&b.isPositive()&&(S=!0,d=d.abs()),b.isUnit())return d.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(d.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:S};for(var R=[],O=d,Z;O.isNegative()||O.compareAbs(b)>=0;){Z=O.divmod(b),O=Z.quotient;var z=Z.remainder;z.isNegative()&&(z=b.minus(z).abs(),O=O.next()),R.push(z.toJSNumber())}return R.push(O.toJSNumber()),{value:R.reverse(),isNegative:S}}function Lf(d,b,E){var S=zi(d,b);return(S.isNegative?"-":"")+S.value.map(function(R){return sg(R,E)}).join("")}p.prototype.toArray=function(d){return zi(this,d)},g.prototype.toArray=function(d){return zi(this,d)},v.prototype.toArray=function(d){return zi(this,d)},p.prototype.toString=function(d,b){if(d===t&&(d=10),d!==10)return Lf(this,d,b);for(var E=this.value,S=E.length,R=String(E[--S]),O="0000000",Z;--S>=0;)Z=String(E[S]),R+=O.slice(Z.length)+Z;var z=this.sign?"-":"";return z+R},g.prototype.toString=function(d,b){return d===t&&(d=10),d!=10?Lf(this,d,b):String(this.value)},v.prototype.toString=g.prototype.toString,v.prototype.toJSON=p.prototype.toJSON=g.prototype.toJSON=function(){return this.toString()},p.prototype.valueOf=function(){return parseInt(this.toString(),10)},p.prototype.toJSNumber=p.prototype.valueOf,g.prototype.valueOf=function(){return this.value},g.prototype.toJSNumber=g.prototype.valueOf,v.prototype.valueOf=v.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};function $f(d){if(F(+d)){var b=+d;if(b===$t(b))return a?new v(BigInt(b)):new g(b);throw new Error("Invalid integer: "+d)}var E=d[0]==="-";E&&(d=d.slice(1));var S=d.split(/e/i);if(S.length>2)throw new Error("Invalid integer: "+S.join("e"));if(S.length===2){var R=S[1];if(R[0]==="+"&&(R=R.slice(1)),R=+R,R!==$t(R)||!F(R))throw new Error("Invalid integer: "+R+" is not a valid exponent.");var O=S[0],Z=O.indexOf(".");if(Z>=0&&(R-=O.length-Z-1,O=O.slice(0,Z)+O.slice(Z+1)),R<0)throw new Error("Cannot include negative exponent part for integers");O+=new Array(R+1).join("0"),d=O}var z=/^([0-9][0-9]*)$/.test(d);if(!z)throw new Error("Invalid integer: "+d);if(a)return new v(BigInt(E?"-"+d:d));for(var j=[],_t=d.length,Rt=e,yt=_t-Rt;_t>0;)j.push(+d.slice(yt,_t)),yt-=Rt,yt<0&&(yt=0),_t-=Rt;return nt(j),new p(j,E)}function ag(d){if(a)return new v(BigInt(d));if(F(d)){if(d!==$t(d))throw new Error(d+" is not an integer.");return new g(d)}return $f(d.toString())}function bt(d){return typeof d=="number"?ag(d):typeof d=="string"?$f(d):typeof d=="bigint"?new v(d):d}for(var gn=0;gn<1e3;gn++)m[gn]=bt(gn),gn>0&&(m[-gn]=bt(-gn));return m.one=m[1],m.zero=m[0],m.minusOne=m[-1],m.max=Fi,m.min=Gn,m.gcd=If,m.lcm=og,m.isInstance=function(d){return d instanceof p||d instanceof g||d instanceof v},m.randBetween=ng,m.fromArray=function(d,b,E){return Rf(d.map(bt),bt(b||10),E)},m}();typeof $s!="undefined"&&$s.hasOwnProperty("exports")&&($s.exports=qr);typeof define=="function"&&define.amd&&define(function(){return qr})});var Ss=bn(Vo());var hr=bn(Vo());var gg=bn(Vo());function _n(t,r){return t.compare(r)}function it(t,r){if(ot(t,r))return!0;if(H(t)){for(let e=0;e<t.tensor.nelem;e++)if(it(t.tensor.elem[e],r))return!0;return!1}return M(t)?[...t].some(e=>it(e,r)):!1}function hn(t,r){if(Se(t))return!1;if(rt(t)&&!qt(A(r))&&it(l(t),f.imaginaryunit)||rt(t)&&St(l(t),-1)&&!qt(A(r)))return!0;if(H(t)){for(let e=0;e<t.tensor.nelem;e++)if(hn(t.tensor.elem[e],r))return!0;return!1}return M(t)?[...t].some(e=>hn(e,r)):!1}function Fn(t){if(rt(t)&&l(t)===s(rr))return it(A(t),f.imaginaryunit);if(H(t)){for(let r=0;r<t.tensor.nelem;r++)if(Fn(t.tensor.elem[r]))return!0;return!1}return M(t)?[...t].some(Fn):!1}function Cf(t,r){let{ndim:e}=t.tensor,o=r.length;o>e&&N("too many indices for tensor");let n=0;for(let m=0;m<o;m++){let p=et(r[m]);(p<1||p>t.tensor.dim[m])&&N("index out of range"),n=n*t.tensor.dim[m]+p-1}if(e===o)return t.tensor.elem[n];n=t.tensor.dim.slice(o).reduce((m,p)=>m*p,n);let i=t.tensor.dim.slice(o).reduce((m,p)=>m*p,1),a=ct(i);a.tensor.ndim=e-o,a.tensor.dim=t.tensor.dim.slice(o);for(let m=0;m<i;m++)a.tensor.elem[m]=t.tensor.elem[n+m];return Dt(t),Dt(a),a}function Pf(t,...r){r.length<2&&N("error in indexed assign");let[e,...o]=r;H(e)||N("error in indexed assign: assigning to something that is not a tensor");let{ndim:n}=e.tensor,i=o.length;i>n&&N("error in indexed assign");let a=0;for(let p=0;p<i;p++){let g=et(o[p]);(g<1||g>e.tensor.dim[p])&&N(`error in indexed assign
`),a=a*e.tensor.dim[p]+g-1}for(let p=i;p<n;p++)a=a*e.tensor.dim[p]+0;let m=ct(e.tensor.nelem);if(m.tensor.ndim=e.tensor.ndim,m.tensor.dim=Array.from(e.tensor.dim),m.tensor.elem=Array.from(e.tensor.elem),Dt(e),Dt(m),e=m,n===i)return H(t)&&N("error in indexed assign"),e.tensor.elem[a]=t,Dt(e),e;H(t)||N("error in indexed assign"),n-i!==t.tensor.ndim&&N("error in indexed assign");for(let p=0;p<t.tensor.ndim;p++)e.tensor.dim[i+p]!==t.tensor.dim[p]&&N("error in indexed assign");for(let p=0;p<t.tensor.nelem;p++)e.tensor.elem[a+p]=t.tensor.elem[p];return Dt(e),Dt(t),e}function q(...t){let r=s(L);for(let e=t.length-1;e>=0;e--)r=new Rr(t[e],r);return r}function kf(t){let r=Oe(t),e=zn(t),o=A(t);return xt(r)||N("function name?"),u(o)===s(io)&&(o=_(l(o))),o=q(s(He),o,e),Jt(r,o),s(L)}function Df(t){return t}function Bf(t){t=c(t);let r=_(u(t));return M(t)&&(r=t.tail().reduce((e,o)=>bl(e,_(o)),r)),r}function bl(t,r){return $r(bg,t,r)}function bg(t,r){return gr($($(Lr(t,r),t),r))}function Uf(t){t=c(t);let r=_(u(t));return M(t)&&(r=t.tail().reduce((e,o)=>so(e,_(o)),r)),r}function so(t,r){return _g(t,r)}function _g(t,r){return X(t)?hg(t,r):H(t)?vg(t,r):it(t,r)?f.zero:t}function hg(t,r){return M(t)?t.tail().reduce((e,o)=>I(e,so(o,r)),f.zero):f.zero}function vg(t,r){let e=t.tensor.nelem,o=ct(e);return o.tensor.ndim=t.tensor.ndim,o.tensor.dim=Array.from(t.tensor.dim),o.tensor.elem=t.tensor.elem.map(n=>so(n,r)),o}function Gt(t,r,e){if(r===s(L)||e===s(L))return t;if(H(t)){let o=ct(t.tensor.nelem);return o.tensor.ndim=t.tensor.ndim,o.tensor.dim=Array.from(t.tensor.dim),o.tensor.elem=t.tensor.elem.map(n=>{let i=Gt(n,r,e);return Dt(o),i}),o}return ot(t,r)?e:M(t)?new Rr(Gt(u(t),r,e),Gt(c(t),r,e)):t}function Gf(t){let r=_(Ft(t)),e=_(A(t)),o=_(l(t));return r===s(L)&&(r=e,e=s(Xr)),so($(o,T(e,r)),e)}function Te(t,r){let e=[];for(;;){let o=_(Gt(t,r,f.zero));if(e.push(o),t=Q(t,o),ot(t,f.zero))return e;t=$r($,t,r)}}var yg=!1;function Ff(t){return Vi(_(l(t)))}function Vi(t){let r=q(s(ut),f.negOne,$(Mr(t),f.Pi())),e=x(be(t),r);return yg&&(console.log(`clockform: abs of ${t} : ${be(t)}`),console.log(`clockform: arg of ${t} : ${Mr(t)}`),console.log(`clockform: divide : ${$(Mr(t),f.Pi())}`),console.log(`clockform: power : ${r}`),console.log(`clockform: multiply : ${e}`)),e}function zf(t){return Zi(_(l(t)))}function Zi(t){return Vf(()=>x(be(t),lr(x(f.imaginaryunit,Mr(t)))))}function Zf(t){return t=_(l(t)),it(t,f.imaginaryunit)?Ne(t):Vi(Ne(Zi(t)))}function Ne(t){return _(Gt(t,f.imaginaryunit,U(f.imaginaryunit)))}function cr(t){return it(t,s(Xr))?s(Xr):it(t,s(ao))?s(ao):it(t,s(lo))?s(lo):it(t,s(Yo))?s(Yo):it(t,s(Zo))?s(Zo):s(Xr)}var Qf=bn(Vo());function Cs(t,r){return t.add(r)}function Yf(t,r){return t.subtract(r)}var jf=bn(Vo());function Qe(t,r){return jf.default.gcd(t,r)}function yr(t,r){return t.multiply(r)}function kr(t,r){return t.divide(r)}function Vn(t,r){return t.mod(r)}function Hf(t,r){let e=t.divmod(r);return[e.quotient,e.remainder]}function Ps(t){return t.isProbablePrime()}var wr=(0,Qf.default)(0);function Jf(t){if(St(t,0)||St(t,1)||St(t,-1))return t;wr=t.q.a;let r=Eg();return r.length==1?r[0]:q(s(Ht),...r)}function Eg(){let t=[];wr.isNegative()&&(wr=Zn(wr,1),t.push(f.negOne));for(let r=0;r<1e4;r++)if(t.push(...Ag(r)),wr.compare(1)===0)return t;return t.push(...qg()),t}function Ag(t){let r=[],e,o=Lo(Yn[t]),n=0;for(;;){if(wr.compare(1)===0)return n&&r.push(Yi(o,n)),r;let i;if([e,i]=Array.from(Hf(wr,o)),i.isZero())n++,wr=e;else break}return n&&r.push(Yi(o,n)),_n(e,o)===-1&&(r.push(Yi(wr,1)),wr=Lo(1)),r}function qg(){let t=[],r=Lo(1),e=Lo(5),o=Lo(2),n=1,i=1;for(;;){if(Ps(wr))return t.push(Yi(wr,1)),t;for(;;){h.esc_flag&&N("esc");let a=Yf(o,e);a=Zn(a,1);let m=Qe(a,wr);if(Wt(m,1)){--n==0&&(o=e,i*=2,n=i),a=yr(e,e),e=Cs(a,r),a=Vn(e,wr),e=a;continue}if(t.push(Yi(m,1)),_n(m,wr)===0)return t;a=kr(wr,m),wr=a,a=Vn(e,wr),e=a,a=Vn(o,wr),o=a;break}}}function Yi(t,r){let e=new Tt(t);return r>1&&(e=q(s(ut),e,new Tt(Lo(r)))),e}function Wf(t){let r=_(l(t)),e=_(A(t)),o=e===s(L)?cr(r):e,n=ji(r,o);return t=jo(t),M(t)&&(n=[...t].reduce((i,a)=>Mg(i,_(a)),n)),n}function Mg(t,r){if(Y(t)){let o=[];return t.tail().forEach(n=>Xf(o,n,r)),ks(o)}let e=[];return Xf(e,t,r),e[0]}function Xf(t,r,e){let o=_e(r,e);if(Y(o)){t.push(...o.tail());return}t.push(o)}function ji(t,r){return qt(t)?Jf(t):_e(t,r)}function vn(t){isNaN(t)&&N("number too big to factor");let r=[];t<0&&(t=-t);for(let e=0;e<jn;e++){let o=Yn[e];if(o>t/o)break;let n=0;for(;t%o==0;)t/=o,n++;n&&(r.push(y(o)),r.push(y(n)))}return t>1&&(r.push(y(t)),r.push(f.one)),r}function Kf(t){let r=Ds(t),e=r.length;r.sort(Ie);let o=ct(e);return o.tensor.ndim=1,o.tensor.dim[0]=e,o.tensor.elem=r,o}var wg=t=>[].concat(...t);function Ds(t){let r=[];if(C(t))r.push(...vn(et(t)));else if(X(t))r.push(...Sg(t));else if(Y(t)){if(t=c(t),C(u(t))&&(r.push(...vn(et(u(t)))),t=c(t)),M(t)){let o=[...t].map(n=>rt(n)?[l(n),A(n)]:[n,f.one]);r.push(...wg(o))}}else rt(t)?r.push(l(t),A(t)):r.push(t,f.one);let e=r.length;return r.push(f.one),tu(r,0,e),r.slice(e)}function tu(t,r,e){let o=t.pop();if(r===e){t.push(o);return}let n=t[r+0],i=t[r+1],a=et(i);if(!isNaN(a))for(let m=0;m<=Math.abs(a);m++)t.push(x(o,T(n,y(yn(a)*m)))),tu(t,r+2,e)}function Sg(t){let r=M(t)?t.tail().reduce(Lr):u(t),e=[],o=r;if(Et(o))return e.push(t,f.one),e;if(C(o))e.push(...vn(et(o)));else if(Y(o)){let i=c(o);C(u(i))?e.push(...vn(et(u(i)))):e.push(u(i),f.one),M(i)&&i.tail().forEach(a=>e.push(a,f.one))}else e.push(o,f.one);o=gr(o);let n=M(t)?t.tail().reduce((i,a)=>I(i,x(o,a)),f.zero):c(t);return e.push(n,f.one),e}function ru(t){let r=_(l(t)),e=_(A(t)),o=_(Ft(t));return o===s(L)&&(o=s(Xr)),Hi(r,e,o)}function Hi(t,r,e){let o=Te(t,e),n=o.length-1,i=Te(r,e),a=i.length-1,m=n-a,p=f.zero;for(;m>=0;){let g=$(o[n],i[a]);for(let v=0;v<=a;v++)o[m+v]=Q(o[m+v],x(i[v],g));p=I(p,x(g,T(e,y(m)))),n--,m--}return p}function eu(t){return br(_(l(t)))}function br(t){return X(t)?Og(t):ou(t)}function Og(t){let r=c(t);for(;M(r);){let e=u(r);if(Hn(e)){let o=Q(t,e);return I(x(br(o),Sr(e)),x(Sr(o),br(e)))}r=c(r)}return ou(t)}function ou(t){if(u(t)===s(Je))return l(t);if(K(t)){let e=Math.sin(t.d);return Math.abs(e)<1e-10&&(e=0),tt(e)}if(ie(t))return U(br(U(t)));if(u(t)===s(zr))return x(l(t),T(I(f.one,T(l(t),y(2))),P(-1,2)));let r=et($(x(t,y(180)),f.Pi()));if(r<0||isNaN(r))return q(s(fr),t);switch(r%360){case 0:case 180:return f.zero;case 30:case 150:return P(1,2);case 210:case 330:return P(-1,2);case 45:case 135:return x(P(1,2),T(y(2),P(1,2)));case 225:case 315:return x(P(-1,2),T(y(2),P(1,2)));case 60:case 120:return x(P(1,2),T(y(3),P(1,2)));case 240:case 300:return x(P(-1,2),T(y(3),P(1,2)));case 90:return f.one;case 270:return f.negOne;default:return q(s(fr),t)}}function nu(t){return Sr(_(l(t)))}function Sr(t){return X(t)?Tg(t):iu(t)}function Tg(t){if(M(t)){for(let r of t.tail())if(Hn(r)){let e=Q(t,r);return Q(x(Sr(e),Sr(r)),x(br(e),br(r)))}}return iu(t)}function iu(t){if(u(t)===s(We))return l(t);if(K(t)){let e=Math.cos(t.d);return Math.abs(e)<1e-10&&(e=0),tt(e)}if(ie(t)&&(t=U(t)),u(t)===s(zr)){let e=I(f.one,T(l(t),y(2)));return T(e,P(-1,2))}let r=et($(x(t,y(180)),f.Pi()));if(r<0||isNaN(r))return q(s(ur),t);switch(r%360){case 90:case 270:return f.zero;case 60:case 300:return P(1,2);case 120:case 240:return P(-1,2);case 45:case 315:return x(P(1,2),T(y(2),P(1,2)));case 135:case 225:return x(P(-1,2),T(y(2),P(1,2)));case 30:case 330:return x(P(1,2),T(y(3),P(1,2)));case 150:case 210:return x(P(-1,2),T(y(3),P(1,2)));case 0:return f.one;case 180:return f.negOne;default:return q(s(ur),t)}}var Qi=!1;function su(t){return Or(_(l(t)))}function Or(t){let r=t;if(Qi&&(console.log(`RECT of ${r}`),console.log(`any clock forms in : ${r} ? ${hn(r,t)}`)),xt(t))return Qi&&console.log(` rect: simple symbol: ${r}`),V(pt(s(fo)))?q(s(Bs),t):t;if(!V(pt(s(fo)))&&!Fn(t)&&!hn(t,t)&&!(it(t,s(fr))&&it(t,s(ur))&&it(t,f.imaginaryunit)))return Qi&&console.log(` rect: simple symbol: ${r}`),t;if(Y(t)&&Se(l(t))&&!V(pt(s(fo))))return t;if(X(t))return Qi&&console.log(` rect - ${r} is a sum `),t.tail().reduce((o,n)=>I(o,Or(n)),f.zero);let e=x(be(t),I(Sr(Mr(t)),x(f.imaginaryunit,br(Mr(t)))));return Qi&&(console.log(` rect - ${r} is NOT a sum `),console.log(` rect - ${r} abs: ${be(t)}`),console.log(` rect - ${r} arg of ${t} : ${t}`),console.log(` rect - ${r} cosine: ${Sr(Mr(t))}`),console.log(` rect - ${r} sine: ${br(Mr(t))}`),console.log(` rect - ${r} i * sine: ${x(f.imaginaryunit,br(Mr(t)))}`),console.log(` rect - ${r} cos + i * sine: ${I(Sr(Mr(t)),x(f.imaginaryunit,br(Mr(t))))}`),console.log(`rect of ${r} : ${e}`)),e}function _e(t,r){return!it(t,r)||!Dr(t,r)||!xt(r)?t:Ng(t,r)}function Ng(t,r){let e,o,n,i;En(t)&&N("floating point numbers in polynomial");let a=Te(t,r),m=a.length-1,p=Ig(a),g="real",v=null;for(;m>0;){var F,B;if(V(a[0])?(e=f.one,o=f.zero):g==="real"?[B,e,o]=Rg(a,m,r,e,o):g==="complex"&&([F,e]=Lg(v,a,m)),g==="real")if(B===!1){g="complex";continue}else{for(n=I(x(e,r),o),D&&console.log(`success
FACTOR=${n}`),p=uo(p,n),$g(e,o,a,m);m&&V(a[m]);)m--;let nt=f.zero;for(let ht=0;ht<=m;ht++)nt=I(nt,x(a[ht],T(r,y(ht))));v=nt}else if(g==="complex"){if(F===!1)break;{let nt=Q(e,r),ht=Q(Ne(e),r);n=x(nt,ht),D&&console.log(`success
FACTOR=${n}`);let $t=p;if(p=uo(p,n),v==null){let vr=f.zero;for(let Ir=0;Ir<=m;Ir++)vr=I(vr,x(a[Ir],T(r,y(Ir))));v=vr}let pr=r,ar=n,kt=v;v=Hi(kt,ar,pr);let nr=x(v,n);if(!ot(nr,kt))return D&&(console.log("we found a polynomial based on complex root and its conj but it doesn't divide the poly, quitting"),console.log(`so just returning previousFactorisation times dividend: ${$t} * ${kt}`)),uo($t,Vr(Qn,kt));for(let vr=0;vr<=m;vr++)a.pop();a.push(...Te(v,r)),m-=2}}}let J=f.zero;for(let nt=0;nt<=m;nt++)J=I(J,x(a[nt],T(r,y(nt))));return t=J,D&&console.log(`POLY=${t}`),t=Vr(Qn,t),m>0&&Ct(a[m])&&(t=U(t),p=au(p)),p=uo(p,t),D&&console.log(`RESULT=${p}`),p}function Ig(t){let r=f.one;for(let e of t)r=bl(Cr(e),r);for(let e=0;e<t.length;e++)t[e]=x(r,t[e]);return r=he(r),D&&console.log("rationalize_coefficients result"),r}function Rg(t,r,e,o,n){let i,a,m;if(D){let v=f.zero;for(let F=0;F<=r;F++)v=I(v,x(t[F],T(e,y(F))));i=v,console.log(`POLY=${i}`)}let p=Ds(t[r]),g=Ds(t[0]);if(D){console.log("divisors of base term");for(let v=0;v<g.length;v++)console.log(`, ${g[v]}`);console.log("divisors of leading term");for(let v=0;v<p.length;v++)console.log(`, ${p[v]}`)}for(let v=0;v<p.length;v++)for(let F=0;F<g.length;F++){if(o=p[v],n=g[F],a=U($(n,o)),m=Ji(a,t,r),D&&console.log(`try A=${o}
, B=${n}
, root ${e}
=-B/A=${a}
, POLY(${a}
)=${m}`),V(m))return D&&console.log("get_factor_from_real_root returning true"),[!0,o,n];if(n=U(n),a=U(a),m=Ji(a,t,r),D&&console.log(`try A=${o}
, B=${n}
, root ${e}
=-B/A=${a}
, POLY(${a}
)=${m}`),V(m))return D&&console.log("get_factor_from_real_root returning true"),[!0,o,n]}return D&&console.log("get_factor_from_real_root returning false"),[!1,o,n]}function Lg(t,r,e){let o,n,i,a;if(e<=2)return D&&console.log("no more factoring via complex roots to be found in polynomial of degree <= 2"),[!1,n];if(o=t,D&&console.log(`complex root finding for POLY=${o}`),n=Or(T(f.negOne,P(2,3))),D&&console.log(`complex root finding: trying with ${n}`),i=n,a=Ji(i,r,e),D&&console.log(`complex root finding result: ${a}`),V(a))return D&&console.log("get_factor_from_complex_root returning true"),[!0,n];if(n=Or(T(f.one,P(2,3))),D&&console.log(`complex root finding: trying with ${n}`),i=n,a=Ji(i,r,e),D&&console.log(`complex root finding result: ${a}`),V(a))return D&&console.log("get_factor_from_complex_root returning true"),[!0,n];for(let m=-10;m<=10;m++)for(let p=1;p<=5;p++){n=Or(I(y(m),x(y(p),f.imaginaryunit)));let v=Ji(n,r,e);if(V(v))return D&&console.log(`found complex root: ${v}`),[!0,n]}return D&&console.log("get_factor_from_complex_root returning false"),[!1,n]}function $g(t,r,e,o){let n=f.zero;for(let i=o;i>0;i--){let a=$(e[i],t);e[i]=n,n=a,e[i-1]=Q(e[i-1],x(n,r))}e[0]=n,D&&console.log("yydivpoly Q:")}function Ji(t,r,e){let o=f.zero;for(let n=e;n>=0;n--)D&&(console.log("Evalpoly top of stack:"),console.log(Kr(o))),o=I(x(o,t),r[n]);return o}function lu(t){t=c(t);let r=_(u(t));return M(t)&&(r=t.tail().reduce((e,o)=>Lr(e,_(o)),r)),r}function Lr(t,r){return $r(Cg,t,r)}function Cg(t,r){let e;return ot(t,r)?t:lt(t)&&lt(r)?cu(t,r):(e=_l(t,r))?Pg(t,r,e):X(t)&&X(r)?kg(t,r):(X(t)&&(t=mu(t)),X(r)&&(r=mu(r)),Y(t)?Dg(t,r):Y(r)?Bg(t,r):Y(t)&&Y(r)?fu(t,r):uu(t,r))}function _l(t,r){let e;if((e=hl(t))&&hl(r,e))return e}function Pg(t,r,e){return t=_e(t,e),r=_e(r,e),(Y(t)||Y(r))&&(Y(t)||(t=q(s(Ht),t,f.one)),Y(r)||(r=q(s(Ht),r,f.one))),Y(t)&&Y(r)?fu(t,r):uu(t,r)}function fu(t,r){let e=c(t),o=c(r);if(M(e))return[...e].reduce((n,i)=>{if(M(o))return x(n,[...o].reduce((a,m)=>x(a,Lr(i,m)),f.one))},f.one)}function uu(t,r){let e,o,n;if(rt(t)?(e=A(t),t=l(t)):e=f.one,rt(r)?(o=A(r),r=l(r)):o=f.one,!ot(t,r))return f.one;if(C(e)&&C(o)){let m=mr(e,o)?e:o;return T(t,m)}let i=$(e,o);if(C(i)){i=Y(e)&&C(l(e))?l(e):f.one,n=Y(o)&&C(l(o))?l(o):f.one;let m=mr(i,n)?e:o;return T(t,m)}if(i=Q(e,o),!C(i))return f.one;let a=It(i)?e:o;return T(t,a)}function kg(t,r){let e,o,n,i;return _r(t)!==_r(r)?f.one:(e=M(t)?t.tail().reduce(Lr):u(c(t)),o=M(r)?r.tail().reduce(Lr):u(c(r)),n=$(t,e),i=$(r,o),ot(n,i)?x(n,Lr(e,o)):f.one)}function mu(t){return M(t)?t.tail().reduce(Lr):u(c(t))}function Dg(t,r){return M(t)?t.tail().reduce((e,o)=>x(e,Lr(o,r)),f.one):f.one}function Bg(t,r){return M(r)?r.tail().reduce((e,o)=>x(e,Lr(t,o)),f.one):f.one}function du(t){return Jn(_(l(t)))}function Jn(t){return Vr(Qn,t)}function Qn(t){if(!X(t))return t;let r=t.tail().reduce(Lr),e=gr(r),o=t.tail().reduce((i,a)=>I(i,uo(e,a)),f.zero),n=vl(o);return $(n,e)}function pu(t){return te(_(l(t)))}function te(t){let r=h.expanding,e=Ug(t);return h.expanding=r,e}function Ug(t){if(H(t))return Fg(t);if(h.expanding=!1,!X(t))return t;let r=Gg(t),e=f.zero;return M(t)&&(e=t.tail().reduce((o,n)=>I(o,x(r,n)),e)),$(Jn(e),r)}function Gg(t){return X(t)?t.tail().reduce((r,e)=>xu(e,r),f.one):xu(t,f.one)}function xu(t,r){return Y(t)?t.tail().reduce((e,o)=>gu(o,e),r):gu(t,r)}function gu(t,r){if(!rt(t))return r;let e=t;return t=A(t),It(t)?bu(r,gr(e)):Y(t)&&It(l(t))?bu(r,gr(e)):r}function Fg(t){return t=_(t),H(t)&&(t.tensor.elem=t.tensor.elem.map(te),Dt(t)),t}function bu(t,r){return $(x(t,r),Lr(t,r))}function _u(t){return Cr(_(l(t)))}function Cr(t){return X(t)&&(t=te(t)),Y(t)&&!Et(u(c(t)))?se(t.tail().map(Cr)):lt(t)?Re(t):rt(t)&&Ct(A(t))?he(t):f.one}function hu(t){return Zr(_(l(t)))}function Zr(t){return X(t)&&(t=te(t)),Y(t)&&!Et(u(c(t)))?se(t.tail().map(Zr)):lt(t)?Le(t):rt(t)&&Ct(A(t))?f.one:t}function vu(t){return Us(_(l(t)))}function Us(t){if(u(t)===s(ve))return l(t);if(K(t))return tt(Math.atan(t.d));if(V(t))return f.zero;if(ie(t))return U(Us(U(t)));if(it(t,s(fr))&&it(t,s(ur))){let r=Zr(t),e=Cr(t);if(u(r)===s(fr)&&u(e)===s(ur)&&ot(l(r),l(e)))return l(r)}return rt(t)&&St(l(t),3)&&zt(A(t),-1,2)||Y(t)&&zt(u(c(t)),1,3)&&u(u(c(c(t))))===s(ut)&&St(u(c(u(c(c(t))))),3)&&zt(u(c(c(u(c(c(t)))))),1,2)?x(P(1,6),f.Pi()):St(t,1)?x(P(1,4),f.Pi()):rt(t)&&St(l(t),3)&&zt(A(t),1,2)?x(P(1,3),f.Pi()):q(s(zr),t)}var zg=!1;function yu(t){return Ho(_(l(t)))}function Ho(t){let r=Or(t),e=Ne(r),o=$(Q(r,e),y(2)),n=$(o,f.imaginaryunit);return zg&&(console.log(`IMAGE of ${r}`),console.log(` image: conjugate result: ${e}`),console.log(` image: 1st divide result: ${o}`),console.log(` image: 2nd divide result: ${n}`)),n}function Eu(t){return Yr(_(l(t)))}function Yr(t){let r=Or(t);return $(I(r,Ne(r)),y(2))}var Vg=!1;function Au(t){return Mr(_(l(t)))}function Mr(t){return Q(qu(Zr(t)),qu(Cr(t)))}function qu(t){if(An(t)||t===s(vt))return K(t)||h.evaluatingAsFloats?f.zeroAsDouble:f.zero;if(It(t)){let r=K(t)||h.evaluatingAsFloats?f.piAsDouble:s(vt);return U(r)}if(xt(t))return q(s(Wi),t);if(rt(t)&&St(l(t),-1))return x(f.Pi(),A(t));if(rt(t)&&l(t)===s(rr))return Ho(A(t));if(rt(t)&&$e(A(t))){let r=Mr(l(t));return Vg&&(console.log(`arg of a sqrt: ${t}`),er,console.log(` = 1/2 * ${r}`)),x(r,A(t))}if(Y(t))return t.tail().map(Mr).reduce(I,f.zero);if(X(t)){t=Or(t);let r=Yr(t),e=Ho(t);if(V(r))return ie(e)?U(f.Pi()):f.Pi();{let o=Us($(e,r));return ie(r)?ie(e)?Q(o,f.Pi()):I(o,f.Pi()):o}}return V(pt(s(fo)))?q(s(Wi),t):f.zero}function Mu(t,r){if(t===0&&r<0&&N("divide by zero"),t>=0||r%1==0)return tt(Math.pow(t,r));let e=Math.pow(Math.abs(t),r),o=Math.PI*r,n=0,i=0;return r%.5==0?(n=0,i=Math.sin(o)):(n=Math.cos(o),i=Math.sin(o)),I(tt(n*e),x(tt(i*e),f.imaginaryunit))}function Ar(t){let r=et(t);return r<0||isNaN(r)?q(s(Br),t):wu(r)}var Nu=bn(Vo());function $o(t,r){return t.pow(r)}var Xi=bn(Vo());function Su(t,r){t=t.abs(),r===0&&N("root index is zero");let e=0;for(;t.shiftRight(e).toJSNumber()>0;)e++;if(e===0)return Lo(0);e=Math.floor((e-1)/r);let o=Math.floor(e/32+1),n=(0,Xi.default)(o);for(let i=0;i<o;i++)n=n.and((0,Xi.default)(1).shiftLeft(i).not());for(;e>=0;){n=n.or((0,Xi.default)(1).shiftLeft(e));let i=$o(n,r);switch(_n(i,t)){case 0:return n;case 1:n=n.and((0,Xi.default)(1).shiftLeft(e).not());break}e--}return 0}function Ou(t,r){let e=vn(et(t)),o=e.length;for(let n=0;n<o;n+=2)e.push(...Zg(e[n],x(e[n+1],r)));return se(e.slice(o))}function Zg(t,r){let e=Gs(r),o=Q(r,e),n;V(o)||(n=q(s(ut),t,o));let i=et(e);if(isNaN(i)){let m=q(s(ut),t,e);return n?[n,m]:[m]}if(i===0)return[n];let a=Tu(t,i);return n?[n,a]:[a]}function Wn(t,r){return Yg(t,r)}function Yg(t,r){if(Et(t)||V(r))return f.one;if(Nt(t)&&$e(r))return f.imaginaryunit;if(V(t))return It(r)&&N("divide by zero"),f.zero;if(Et(r))return t;let e=0,o,n;if(qt(r)){if(e=et(r),isNaN(e))return q(s(ut),t,r);if(o=$o(t.q.a,Math.abs(e)),n=$o(t.q.b,Math.abs(e)),e<0){let m=o;o=n,n=m,o=mo(o,n),n=Iu(n)}return new Tt(o,n)}if(Nt(t))return jg(r);if(It(t))return x(Wn(U(t),r),Wn(f.negOne,r));if(!qt(t))return x(Wn(Le(t),r),Wn(Re(t),U(r)));if(Hg(t))return Ou(t,r);if(!Ki(r.q.a)||!Ki(r.q.b))return q(s(ut),t,r);let{a:i,b:a}=r.q;return o=Su(t.q.a,a.toJSNumber()),o===0?q(s(ut),t,r):(n=$o(o,i),r.q.a.isNegative()?new Tt(Nu.default.one,n):new Tt(n))}function jg(t){if(qt(t))return t.q.a.isOdd()?f.negOne:f.one;let r=Gs(t);It(t)&&(r=I(r,f.negOne));let e=Q(t,r),o=q(s(ut),f.negOne,e);return r.q.a.isOdd()&&(o=U(o)),o}function Hg(t){return Ki(t.q.a)}var Vt=!1;function Ru(t){Vt&&er;let r=_(l(t)),e=_(A(t));return T(r,e)}function T(t,r){return Qg(t,r)}function Qg(t,r){Vt&&er;let e=r,o=t;if(Vt&&console.log(`POWER: ${t} ^ ${r}`),ot(t,f.one)||V(r)){let g=f.One();return Vt&&console.log(`   power of ${o} ^ ${e}: ${g}`),g}if(ot(r,f.one))return Vt&&console.log(`   power of ${o} ^ ${e}: ${t}`),t;if(Nt(t)&&Nt(r)){let g=U(f.One());return Vt&&console.log(`   power of ${o} ^ ${e}: ${g}`),g}if(Nt(t)&&$e(r)){let g=f.imaginaryunit;return Vt&&console.log(`   power of ${o} ^ ${e}: ${g}`),g}if(Nt(t)&&ts(r)){let g=U(f.imaginaryunit);return Vt&&console.log(`   power of ${o} ^ ${e}: ${g}`),g}let n;if(Nt(t)&&!K(t)&&lt(r)&&!qt(r)&&An(r)&&!h.evaluatingAsFloats){Vt&&(console.log("   power: -1 ^ rational"),console.log(` trick: exponent.q.a , exponent.q.b ${r.q.a} , ${r.q.b}`)),r.q.a<r.q.b?n=q(s(ut),t,r):(n=q(s(Ht),t,q(s(ut),t,P(r.q.a.mod(r.q.b),r.q.b))),Vt&&console.log(` trick applied : ${n}`));let g=Or(n);return Vt&&console.log(`   power of ${o} ^ ${e}: ${g}`),g}if(lt(t)&&lt(r)){Vt&&console.log("   power: isrational(base) && isrational(exponent)");let g=Wn(t,r);return Vt&&console.log(`   power of ${o} ^ ${e}: ${g}`),g}if(C(t)&&C(r)){let g=Mu(co(t),co(r));return Vt&&(console.log("   power: both base and exponent are either rational or double "),console.log("POWER - isNumericAtom(base) && isNumericAtom(exponent)"),console.log(`   power of ${o} ^ ${e}: ${g}`)),g}if(H(t)){let g=Cu(t,r);return Vt&&(console.log("   power: istensor(base) "),console.log(`   power of ${o} ^ ${e}: ${g}`)),g}if(u(t)===s(Ce)&&qn(r)&&!V(pt(s(fo)))){let g=T(l(t),r);return Vt&&(console.log("   power: even power of absolute of real value "),console.log(`   power of ${o} ^ ${e}: ${g}`)),g}if(t===s(rr)&&u(r)===s(Jo)){let g=l(r);return Vt&&console.log(`   power of ${o} ^ ${e}: ${g}`),g}if(t===s(rr)&&K(r)){let g=tt(Math.exp(r.d));return Vt&&(console.log("   power: base == symbol(E) && isdouble(exponent) "),console.log(`   power of ${o} ^ ${e}: ${g}`)),g}if(t===s(rr)&&it(r,f.imaginaryunit)&&it(r,s(vt))&&!h.evaluatingPolar){let g=q(s(ut),t,r);Vt&&console.log(`   power: turning complex exponential to rect: ${g}`);let v=Or(g);if(!it(v,s(vt)))return Vt&&console.log(`   power: turned complex exponential to rect: ${v}`),v}if(Y(t)&&qt(r)){t=c(t);let g=T(u(t),r);return M(t)&&(g=t.tail().reduce((v,F)=>x(v,T(F,r)),g)),Vt&&(console.log("   power: (a * b) ^ c  ->  (a ^ c) * (b ^ c) "),console.log(`   power of ${o} ^ ${e}: ${g}`)),g}let i=!1;if(C(l(t))&&(i=yn(Fs(l(t),f.zero))>0),rt(t)&&(qt(r)||i)){let g=T(l(t),x(A(t),r));return Vt&&console.log(`   power of ${o} ^ ${e}: ${g}`),g}let a=!1;if(qn(A(t))){let g=x(A(t),r);Xe(g)&&(a=!0)}if(rt(t)&&a){let g=be(l(t));return Vt&&(console.log("   power: car(base) == symbol(POWER) && b_isEven_and_c_isItsInverse "),console.log(`   power of ${o} ^ ${e}: ${g}`)),g}if(h.expanding&&X(t)&&C(r)){let g=et(r);if(g>1&&!isNaN(g)){Vt&&console.log("   power: expanding && isadd(base) && isNumericAtom(exponent) ");let v=Jg(g,t);return Vt&&console.log(`   power of ${o} ^ ${e}: ${v}`),v}}if(h.trigmode===1&&u(t)===s(fr)&&qn(r)){let g=T(Q(f.one,T(Sr(l(t)),y(2))),x(r,P(1,2)));return Vt&&(console.log("   power: trigmode == 1 && car(base) == symbol(SIN) && iseveninteger(exponent) "),console.log(`   power of ${o} ^ ${e}: ${g}`)),g}if(h.trigmode===2&&u(t)===s(ur)&&qn(r)){let g=T(Q(f.one,T(br(l(t)),y(2))),x(r,P(1,2)));return Vt&&(console.log("   power: trigmode == 2 && car(base) == symbol(COS) && iseveninteger(exponent) "),console.log(`   power of ${o} ^ ${e}: ${g}`)),g}if(Qo(t)){if(Vt&&console.log(" power - handling the case (a + ib) ^ n"),qt(r)){let g=Ne(t),v=$(g,x(g,t));return Xe(r)||(v=T(v,U(r))),Vt&&console.log(`   power of ${o} ^ ${e}: ${v}`),v}if(C(r)){let g=h.evaluatingAsFloats||$u(t)&&K(r)?tt(Math.PI):s(vt),v=x(T(be(t),r),T(f.negOne,$(x(Mr(t),r),g)));return Pu&&it(v,s(zr))&&(v=q(s(ut),t,r)),Vt&&console.log(`   power of ${o} ^ ${e}: ${v}`),v}}let m=Wg(r);if(m!==void 0)return Vt&&console.log("   power: using simplify_polar"),m;let p=q(s(ut),t,r);return Vt&&(console.log("   power: nothing can be done "),console.log(`   power of ${o} ^ ${e}: ${p}`)),p}function Jg(t,r){let e=[],o=_r(r)-1,n=[];r=c(r);for(let i=0;i<o;i++){for(let a=0;a<=t;a++)n[i*(t+1)+a]=T(u(r),y(a));r=c(r)}r=Ar(y(t));for(let i=0;i<o;i++)e[i]=0;return Lu(o,t,e,0,t,n,r,f.zero)}function Lu(t,r,e,o,n,i,a,m){if(o<t-1){for(let g=0;g<=n;g++)e[o]=g,m=Lu(t,r,e,o+1,n-g,i,a,m);return m}e[o]=n;let p=a;for(let g=0;g<t;g++)p=$(p,Ar(y(e[g])));for(let g=0;g<t;g++)p=x(p,i[g*(r+1)+e[g]]);return I(m,p)}function Wg(t){let r=rs(t);switch(r){case 0:break;case 1:return f.one;case 2:return f.negOne;case 3:return f.imaginaryunit;case 4:return U(f.imaginaryunit)}if(X(t)){let e=c(t);for(;M(e)&&(r=rs(u(e)),!r);)e=c(e);let o;switch(r){case 0:return;case 1:o=f.one;break;case 2:o=f.negOne;break;case 3:o=f.imaginaryunit;break;case 4:o=U(f.imaginaryunit);break}return x(o,lr(Q(t,u(e))))}}function ku(t){let r=_(l(t));return t=Er(t),M(t)&&(r=[...t].reduce((e,o)=>x(e,_(o)),r)),r}function x(t,r){return h.esc_flag&&N("escape key stop"),C(t)&&C(r)?es(t,r):Xg(t,r)}function Xg(t,r){if(Xn(t)||Xn(r))return f.Zero();if(h.expanding&&X(t))return t.tail().reduce((p,g)=>I(p,x(g,r)),f.Zero());if(h.expanding&&X(r))return r.tail().reduce((p,g)=>I(p,x(t,g)),f.Zero());if(!H(t)&&H(r))return ti(t,r);if(H(t)&&!H(r))return Kn(t,r);t=Y(t)?c(t):q(t),r=Y(r)?c(r):q(r);let e=[];if(C(u(t))&&C(u(r))){let p=u(t),g=u(r);e.push(es(p,g)),t=c(t),r=c(r)}else C(u(t))?(e.push(u(t)),t=c(t)):C(u(r))?(e.push(u(r)),r=c(r)):e.push(f.One());let[o,n]=zs(t),[i,a]=Vs(r);for(;M(t)&&M(r);){if(jr(t)===s(Wo)&&jr(r)===s(Wo)){e.push(new Rr(s(Wo),Du(os(t),os(r)))),t=c(t),r=c(r),[o,n]=zs(t),[i,a]=Vs(r);continue}switch(Ie(o,i)){case-1:e.push(u(t)),t=c(t),[o,n]=zs(t);break;case 1:e.push(u(r)),r=c(r),[i,a]=Vs(r);break;case 0:Kg(e,i,n,a),t=c(t),r=c(r),[o,n]=zs(t),[i,a]=Vs(r);break;default:N("internal error 2")}}if(M(t)&&e.push(...t),M(r)&&e.push(...r),tb(e),h.expanding){for(let p=0;p<e.length;p++)if(X(e[p]))return se(e)}let m=e.length;return m===1?e.pop():lt(e[0])&&St(e[0],1)?m===2?e.pop():(e[0]=s(Ht),q(...e)):new Rr(s(Ht),q(...e))}function zs(t){let r=u(t),e=f.One();return rt(r)&&(e=A(r),r=l(r)),[r,e]}function Vs(t){let r=u(t),e=f.One();return rt(r)&&(e=A(r),r=l(r)),[r,e]}function Kg(t,r,e,o){let n=T(r,I(e,o));if(C(n))t[0]=es(t[0],n);else if(Y(n))if(C(l(n))&&jo(n)===s(L)){let i=t[0],a=l(n);t[0]=es(i,a),t.push(A(n))}else t.push(n);else t.push(n)}function uo(t,r){return Vr(x,t,r)}function se(t){if(t.length===1)return t[0];if(t.length===0)return f.One();let r=t[0];for(let e=1;e<t.length;e++)r=x(r,t[e]);return r}function ks(t){return Vr(se,t)}function $(t,r){return C(t)&&C(r)?Bu(t,r):x(t,gr(r))}function gr(t){return C(t)?Uu(t):T(t,f.negOne)}function he(t){return gr(t)}function U(t){return C(t)?Gu(t):x(t,f.NegOne())}function au(t){return Vr(U,t)}function tb(t){let r=0;if(Et(t[0])||Nt(t[0])||K(t[0]))return;for(r=1;r<t.length&&!yl(t[r]);r++);if(r===t.length)return;let e=Le(t[0]);for(let n=1;n<t.length&&!(Et(e)||Nt(e));n++){if(!yl(t[n]))continue;let i=l(t[n]),a=A(t[n]);if(!It(a))continue;let m=$(e,i);!qt(m)||(e=m,t[n]=q(s(ut),i,I(f.One(),a)))}let o=Re(t[0]);for(let n=1;n<t.length&&!Et(o);n++){if(!yl(t[n]))continue;let i=l(t[n]),a=A(t[n]);if(It(a))continue;let m=$(o,i);if(!qt(m))continue;o=m;let p=Q(a,f.one);if(Fu&&qt(i)&&!qt(p)&&It(p)){e=$(e,i);break}t[n]=q(s(ut),i,p)}t[0]=$(e,o)}function yl(t){return rt(t)&&C(l(t))&&or(A(t))&&!Nt(l(t))}function Zs(t){if(!Co(t))return q(s(js),t);let r=t.tensor.elem;return r.every(o=>C(o))?rb(t):El(r,t.tensor.dim[0])}function El(t,r){let e=0,o=[];for(let a=0;a<r;a++)o[a]=a,o[a+r]=0,o[a+r+r]=1;let n=1,i=f.zero;for(;;){let a=y(n);for(let F=0;F<r;F++){let B=r*o[F]+F;a=x(a,t[B])}i=I(i,a);let m=r-1,p=0,g=!1;for(;;){if(e=o[r+m]+o[r+r+m],e<0){o[r+r+m]=-o[r+r+m],m--;continue}if(e===m+1){if(m===0){g=!0;break}p++,o[r+r+m]=-o[r+r+m],m--;continue}break}if(g)break;let v=o[m-o[r+m]+p];o[m-o[r+m]+p]=o[m-e+p],o[m-e+p]=v,o[r+m]=e,n=n===1?-1:1}return i}function rb(t){let r=t.tensor.dim[0],e=[...t.tensor.elem];return eb(e,r)}function po(t,r,e,o){return t[r*e+o]}function Ys(t,r,e,o,n){t[r*e+o]=n}function eb(t,r){let e=f.one;for(let o=0;o<r-1;o++){if(ot(po(t,r,o,o),f.zero)){let n=0;for(n=o+1;n<r&&ot(po(t,r,n,o),f.zero);n++);if(n===r){e=f.zero;break}for(let i=o;i<r;i++){let a=po(t,r,o,i);Ys(t,r,o,i,po(t,r,n,i)),Ys(t,r,n,i,a)}e=U(e)}e=x(e,po(t,r,o,o));for(let n=o+1;n<r;n++){let i=U($(po(t,r,n,o),po(t,r,o,o)));Ys(t,r,n,o,f.zero);for(let a=o+1;a<r;a++){let m=I(x(po(t,r,o,a),i),po(t,r,n,a));Ys(t,r,n,a,m)}}}return x(e,po(t,r,r-1,r-1))}function Hs(t,r){return ob(t,r)}function ob(t,r){let e=et(r);return e<0||isNaN(e)?q(s(ri),t,r):xt(t)?zu(e,t):_(Gt(zu(e,s(Pt)),s(Pt),t))}function zu(t,r){let e=f.zero,o=f.one;for(let n=0;n<t;n++){let i=e;e=o,o=x(Q(x(r,e),x(y(n),i)),y(2))}return o}function Vu(t){let r=et(t);if(r<2)return q(s(Qs),t);let e=Zu(r,r);for(let o=0;o<r;o++)for(let n=0;n<r;n++)e.tensor.elem[o*r+n]=gr(y(o+n+1));return e}function Yu(t){let r=_(l(t));Co(r)||N("cofactor: 1st arg: square matrix expected");let e=r.tensor.dim[0],o=Hr(A(t));(o<1||o>e)&&N("cofactor: 2nd arg: row index expected");let n=Hr(Ft(t));return(n<1||n>e)&&N("cofactor: 3rd arg: column index expected"),Al(r,e,o-1,n-1)}function Al(t,r,e,o){let n=[];for(let a=0;a<r;a++)for(let m=0;m<r;m++)a!==e&&m!==o&&n.push(t.tensor.elem[r*a+m]);let i=El(n,r-1);return(e+o)%2&&(i=U(i)),i}function ju(t){return ql(_(l(t)))}function ql(t){Co(t)||N("adj: square matrix expected");let r=t.tensor.dim[0],e=ct(r*r);e.tensor.ndim=2,e.tensor.dim[0]=r,e.tensor.dim[1]=r;for(let o=0;o<r;o++)for(let n=0;n<r;n++)e.tensor.elem[r*n+o]=Al(t,r,o,n);return e}function Js(t){let r=[];r.push(u(c(t))),u(c(c(t)))===s(L)&&N("pattern needs at least a template and a transformed version");let o=c(c(t));for(;o!==s(L);)r.push(u(o)),o=c(o);if(r.length>2){let a=q(s(Po),r[r.length-2],r[r.length-1]);for(let m=2;m<r.length;m++)a=q(s(Po),r[r.length-m-1],a);return Js(a)}let n=[];Ws(t,n);let i=[];for(let a=0;a<n.length;a++)n[a]!==s(Pe)&&i.push(n[a]);if(n=i,i=[],n.length>1){let a=0;for(let m=0;m<n.length&&m+a+1<=n.length-1;m++){if(ke(n[m+a])||ke(n[m+a+1]))i.push(n[m+a]);else{let p=xo(_(n[m+a])),g=_(n[m+a+1]),v=Q(p,g);V(v)?a+=1:i.push(n[m+a])}if(m+a===n.length-2&&i.push(n[n.length-1]),m+a>=n.length-1)break}n=i}return n.length==0?s(Pe):(n=n.map(_),n.reduce(Ur))}function Ur(t,r){if(Ct(r)&&Ct(t)&&(r=U(r),t=U(t)),De(t)&&(r=Ur(u(c(c(t))),r),t=u(c(t))),t===s(Pe))return r;if(r===s(Pe))return t;if(H(t)&&H(r))return nb(t,r);if(!(ke(t)||ke(r))){let e=Q(t,xo(r));if(V(e))return s(Pe)}return h.expanding&&X(t)?t.tail().reduce((e,o)=>I(e,Ur(o,r)),f.zero):h.expanding&&X(r)?r.tail().reduce((e,o)=>I(e,Ur(t,o)),f.zero):H(t)&&C(r)?Kn(t,r):C(t)&&H(r)?ti(t,r):C(t)||C(r)?x(t,r):q(s(Po),t,r)}function nb(t,r){let e=t.tensor.dim[t.tensor.ndim-1];e!==r.tensor.dim[0]&&(er,N("inner: tensor dimension check"));let o=t.tensor.ndim+r.tensor.ndim-2;o>ye&&N("inner: rank of result exceeds maximum");let n=t.tensor.elem,i=r.tensor.elem,a=t.tensor.dim.slice(0,t.tensor.dim.length-1).reduce((v,F)=>v*F,1),m=r.tensor.dim.slice(1).reduce((v,F)=>v*F,1),p=ct(a*m),g=p.tensor.elem;for(let v=0;v<a;v++)for(let F=0;F<e;F++)if(!V(n[v*e+F]))for(let B=0;B<m;B++)g[v*m+B]=I(x(n[v*e+F],i[F*m+B]),g[v*m+B]);return o===0?p.tensor.elem[0]:(p.tensor.ndim=o,p.tensor.dim=[...t.tensor.dim.slice(0,t.tensor.ndim-1),...r.tensor.dim.slice(1,r.tensor.ndim)],p)}function Ws(t,r){if(!M(t)){Hu(t,r);return}if(c(t)===s(L)){Ws(u(t),r);return}if(De(t)){Ws(u(c(t)),r),Ws(c(c(t)),r);return}Hu(t,r)}function Hu(t,r){t!==s(L)&&r.push(t)}function xo(t){if(Ks(t))return u(c(t));if(ta(t))return t;if(h.expanding&&De(t)){let o=(M(t)?t.tail():[]).map(xo);for(let n=o.length-1;n>0;n--)o[n-1]=Ur(o[n],o[n-1]);return o[0]}if(!Co(t))return q(s(ns),t);if(ke(t))return Ju(t);let r=Zs(t);return V(r)&&N("inverse of singular matrix"),$(ql(t),r)}function Qu(t){return Co(t)?Ju(t):q(s(Xs),t)}function Ju(t){let r=t.tensor.dim[0],e=new Array(r*r);e.fill(f.zero);for(let i=0;i<r;i++)e[i*r+i]=f.one;let o=ib(e,t.tensor.elem,r),n=ct(r*r);return n.tensor.ndim=2,n.tensor.dim[0]=r,n.tensor.dim[1]=r,n.tensor.elem=o,n}function ib(t,r,e){for(let o=0;o<e;o++){if(ot(r[e*o+o],f.zero)){let i=0;for(i=o+1;i<e&&ot(r[e*i+o],f.zero);i++);i===e&&N("inverse of singular matrix");for(let a=0;a<e;a++){let m=r[e*o+a];r[e*o+a]=r[e*i+a],r[e*i+a]=m,m=t[e*o+a],t[e*o+a]=t[e*i+a],t[e*i+a]=m}}let n=r[e*o+o];for(let i=0;i<e;i++)i>o&&(r[e*o+i]=$(r[e*o+i],n)),t[e*o+i]=$(t[e*o+i],n);for(let i=0;i<e;i++){if(i===o)continue;let a=r[e*i+o];for(let m=0;m<e;m++)m>o&&(r[e*i+m]=Q(r[e*i+m],x(r[e*o+m],a))),t[e*i+m]=Q(t[e*i+m],x(t[e*o+m],a))}}return t}function Wu(t){return Xo(_(l(t)),_(A(t)))}function Xo(t,r){return sb(t,r)}function sb(t,r){let e=et(r);if(K(t)&&!isNaN(e)){let o=Xu(e,t.d);return tt(o)}if(V(t)&&V(r))return f.one;if(V(t)&&!isNaN(e))return f.zero;if(r.k===Zt&&Wt(r.q.b,2)){if(Wt(r.q.a,1)){let n=h.evaluatingAsFloats?tt(2/Math.PI):$(y(2),s(vt));return x(T($(n,t),P(1,2)),br(t))}if(Wt(r.q.a,-1)){let n=h.evaluatingAsFloats?tt(2/Math.PI):$(y(2),s(vt));return x(T($(n,t),P(1,2)),Sr(t))}let o=y(Ke(r.q.a));return Q(x(x($(y(2),t),Q(r,o)),Xo(t,Q(r,o))),Xo(t,Q(r,x(y(2),o))))}return Ct(t)?x(x(T(U(t),r),T(t,U(r))),q(s(Ko),U(t),r)):Ct(r)?x(T(f.negOne,r),q(s(Ko),t,U(r))):q(s(Ko),t,r)}function Ku(t){return ra(_(l(t)),_(A(t)))}function ra(t,r){return ab(t,r)}function ab(t,r){let e=et(r);if(K(t)&&!isNaN(e)){let o=tm(e,t.d);return tt(o)}return Ct(r)?x(T(f.negOne,r),q(s(Mn),t,U(r))):q(s(Mn),t,r)}function rm(t){return ea(_(l(t)))}function ea(t){if(u(t)===s(tn))return l(t);if(K(t)){let r=Math.cosh(t.d);return Math.abs(r)<1e-10&&(r=0),tt(r)}return V(t)?f.one:q(s(go),t)}function em(t){return Ml(_(l(t)))}function Ml(t){return lb(t)}function lb(t){return K(t)?t.d===0?f.one:f.zero:lt(t)?le(yr(t.q.a,t.q.b))?f.one:f.zero:rt(t)?q(s(ei),l(t)):Ct(t)?q(s(ei),U(t)):((Ct(t)||X(t)&&Ct(l(t)))&&(t=U(t)),q(s(ei),t))}function om(t,r){let e=f.one,o=e;if(t=c(t),!M(t))return[e,o];for(let n of t)it(n,r)?o=x(o,n):e=x(e,n);return[e,o]}var wl=1001,Sl=1002,oa=1003,Ol=1004,Tl=1006,Nl=1007,nm=1008,im=1009,sm=1010,am=1011,Il=1012,at="",is=0,Rl=0,Be=0,st=0,oi=0,ir="",na=null,Bt=null,ss=null,rn=null,ni=null,Yt=null,en=!1,Ll=null,gt="";function bo(t){D&&console.log(`#### scanning ${t}`),na=null,Bt=[],ss=[],rn=!0,ni=[],Yt=[""],Ll=!1,gt=t,Rl=0;let r=h.expanding;if(h.expanding=!0,Be=0,st=0,Ot(),at==="")return h.expanding=r,[0,s(L)];let e=ko();return h.expanding=r,Ll||(h.symbolsInExpressionsWithoutAssignments=h.symbolsInExpressionsWithoutAssignments.concat(ss)),[oi-Be,e]}function ia(t){gt=t,Rl=1;let r=h.expanding;if(h.expanding=!0,Be=0,st=0,Ot(),at==="")return h.expanding=r,s(L);let e=ko();return h.expanding=r,e}function ko(){let t=lm(),r=!1;if(at===Il&&(r=!0),at===Il||at==="="){let e=na;D&&console.log("assignment!"),Ll=!0,rn=!1,Ot();let o=lm();if(r&&(o=q(s(aa),o)),t=q(s(Ee),t,o),rn=!0,h.codeGen){let n=Bt.indexOf(e);if(n!==-1&&(Bt.splice(n,1),h.symbolsHavingReassignments.push(e)),D){console.log(`locally, ${e} depends on: `);for(let a of Array.from(Bt))console.log(`  ${a}`)}h.symbolsDependencies[e]==null&&(h.symbolsDependencies[e]=[]);let i=h.symbolsDependencies[e];for(let a of Array.from(Bt))i.indexOf(a)===-1&&i.push(a);Bt=[]}}return t}function lm(){let t=Do(),r;switch(at){case sm:return Ot(),r=Do(),q(s(Ge),t,r);case am:return Ot(),r=Do(),q(s(sa),q(s(Ge),t,r));case im:return Ot(),r=Do(),q(s(li),t,r);case nm:return Ot(),r=Do(),q(s(si),t,r);case"<":return Ot(),r=Do(),q(s(fi),t,r);case">":return Ot(),r=Do(),q(s(ai),t,r)}return t}function Do(){let t=[s(Pr)];switch(at){case"+":Ot(),t.push(as());break;case"-":Ot(),t.push(U(as()));break;default:t.push(as())}for(;is===0&&(at==="+"||at==="-");)at==="+"?(Ot(),t.push(as())):(Ot(),t.push(U(as())));return t.length===2?t[1]:q(...t)}function $l(){if(typeof at=="string")return at.charCodeAt(0)}function fb(){if($l()===vo)return!0;switch(at){case"*":case"/":return!0;case"(":case oa:case Ol:case wl:case Sl:case Nl:return is?(st=oi,!1):!0}return!1}function Cl(t){t.length>0&&lt(t[t.length-1])&&St(t[t.length-1],1)&&t.pop()}function ub(t){if(t.length>1&&C(t[t.length-2])&&C(t[t.length-1])){let r=t.pop(),e=t.pop();t.push(x(e,r))}}function as(){let t=[ii()];for(Dl&&Cl(t);fb();)at==="*"?(Ot(),t.push(ii())):at==="/"?(Cl(t),Ot(),t.push(gr(ii()))):$l()===vo?(Ot(),t.push(q(s(Po),t.pop(),ii()))):t.push(ii()),Dl&&(ub(t),Cl(t));return t.length===0?f.one:t.length==1?t[0]:q(s(Ht),...t)}function mb(t){return at==="^"?(Ot(),q(s(ut),t,ii())):t}function cb(t){Ot();let r=[s(ho),t,Do()];for(;at===",";)Ot(),r.push(Do());return at!=="]"&&_o("] expected"),Ot(),q(...r)}function ii(){let t=!1,r;for(at==="("?r=_b():at===oa?r=pb():at===Ol?r=gb():at==="["?r=hb():at===wl?(t=!0,r=cm(ir),at=Ot()):at===Sl?(t=!0,r=dm(ir),at=Ot()):at===Nl?r=xb():_o("syntax error");at==="["||at==="("&&is===0&&!t;)at==="["?r=cb(r):at==="("&&(r=bb(r));for(;at==="!";)Ot(),r=q(s(Br),r);for(;$l()===fa;)Ot(),r=q(s(to),r);return mb(r)}function Pl(t){if(la.indexOf(t)===-1&&Bt.indexOf(t)===-1&&Bt.indexOf("'"+t)===-1&&!en){D&&console.log(`... adding symbol: ${t} to the set of the symbols right of assignment`);let r="";for(let e=1;e<Yt.length;e++)Yt[e]!==""&&(r+=Yt[e]+"_"+e+"_");t=r+t,Bt.push(t)}}function db(t){if(la.indexOf(t)===-1&&ss.indexOf(t)===-1&&ss.indexOf("'"+t)===-1&&!en){D&&console.log(`... adding symbol: ${t} to the set of the symbols left of assignment`);let r="";for(let e=1;e<Yt.length;e++)Yt[e]!==""&&(r+=Yt[e]+"_"+e+"_");t=r+t,ss.push(t)}}function pb(){at!==oa&&_o("symbol expected");let t;if(Rl&&typeof ir=="string"&&ir.length===1)switch(ir[0]){case"a":t=s(fe);break;case"b":t=s(ue);break;case"x":t=s(re);break;default:t=Ue(ir)}else t=Ue(ir);return ni.length===0?(D&&console.log(`out of scanning parameters, processing ${ir}`),na=ir,rn&&db(ir)):(D&&console.log(`still scanning parameters, skipping ${ir}`),rn&&Pl("'"+ir)),D&&console.log(`found symbol: ${ir} left of assignment: ${rn}`),rn||Pl(ir),Ot(),t}function xb(){let t=new Bo(ir);return Ot(),t}function gb(){D&&console.log("-- scan_function_call_with_function_name start");let t=1,e=[Ue(ir)],o=ir;if((o==="roots"||o==="defint"||o==="sum"||o==="product"||o==="for")&&Yt.push(ir),na=ir,rn||Pl(ir),Ot(),Ot(),ni.push(!0),at!==")"){for(e.push(ko()),t++;at===",";)Ot(),t===2&&Yt[Yt.length-1].indexOf("roots")!==-1&&(Bt=Bt.filter(n=>!new RegExp("roots_"+(Yt.length-1)+"_"+ir).test(n)),en=!0),t===2&&Yt[Yt.length-1].indexOf("sum")!==-1&&(Bt=Bt.filter(n=>!new RegExp("sum_"+(Yt.length-1)+"_"+ir).test(n)),en=!0),t===2&&Yt[Yt.length-1].indexOf("product")!==-1&&(Bt=Bt.filter(n=>!new RegExp("product_"+(Yt.length-1)+"_"+ir).test(n)),en=!0),t===2&&Yt[Yt.length-1].indexOf("for")!==-1&&(Bt=Bt.filter(n=>!new RegExp("for_"+(Yt.length-1)+"_"+ir).test(n)),en=!0),Yt[Yt.length-1].indexOf("defint")!==-1&&(t===2||t>2&&(t-2)%3==0)&&(Bt=Bt.filter(n=>!new RegExp("defint_"+(Yt.length-1)+"_"+ir).test(n)),en=!0),e.push(ko()),en=!1,t++;t===2&&Yt[Yt.length-1].indexOf("roots")!==-1&&(Bt=Bt.filter(n=>!new RegExp("roots_"+(Yt.length-1)+"_x").test(n)))}ni.pop();for(let n=0;n<=Bt.length;n++)Bt[n]!=null&&(o==="roots"&&(Bt[n]=Bt[n].replace(new RegExp("roots_"+(Yt.length-1)+"_"),"")),o==="defint"&&(Bt[n]=Bt[n].replace(new RegExp("defint_"+(Yt.length-1)+"_"),"")),o==="sum"&&(Bt[n]=Bt[n].replace(new RegExp("sum_"+(Yt.length-1)+"_"),"")),o==="product"&&(Bt[n]=Bt[n].replace(new RegExp("product_"+(Yt.length-1)+"_"),"")),o==="for"&&(Bt[n]=Bt[n].replace(new RegExp("for_"+(Yt.length-1)+"_"),"")));return at!==")"&&_o(") expected"),Ot(),(o==="roots"||o==="defint"||o==="sum"||o==="product"||o==="for")&&Yt.pop(),o===s(on).printname&&(h.patternHasBeenFound=!0),D&&console.log("-- scan_function_call_with_function_name end"),q(...e)}function bb(t){D&&console.log("-- scan_function_call_without_function_name start");let e=[q(s(io),t)];if(Ot(),ni.push(!0),at!==")")for(e.push(ko());at===",";)Ot(),e.push(ko());return ni.pop(),at!==")"&&_o(") expected"),Ot(),D&&console.log(`-- scan_function_call_without_function_name end: ${e[e.length-1]}`),q(...e)}function _b(){let t=0;at!=="("&&_o("( expected"),at=Ot();let r=ko();return at!==")"&&_o(") expected"),Ot(),r}function hb(){at!=="["&&_o("[ expected"),Ot();let t=[ko()];for(;at===",";)at=Ot(),t.push(ko());let r=vb(t);return at!=="]"&&_o("] expected"),Ot(),r}function _o(t){for(h.errorMessage="";Be!==st&&!((gt[Be]===`
`||gt[Be]==="\r")&&Be+1===st);)h.errorMessage+=gt[Be++];for(h.errorMessage+=" ? ";gt[Be]&&gt[Be]!==`
`&&gt[Be]!=="\r";)h.errorMessage+=gt[Be++];h.errorMessage+=`
`,N(t)}function vb(t){let r=ct(t.length);r.tensor.ndim=1,r.tensor.dim[0]=t.length;for(let e=0;e<t.length;e++)r.tensor.elem[e]=t[e];return Dt(r),r}function Ot(){for(is=0;yb(),at===Tl;)is=1;return D&&console.log(`get_next_token token: ${at}`),at}function yb(){for(;fm(gt[st]);){if(gt[st]===`
`||gt[st]==="\r"){at=Tl,st++;return}st++}if(oi=st,st===gt.length){at="";return}if(wn(gt[st])||gt[st]==="."){for(;wn(gt[st]);)st++;if(gt[st]==="."){for(st++;wn(gt[st]);)st++;if(gt[st]==="e"&&(gt[st+1]==="+"||gt[st+1]==="-"||wn(gt[st+1])))for(st+=2;wn(gt[st]);)st++;at=Sl}else at=wl;kl(oi,st);return}if(um(gt[st])){for(;mm(gt[st]);)st++;gt[st]==="("?at=Ol:at=oa,kl(oi,st);return}if(gt[st]==='"'){for(st++;gt[st]!=='"';)st===gt.length-1&&(st++,_o("runaway string"),st--),st++;st++,at=Nl,kl(oi+1,st-1);return}if(gt[st]==="#"||gt[st]==="-"&&gt[st+1]==="-"){for(;gt[st]&&gt[st]!==`
`&&gt[st]!=="\r";)st++;gt[st]&&st++,at=Tl;return}if(gt[st]===":"&&gt[st+1]==="="){st+=2,at=Il;return}if(gt[st]==="="&&gt[st+1]==="="){st+=2,at=sm;return}if(gt[st]==="!"&&gt[st+1]==="="){st+=2,at=am;return}if(gt[st]==="<"&&gt[st+1]==="="){st+=2,at=im;return}if(gt[st]===">"&&gt[st+1]==="="){st+=2,at=nm;return}at=gt[st++]}function kl(t,r){ir=gt.substring(t,r)}function pm(t){return ua(()=>_(Tr(_(l(t)))))}function ui(t){return ua(()=>{t=_(t),t=Tr(t),t=_(t)}),t}function Tr(t){return ua(Bl,t)}function Bl(t){return M(t)?q(...t.map(Bl)):H(t)?(t=ro(t),t.tensor.elem=t.tensor.elem.map(Bl),t):lt(t)?xm(t):t===s(vt)?f.piAsDouble:t===s(rr)?tt(Math.E):t}var Xt={debug:t=>{D&&console.log(t)}},Eb=t=>[].concat(...t);function gm(t){let r=l(t),e;u(r)===s(Ee)||u(r)===s(Ge)?e=Q(_(l(r)),_(A(r))):(r=_(r),u(r)===s(Ee)||u(r)===s(Ge)?e=Q(_(l(r)),_(A(r))):e=r),r=_(A(t));let o=r===s(L)?cr(e):r;return Dr(e,o)||N("roots: 1st argument is not a polynomial in the variable "+o),mi(e,o)}function Ab(t){return t.some(r=>Qo(r))}function qb(t){return t.length<=2||V(t[0])?!1:t.slice(1,t.length-1).every(r=>V(r))}function ma(t,r){let e=Te(t,r),o=e[e.length-1];return e.map(n=>$(n,o))}function mi(t,r){if(h.recursionLevelNestedRadicalsRemoval>1)return s(L);Xt.debug(`checking if ${t} is a case of simple roots`);let e=ma(t,r),o=[];if(qb(e)){Xt.debug(`yes, ${e[e.length-1]} is a case of simple roots`);let a=e.length,m=e[0],p=e.pop(),g=Mb(a,p,m);o.push(...g)}else{let a=wb(t,r);o.push(...a)}let n=o.length;if(n===0&&N("roots: the polynomial is not factorable, try nroots"),n===1)return o[0];hm(o);let i=ct(n);i.tensor.ndim=1,i.tensor.dim[0]=n;for(let a=0;a<n;a++)i.tensor.elem[a]=o[a];return console.log(`roots returning ${i}`),i}function Mb(t,r,e){Xt.debug("getSimpleRoots"),t=t-1;let o=$(T(e,P(1,t)),T(r,P(1,t))),n=[];if(t%2==0){for(let i=1;i<=t;i+=2){let a=x(o,T(f.negOne,P(i,t)));n.push(a),n.push(U(a))}return n}for(let i=1;i<=t;i++){let a=x(o,T(f.negOne,P(i,t)));i%2==0&&(a=U(a)),n.push(a)}return n}function wb(t,r){let e=ma(t,r);if(Ab(e)||(t=_e(t,r)),Y(t)){let o=t.tail().map(n=>bm(n,r));return Eb(o)}return bm(t,r)}function bm(t,r){if(rt(t)&&Dr(l(t),r)&&On(A(t))){let e=ma(l(t),r);return _m(e)}if(Dr(t,r)){let e=ma(t,r);return _m(e)}return[]}function _m(t){let r=t.length;if(r===2){let e=t.pop(),o=t.pop();return Sb(e,o)}if(r===3){let e=t.pop(),o=t.pop(),n=t.pop();return Ob(e,o,n)}if(r===4){let e=t.pop(),o=t.pop(),n=t.pop(),i=t.pop();return Tb(e,o,n,i)}if(r===5){let e=t.pop(),o=t.pop(),n=t.pop(),i=t.pop(),a=t.pop();return Ib(e,o,n,i,a)}return[]}function Sb(t,r){return[U($(r,t))]}function Ob(t,r,e){let o=T(Q(T(r,y(2)),x(x(y(4),t),e)),P(1,2)),n=$(Q(o,r),x(t,y(2))),i=x($(U(I(o,r)),t),P(1,2));return[n,i]}function Tb(t,r,e,o){let n=x(x(e,e),e),i=x(r,r),a=x(i,r),m=x(x(a,o),y(-4)),p=x(a,y(2)),g=x(y(3),t),v=x(x(t,t),o),F=x(v,y(27)),B=x(x(v,o),y(-27)),J=x(x(t,e),r),nt=x(x(t,e),y(3)),ht=x(y(-4),x(t,n)),$t=U(x(J,y(9))),pr=x(x(J,o),y(18)),ar=Q(i,nt),kt=x(i,x(e,e)),nr=$(U(r),g),vr=x(T(ar,y(3)),y(4)),Ir=Sn(Mt(ar)),Ze=Sn(Mt(Gr([pr,m,kt,ht,B]))),oe=Gr([p,$t,F]),we=Mt(T(Q(T(oe,y(2)),vr),P(1,2)));if(Xt.debug(">>>>>>>>>>>>>>>> actually using cubic formula <<<<<<<<<<<<<<< "),Xt.debug(`cubic: D0: ${ar}`),Xt.debug(`cubic: D0 as float: ${Ir}`),Xt.debug(`cubic: DETERMINANT: ${Ze}`),Xt.debug(`cubic: D1: ${oe}`),V(Ze))return Nb(t,r,e,o,{R_DELTA0_toBeCheckedIfZero:Ir,R_m_b_over_3a:nr,R_DELTA0:ar,R_b3:a,R_a_b_c:J});let no=!1,Os=!1,No;for(;!no;){let Fi=Os?U(we):we;No=Mt(T(x(I(Fi,oe),P(1,2)),P(1,3)));let Gn=Sn(Mt(No));Xt.debug(`cubic: C: ${No}`),Xt.debug(`cubic: C as absval and float: ${Gn}`),V(Gn)?(Xt.debug(" cubic: C IS ZERO flipping the sign"),Os=!0):no=!0}let ki=x(x(No,g),y(2)),Ts=x(f.imaginaryunit,T(y(3),P(1,2))),Ns=I(f.one,Ts),Di=Q(f.one,Ts),Ye=$(No,g),Io=nr,Is=U(Ye),Bi=U($(ar,x(No,g))),je=Mt(Gr([Io,Is,Bi])),xn=nr,Ro=$(x(Ye,Ns),y(2)),Rs=$(x(Di,ar),ki),Ui=Mt(Gr([xn,Ro,Rs])),Gi=nr,dl=$(x(Ye,Di),y(2)),Un=$(x(Ns,ar),ki),Ls=Mt(Gr([Gi,dl,Un]));return[je,Ui,Ls]}function Nb(t,r,e,o,n){let{R_DELTA0_toBeCheckedIfZero:i,R_m_b_over_3a:a,R_DELTA0:m,R_b3:p,R_a_b_c:g}=n;if(V(i))return Xt.debug(" cubic: DETERMINANT IS ZERO and delta0 is zero"),[a];Xt.debug(" cubic: DETERMINANT IS ZERO and delta0 is not zero");let v=$(Q(x(t,x(o,y(9))),x(r,e)),x(m,y(2))),F=U(p),B=U(x(t,x(t,x(o,y(9))))),J=x(g,y(4)),nt=$(Gr([J,B,F]),x(t,m));return[v,v,nt]}function Ib(t,r,e,o,n){return Xt.debug(">>>>>>>>>>>>>>>> actually using quartic formula <<<<<<<<<<<<<<< "),V(r)&&V(o)&&!V(e)&&!V(n)?Rb(t,r,e,o,n):V(r)?Lb(t,r,e,o,n):$b(t,r,e,o,n)}function Rb(t,r,e,o,n){Xt.debug("biquadratic case");let i=mi(I(x(t,T(s(Pt),y(2))),I(x(e,s(Pt)),n)),s(Pt)),a=[];for(let m of i.tensor.elem)a.push(Mt(T(m,P(1,2)))),a.push(Mt(U(T(m,P(1,2)))));return a}function Lb(t,r,e,o,n){let i=e,a=o,m=n,p=x(P(5,2),i),g=Q(x(y(2),T(i,y(2))),m),v=I(x(P(-1,2),x(i,m)),I($(T(i,y(3)),y(2)),x(P(-1,8),T(a,y(2))))),F=I(T(s(Pt),y(3)),I(x(p,T(s(Pt),y(2))),I(x(g,s(Pt)),v)));Xt.debug(`resolventCubic: ${F}`);let B=mi(F,s(Pt));Xt.debug(`resolventCubicSolutions: ${B}`);let J=null;for(let we of B.tensor.elem){Xt.debug(`examining solution: ${we}`);let no=Sn(I(x(we,y(2)),i));if(Xt.debug(`abs value is: ${we}`),!V(no)){J=we;break}}Xt.debug(`chosen solution: ${J}`);let nt=Mt(T(I(x(J,y(2)),i),P(1,2))),ht=Mt($(x(a,y(2)),nt)),$t=I(x(i,y(3)),x(J,y(2))),pr=Mt(T(U(I($t,ht)),P(1,2))),ar=$(I(nt,pr),y(2)),kt=Mt(T(U(I($t,ht)),P(1,2))),nr=$(Q(nt,kt),y(2)),vr=Mt(T(U(Q($t,ht)),P(1,2))),Ir=$(I(U(nt),vr),y(2)),Ze=Mt(T(U(Q($t,ht)),P(1,2))),oe=$(Q(U(nt),Ze),y(2));return[ar,nr,Ir,oe]}function $b(t,r,e,o,n){let i=$(I(x(y(8),x(e,t)),x(y(-3),T(r,y(2)))),x(y(8),T(t,y(2)))),a=$(I(T(r,y(3)),I(x(y(-4),x(t,x(r,e))),x(y(8),x(o,T(t,y(2)))))),x(y(8),T(t,y(3)))),m=x(x(t,t),t),p=x(r,r),g=x(x(t,t),o),v=$(I(x(T(r,y(4)),y(-3)),I(x(y(256),x(m,n)),I(x(y(-64),x(g,r)),x(y(16),x(p,x(t,e)))))),x(y(256),T(t,y(4)))),F=T(s(Pt),y(4)),B=x(i,T(s(Pt),y(2))),J=x(a,s(Pt)),nt=Mt(Gr([F,B,J,v])),ht=mi(nt,s(Pt));return Xt.debug(`p for depressed quartic: ${i}`),Xt.debug(`q for depressed quartic: ${a}`),Xt.debug(`r for depressed quartic: ${v}`),Xt.debug(`4 * x^4: ${F}`),Xt.debug(`R_p * x^2: ${B}`),Xt.debug(`R_q * x: ${J}`),Xt.debug(`R_r: ${v}`),Xt.debug(`solving depressed quartic: ${nt}`),Xt.debug(`depressedSolutions: ${ht}`),ht.tensor.elem.map($t=>{let pr=Mt(Q($t,$(r,x(y(4),t))));return Xt.debug(`solution from depressed: ${pr}`),pr})}function Ul(t){if(X(t)){let r=t.tail().map(vm);return Gr(r)}return vm(t)}function vm(t){if(!Y(t))return t;let r=t.tail();for(;Cb(r););return ks(r)}function Cb(t){for(let r=0;r<t.length;r++){let e=t[r];for(let o=0;o<t.length;o++){if(r===o)continue;let n=t[o];if(ae(e)&&rt(n)&&Nt(A(n))&&ot(l(e),l(n)))return t[r]=Ar(Q(l(e),f.one)),t[o]=f.one,!0;if(rt(n)&&Nt(A(n))&&Oe(n)===s(Br)&&ot(e,ci(n)))return t[r]=he(Ar(I(e,f.negOne))),t[o]=f.one,!0;if(ae(n)){let i=Q(e,l(n));if(Et(i))return t[r]=Ar(e),t[o]=f.one,!0}if(rt(e)&&Nt(A(e))&&rt(n)&&Nt(A(n))&&Oe(n)===s(Br)){let i=Q(l(e),l(l(n)));if(Et(i))return t[r]=he(Ar(l(e))),t[o]=f.one,!0}if(ae(e)&&rt(n)&&Nt(A(n))&&Oe(n)===s(Br)){let i=Q(l(e),l(l(n)));if(Et(i))return t[r]=l(e),t[o]=f.one,!0;if(Nt(i))return t[r]=he(l(l(n))),t[o]=f.one,!0;if(St(i,2))return t[r]=l(e),t[o]=I(l(e),f.negOne),!0;if(St(i,-2))return t[r]=he(l(l(n))),t[o]=he(I(l(l(n)),f.negOne)),!0}}}return!1}function ym(t){console.log("Eval_decomp is being called!!!!!!!!!!!!!!!!!!!!");let r=_(l(t));t=_(A(t));let e=t===s(L)?cr(r):t,o=di(!1,r,e);return q(s(L),...o)}function Pb(t,r){return t.length>0&&ot(r,t[t.length-1])?!1:(t.push(r),!0)}function di(t,r,e){if(D&&console.log(`DECOMPOSING ${r}`),t){if(!M(r))return D&&console.log(` ground thing: ${r}`),[r]}else if(!it(r,e))return D&&console.log(" entire expression is constant"),[r];if(X(r))return kb(t,r,e);if(Y(r))return Db(t,r,e);let o=c(r);D&&(console.log(" naive decomp"),console.log(`startig p3: ${o}`));let n=[];for(;M(o);)t&&n.push(u(o)),D&&(console.log("recursive decomposition"),console.log(`car(p3): ${u(o)}`),console.log(`p2: ${e}`)),n.push(...di(t,u(o),e)),o=c(o);return n}function kb(t,r,e){D&&console.log(" decomposing the sum ");let o=c(r),n=[];for(;M(o);)(it(u(o),e)||t)&&n.push(...di(t,u(o),e)),o=c(o);o=c(r);let i=[...o].filter(a=>!it(a,e));return i.length&&(o=Gr(i),Pb(n,o),n.push(U(o))),n}function Db(t,r,e){D&&console.log(" decomposing the product ");let o=c(r),n=[];for(;M(o);)(it(u(o),e)||t)&&n.push(...di(t,u(o),e)),o=c(o);o=c(r);let i=[];for(;M(o);){let a=u(o);it(a,e)||(i.length<1||!ot(a,i[i.length-1]))&&i.push(a),o=c(o)}return i.length>0&&n.push(se(i)),n}function fs(t,r,e,o){D&&console.log(`         !!!!!!!!!   transform on: ${t}`);let n=Bb();Jt(s(re),r);let i=Gl(t,r),a=di(o,i,r);if(D){console.log(`  ${a.length} decomposed elements ====== `);for(let v=0;v<a.length;v++)console.log(`  decomposition element ${v}: ${a[v]}`)}let m=!1,p;if(o){if(!C(t)){let v=e;D&&(console.log(`applying transform: ${v}`),console.log(`scanning table entry ${v}`));let F=Gt(v,s(ca),s(fe));F=Gt(F,s(da),s(ue));let B=Gt(F,s(pa),s(re)),J=u(B);D&&console.log(`template expression: ${J}`),p=l(B);let nt=Er(B);if(Em([f.one,...a],o,t,J,nt))m=!0;else{D&&(console.log(`p3 at this point: ${t}`),console.log(`car(p3): ${u(t)}`));let ht=[],$t=t;for(M($t)&&(ht.push(u(t)),$t=c(t));M($t);){let pr=u($t);$t=c($t),D&&(console.log(`testing: ${pr}`),console.log(`about to try to simplify other term: ${pr}`));let[ar,kt]=fs(pr,s(L),e,o);m=m||kt,ht.push(ar),D&&console.log(`tried to simplify other term: ${pr} ...successful?: ${kt} ...transformed: ${ht[ht.length-1]}`)}ht.length!==0&&(p=q(...ht))}}}else for(let v of Array.from(e))if(D&&(console.log(`scanning table entry ${v}`),(v+"").indexOf("f(sqrt(a+b*x),2/3*1/b*sqrt((a+b*x)^3))")!==-1&&er),v){let F=ia(v),B=l(F);p=A(F);let J=jo(F);if(Em([f.one,...a],o,t,B,J)){m=!0;break}}let g=m?_(p):o?t:s(L);return Ub(n),[g,m]}function Bb(){return{METAA:pt(s(fe)),METAB:pt(s(ue)),METAX:pt(s(re))}}function Ub(t){Jt(s(re),t.METAX),Jt(s(ue),t.METAB),Jt(s(fe),t.METAA)}function Em(t,r,e,o,n){for(let i of t){Jt(s(fe),i),D&&console.log(`  binding METAA to ${pt(s(fe))}`);for(let a of t){Jt(s(ue),a),D&&console.log(`  binding METAB to ${pt(s(ue))}`);let m=n;for(;M(m);){let g=_(u(m));if(V(g))break;m=c(m)}if(M(m))continue;let p=r?Vr(_,o):_(o);if(D&&(console.log(`about to evaluate template expression: ${o} binding METAA to ${pt(s(fe))} and binding METAB to ${pt(s(ue))} and binding METAX to ${pt(s(re))}`),console.log(`  comparing ${p} to: ${e}`)),V(Q(e,p)))return D&&(console.log(`binding METAA to ${pt(s(fe))}`),console.log(`binding METAB to ${pt(s(ue))}`),console.log(`binding METAX to ${pt(s(re))}`),console.log(`comparing ${e} to: ${o}`)),!0}}return!1}function Am(t){let r=_(l(t)),e=f.one,o=y(2);return Er(t)!==s(L)&&(e=_(A(t)),o=_(Ft(t))),pi(r,e,o)}function pi(t,r,e){let o=0,n=Array(ye).fill(0),i=Array(ye).fill(0);if(C(t)||(Et(r)&&Uo(e)||Et(e)&&Uo(r))&&ta(t))return t;if(qm(t)){let B=u(c(c(t))),J=u(c(c(c(t))));if(ot(B,e)&&ot(J,r)||ot(J,e)&&ot(B,r)||ot(B,s(L))&&ot(J,s(L))&&(Et(e)&&Uo(r)||Et(r)&&Uo(e)))return u(c(t))}if(h.expanding&&X(t))return t.tail().reduce((B,J)=>I(B,pi(J,r,e)),f.zero);if(h.expanding&&Y(t))return t.tail().reduce((B,J)=>x(B,pi(J,r,e)),f.one);if(h.expanding&&De(t)){let B=[];return M(t)&&B.push(...t.tail().map(J=>[J,r,e])),B.reverse(),B.reduce((J,nt)=>Ur(J,pi(nt[0],nt[1],nt[2])),s(Pe))}if(!H(t))return V(t)?f.zero:(!Et(r)||!Uo(e))&&(!Et(e)||!Uo(r))?q(s(to),t,r,e):q(s(to),t);let{ndim:a,nelem:m}=t.tensor;if(a===1)return t;let p=et(r),g=et(e);(p<1||p>a||g<1||g>a)&&N("transpose: index out of range"),p--,g--,r=ct(m),r.tensor.ndim=a,r.tensor.dim=[...t.tensor.dim],r.tensor.dim[p]=t.tensor.dim[g],r.tensor.dim[g]=t.tensor.dim[p];let v=t.tensor.elem,F=r.tensor.elem;for(let B=0;B<a;B++)n[B]=0,i[B]=t.tensor.dim[B];for(let B=0;B<m;B++){o=n[p],n[p]=n[g],n[g]=o,o=i[p],i[p]=i[g],i[g]=o;let J=0;for(let nt=0;nt<a;nt++)J=J*i[nt]+n[nt];o=n[p],n[p]=n[g],n[g]=o,o=i[p],i[p]=i[g],i[g]=o,F[J]=v[B];for(let nt=a-1;nt>=0&&!(++n[nt]<i[nt]);nt--)n[nt]=0}return r}function Mm(t){let r=Gb(l(t));return Mt(_(r))}function Gb(t){if(h.userSimplificationsInListForm.length===0||it(t,s(yo)))return t;D&&console.log(`runUserDefinedSimplifications passed: ${t}`);let r=Vr(_,t);if(D){console.log(`runUserDefinedSimplifications after eval no expanding: ${r}`),console.log("patterns to be checked: ");for(let n of Array.from(h.userSimplificationsInListForm))console.log(`...${n}`)}let e=!0,o=0;for(;e&&o<zl;){e=!1,o++;for(let n of Array.from(h.userSimplificationsInListForm)){let i=!0,a=0;for(;i&&a<Vl;)a++,D&&console.log(`simplify - checking pattern: ${n} on: ${r}`),[r,i]=fs(r,s(L),n,!0),i&&(e=!0),D&&console.log(`p1 at this stage of simplification: ${r}`);a===Vl&&N(`maximum application of single transformation rule exceeded: ${n}`)}}return o===zl&&N("maximum application of all transformation rules exceeded "),D&&(console.log(`METAX = ${pt(s(re))}`),console.log(`METAA = ${pt(s(fe))}`),console.log(`METAB = ${pt(s(ue))}`)),r}function Mt(t){if(h.codeGen&&u(t)===s(He)){let r=l(t),e=Mt(_(r)),o=A(t);t=q(s(He),e,o)}if(H(t))return Fb(t);if(it(t,s(Br))){let r=Ul(t),e=Ul(te(t));t=Kt(r)<Kt(e)?r:e}if(t=Yb(t),t=zb(t),t=Vb(t),t=Zb(t),t=jb(t),t=Sm(t),t=Hb(t),t=Jb(t),Tm){let r;if([r,t]=Wb(t),r)return D&&console.log("de-nesting successful into: "+t.toString()),Mt(t)}return t=Qb(t),t=Om(t),t}function Fb(t){let r=ct(t.tensor.nelem);return r.tensor.ndim=t.tensor.ndim,r.tensor.dim=Array.from(t.tensor.dim),r.tensor.elem=t.tensor.elem.map(Mt),Dt(r),V(r)&&(r=f.zero),r}function zb(t){if(!X(t))return t;let r=te(t);return Kt(r)<Kt(t)&&(t=r),t}function Vb(t){if(!X(t))return t;let r=Jn(t);return Kt(r)<=Kt(t)&&(t=r),t}function Zb(t){let r=te(U(te(U(te(t)))));return Kt(r)<Kt(t)&&(t=r),t}function Yb(t){let r=u(t);if((r===s(Ht)||De(t))&&u(u(c(t)))===s(to)&&u(u(c(c(t))))===s(to)){D&&console.log(`maybe collecting a transpose ${t}`);let e=l(u(c(t))),o=l(u(c(c(t)))),n;r===s(Ht)?n=x(e,o):De(t)?n=Ur(o,e):n=N("f10: nothing to pop.");let i=Vr(()=>pi(n,f.one,y(2)));Kt(i)<Kt(t)&&(t=i),D&&console.log(`collecting a transpose ${i}`)}return t}function jb(t){if(V(t))return t;let r=te(gr(te(gr(te(t)))));return Kt(r)<Kt(t)&&(t=r),t}function wm(t){return Sm(t)}function Sm(t){if(!it(t,s(fr))&&!it(t,s(ur)))return t;let r=t;h.trigmode=1;let e=_(r);h.trigmode=2;let o=_(r);return h.trigmode=0,(Kt(o)<Kt(e)||xa(o)<xa(e))&&(e=o),(Kt(e)<Kt(t)||xa(e)<xa(t))&&(t=e),t}function Hb(t){if(!X(t))return t;let r=c(t);return M(r)&&(r=[...r].reduce((e,o)=>Om(I(e,Mt(o))),f.zero)),Kt(r)<Kt(t)&&(t=r),t}function Om(t){var r,e,o,n,i;if(r=Cr(t),Xe(r)||(e=Zr(t),Xe(e))||!(n=_l(e,r))||(i=ji(Lr(e,r),n),Xe(i)))return t;let a=ji(e,n),m=gr(i),p=uo(a,m),g=Mt(p),v=ji(r,n),F=uo(v,m),B=Mt(F),J=$(g,B);return o=Jn(J),Kt(o)<Kt(t)?o:t}function Qb(t){let r;return!it(t,s(fr))&&!it(t,s(ur))||(r=Vi(_(t)),D&&console.log(`before simplification clockform: ${t} after: ${r}`),Kt(r)<Kt(t)&&(t=r)),t}function Jb(t){let r=Fl(t),e=_(r);return Kt(e)<Kt(t)&&(t=e),t}function Fl(t){if(Se(t))return t;if(ot(u(t),s(ut))&&Nt(l(t))){let r=U(f.one),e=Fl(A(t));return Or(Zi(T(r,e)))}else return M(t)?t.map(Fl):t}function xa(t){return X(t)?_r(t)-1:1}function Wb(t){if(h.recursionLevelNestedRadicalsRemoval>0)return D&&console.log("denesting bailing out because of too much recursion"),[!1,t];let[r,e]=ga(t),o=Vr(Qn,r);return t=ls(s(ut),r)<ls(s(ut),o)?r:o,[e,t]}function ga(t){return h.recursionLevelNestedRadicalsRemoval>0?(D&&console.log("denesting bailing out because of too much recursion"),[t,!1]):ot(u(t),s(ut))?Xb(t):M(t)?t0(t):[t,!1]}function Xb(t){let r=l(t),e=A(t);if(Nt(e)||!ot(u(r),s(Pr))||!or(e)||!zt(e,1,3)&&!zt(e,1,2))return[t,!1];let o=l(r);ga(o);let n=A(r);ga(n);let i=0,a=r;for(;c(a)!==s(L);)i++,a=c(a);if(i>2)return[t,!1];let{commonBases:m,termsThatAreNotPowers:p}=Kb(n);if(m.length===0)return[t,!1];let g=o,v=m.reduce(x,f.one),F=p.reduce(x,f.one),B;if(zt(e,1,3)){let kt=$(x(U(g),v),F),nr=co(Tr(Yr(kt)));if(Math.abs(nr)>Math.pow(2,32))return[t,!1];let vr=x(y(3),v),Ir=co(Tr(Yr(vr)));if(Math.abs(Ir)>Math.pow(2,32))return[t,!1];let Ze=x(vr,s(Pt)),oe=$(x(y(-3),g),F),we=co(Tr(Yr(oe)));if(Math.abs(we)>Math.pow(2,32))return[t,!1];B=Gr([kt,Ze,x(oe,T(s(Pt),y(2))),x(f.one,T(s(Pt),y(3)))])}else if(zt(e,1,2)){let kt=co(Tr(Yr(v)));if(Math.abs(kt)>Math.pow(2,32))return[t,!1];let nr=$(x(y(-2),g),F),vr=co(Tr(Yr(nr)));if(Math.abs(vr)>Math.pow(2,32))return[t,!1];B=I(v,I(x(nr,s(Pt)),x(f.one,T(s(Pt),y(2)))))}h.recursionLevelNestedRadicalsRemoval++;let J=mi(B,s(Pt));if(h.recursionLevelNestedRadicalsRemoval--,ot(J,s(L)))return D&&console.log("roots bailed out because of too much recursion"),[t,!1];let nt=J.elem.filter(kt=>!it(kt,s(ut)));if(nt.length===0)return[t,!1];let ht=[],$t=[];for(let kt of Array.from(nt)){let nr=co(Tr(Yr(kt)));ht.push(kt),$t.push(nr)}let pr=$t.indexOf(Math.max.apply(Math,$t)),ar=ht[pr];if(!zt(e,1,3)&&!zt(e,1,2))return[t,!1];if(zt(e,1,3)){let kt=T($(g,I(T(ar,y(3)),x(x(y(3),v),ar))),P(1,3)),nr=x(kt,ar);return[Mt(I(x(kt,T(v,P(1,2))),nr)),!0]}if(zt(e,1,2)){let kt=T($(g,I(T(ar,y(2)),v)),P(1,2)),nr=x(kt,ar),vr=Mt(I(x(kt,T(v,P(1,2))),nr)),Ir=Tr(Yr(vr));return It(Ir)?[Mt(I(x(U(kt),T(v,P(1,2))),U(nr))),!0]:[vr,!0]}return[null,!0]}function Kb(t){let r=null,e=[],o=[];if(Y(t)){let n=c(t);if(M(n))for(;M(n);){let i=u(n);if(rt(i)){let a=l(i),m=A(i);zt(m,1,2)&&(r==null?(r=m,e.push(a)):ot(m,r)&&e.push(a))}else o.push(i);n=c(n)}}else if(rt(t)){let n=l(t),i=A(t);r==null&&zt(i,1,2)&&(r=i,e.push(n))}return{commonBases:e,termsThatAreNotPowers:o}}function t0(t){let r=!1,e=[];if(M(t)){let o=Array.from(t).map(n=>{if(!r){let i;return[i,r]=ga(n),i}return n});e.push(...o)}return[q(...e),r]}var r0=["f(a,a*x)","f(1/x,log(x))","f(x^a,x^(a+1)/(a+1))","f(x^(-2),-x^(-1))","f(x^(-1/2),2*x^(1/2))","f(x^(1/2),2/3*x^(3/2))","f(x,x^2/2)","f(x^2,x^3/3)","f(exp(a*x),1/a*exp(a*x))","f(exp(a*x+b),1/a*exp(a*x+b))","f(x*exp(a*x^2),exp(a*x^2)/(2*a))","f(x*exp(a*x^2+b),exp(a*x^2+b)/(2*a))","f(log(a*x),x*log(a*x)-x)","f(a^x,a^x/log(a),or(not(number(a)),a>0))","f(1/(a+x^2),1/sqrt(a)*arctan(x/sqrt(a)),or(not(number(a)),a>0))","f(1/(a-x^2),1/sqrt(a)*arctanh(x/sqrt(a)))","f(1/sqrt(a-x^2),arcsin(x/(sqrt(a))))","f(1/sqrt(a+x^2),log(x+sqrt(a+x^2)))","f(1/(a+b*x),1/b*log(a+b*x))","f(1/(a+b*x)^2,-1/(b*(a+b*x)))","f(1/(a+b*x)^3,-1/(2*b)*1/(a+b*x)^2)","f(x/(a+b*x),x/b-a*log(a+b*x)/b/b)","f(x/(a+b*x)^2,1/b^2*(log(a+b*x)+a/(a+b*x)))","f(x^2/(a+b*x),1/b^2*(1/2*(a+b*x)^2-2*a*(a+b*x)+a^2*log(a+b*x)))","f(x^2/(a+b*x)^2,1/b^3*(a+b*x-2*a*log(a+b*x)-a^2/(a+b*x)))","f(x^2/(a+b*x)^3,1/b^3*(log(a+b*x)+2*a/(a+b*x)-1/2*a^2/(a+b*x)^2))","f(1/x*1/(a+b*x),-1/a*log((a+b*x)/x))","f(1/x*1/(a+b*x)^2,1/a*1/(a+b*x)-1/a^2*log((a+b*x)/x))","f(1/x*1/(a+b*x)^3,1/a^3*(1/2*((2*a+b*x)/(a+b*x))^2+log(x/(a+b*x))))","f(1/x^2*1/(a+b*x),-1/(a*x)+b/a^2*log((a+b*x)/x))","f(1/x^3*1/(a+b*x),(2*b*x-a)/(2*a^2*x^2)+b^2/a^3*log(x/(a+b*x)))","f(1/x^2*1/(a+b*x)^2,-(a+2*b*x)/(a^2*x*(a+b*x))+2*b/a^3*log((a+b*x)/x))","f(1/(a+b*x^2),1/sqrt(a*b)*arctan(x*sqrt(a*b)/a),or(not(number(a*b)),a*b>0))","f(1/(a+b*x^2),1/(2*sqrt(-a*b))*log((a+x*sqrt(-a*b))/(a-x*sqrt(-a*b))),or(not(number(a*b)),a*b<0))","f(x/(a+b*x^2),1/2*1/b*log(a+b*x^2))","f(x^2/(a+b*x^2),x/b-a/b*integral(1/(a+b*x^2),x))","f(1/(a+b*x^2)^2,x/(2*a*(a+b*x^2))+1/2*1/a*integral(1/(a+b*x^2),x))","f(1/x*1/(a+b*x^2),1/2*1/a*log(x^2/(a+b*x^2)))","f(1/x^2*1/(a+b*x^2),-1/(a*x)-b/a*integral(1/(a+b*x^2),x))","f(1/(a+b*x^3),1/3*1/a*(a/b)^(1/3)*(1/2*log(((a/b)^(1/3)+x)^3/(a+b*x^3))+sqrt(3)*arctan((2*x-(a/b)^(1/3))*(a/b)^(-1/3)/sqrt(3))))","f(x^2/(a+b*x^3),1/3*1/b*log(a+b*x^3))","f(x/(a+b*x^4),1/2*sqrt(b/a)/b*arctan(x^2*sqrt(b/a)),or(not(number(a*b)),a*b>0))","f(x/(a+b*x^4),1/4*sqrt(-b/a)/b*log((x^2-sqrt(-a/b))/(x^2+sqrt(-a/b))),or(not(number(a*b)),a*b<0))","f(x^3/(a+b*x^4),1/4*1/b*log(a+b*x^4))","f(sqrt(a+b*x),2/3*1/b*sqrt((a+b*x)^3))","f(x*sqrt(a+b*x),-2*(2*a-3*b*x)*sqrt((a+b*x)^3)/15/b^2)","f(x^2*sqrt(a+b*x),2*(8*a^2-12*a*b*x+15*b^2*x^2)*sqrt((a+b*x)^3)/105/b^3)","f(sqrt(a+b*x)/x,2*sqrt(a+b*x)+a*integral(1/x*1/sqrt(a+b*x),x))","f(sqrt(a+b*x)/x^2,-sqrt(a+b*x)/x+b/2*integral(1/x*1/sqrt(a+b*x),x))","f(1/sqrt(a+b*x),2*sqrt(a+b*x)/b)","f(x/sqrt(a+b*x),-2/3*(2*a-b*x)*sqrt(a+b*x)/b^2)","f(x^2/sqrt(a+b*x),2/15*(8*a^2-4*a*b*x+3*b^2*x^2)*sqrt(a+b*x)/b^3)","f(1/x*1/sqrt(a+b*x),1/sqrt(a)*log((sqrt(a+b*x)-sqrt(a))/(sqrt(a+b*x)+sqrt(a))),or(not(number(a)),a>0))","f(1/x*1/sqrt(a+b*x),2/sqrt(-a)*arctan(sqrt(-(a+b*x)/a)),or(not(number(a)),a<0))","f(1/x^2*1/sqrt(a+b*x),-sqrt(a+b*x)/a/x-1/2*b/a*integral(1/x*1/sqrt(a+b*x),x))","f(sqrt(x^2+a),1/2*(x*sqrt(x^2+a)+a*log(x+sqrt(x^2+a))))","f(1/sqrt(x^2+a),log(x+sqrt(x^2+a)))","f(1/x*1/sqrt(x^2+a),arcsec(x/sqrt(-a))/sqrt(-a),or(not(number(a)),a<0))","f(1/x*1/sqrt(x^2+a),-1/sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(-a)*arcsec(x/sqrt(-a)),or(not(number(a)),a<0))","f(x/sqrt(x^2+a),sqrt(x^2+a))","f(x*sqrt(x^2+a),1/3*sqrt((x^2+a)^3))","f(sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2+a^(1/3))^3)+3/2*a^(1/3)*x*sqrt(x^2+a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2+a^(1/3)))))","f(sqrt(-a+x^6-3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2-a^(1/3))^3)-3/2*a^(1/3)*x*sqrt(x^2-a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2-a^(1/3)))))","f(1/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),x/a^(1/3)/sqrt(x^2+a^(1/3)))","f(x/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),-1/sqrt(x^2+a^(1/3)))","f(x*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/5*sqrt((x^2+a^(1/3))^5))","f(x^2*sqrt(x^2+a),1/4*x*sqrt((x^2+a)^3)-1/8*a*x*sqrt(x^2+a)-1/8*a^2*log(x+sqrt(x^2+a)))","f(x^3*sqrt(x^2+a),(1/5*x^2-2/15*a)*sqrt((x^2+a)^3),and(number(a),a>0))","f(x^3*sqrt(x^2+a),sqrt((x^2+a)^5)/5-a*sqrt((x^2+a)^3)/3,and(number(a),a<0))","f(x^2/sqrt(x^2+a),1/2*x*sqrt(x^2+a)-1/2*a*log(x+sqrt(x^2+a)))","f(x^3/sqrt(x^2+a),1/3*sqrt((x^2+a)^3)-a*sqrt(x^2+a))","f(1/x^2*1/sqrt(x^2+a),-sqrt(x^2+a)/a/x)","f(1/x^3*1/sqrt(x^2+a),-1/2*sqrt(x^2+a)/a/x^2+1/2*log((sqrt(a)+sqrt(x^2+a))/x)/a^(3/2),or(not(number(a)),a>0))","f(1/x^3*1/sqrt(x^2-a),1/2*sqrt(x^2-a)/a/x^2+1/2*1/(a^(3/2))*arcsec(x/(a^(1/2))),or(not(number(a)),a>0))","f(x^2*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/6*x*sqrt((x^2+a^(1/3))^5)-1/24*a^(1/3)*x*sqrt((x^2+a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2+a^(1/3))-1/16*a*log(x+sqrt(x^2+a^(1/3))),or(not(number(a)),a>0))","f(x^2*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/6*x*sqrt((x^2-a^(1/3))^5)+1/24*a^(1/3)*x*sqrt((x^2-a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2-a^(1/3))+1/16*a*log(x+sqrt(x^2-a^(1/3))),or(not(number(a)),a>0))","f(x^3*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/7*sqrt((x^2+a^(1/3))^7)-1/5*a^(1/3)*sqrt((x^2+a^(1/3))^5),or(not(number(a)),a>0))","f(x^3*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/7*sqrt((x^2-a^(1/3))^7)+1/5*a^(1/3)*sqrt((x^2-a^(1/3))^5),or(not(number(a)),a>0))","f(1/(x-a)/sqrt(x^2-a^2),-sqrt(x^2-a^2)/a/(x-a))","f(1/(x+a)/sqrt(x^2-a^2),sqrt(x^2-a^2)/a/(x+a))","f(sqrt(a-x^2),1/2*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(abs(a)))))","f(1/x*1/sqrt(a-x^2),-1/sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x,sqrt(a-x^2)-sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))","f(x/sqrt(a-x^2),-sqrt(a-x^2))","f(x*sqrt(a-x^2),-1/3*sqrt((a-x^2)^3))","f(x^2*sqrt(a-x^2),-x/4*sqrt((a-x^2)^3)+1/8*a*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(a))),or(not(number(a)),a>0))","f(x^3*sqrt(a-x^2),(-1/5*x^2-2/15*a)*sqrt((a-x^2)^3),or(not(number(a)),a>0))","f(x^2/sqrt(a-x^2),-x/2*sqrt(a-x^2)+a/2*arcsin(x/sqrt(a)),or(not(number(a)),a>0))","f(1/x^2*1/sqrt(a-x^2),-sqrt(a-x^2)/a/x,or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^2,-sqrt(a-x^2)/x-arcsin(x/sqrt(a)),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^3,-1/2*sqrt(a-x^2)/x^2+1/2*log((sqrt(a)+sqrt(a-x^2))/x)/sqrt(a),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^4,-1/3*sqrt((a-x^2)^3)/a/x^3,or(not(number(a)),a>0))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*log(x*sqrt(a)+sqrt(a*x^2+b))/2/sqrt(a),and(number(a),a>0))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*arcsin(x*sqrt(-a/b))/2/sqrt(-a),and(number(a),a<0))","f(sin(a*x),-cos(a*x)/a)","f(cos(a*x),sin(a*x)/a)","f(tan(a*x),-log(cos(a*x))/a)","f(1/tan(a*x),log(sin(a*x))/a)","f(1/cos(a*x),log(tan(pi/4+a*x/2))/a)","f(1/sin(a*x),log(tan(a*x/2))/a)","f(sin(a*x)^2,x/2-sin(2*a*x)/(4*a))","f(sin(a*x)^3,-cos(a*x)*(sin(a*x)^2+2)/(3*a))","f(sin(a*x)^4,3/8*x-sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))","f(cos(a*x)^2,x/2+sin(2*a*x)/(4*a))","f(cos(a*x)^3,sin(a*x)*(cos(a*x)^2+2)/(3*a))","f(cos(a*x)^4,3/8*x+sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))","f(1/sin(a*x)^2,-1/(a*tan(a*x)))","f(1/cos(a*x)^2,tan(a*x)/a)","f(sin(a*x)*cos(a*x),sin(a*x)^2/(2*a))","f(sin(a*x)^2*cos(a*x)^2,-sin(4*a*x)/(32*a)+x/8)","f(sin(a*x)/cos(a*x)^2,1/(a*cos(a*x)))","f(sin(a*x)^2/cos(a*x),(log(tan(pi/4+a*x/2))-sin(a*x))/a)","f(cos(a*x)/sin(a*x)^2,-1/(a*sin(a*x)))","f(1/(sin(a*x)*cos(a*x)),log(tan(a*x))/a)","f(1/(sin(a*x)*cos(a*x)^2),(1/cos(a*x)+log(tan(a*x/2)))/a)","f(1/(sin(a*x)^2*cos(a*x)),(log(tan(pi/4+a*x/2))-1/sin(a*x))/a)","f(1/(sin(a*x)^2*cos(a*x)^2),-2/(a*tan(2*a*x)))","f(sin(a+b*x),-cos(a+b*x)/b)","f(cos(a+b*x),sin(a+b*x)/b)","f(1/(b+b*sin(a*x)),-tan(pi/4-a*x/2)/a/b)","f(1/(b-b*sin(a*x)),tan(pi/4+a*x/2)/a/b)","f(1/(b+b*cos(a*x)),tan(a*x/2)/a/b)","f(1/(b-b*cos(a*x)),-1/tan(a*x/2)/a/b)","f(1/(a+b*sin(x)),1/sqrt(b^2-a^2)*log((a*tan(x/2)+b-sqrt(b^2-a^2))/(a*tan(x/2)+b+sqrt(b^2-a^2))),b^2-a^2)","f(1/(a+b*cos(x)),1/sqrt(b^2-a^2)*log((sqrt(b^2-a^2)*tan(x/2)+a+b)/(sqrt(b^2-a^2)*tan(x/2)-a-b)),b^2-a^2)","f(x*sin(a*x),sin(a*x)/a^2-x*cos(a*x)/a)","f(x^2*sin(a*x),2*x*sin(a*x)/a^2-(a^2*x^2-2)*cos(a*x)/a^3)","f(x*cos(a*x),cos(a*x)/a^2+x*sin(a*x)/a)","f(x^2*cos(a*x),2*x*cos(a*x)/a^2+(a^2*x^2-2)*sin(a*x)/a^3)","f(arcsin(a*x),x*arcsin(a*x)+sqrt(1-a^2*x^2)/a)","f(arccos(a*x),x*arccos(a*x)-sqrt(1-a^2*x^2)/a)","f(arctan(a*x),x*arctan(a*x)-1/2*log(1+a^2*x^2)/a)","f(x*log(a*x),x^2*log(a*x)/2-x^2/4)","f(x^2*log(a*x),x^3*log(a*x)/3-1/9*x^3)","f(log(x)^2,x*log(x)^2-2*x*log(x)+2*x)","f(1/x*1/(a+log(x)),log(a+log(x)))","f(log(a*x+b),(a*x+b)*log(a*x+b)/a-x)","f(log(a*x+b)/x^2,a/b*log(x)-(a*x+b)*log(a*x+b)/b/x)","f(sinh(x),cosh(x))","f(cosh(x),sinh(x))","f(tanh(x),log(cosh(x)))","f(x*sinh(x),x*cosh(x)-sinh(x))","f(x*cosh(x),x*sinh(x)-cosh(x))","f(sinh(x)^2,sinh(2*x)/4-x/2)","f(tanh(x)^2,x-tanh(x))","f(cosh(x)^2,sinh(2*x)/4+x/2)","f(x^3*exp(a*x^2),exp(a*x^2)*(x^2/a-1/(a^2))/2)","f(x^3*exp(a*x^2+b),exp(a*x^2)*exp(b)*(x^2/a-1/(a^2))/2)","f(exp(a*x^2),-i*sqrt(pi)*erf(i*sqrt(a)*x)/sqrt(a)/2)","f(erf(a*x),x*erf(a*x)+exp(-a^2*x^2)/a/sqrt(pi))","f(x^2*(1-x^2)^(3/2),(x*sqrt(1-x^2)*(-8*x^4+14*x^2-3)+3*arcsin(x))/48)","f(x^2*(1-x^2)^(5/2),(x*sqrt(1-x^2)*(48*x^6-136*x^4+118*x^2-15)+15*arcsin(x))/384)","f(x^4*(1-x^2)^(3/2),(-x*sqrt(1-x^2)*(16*x^6-24*x^4+2*x^2+3)+3*arcsin(x))/128)","f(x*exp(a*x),exp(a*x)*(a*x-1)/(a^2))","f(x*exp(a*x+b),exp(a*x+b)*(a*x-1)/(a^2))","f(x^2*exp(a*x),exp(a*x)*(a^2*x^2-2*a*x+2)/(a^3))","f(x^2*exp(a*x+b),exp(a*x+b)*(a^2*x^2-2*a*x+2)/(a^3))","f(x^3*exp(a*x),exp(a*x)*x^3/a-3/a*integral(x^2*exp(a*x),x))","f(x^3*exp(a*x+b),exp(a*x+b)*x^3/a-3/a*integral(x^2*exp(a*x+b),x))"];function Nm(t){let r=0;t=c(t);let e=_(u(t));t=c(t);let o=_(u(t)),n,i;for(o===s(L)?(i=cr(e),n=s(L)):C(o)?(i=cr(e),n=o):(i=o,t=c(t),n=_(u(t)));;){C(n)?(r=et(n),isNaN(r)&&N("nth integral: check n")):r=1;let a=e;if(r>=0)for(let m=0;m<r;m++)a=Tn(a,i);else{r=-r;for(let m=0;m<r;m++)a=wt(a,i)}if(e=a,n===s(L))break;if(C(n)){if(t=c(t),n=_(u(t)),n===s(L))break;C(n)||(i=n,t=c(t),n=_(u(t)))}else i=n,t=c(t),n=_(u(t))}return e}function Tn(t,r){let e;return X(t)?e=e0(t,r):Y(t)?e=o0(t,r):e=Im(t,r),it(e,s(yo))&&N("integral: sorry, could not find a solution"),_(Mt(e))}function e0(t,r){t=c(t);let e=Tn(u(t),r);return M(t)&&(e=t.tail().reduce((o,n)=>I(o,Tn(n,r)),e)),e}function o0(t,r){let[e,o]=om(t,r);return x(e,Im(o,r))}function Im(t,r){let e=Nn(t,r).toFixed(6),o=a0[e];if(!o)return q(s(yo),t,r);let[n,i]=fs(t,r,o,!1);return n===s(L)?q(s(yo),t,r):n}var Eo={x:.95532,constexp:1.43762,constant:1.1441659362941434,constbase:1.2036412230421882,sin:1.7330548251830322,arcsin:1.6483368529465805,cos:1.0586721236863401,arccos:1.8405225918106694,tan:1.1224943776292506,arctan:1.1297397925394963,sinh:1.8176164926060079,cosh:1.9404934661708022,tanh:1.6421307715103122,log:1.477443701354924,erf:1.0825269225702916};function Nn(t,r){if(xt(t))return ot(t,r)?Eo.x:Eo.constant;if(M(t)){let o=u(t);switch(xt(o)&&o.printname){case Pr:return i0(c(t),r);case Ht:return s0(c(t),r);case ut:return Zl(l(t),A(t),r);case ba:return Zl(s(rr),l(t),r);case xi:var e=tt(.5);return Zl(l(t),e,r);default:return n0(t,r)}}return Eo.constant}function n0(t,r){if(!it(l(t),r))return Eo.constant;let e=u(t),o=Nn(l(t),r),n=Eo[e.printname];if(!n)throw new Error("Unsupported function "+e.printname);return Math.pow(n,o)}function i0(t,r){let e={};for(;M(t);){let n=u(t);t=c(t);let i=0;it(n,r)?i=Nn(n,r):i=Eo.constant,e[i.toFixed(6)]=!0}let o=0;for(let n of Object.keys(e||{})){let i=e[n];o=o+Number(n)}return o}function s0(t,r){let e=1;return M(t)&&[...t].forEach(o=>{it(o,r)&&(e=e*Nn(o,r))}),e}function Zl(t,r,e){let o=Eo.constant,n=Eo.constexp;if(it(t,e)&&(o=Nn(t,e)),it(r,e))n=Nn(r,e);else{if(o===Eo.constant)return Eo.constant;Nt(r)?n=-1:$e(r)?n=.5:ts(r)?n=-.5:zt(r,2,1)?n=2:zt(r,-2,1)&&(n=-2)}return Math.pow(o,n)}function Rm(){let t={};for(let r of Array.from(r0)){let e=ia(r),o=l(e),i=Nn(o,s(re)).toFixed(6);t[i]||(t[i]=[]),t[i].push(r)}return console.log(`hashed_itab = ${JSON.stringify(t,null,2)}`),t}var a0={"1.144166":["f(a,a*x)"],"1.046770":["f(1/x,log(x))"],"0.936400":["f(x^a,x^(a+1)/(a+1))"],"1.095727":["f(x^(-2),-x^(-1))"],"1.023118":["f(x^(-1/2),2*x^(1/2))"],"0.977405":["f(x^(1/2),2/3*x^(3/2))"],"0.955320":["f(x,x^2/2)"],"0.912636":["f(x^2,x^3/3)"],"1.137302":["f(exp(a*x),1/a*exp(a*x))","f(a^x,a^x/log(a),or(not(number(a)),a>0))"],"1.326774":["f(exp(a*x+b),1/a*exp(a*x+b))"],"1.080259":["f(x*exp(a*x^2),exp(a*x^2)/(2*a))"],"1.260228":["f(x*exp(a*x^2+b),exp(a*x^2+b)/(2*a))"],"1.451902":["f(log(a*x),x*log(a*x)-x)"],"0.486192":["f(1/(a+x^2),1/sqrt(a)*arctan(x/sqrt(a)),or(not(number(a)),a>0))","f(1/(a-x^2),1/sqrt(a)*arctanh(x/sqrt(a)))","f(1/(a+b*x^2),1/sqrt(a*b)*arctan(x*sqrt(a*b)/a),or(not(number(a*b)),a*b>0))","f(1/(a+b*x^2),1/(2*sqrt(-a*b))*log((a+x*sqrt(-a*b))/(a-x*sqrt(-a*b))),or(not(number(a*b)),a*b<0))"],"0.697274":["f(1/sqrt(a-x^2),arcsin(x/(sqrt(a))))","f(1/sqrt(a+x^2),log(x+sqrt(a+x^2)))","f(1/sqrt(x^2+a),log(x+sqrt(x^2+a)))"],"0.476307":["f(1/(a+b*x),1/b*log(a+b*x))"],"0.226868":["f(1/(a+b*x)^2,-1/(b*(a+b*x)))"],"2.904531":["f(1/(a+b*x)^3,-1/(2*b)*1/(a+b*x)^2)"],"0.455026":["f(x/(a+b*x),x/b-a*log(a+b*x)/b/b)"],"0.216732":["f(x/(a+b*x)^2,1/b^2*(log(a+b*x)+a/(a+b*x)))"],"0.434695":["f(x^2/(a+b*x),1/b^2*(1/2*(a+b*x)^2-2*a*(a+b*x)+a^2*log(a+b*x)))"],"0.207048":["f(x^2/(a+b*x)^2,1/b^3*(a+b*x-2*a*log(a+b*x)-a^2/(a+b*x)))"],"2.650781":["f(x^2/(a+b*x)^3,1/b^3*(log(a+b*x)+2*a/(a+b*x)-1/2*a^2/(a+b*x)^2))"],"0.498584":["f(1/x*1/(a+b*x),-1/a*log((a+b*x)/x))"],"0.237479":["f(1/x*1/(a+b*x)^2,1/a*1/(a+b*x)-1/a^2*log((a+b*x)/x))"],"3.040375":["f(1/x*1/(a+b*x)^3,1/a^3*(1/2*((2*a+b*x)/(a+b*x))^2+log(x/(a+b*x))))"],"0.521902":["f(1/x^2*1/(a+b*x),-1/(a*x)+b/a^2*log((a+b*x)/x))"],"0.446014":["f(1/x^3*1/(a+b*x),(2*b*x-a)/(2*a^2*x^2)+b^2/a^3*log(x/(a+b*x)))"],"0.248586":["f(1/x^2*1/(a+b*x)^2,-(a+2*b*x)/(a^2*x*(a+b*x))+2*b/a^3*log((a+b*x)/x))"],"0.464469":["f(x/(a+b*x^2),1/2*1/b*log(a+b*x^2))"],"0.443716":["f(x^2/(a+b*x^2),x/b-a/b*integral(1/(a+b*x^2),x))"],"0.236382":["f(1/(a+b*x^2)^2,x/(2*a*(a+b*x^2))+1/2*1/a*integral(1/(a+b*x^2),x))"],"0.508931":["f(1/x*1/(a+b*x^2),1/2*1/a*log(x^2/(a+b*x^2)))"],"0.532733":["f(1/x^2*1/(a+b*x^2),-1/(a*x)-b/a*integral(1/(a+b*x^2),x))"],"0.480638":["f(1/(a+b*x^3),1/3*1/a*(a/b)^(1/3)*(1/2*log(((a/b)^(1/3)+x)^3/(a+b*x^3))+sqrt(3)*arctan((2*x-(a/b)^(1/3))*(a/b)^(-1/3)/sqrt(3))))"],"0.438648":["f(x^2/(a+b*x^3),1/3*1/b*log(a+b*x^3))"],"0.459164":["f(x/(a+b*x^4),1/2*sqrt(b/a)/b*arctan(x^2*sqrt(b/a)),or(not(number(a*b)),a*b>0))","f(x/(a+b*x^4),1/4*sqrt(-b/a)/b*log((x^2-sqrt(-a/b))/(x^2+sqrt(-a/b))),or(not(number(a*b)),a*b<0))"],"0.450070":["f(x^3/(a+b*x^4),1/4*1/b*log(a+b*x^4))"],"1.448960":["f(sqrt(a+b*x),2/3*1/b*sqrt((a+b*x)^3))"],"1.384221":["f(x*sqrt(a+b*x),-2*(2*a-3*b*x)*sqrt((a+b*x)^3)/15/b^2)"],"1.322374":["f(x^2*sqrt(a+b*x),2*(8*a^2-12*a*b*x+15*b^2*x^2)*sqrt((a+b*x)^3)/105/b^3)"],"1.516728":["f(sqrt(a+b*x)/x,2*sqrt(a+b*x)+a*integral(1/x*1/sqrt(a+b*x),x))"],"1.587665":["f(sqrt(a+b*x)/x^2,-sqrt(a+b*x)/x+b/2*integral(1/x*1/sqrt(a+b*x),x))"],"0.690150":["f(1/sqrt(a+b*x),2*sqrt(a+b*x)/b)"],"0.659314":["f(x/sqrt(a+b*x),-2/3*(2*a-b*x)*sqrt(a+b*x)/b^2)"],"0.629856":["f(x^2/sqrt(a+b*x),2/15*(8*a^2-4*a*b*x+3*b^2*x^2)*sqrt(a+b*x)/b^3)"],"0.722428":["f(1/x*1/sqrt(a+b*x),1/sqrt(a)*log((sqrt(a+b*x)-sqrt(a))/(sqrt(a+b*x)+sqrt(a))),or(not(number(a)),a>0))","f(1/x*1/sqrt(a+b*x),2/sqrt(-a)*arctan(sqrt(-(a+b*x)/a)),or(not(number(a)),a<0))"],"0.756216":["f(1/x^2*1/sqrt(a+b*x),-sqrt(a+b*x)/a/x-1/2*b/a*integral(1/x*1/sqrt(a+b*x),x))"],"1.434156":["f(sqrt(x^2+a),1/2*(x*sqrt(x^2+a)+a*log(x+sqrt(x^2+a))))","f(sqrt(a-x^2),1/2*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(abs(a)))))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*log(x*sqrt(a)+sqrt(a*x^2+b))/2/sqrt(a),and(number(a),a>0))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*arcsin(x*sqrt(-a/b))/2/sqrt(-a),and(number(a),a<0))"],"0.729886":["f(1/x*1/sqrt(x^2+a),arcsec(x/sqrt(-a))/sqrt(-a),or(not(number(a)),a<0))","f(1/x*1/sqrt(x^2+a),-1/sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(1/x*1/sqrt(a-x^2),-1/sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))"],"1.501230":["f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(-a)*arcsec(x/sqrt(-a)),or(not(number(a)),a<0))","f(sqrt(a-x^2)/x,sqrt(a-x^2)-sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))"],"0.666120":["f(x/sqrt(x^2+a),sqrt(x^2+a))","f(x/sqrt(a-x^2),-sqrt(a-x^2))"],"1.370077":["f(x*sqrt(x^2+a),1/3*sqrt((x^2+a)^3))","f(x*sqrt(a-x^2),-1/3*sqrt((a-x^2)^3))"],"1.730087":["f(sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2+a^(1/3))^3)+3/2*a^(1/3)*x*sqrt(x^2+a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2+a^(1/3)))))","f(sqrt(-a+x^6-3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2-a^(1/3))^3)-3/2*a^(1/3)*x*sqrt(x^2-a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2-a^(1/3)))))"],"0.578006":["f(1/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),x/a^(1/3)/sqrt(x^2+a^(1/3)))"],"0.552180":["f(x/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),-1/sqrt(x^2+a^(1/3)))"],"1.652787":["f(x*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/5*sqrt((x^2+a^(1/3))^5))"],"1.308862":["f(x^2*sqrt(x^2+a),1/4*x*sqrt((x^2+a)^3)-1/8*a*x*sqrt(x^2+a)-1/8*a^2*log(x+sqrt(x^2+a)))","f(x^2*sqrt(a-x^2),-x/4*sqrt((a-x^2)^3)+1/8*a*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(a))),or(not(number(a)),a>0))"],"1.342944":["f(x^3*sqrt(x^2+a),(1/5*x^2-2/15*a)*sqrt((x^2+a)^3),and(number(a),a>0))","f(x^3*sqrt(x^2+a),sqrt((x^2+a)^5)/5-a*sqrt((x^2+a)^3)/3,and(number(a),a<0))","f(x^3*sqrt(a-x^2),(-1/5*x^2-2/15*a)*sqrt((a-x^2)^3),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^3,-1/2*sqrt(a-x^2)/x^2+1/2*log((sqrt(a)+sqrt(a-x^2))/x)/sqrt(a),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^4,-1/3*sqrt((a-x^2)^3)/a/x^3,or(not(number(a)),a>0))"],"0.636358":["f(x^2/sqrt(x^2+a),1/2*x*sqrt(x^2+a)-1/2*a*log(x+sqrt(x^2+a)))","f(x^2/sqrt(a-x^2),-x/2*sqrt(a-x^2)+a/2*arcsin(x/sqrt(a)),or(not(number(a)),a>0))"],"0.652928":["f(x^3/sqrt(x^2+a),1/3*sqrt((x^2+a)^3)-a*sqrt(x^2+a))","f(1/x^3*1/sqrt(x^2+a),-1/2*sqrt(x^2+a)/a/x^2+1/2*log((sqrt(a)+sqrt(x^2+a))/x)/a^(3/2),or(not(number(a)),a>0))","f(1/x^3*1/sqrt(x^2-a),1/2*sqrt(x^2-a)/a/x^2+1/2*1/(a^(3/2))*arcsec(x/(a^(1/2))),or(not(number(a)),a>0))"],"0.764022":["f(1/x^2*1/sqrt(x^2+a),-sqrt(x^2+a)/a/x)","f(1/x^2*1/sqrt(a-x^2),-sqrt(a-x^2)/a/x,or(not(number(a)),a>0))"],"1.578940":["f(x^2*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/6*x*sqrt((x^2+a^(1/3))^5)-1/24*a^(1/3)*x*sqrt((x^2+a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2+a^(1/3))-1/16*a*log(x+sqrt(x^2+a^(1/3))),or(not(number(a)),a>0))","f(x^2*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/6*x*sqrt((x^2-a^(1/3))^5)+1/24*a^(1/3)*x*sqrt((x^2-a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2-a^(1/3))+1/16*a*log(x+sqrt(x^2-a^(1/3))),or(not(number(a)),a>0))"],"1.620055":["f(x^3*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/7*sqrt((x^2+a^(1/3))^7)-1/5*a^(1/3)*sqrt((x^2+a^(1/3))^5),or(not(number(a)),a>0))","f(x^3*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/7*sqrt((x^2-a^(1/3))^7)+1/5*a^(1/3)*sqrt((x^2-a^(1/3))^5),or(not(number(a)),a>0))"],"0.332117":["f(1/(x-a)/sqrt(x^2-a^2),-sqrt(x^2-a^2)/a/(x-a))","f(1/(x+a)/sqrt(x^2-a^2),sqrt(x^2-a^2)/a/(x+a))"],"1.571443":["f(sqrt(a-x^2)/x^2,-sqrt(a-x^2)/x-arcsin(x/sqrt(a)),or(not(number(a)),a>0))"],"1.690994":["f(sin(a*x),-cos(a*x)/a)"],"1.055979":["f(cos(a*x),sin(a*x)/a)"],"1.116714":["f(tan(a*x),-log(cos(a*x))/a)"],"0.895484":["f(1/tan(a*x),log(sin(a*x))/a)"],"0.946989":["f(1/cos(a*x),log(tan(pi/4+a*x/2))/a)"],"0.591368":["f(1/sin(a*x),log(tan(a*x/2))/a)"],"2.859462":["f(sin(a*x)^2,x/2-sin(2*a*x)/(4*a))"],"2.128050":["f(sin(a*x)^3,-cos(a*x)*(sin(a*x)^2+2)/(3*a))","f(sin(a*x)^4,3/8*x-sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))"],"1.115091":["f(cos(a*x)^2,x/2+sin(2*a*x)/(4*a))"],"1.081452":["f(cos(a*x)^3,sin(a*x)*(cos(a*x)^2+2)/(3*a))","f(cos(a*x)^4,3/8*x+sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))"],"0.349716":["f(1/sin(a*x)^2,-1/(a*tan(a*x)))"],"0.896788":["f(1/cos(a*x)^2,tan(a*x)/a)"],"1.785654":["f(sin(a*x)*cos(a*x),sin(a*x)^2/(2*a))"],"3.188560":["f(sin(a*x)^2*cos(a*x)^2,-sin(4*a*x)/(32*a)+x/8)"],"1.516463":["f(sin(a*x)/cos(a*x)^2,1/(a*cos(a*x)))"],"2.707879":["f(sin(a*x)^2/cos(a*x),(log(tan(pi/4+a*x/2))-sin(a*x))/a)"],"0.369293":["f(cos(a*x)/sin(a*x)^2,-1/(a*sin(a*x)))"],"0.560019":["f(1/(sin(a*x)*cos(a*x)),log(tan(a*x))/a)"],"0.530332":["f(1/(sin(a*x)*cos(a*x)^2),(1/cos(a*x)+log(tan(a*x/2)))/a)"],"0.331177":["f(1/(sin(a*x)^2*cos(a*x)),(log(tan(pi/4+a*x/2))-1/sin(a*x))/a)"],"0.313621":["f(1/(sin(a*x)^2*cos(a*x)^2),-2/(a*tan(2*a*x)))"],"3.172365":["f(sin(a+b*x),-cos(a+b*x)/b)"],"1.127162":["f(cos(a+b*x),sin(a+b*x)/b)"],"0.352714":["f(1/(b+b*sin(a*x)),-tan(pi/4-a*x/2)/a/b)","f(1/(b-b*sin(a*x)),tan(pi/4+a*x/2)/a/b)","f(1/(a+b*sin(x)),1/sqrt(b^2-a^2)*log((a*tan(x/2)+b-sqrt(b^2-a^2))/(a*tan(x/2)+b+sqrt(b^2-a^2))),b^2-a^2)"],"0.454515":["f(1/(b+b*cos(a*x)),tan(a*x/2)/a/b)","f(1/(b-b*cos(a*x)),-1/tan(a*x/2)/a/b)","f(1/(a+b*cos(x)),1/sqrt(b^2-a^2)*log((sqrt(b^2-a^2)*tan(x/2)+a+b)/(sqrt(b^2-a^2)*tan(x/2)-a-b)),b^2-a^2)"],"1.615441":["f(x*sin(a*x),sin(a*x)/a^2-x*cos(a*x)/a)"],"1.543263":["f(x^2*sin(a*x),2*x*sin(a*x)/a^2-(a^2*x^2-2)*cos(a*x)/a^3)"],"1.008798":["f(x*cos(a*x),cos(a*x)/a^2+x*sin(a*x)/a)"],"0.963724":["f(x^2*cos(a*x),2*x*cos(a*x)/a^2+(a^2*x^2-2)*sin(a*x)/a^3)"],"1.611938":["f(arcsin(a*x),x*arcsin(a*x)+sqrt(1-a^2*x^2)/a)"],"1.791033":["f(arccos(a*x),x*arccos(a*x)-sqrt(1-a^2*x^2)/a)"],"1.123599":["f(arctan(a*x),x*arctan(a*x)-1/2*log(1+a^2*x^2)/a)"],"1.387031":["f(x*log(a*x),x^2*log(a*x)/2-x^2/4)"],"1.325058":["f(x^2*log(a*x),x^3*log(a*x)/3-1/9*x^3)"],"2.108018":["f(log(x)^2,x*log(x)^2-2*x*log(x)+2*x)"],"0.403214":["f(1/x*1/(a+log(x)),log(a+log(x)))"],"2.269268":["f(log(a*x+b),(a*x+b)*log(a*x+b)/a-x)"],"2.486498":["f(log(a*x+b)/x^2,a/b*log(x)-(a*x+b)*log(a*x+b)/b/x)"],"1.769733":["f(sinh(x),cosh(x))"],"1.883858":["f(cosh(x),sinh(x))"],"1.606140":["f(tanh(x),log(cosh(x)))"],"1.690661":["f(x*sinh(x),x*cosh(x)-sinh(x))"],"1.799688":["f(x*cosh(x),x*sinh(x)-cosh(x))"],"3.131954":["f(sinh(x)^2,sinh(2*x)/4-x/2)"],"2.579685":["f(tanh(x)^2,x-tanh(x))"],"3.548923":["f(cosh(x)^2,sinh(2*x)/4+x/2)"],"1.058866":["f(x^3*exp(a*x^2),exp(a*x^2)*(x^2/a-1/(a^2))/2)"],"1.235270":["f(x^3*exp(a*x^2+b),exp(a*x^2)*exp(b)*(x^2/a-1/(a^2))/2)"],"1.130783":["f(exp(a*x^2),-i*sqrt(pi)*erf(i*sqrt(a)*x)/sqrt(a)/2)"],"1.078698":["f(erf(a*x),x*erf(a*x)+exp(-a^2*x^2)/a/sqrt(pi))"],"2.573650":["f(x^2*(1-x^2)^(3/2),(x*sqrt(1-x^2)*(-8*x^4+14*x^2-3)+3*arcsin(x))/48)","f(x^2*(1-x^2)^(5/2),(x*sqrt(1-x^2)*(48*x^6-136*x^4+118*x^2-15)+15*arcsin(x))/384)"],"2.640666":["f(x^4*(1-x^2)^(3/2),(-x*sqrt(1-x^2)*(16*x^6-24*x^4+2*x^2+3)+3*arcsin(x))/128)"],"1.086487":["f(x*exp(a*x),exp(a*x)*(a*x-1)/(a^2))"],"1.267493":["f(x*exp(a*x+b),exp(a*x+b)*(a*x-1)/(a^2))"],"1.037943":["f(x^2*exp(a*x),exp(a*x)*(a^2*x^2-2*a*x+2)/(a^3))"],"1.210862":["f(x^2*exp(a*x+b),exp(a*x+b)*(a^2*x^2-2*a*x+2)/(a^3))"],"1.064970":["f(x^3*exp(a*x),exp(a*x)*x^3/a-3/a*integral(x^2*exp(a*x),x))"],"1.242392":["f(x^3*exp(a*x+b),exp(a*x+b)*x^3/a-3/a*integral(x^2*exp(a*x+b),x))"]};function Lm(t){return nn(_(l(t)))}function nn(t){return t===s(rr)?f.one:St(t,1)?f.zero:It(t)?I(nn(U(t)),x(f.imaginaryunit,f.Pi())):K(t)?tt(Math.log(t.d)):or(t)?Q(nn(Zr(t)),nn(Cr(t))):rt(t)?x(A(t),nn(l(t))):Y(t)?t.tail().map(nn).reduce(I,f.zero):q(s(Jo),t)}function $m(t){return Yl(_(l(t)))}function Yl(t){return K(t)?t.d>0?f.one:t.d===0?f.one:f.negOne:lt(t)?Ke(yr(t.q.a,t.q.b))===-1?f.negOne:le(yr(t.q.a,t.q.b))?f.zero:f.one:Qo(t)?x(T(f.negOne,me(t)),t):Ct(t)?x(q(s(In),U(t)),f.negOne):q(s(In),t)}function Cm(t){return jl(_(l(t)))}function jl(t){if(u(t)===s(sn))return l(t);if(K(t)){let r=Math.sinh(t.d);return Math.abs(r)<1e-10&&(r=0),tt(r)}return V(t)?f.zero:q(s(Ao),t)}function _a(t){t=c(t);let r=_(u(t));t=c(t);let e,o,n=_(u(t));for(n===s(L)?(e=cr(r),o=s(L)):C(n)?(e=cr(r),o=n):(e=n,t=c(t),o=_(u(t)));;){let i;C(o)?(i=et(o),isNaN(i)&&N("nth derivative: check n")):i=1;let a=r;if(i>=0)for(let m=0;m<i;m++)a=wt(a,e);else{i=-i;for(let m=0;m<i;m++)a=Tn(a,e)}if(r=a,o===s(L))break;if(C(o)){if(t=c(t),o=_(u(t)),o===s(L))break;C(o)||(e=o,t=c(t),o=_(u(t)))}else e=o,t=c(t),o=_(u(t))}return r}function wt(t,r){return C(r)&&N("undefined function"),H(t)?H(r)?Pm(t,r):Dm(t,r):H(r)?km(t,r):l0(t,r)}function l0(t,r){if(xt(r))return f0(t,r);let e=Gt(t,r,s(Pt));return Gt(wt(e,s(Pt)),s(Pt),r)}function f0(t,r){if(ot(t,r))return f.one;if(!M(t))return f.zero;if(X(t))return u0(t,r);switch(u(t)){case s(Ht):return m0(t,r);case s(ut):return c0(t,r);case s(Qr):return p0(t,r);case s(Jo):return d0(t,r);case s(fr):return g0(t,r);case s(ur):return b0(t,r);case s(ve):return _0(t,r);case s(Je):return h0(t,r);case s(We):return v0(t,r);case s(zr):return y0(t,r);case s(Ao):return E0(t,r);case s(go):return A0(t,r);case s(qo):return q0(t,r);case s(sn):return M0(t,r);case s(tn):return w0(t,r);case s(an):return S0(t,r);case s(Ce):return O0(t,r);case s(In):return T0(t,r);case s(ri):return N0(t,r);case s(Rn):return I0(t,r);case s(gi):return R0(t,r);case s(Ko):return L0(t,r);case s(Mn):return P0(t,r);default:}return u(t)===s(yo)&&A(t)===r?B0(t):x0(t,r)}function u0(t,r){let e=M(t)?t.tail().map(o=>wt(o,r)):[];return Gr(e)}function m0(t,r){let e=_r(t)-1,o=[];for(let n=0;n<e;n++){let i=[],a=c(t);for(let m=0;m<e;m++){let p=u(a);n===m&&(p=wt(p,r)),i.push(p),a=c(a)}o.push(se(i))}return Gr(o)}function c0(t,r){let e=$(A(t),l(t)),o=wt(l(t),r),n=nn(l(t)),i=wt(A(t),r);return x(I(x(e,o),x(n,i)),t)}function d0(t,r){let e=wt(l(t),r);return $(e,l(t))}function p0(t,r){let e=wt(l(t),r);return u(e)===s(Qr)?mr(A(e),A(t))?q(s(Qr),q(s(Qr),l(e),A(e)),A(t)):q(s(Qr),q(s(Qr),l(e),A(t)),A(e)):wt(e,A(t))}function x0(t,r){let e=c(t);return e===s(L)||it(e,r)?q(s(Qr),t,r):f.zero}function g0(t,r){let e=wt(l(t),r);return x(e,Sr(l(t)))}function b0(t,r){let e=wt(l(t),r);return U(x(e,br(l(t))))}function _0(t,r){let e=wt(l(t),r);return x(e,T(Sr(l(t)),y(-2)))}function h0(t,r){let e=wt(l(t),r);return x(e,T(Q(f.one,T(l(t),y(2))),P(-1,2)))}function v0(t,r){let e=wt(l(t),r);return U(x(e,T(Q(f.one,T(l(t),y(2))),P(-1,2))))}function y0(t,r){let e=wt(l(t),r);return Mt(x(e,gr(I(f.one,T(l(t),y(2))))))}function E0(t,r){let e=wt(l(t),r);return x(e,ea(l(t)))}function A0(t,r){let e=wt(l(t),r);return x(e,jl(l(t)))}function q0(t,r){let e=wt(l(t),r);return x(e,T(ea(l(t)),y(-2)))}function M0(t,r){let e=wt(l(t),r);return x(e,T(I(T(l(t),y(2)),f.one),P(-1,2)))}function w0(t,r){let e=wt(l(t),r);return x(e,T(I(T(l(t),y(2)),f.negOne),P(-1,2)))}function S0(t,r){let e=wt(l(t),r);return x(e,gr(Q(f.one,T(l(t),y(2)))))}function O0(t,r){let e=wt(l(t),r);return x(e,Yl(l(t)))}function T0(t,r){let e=wt(l(t),r);return x(x(e,Ml(l(t))),y(2))}function N0(t,r){let e=wt(l(t),r);return x(x(e,x(y(2),A(t))),Hs(l(t),I(A(t),f.negOne)))}function I0(t,r){let e=wt(l(t),r);return x(x(x(lr(x(T(l(t),y(2)),f.negOne)),T(f.Pi(),P(-1,2))),y(2)),e)}function R0(t,r){let e=wt(l(t),r);return x(x(x(lr(x(T(l(t),y(2)),f.negOne)),T(f.Pi(),P(-1,2))),y(-2)),e)}function L0(t,r){return V(A(t))?$0(t,r):C0(t,r)}function $0(t,r){let e=wt(l(t),r);return x(x(e,Xo(l(t),f.one)),f.negOne)}function C0(t,r){let e=wt(l(t),r);return x(e,I(Xo(l(t),I(A(t),f.negOne)),x($(x(A(t),f.negOne),l(t)),Xo(l(t),A(t)))))}function P0(t,r){return V(A(t))?k0(t,r):D0(t,r)}function k0(t,r){let e=wt(l(t),r);return x(x(e,Xo(l(t),f.one)),f.negOne)}function D0(t,r){let e=wt(l(t),r);return x(e,I(ra(l(t),I(A(t),f.negOne)),x($(x(A(t),f.negOne),l(t)),ra(l(t),A(t)))))}function B0(t){return l(t)}function Hl(t){if(D&&console.log(`Eval_user_function evaluating: ${u(t)}`),u(t)===s(bi)&&pt(s(bi))===s(bi))return _a(t);let r=_(u(t));C(r)?N("expected function invocation, found multiplication instead. Use '*' symbol explicitly for multiplication."):H(r)?N("expected function invocation, found tensor product instead. Use 'dot/inner' explicitly."):ee(r)&&N("expected function, found string instead.");let e=u(c(r)),o=u(c(c(r))),n=c(t);if(u(r)!==s(He)||r===u(t))return q(r,...Ql(n));t=o;let i=n,a=[];for(;M(t)&&M(i);)a.push(u(t)),a.push(u(i)),t=c(t),i=c(i);return a.length&&(e=ha(e,a)),_(e)}function ha(t,r){if(H(t))return U0(t,r);if(M(t)){let o=[];for(u(t)===r[0]?o.push(q(s(io),r[1])):o.push(u(t)),t=c(t);M(t);)o.push(ha(u(t),r)),t=c(t);return q(...o)}if(!xt(t))return t;for(let o=0;o<r.length;o+=2)if(t===r[o])return r[o+1];let e=pt(t);return t!==e&&ha(e,r)===e?t:e}function U0(t,r){return t=ro(t),t.tensor.elem=t.tensor.elem.map(e=>ha(e,r)),Dt(t),t}function Hr(t){return et(_(t))}function _(t){let r;va(),t==null&&er,!h.evaluatingAsFloats&&En(t)&&(r=!0,h.evaluatingAsFloats=!0);try{switch(t.k){case ln:return F0(t);case Zt:return h.evaluatingAsFloats?tt(Fe(t)):t;case Ut:case fn:return t;case un:return mc(t);case Fr:return G0(t);default:N("atom?")}}finally{r&&(h.evaluatingAsFloats=!1)}}function G0(t){if(ya(t))return _(q(t,s(_i)));if(t===s(vt)&&h.evaluatingAsFloats)return f.piAsDouble;let r=pt(t);if(D&&console.log(`looked up: ${t} which contains: ${r}`),t!==r){let e=h.chainOfUserSymbolsNotFunctionsBeingEvaluated.indexOf(t);if(e!==-1){let o="";for(let n=e;n<h.chainOfUserSymbolsNotFunctionsBeingEvaluated.length;n++)o+=h.chainOfUserSymbolsNotFunctionsBeingEvaluated[n].printname+" -> ";o+=t.printname,N("recursive evaluation of symbols: "+o);return}h.chainOfUserSymbolsNotFunctionsBeingEvaluated.push(t),r=_(r),h.chainOfUserSymbolsNotFunctionsBeingEvaluated.pop()}return r}function F0(t){let r=u(t);return u(r)===s(io)?Hl(t):(xt(r)||N("cons?"),r.keyword?r.keyword(t):Hl(t))}function Bm(t){return pt(l(t))}function Um(t){let r=Go(l(t));return r==null?t:y(Number(r))}function Gm(t){let r=_(l(t));return Zs(r)}function Fm(t){let r=_(l(t)),e=M(Er(t))?Hr(A(t)):1;return H(r)?e<1||e>r.tensor.ndim?t:y(r.tensor.dim[e-1]):f.one}function zm(t){return Kf(_(l(t)))}function Vm(t){let r=u(t);for(t=c(t);M(t);)r=_(u(t)),t=c(t);return r}function Zm(t){let r=_(l(t));for(t=Er(t);M(t);)r=Gt(r,_(u(t)),_(l(t))),t=Er(t);return _(r)}function Ym(t){return lr(_(l(t)))}function jm(t){return Ar(_(l(t)))}function Hm(t){t=c(t);let r=_(u(t));t=c(t);let e=_(u(t)),o=_e(r,e);return M(t)&&(o=t.tail().reduce((n,i)=>_e(n,_(i)),o)),o}function Qm(t){let r=_(A(t)),e=_(l(t));return Hs(e,r)}function Jm(t){return Vu(_(l(t)))}function Wm(t){let r=t;t=c(t);let e=_(u(t));if(C(e)&&N("trying to access a scalar as a tensor"),!H(e))return r;let o=[];for(t=c(t);M(t);){if(o.push(_(u(t))),!uc(o[o.length-1]))return r;t=c(t)}return Cf(e,o)}function Xm(t){let r=_(l(t));return xo(r)}function Km(t){let r=_(l(t));return Qu(r)}function tc(t){return t=_(l(t)),lt(t)?qt(t)?f.one:f.zero:K(t)?Math.floor(t.d)===t.d?f.one:f.zero:q(s(Ea),t)}function rc(t){return t=_(l(t)),t.k===Zt||t.k===Ut?f.one:f.zero}function ec(t){return q(s(Wo),...Ql(c(t)))}function oc(t){return l(t)}function nc(t){return t=_(l(t)),H(t)?y(t.tensor.ndim):f.zero}function ic(t){if(Oe(t)===s(ho))return z0(t);if(M(l(t)))return kf(t);xt(l(t))||N("symbol assignment: error in symbol");let r=_(A(t));return Jt(l(t),r),s(L)}function z0(t){let r=ci(t);console.log(`p4: ${r}`),xt(r)||N("indexed assignment: expected a symbol name");let e=_(A(t)),o=[],n=zn(t);M(n)&&(o=[...n].map(_));let i=Pf(e,...o);return Jt(r,i),s(L)}function sc(t){let r=_(l(t));return T(r,P(1,2))}function ac(){N("user stop")}function lc(t){let r=_(l(t)),e=_(A(t)),o=_(Ft(t));return _(Gt(o,e,r))}function fc(t){let r=Hr(l(t));if(isNaN(r)||r<1)return t;t=ct(r*r),t.tensor.ndim=2,t.tensor.dim[0]=r,t.tensor.dim[1]=r;for(let e=0;e<r;e++)t.tensor.elem[r*e+e]=f.one;return Dt(t),t}function Jl(t){return u(t)===s(Ee)&&(t=q(s(Ge),l(t),A(t))),_(t)}function*Ql(t){if(M(t))for(let r of t)yield _(r)}var us=0;function cc(t){let r=[];t=c(t);for(let e of t){let o=_(e);Aa(r,o)}return Wl(r)}function Wl(t){if(D)for(let r of t)console.log(Kr(r));for(let r=0;r<10&&!(t.length<2||(us=0,t.sort(Z0),us===0));r++)Y0(t);switch(t.length){case 0:return f.Zero();case 1:return t[0];default:return t.unshift(s(Pr)),q(...t)}}var V0=0;function Z0(t,r){if(V0++,C(t)&&C(r))return us=1,0;if(H(t)&&H(r)){if(t.tensor.ndim<r.tensor.ndim)return-1;if(t.tensor.ndim>r.tensor.ndim)return 1;for(let o=0;o<t.tensor.ndim;o++){if(t.tensor.dim[o]<r.tensor.dim[o])return-1;if(t.tensor.dim[o]>r.tensor.dim[o])return 1}return us=1,0}Y(t)&&(t=c(t),C(u(t))&&(t=c(t),c(t)===s(L)&&(t=u(t)))),Y(r)&&(r=c(r),C(u(r))&&(r=c(r),c(r)===s(L)&&(r=u(r))));let e=Ie(t,r);return e===0&&(us=1),e}function Y0(t){let r=0;for(;r<t.length-1;){va();let e,o,n=t[r],i=t[r+1];if(H(n)&&H(i)){e=dc(n,i),e!==s(L)&&(t.splice(r,2,e),r--),r++;continue}if(H(n)||H(i)){r++;continue}if(C(n)&&C(i)){e=Xl(n,i),V(e)?t.splice(r,2):t.splice(r,2,e),r--,r++;continue}if(C(n)||C(i)){r++;continue}e=f.One(),o=f.One();let a=0;if(Y(n)&&(n=c(n),a=1,C(u(n))&&(e=u(n),n=c(n),c(n)===s(L)&&(n=u(n),a=0))),Y(i)&&(i=c(i),C(u(i))&&(o=u(i),i=c(i),c(i)===s(L)&&(i=u(i)))),!ot(n,i)){r++;continue}if(e=Xl(e,o),V(e)){t.splice(r,2),r--,r++;continue}let m=a?new Rr(s(Ht),n):n;t.splice(r,2,x(e,m)),r--,r++}}function Aa(t,r){X(r)?t.push(...r.tail()):Xn(r)||t.push(r)}function I(t,r){let e=[];return Aa(e,t),Aa(e,r),Wl(e)}function Gr(t){let r=[];for(let e of t)Aa(r,e);return Wl(r)}function Q(t,r){return I(t,U(r))}var ce=!1;function pc(t){return be(_(l(t)))}function Sn(t){return ui(_(me(_(t))))}function be(t){let r=Zr(t),e=me(r),o=Cr(t),n=me(o),i=$(e,n);return ce&&(console.trace(">>>>  ABS of "+t),console.log(`ABS numerator ${r}`),console.log(`ABSVAL numerator: ${e}`),console.log(`ABS denominator: ${o}`),console.log(`ABSVAL denominator: ${n}`),console.log(`ABSVAL divided: ${i}`),console.log("<<<<<<<  ABS")),i}function me(t){let r=t;if(ce&&console.log(`ABS of ${t}`),V(t))return ce&&(console.log(` abs: ${t} just zero`),console.log(" --> ABS of "+r+" : "+f.zero)),f.zero;if(It(t))return ce&&console.log(` abs: ${t} just a negative`),U(t);if(An(t))return ce&&(console.log(` abs: ${t} just a positive`),console.log(` --> ABS of ${r} : ${t}`)),t;if(t===s(vt))return ce&&(console.log(` abs: ${t} of PI`),console.log(` --> ABS of ${r} : ${t}`)),t;if(X(t)&&(hn(t,t)||Fn(t)||it(t,f.imaginaryunit))){ce&&(console.log(` abs: ${t} is a sum`),console.log("abs of a sum")),t=Or(t);let o=wm(T(I(T(Yr(t),y(2)),T(Ho(t),y(2))),P(1,2)));return ce&&console.log(` --> ABS of ${r} : ${o}`),o}if(rt(t)&&St(l(t),-1)){let o=f.One();if(ce){console.log(` abs: ${t} is -1 to any power`);let n=h.evaluatingAsFloats?" abs: numeric, so result is 1.0":" abs: symbolic, so result is 1";console.log(n),console.log(` --> ABS of ${r} : ${o}`)}return o}if(rt(t)&&An(A(t))){let o=T(be(l(t)),A(t));return ce&&(console.log(` abs: ${t} is something to the power of a positive number`),console.log(` --> ABS of ${r} : ${o}`)),o}if(rt(t)&&l(t)===s(rr)){let o=lr(Yr(A(t)));return ce&&(console.log(` abs: ${t} is an exponential`),console.log(` --> ABS of ${r} : ${o}`)),o}if(Y(t)){let o=t.tail().map(me).reduce(x);return ce&&(console.log(` abs: ${t} is a product`),console.log(` --> ABS of ${r} : ${o}`)),o}if(u(t)===s(Ce)){let o=q(s(Ce),l(t));return ce&&(console.log(` abs: ${t} is abs of a abs`),console.log(` --> ABS of ${r} : ${o}`)),o}if(H(t))return j0(t);(Ct(t)||X(t)&&Ct(l(t)))&&(t=U(t));let e=q(s(Ce),t);return ce&&(console.log(` abs: ${t} is nothing decomposable`),console.log(` --> ABS of ${r} : ${e}`)),e}function j0(t){return t.tensor.ndim!==1&&N("abs(tensor) with tensor rank > 1"),_(Mt(T(Ur(t,Ne(t)),P(1,2))))}var ms=!1;function Xn(t){switch(t.k){case Zt:if(le(t.q.a))return!0;break;case Ut:if(t.d===0)return!0;break}return!1}function H0(t){return H(t)?t.tensor.elem.every(r=>V(r)):!1}function V(t){return Xn(t)||H0(t)}function Go(t){let r=Jl(t);if(V(r))return!1;if(ke(r))return!0;if(r=ui(r),V(r))return!1;if(ke(r))return!0;if(it(r,f.imaginaryunit)){if(r=Jl(Sn(r)),V(r))return!1;if(ke(r))return!0}return null}function It(t){switch(t.k){case Zt:if(Ke(t.q.a)===-1)return!0;break;case Ut:if(t.d<0)return!0;break}return!1}function An(t){switch(t.k){case Zt:if(Ke(t.q.a)===1)return!0;break;case Ut:if(t.d>0)return!0;break}return!1}function Uo(t){switch(t.k){case Zt:if(Wt(t.q.a,2)&&Wt(t.q.b,1))return!0;break;case Ut:if(t.d===2)return!0;break}return!1}function Et(t){switch(t.k){case Zt:if(Wt(t.q.a,1)&&Wt(t.q.b,1))return!0;break;case Ut:if(t.d===1)return!0;break}return!1}function Nt(t){switch(t.k){case Zt:if(Wt(t.q.a,-1)&&Wt(t.q.b,1))return!0;break;case Ut:if(t.d===-1)return!0;break}return!1}function Xe(t){return Et(t)||Nt(t)}function qt(t){return t.k===Zt&&Wt(t.q.b,1)}function uc(t){return t.k===Ut?t.d===Math.round(t.d):qt(t)}function qa(t){return lt(t)&&Wt(t.q.b,1)&&Ke(t.q.a)===1}function On(t){return qt(t)&&Ke(t.q.a)===1}function hl(t,r){return r==null&&(r=cr(t)),J0(t,r)&&Q0(it(t,s(Xr)),it(t,s(ao)),it(t,s(lo)))===1?r:!1}function Q0(...t){return t.reduce((r,e)=>r+Number(e),0)}function J0(t,r){return W0(t,r)}function W0(t,r){return Y(t)?t.tail().every(e=>{let o=xc(e,r);return D&&(console.log(`ispolyfactoredorexpandedform_factor testing ${e}`),o&&console.log(`... tested negative:${e}`)),o}):xc(t,r)}function xc(t,r){return rt(t)?(D&&console.log("ispolyfactoredorexpandedform_power (isposint(caddr(p)) "+(On(A(t)),D?console.log("ispolyfactoredorexpandedform_power ispolyexpandedform_expr(cadr(p), x)) "+Ma(l(t),r)):void 0)),On(A(t))&&Ma(l(t),r)):(D&&console.log(`ispolyfactoredorexpandedform_power not a power, testing if this is exp form: ${t}`),Ma(t,r))}function Dr(t,r){return it(t,r)?Ma(t,r):!1}function Ma(t,r){return X(t)?t.tail().every(e=>gc(e,r)):gc(t,r)}function gc(t,r){return Y(t)?t.tail().every(e=>bc(e,r)):bc(t,r)}function bc(t,r){return ot(t,r)?!0:rt(t)&&ot(l(t),r)?On(A(t)):!it(t,r)}function Ct(t){return It(t)||Y(t)&&It(l(t))}function _c(t){return rt(t)&&lt(u(c(c(t))))&&It(u(c(t)))?(ms&&console.log(`hasNegativeRationalExponent: ${t} has imaginary component`),!0):(ms&&console.log(`hasNegativeRationalExponent: ${t} has NO imaginary component`),!1)}function hc(t){return Y(t)&&_r(t)===3&&K(l(t))&&_c(A(t))||ot(t,f.imaginaryunit)}function wa(t){return Y(t)&&_r(t)===3&&C(l(t))&&ot(A(t),f.imaginaryunit)||ot(t,f.imaginaryunit)||_c(A(t))?(ms&&console.log(`isimaginarynumber: ${t} is imaginary number`),!0):(ms&&console.log(`isimaginarynumber: ${t} isn't an imaginary number`),!1)}function $u(t){return X(t)&&_r(t)===3&&K(l(t))&&hc(A(t))||hc(t)}function Qo(t){return ms&&er,X(t)&&_r(t)===3&&C(l(t))&&wa(A(t))||wa(t)?(D&&console.log(`iscomplexnumber: ${t} is imaginary number`),!0):(D&&console.log(`iscomplexnumber: ${t} is imaginary number`),!1)}function qn(t){return qt(t)&&t.q.a.isEven()}function ie(t){return X(t)&&Ct(l(t))||Ct(t)}function Kl(t){return xt(t)?!0:M(t)?[...t].some(Kl):!1}function vc(t){return qt(t)||rt(t)&&qt(l(t))&&qt(A(t))}function yc(t){return or(t)&&Wt(t.q.a.abs(),1)}function Ec(t){return rt(t)&&Nt(A(t))}function or(t){return t.k===Zt&&!Wt(t.q.b,1)}function St(t,r){switch(t.k){case Zt:return Wt(t.q.a,r)&&Wt(t.q.b,1);case Ut:return t.d===r;default:return!1}}function zt(t,r,e){switch(t.k){case Zt:return Wt(t.q.a,r)&&Wt(t.q.b,e);case Ut:return t.d===r/e;default:return!1}}function $e(t){return zt(t,1,2)}function ts(t){return zt(t,-1,2)}function Ln(t){return rt(t)&&St(l(t),2)&&zt(A(t),-1,2)}function hi(t){return Y(t)&&St(l(t),-1)&&Ln(A(t))&&_r(t)===3}function Sa(t){return Y(t)&&$e(l(t))&&Ac(A(t))&&_r(t)===3}function Oa(t){return Y(t)&&ts(l(t))&&Ac(A(t))&&_r(t)===3}function Ac(t){return rt(t)&&St(l(t),3)&&$e(A(t))}function En(t){return t.k===Ut||t===s(Ta)?!0:M(t)?[...t].some(En):!1}function Se(t){return ot(t,f.imaginaryunit)}function rs(t){let r=0;if(!Y(t))return 0;if(ot(l(t),f.imaginaryunit))return A(t)!==s(vt)||_r(t)!==3?0:2;if(!C(l(t))||!ot(A(t),f.imaginaryunit)||Ft(t)!==s(vt)||_r(t)!==4)return 0;let e=et(x(l(t),y(2)));if(isNaN(e))return 0;switch(e<1&&(r=1,e=-e),e%4){case 0:e=1;break;case 1:e=r?4:3;break;case 2:e=2;break;case 3:e=r?3:4}return e}function Hn(t){let r=0;return t===s(vt)?2:!Y(t)||!C(l(t))||A(t)!==s(vt)||_r(t)!==3||(r=et(x(l(t),y(2))),isNaN(r))?0:(r<0?r=4- -r%4:r=1+(r-1)%4,r)}function tf(t,r){return t===r?0:t>r?1:-1}function Na(t){let r;if(h.codeGen||h.fullDoubleOutput)return""+t;if(V(pt(s(Ia))))r=""+t,h.printMode===ft?/\d*\.\d*e.*/gm.test(r)?r=r.replace(/e(.*)/gm,"\\mathrm{e}{$1}"):r=r.replace(/(\d+)e(.*)/gm,"$1.0\\mathrm{e}{$2}"):/\d*\.\d*e.*/gm.test(r)?r=r.replace(/e(.*)/gm,"*10^($1)"):r=r.replace(/(\d+)e(.*)/gm,"$1.0*10^($2)");else{let e=et(pt(s(Ra)));r=""+t.toFixed(e),r=r.replace(/(\.\d*?[1-9])0+$/gm,"$1"),r=r.replace(/\.0+$/gm,""),r.indexOf(".")===-1&&(r+=".0"),parseFloat(r)!==t&&(r=t.toFixed(e)+"...")}return r}function qc(){}function fm(t){return t==null?!1:t===" "||t==="	"||t===`
`||t==="\v"||t==="\f"||t==="\r"}function wn(t){return t==null?!1:/^\d+$/.test(t)}function um(t){return t==null?!1:t.search(/[^A-Za-z]/)===-1}function X0(t){return t==null?!1:t.search(/[^A-Za-z_]/)===-1}function mm(t){return t==null?!1:X0(t)||wn(t)}function Du(t,r){let e=[];return M(t)&&e.push(...t),M(r)&&e.push(...r),q(...e)}function Xu(t,r){N("Not implemented")}function tm(t,r){N("Not implemented")}function Mc(t,r){let e=yr(t.q.a,r.q.b),o=yr(t.q.b,r.q.a),n=Cs(e,o);if(le(n))return f.zero;let i=yr(t.q.b,r.q.b),a=Qe(n,i);a=mo(a,i);let m=kr(n,a),p=kr(i,a);return new Tt(m,p)}function wc(t,r){if(le(r.q.a)&&N("divide by zero"),le(t.q.a))return f.zero;let e=yr(t.q.a,r.q.b),o=yr(t.q.b,r.q.a),n=Qe(e,o);return n=mo(n,o),new Tt(kr(e,n),kr(o,n))}function Sc(t,r){if(le(t.q.a)||le(r.q.a))return f.zero;let e=yr(t.q.a,r.q.a),o=yr(t.q.b,r.q.b),n=Qe(e,o);return n=mo(n,o),new Tt(kr(e,n),kr(o,n))}function Lo(t){return(0,hr.default)(t)}function Ki(t){return t.geq(Number.MIN_SAFE_INTEGER)&&t.leq(Number.MAX_SAFE_INTEGER)}function Zn(t,r){if(t.isPositive()){if(r<0)return t.multiply((0,hr.default)(-1))}else if(r>0)return t.multiply((0,hr.default)(-1));return t}function mo(t,r){if(t.isPositive()){if(r.isNegative())return t.multiply((0,hr.default)(-1))}else if(r.isPositive())return t.multiply((0,hr.default)(-1));return t}function Iu(t){return t.isNegative()?t.multiply((0,hr.default)(-1)):t}function Xl(t,r){if(lt(t)&&lt(r))return Mc(t,r);let e=K(t)?t.d:Fe(t),o=K(r)?r.d:Fe(r);return tt(e+o)}function es(t,r){if(lt(t)&&lt(r))return Sc(t,r);let e=K(t)?t.d:Fe(t),o=K(r)?r.d:Fe(r);return new de(e*o)}function Bu(t,r){if(lt(t)&&lt(r))return wc(t,r);V(r)&&N("divide by zero");let e=K(t)?t.d:Fe(t),o=K(r)?r.d:Fe(r);return new de(e/o)}function Uu(t){if(V(t)&&N("divide by zero"),K(t))return new de(1/t.d);let r=(0,hr.default)(t.q.a),e=(0,hr.default)(t.q.b);return e=mo(e,r),r=Zn(r,1),new Tt(e,r)}function K0(t,r){let e=yr(t.q.a,r.q.b),o=yr(t.q.b,r.q.a);return _n(e,o)}function Fs(t,r){if(lt(t)&&lt(r))return K0(t,r);let e=K(t)?t.d:Fe(t),o=K(r)?r.d:Fe(r);return e<o?-1:e>o?1:0}function Gu(t){if(V(t))return t;switch(t.k){case Zt:return new Tt((0,hr.default)(t.q.a.multiply(hr.default.minusOne)),(0,hr.default)(t.q.b));case Ut:return new de(-t.d);default:N("bug caught in mp_negate_number")}}function Gs(t){let r=kr(t.q.a,t.q.b);return new Tt(r)}function Le(t){return lt(t)?new Tt((0,hr.default)(t.q.a)):f.one}function Re(t){return lt(t)?new Tt((0,hr.default)(t.q.b)):f.one}function Tu(t,r){let e=$o(t.q.a,Math.abs(r)),o=$o(t.q.b,Math.abs(r));if(r<0){let n=e;e=o,o=n,e=mo(e,o),o=Zn(o,1)}return new Tt(e,o)}function Fe(t){t.q==null&&er;let r=t.q.a.divmod(t.q.b);return r.quotient.toJSNumber()+r.remainder.toJSNumber()/t.q.b.toJSNumber()}function y(t){return new Tt((0,hr.default)(t))}function tt(t){return new de(t)}function P(t,r){return new Tt((0,hr.default)(t),(0,hr.default)(r))}function et(t){let r=NaN;switch(t.k){case Zt:qt(t)&&Ki(t.q.a)&&(r=t.q.a.toJSNumber());break;case Ut:D&&console.log("popping integer but double is found"),Math.floor(t.d)===t.d&&(D&&console.log("...although it's an integer"),r=t.d);break}return r}function cm(t){let r=0,e=t[r];(e==="+"||e==="-")&&r++;let o=(0,hr.default)(t.substring(r)),n=new Tt(o);return e==="-"&&(n=U(n)),n}function dm(t){return tt(parseFloat(t))}function rf(t,r){let e="",o="",n="";switch(t.k){case Zt:var i=t.q.a.toString();r||i[0]==="-"&&(i=i.substring(1)),h.printMode===ft&&or(t)&&(i="\\frac{"+i+"}{"),e+=i,or(t)&&(h.printMode!==ft&&(e+="/"),o=t.q.b.toString(),h.printMode===ft&&(o+="}"),e+=o);break;case Ut:i=Na(t.d),r||i[0]==="-"&&(i=i.substring(1)),e+=i;break}return e}function cu(t,r){let e=Qe(t.q.a,r.q.a),o=Qe(t.q.b,r.q.b);return new Tt(Zn(e,1),o)}function co(t){let r=0;switch(t.k){case Zt:r=Fe(t);break;case Ut:({d:r}=t);break;default:r=0}return r}function xm(t){let r=Fe(t);return new de(r)}function wu(t){return new Tt(t_(t))}function t_(t){let r;if(t===0||t===1)return r=(0,hr.default)(1),r;r=(0,hr.default)(2);let e=(0,hr.default)(0);if(3<=t)for(let o=3;o<=t;o++)e=(0,hr.default)(o),r=yr(r,e);return r}function ef(t){return $r(r_,t)}function r_(t){let r=Dr(t,s(Zo)),e=Dr(t,s(Yo)),o=Dr(t,s(Xr)),n=Dr(t,s(ao)),i=Dr(t,s(lo)),a;return r&&!e&&!o&&!n&&!i?a=vi(t,s(Zo)):!r&&e&&!o&&!n&&!i?a=vi(t,s(Yo)):!r&&!e&&o&&!n&&!i?a=vi(t,s(Xr)):!r&&!e&&!o&&n&&!i?a=vi(t,s(ao)):!r&&!e&&!o&&!n&&i?a=vi(t,s(lo)):M(t)&&u(t)!==s(yi)?a=q(u(t),...t.tail().map(ef)):a=t,a}function Gl(t,r){return Dr(t,r)?vi(t,r):M(t)?q(u(t),...t.tail().map(e=>Gl(e,r))):t}function vi(t,r){let e=Te(t,r),o=[];for(let n=e.length-1;n>=0;n--){let i=e[n];o.push(...e_(n,i,r))}return o.length>1?new Rr(s(Pr),q(...o)):o[0]}function e_(t,r,e){if(V(r))return[];if(t===0)return X(r)?r.tail():[r];let o=[];return Y(r)?o.push(...r.tail()):St(r,1)||o.push(r),t===1?o.push(e):o.push(q(s(ut),e,y(t))),o.length>1?[q(s(Ht),...o)]:o}function Oc(t){return La(l(t))}function La(t){if(H(t)){let r=ct(t.tensor.nelem);return r.tensor.ndim=t.tensor.ndim,r.tensor.dim=Array.from(t.tensor.dim),r.tensor.elem=r.tensor.elem.map(e=>{let o=La(e);return Dt(r),o}),r}return t.k===Ut?o_(t):M(t)?new Rr(La(u(t)),La(c(t))):t}function o_(t){let r=ui(t);if(r.k===Ut){let e=r.d,o=e.toString().split(".");if(o.length===2){let n=o[1].length,i=1/Math.pow(10,n),a=n_(e,i);return P(a[0],a[1])}return y(e)}return q(s($a),r)}function n_(t,r){if(isNaN(t))return[0,0];if(t===1/0)return[1,0];if(t===-1/0)return[-1,0];let e=t<0?-1:1;if(t=Math.abs(t),Math.abs(t-Math.floor(t))<r)return[t*e,1];if(t<1e-19)return[e,1e19];if(t>1e19)return[1e19*e,1];let o=t,n=0,i=1,a;for(;;){o=1/(o-Math.floor(o));let m=i;if(i=i*Math.floor(o)+n,n=m,a=Math.floor(t*i+.5),!(Math.abs(t-a/i)>r)||o===Math.floor(o))break}return a=e*a,[a,i]}var ze=0,i_=1,Tc=2,Nc=3,of=4;var s_=6,Ic=7,a_=8,l_=9;function f_(t){let r,e=t.toString().split(".");if(e.length===2){let i=e[1].length;r=1/Math.pow(10,i)}else return[""+Math.floor(t),ze,Math.floor(t),1,2];console.log(`precision: ${r}`);let o=null,n=Number.MAX_VALUE;for(let i of[2,3,5,6,7,8,10])for(let a=1;a<=10;a++){let m,p,g,v=Math.sqrt(i)/a;if(Math.abs(v)>1e-10?(g=t/v,p=Math.round(g),m=Math.abs(1-g/p)):(g=1,p=1,m=Math.abs(t-v)),m<2*r){let F=Ae(p,i,a);F<n&&(n=F,o=[`${p} * sqrt( ${i} ) / ${a}`,s_,p,i,a])}}return o}function u_(t){let r,e=t.toString().split(".");if(e.length===2){let i=e[1].length;r=1/Math.pow(10,i)}else return[""+Math.floor(t),ze,Math.floor(t),1,2];console.log(`precision: ${r}`);let o=null,n=Number.MAX_VALUE;for(let i of[1,2,3,5,6,7,8,10])for(let a of[1,2,3,5,6,7,8,10]){let m,p,g,v=Math.sqrt(i/a);if(Math.abs(v)>1e-10?(g=t/v,p=Math.round(g),m=Math.abs(1-g/p)):(g=1,p=1,m=Math.abs(t-v)),m<2*r){let F=Ae(p,i,a);F<n&&(n=F,o=[`${p} * (sqrt( ${i} / ${a} )`,of,p,i,a])}}return o}function mn(t){let r,e=t.toString().split(".");if(e.length===2){let i=e[1].length;r=1/Math.pow(10,i)}else return[""+Math.floor(t),ze,Math.floor(t),1,2];console.log(`precision: ${r}`);let o=f_(t);if(o!=null)return o;let n=u_(t);return n!=null?n:null}function cs(t){let r,e=t.toString().split(".");if(e.length===2){let i=e[1].length;r=1/Math.pow(10,i)}else return[""+Math.floor(t),ze,Math.floor(t),1,2];console.log(`precision: ${r}`);let o=nf(t);if(o!=null)return o;let n=m_(t);return n!=null?n:null}function nf(t){let r,e=t.toString().split(".");if(e.length===2){let i=e[1].length;r=1/Math.pow(10,i)}else return[""+Math.floor(t),ze,Math.floor(t),1,2];console.log(`precision: ${r}`);let o=null,n=Number.MAX_VALUE;for(let i=2;i<=5;i++)for(let a=1;a<=5;a++){let m,p,g,v=Math.log(i)/a;if(Math.abs(v)>1e-10?(g=t/v,p=Math.round(g),m=Math.abs(1-g/p)):(g=1,p=1,m=Math.abs(t-v)),!(p!==1&&Math.abs(Math.floor(p/a))===Math.abs(p/a))&&m<2.2*r){let F=Ae(p,i,a);F<n&&(n=F,o=[`${p} * log( ${i} ) / ${a}`,l_,p,i,a])}}return o}function m_(t){let r,e=t.toString().split(".");if(e.length===2){let i=e[1].length;r=1/Math.pow(10,i)}else return[""+Math.floor(t),ze,Math.floor(t),1,2];console.log(`precision: ${r}`);let o=null,n=Number.MAX_VALUE;for(let i=1;i<=5;i++)for(let a=1;a<=5;a++){let m,p,g,v=Math.log(i/a);if(Math.abs(v)>1e-10?(g=t/v,p=Math.round(g),m=Math.abs(1-g/p)):(g=1,p=1,m=Math.abs(t-v)),m<1.96*r){let F=Ae(p,i,a);F<n&&(n=F,o=[`${p} * log( ${i} / ${a} )`,a_,p,i,a])}}return o}function Rc(t){let r,e=t.toString().split(".");if(e.length===2){let i=e[1].length;r=1/Math.pow(10,i)}else return[""+Math.floor(t),ze,Math.floor(t),1,2];console.log(`precision: ${r}`);let o=null,n=Number.MAX_VALUE;for(let i=1;i<=2;i++)for(let a=1;a<=12;a++){let m,p,g,v=Math.pow(Math.E,i)/a;if(Math.abs(v)>1e-10?(g=t/v,p=Math.round(g),m=Math.abs(1-g/p)):(g=1,p=1,m=Math.abs(t-v)),m<2*r){let F=Ae(p,i,a);F<n&&(n=F,o=[`${p} * (e ^ ${i} ) / ${a}`,Ic,p,i,a])}}return o}function sf(t){let r,e=t.toString().split(".");if(e.length===2){let i=e[1].length;r=1/Math.pow(10,i)}else return[""+Math.floor(t),ze,Math.floor(t),1,2];console.log(`precision: ${r}`);let o=null,n=Number.MAX_VALUE;for(let i=1;i<=5;i++)for(let a=1;a<=12;a++){let m,p,g,v=Math.pow(Math.PI,i)/a;if(Math.abs(v)>1e-10?(g=t/v,p=Math.round(g),m=Math.abs(1-g/p)):(g=1,p=1,m=Math.abs(t-v)),m<2*r){let F=Ae(p,i,a);F<n&&(n=F,o=[`${p} * (pi ^ ${i} ) / ${a} )`,Nc,p,i,a])}}return o}function ds(t){let r,e=t.toString().split(".");if(e.length===2){let i=e[1].length;r=1/Math.pow(10,i)}else return[""+Math.floor(t),ze,Math.floor(t),1,2];console.log(`precision: ${r}`);let o=c_(t);if(o!=null)return o;let n=d_(t);return n!=null?n:null}function c_(t){let r,e=t.toString().split(".");if(e.length===2){let i=e[1].length;r=1/Math.pow(10,i)}else return[""+Math.floor(t),ze,Math.floor(t),1,2];console.log(`precision: ${r}`);let o=null,n=Number.MAX_VALUE;for(let i=1;i<=4;i++)for(let a=1;a<=4;a++){let m,p,g,v=i/a,F=Math.sin(v);if(Math.abs(F)>1e-10?(g=t/F,p=Math.round(g),m=Math.abs(1-g/p)):(g=1,p=1,m=Math.abs(t-F)),m<2*r){let B=Ae(p,i,a);B<n&&(n=B,o=[`${p} * sin( ${i}/${a} )`,i_,p,i,a])}}return o}function d_(t){let r,e=t.toString().split(".");if(e.length===2){let i=e[1].length;r=1/Math.pow(10,i)}else return[""+Math.floor(t),ze,Math.floor(t),1,2];console.log(`precision: ${r}`);let o=null,n=Number.MAX_VALUE;for(let i=1;i<=13;i++)for(let a=1;a<=13;a++){let m,p,g,v=i/a,F=Math.sin(Math.PI*v);if(Math.abs(F)>1e-10?(g=t/F,p=Math.round(g),m=Math.abs(1-g/p)):(g=1,p=1,m=Math.abs(t-F)),m<23*r){let B=Ae(p,i,a);B<n&&(n=B,o=[`${p} * sin( ${i}/${a} * pi )`,Tc,p,i,a])}}return o}function At(t){let r,e=t.toString().split(".");if(e.length===2){let B=e[1].length;r=1/Math.pow(10,B)}else return[""+Math.floor(t),ze,Math.floor(t),1,2];console.log(`precision: ${r}`);let o=Number.MAX_VALUE,n=0,i=null,a=!0,m=mn(t);m!=null&&(n=Ae(m),n<o?(a&&console.log(`better explanation by approxRadicals: ${m} complexity: ${n}`),o=n,i=m):a&&console.log(`subpar explanation by approxRadicals: ${m} complexity: ${n}`));let p=cs(t);p!=null&&(n=Ae(p),n<o?(a&&console.log(`better explanation by approxLogs: ${p} complexity: ${n}`),o=n,i=p):a&&console.log(`subpar explanation by approxLogs: ${p} complexity: ${n}`));let g=Rc(t);g!=null&&(n=Ae(g),n<o?(a&&console.log(`better explanation by approxRationalsOfPowersOfE: ${g} complexity: ${n}`),o=n,i=g):a&&console.log(`subpar explanation by approxRationalsOfPowersOfE: ${g} complexity: ${n}`));let v=sf(t);v!=null&&(n=Ae(v),n<o?(a&&console.log(`better explanation by approxRationalsOfPowersOfPI: ${v} complexity: ${n}`),o=n,i=v):a&&console.log(`subpar explanation by approxRationalsOfPowersOfPI: ${v} complexity: ${n}`));let F=ds(t);return F!=null&&(n=Ae(F),n<o?(a&&console.log(`better explanation by approxTrigonometric: ${F} complexity: ${n}`),o=n,i=F):a&&console.log(`subpar explanation by approxTrigonometric: ${F} complexity: ${n}`)),i}function Ae(t,r,e){let o=0;if(t instanceof Array){switch(t[1]){case Tc:o=4;break;case Nc:o=Math.pow(4,Math.abs(t[3]))*Math.abs(t[2]);break;case Ic:o=Math.pow(3,Math.abs(t[3]))*Math.abs(t[2]);break;default:o=0}o+=Math.abs(t[2])*(Math.abs(t[3])+Math.abs(t[4]))}else o+=Math.abs(t)*(Math.abs(r)+Math.abs(e));return t[2]===1?o-=1:o+=1,t[3]===1?o-=1:o+=1,t[4]===1?o-=1:o+=1,o<0&&(o=0),o}function Lc(){for(let r of[2,3,5,6,7,8,10])for(let e of[2,3,5,6,7,8,10]){if(r===e)continue;console.log(`testapproxRadicals testing: 1 * sqrt( ${r} ) / ${e}`);let o=r/e,n=Math.sqrt(r)/e,i=mn(n),a=i[2]*Math.sqrt(i[3])/i[4];Math.abs(n-a)>1e-15&&console.log(`fail testapproxRadicals: 1 * sqrt( ${r} ) / ${e} . obtained: ${i}`)}for(let r of[2,3,5,6,7,8,10])for(let e of[2,3,5,6,7,8,10]){if(r===e)continue;console.log(`testapproxRadicals testing with 4 digits: 1 * sqrt( ${r} ) / ${e}`);let o=r/e,n=Math.sqrt(r)/e,i=n.toFixed(4),a=mn(Number(i)),m=a[2]*Math.sqrt(a[3])/a[4];Math.abs(n-m)>1e-15&&console.log(`fail testapproxRadicals with 4 digits: 1 * sqrt( ${r} ) / ${e} . obtained: ${a}`)}for(let r of[2,3,5,6,7,8,10])for(let e of[2,3,5,6,7,8,10]){if(r===e)continue;console.log(`testapproxRadicals testing: 1 * sqrt( ${r} / ${e} )`);let o=r/e,n=Math.sqrt(r/e),i=mn(n);if(i!=null){let a=i[2]*Math.sqrt(i[3]/i[4]);i[1]===of&&Math.abs(n-a)>1e-15&&console.log(`fail testapproxRadicals: 1 * sqrt( ${r} / ${e} ) . obtained: ${i}`)}}for(let r of[1,2,3,5,6,7,8,10])for(let e of[1,2,3,5,6,7,8,10]){if(r===1&&e===1)continue;console.log(`testapproxRadicals testing with 4 digits:: 1 * sqrt( ${r} / ${e} )`);let o=r/e,n=Math.sqrt(r/e),i=n.toFixed(4),a=mn(Number(i)),m=a[2]*Math.sqrt(a[3]/a[4]);a[1]===of&&Math.abs(n-m)>1e-15&&console.log(`fail testapproxRadicals with 4 digits:: 1 * sqrt( ${r} / ${e} ) . obtained: ${a}`)}for(let r=1;r<=5;r++)for(let e=1;e<=5;e++){console.log(`testApproxAll testing: 1 * log(${r} ) / ${e}`);let o=r/e,n=Math.log(r)/e,i=At(n),a=i[2]*Math.log(i[3])/i[4];Math.abs(n-a)>1e-15&&console.log(`fail testApproxAll: 1 * log(${r} ) / ${e} . obtained: ${i}`)}for(let r=1;r<=5;r++)for(let e=1;e<=5;e++){console.log(`testApproxAll testing with 4 digits: 1 * log(${r} ) / ${e}`);let o=r/e,n=Math.log(r)/e,i=n.toFixed(4),a=At(Number(i)),m=a[2]*Math.log(a[3])/a[4];Math.abs(n-m)>1e-15&&console.log(`fail testApproxAll with 4 digits: 1 * log(${r} ) / ${e} . obtained: ${a}`)}for(let r=1;r<=5;r++)for(let e=1;e<=5;e++){console.log(`testApproxAll testing: 1 * log(${r} / ${e} )}`);let o=r/e,n=Math.log(r/e),i=At(n),a=i[2]*Math.log(i[3]/i[4]);Math.abs(n-a)>1e-15&&console.log(`fail testApproxAll: 1 * log(${r} / ${e} ) . obtained: ${i}`)}for(let r=1;r<=5;r++)for(let e=1;e<=5;e++){console.log(`testApproxAll testing with 4 digits: 1 * log(${r} / ${e} )`);let o=r/e,n=Math.log(r/e),i=n.toFixed(4),a=At(Number(i)),m=a[2]*Math.log(a[3]/a[4]);Math.abs(n-m)>1e-15&&console.log(`fail testApproxAll with 4 digits: 1 * log(${r} / ${e} ) . obtained: ${a}`)}for(let r=1;r<=2;r++)for(let e=1;e<=12;e++){console.log(`testApproxAll testing: 1 * (e ^ ${r} ) / ${e}`);let o=r/e,n=Math.pow(Math.E,r)/e,i=At(n),a=i[2]*Math.pow(Math.E,i[3])/i[4];Math.abs(n-a)>1e-15&&console.log(`fail testApproxAll: 1 * (e ^ ${r} ) / ${e} . obtained: ${i}`)}for(let r=1;r<=2;r++)for(let e=1;e<=12;e++){console.log(`approxRationalsOfPowersOfE testing with 4 digits: 1 * (e ^ ${r} ) / ${e}`);let o=r/e,n=Math.pow(Math.E,r)/e,i=n.toFixed(4),a=Rc(Number(i)),m=a[2]*Math.pow(Math.E,a[3])/a[4];Math.abs(n-m)>1e-15&&console.log(`fail approxRationalsOfPowersOfE with 4 digits: 1 * (e ^ ${r} ) / ${e} . obtained: ${a}`)}for(let r=1;r<=2;r++)for(let e=1;e<=12;e++){console.log(`testApproxAll testing: 1 * pi ^ ${r} / ${e}`);let o=r/e,n=Math.pow(Math.PI,r)/e,i=At(n),a=i[2]*Math.pow(Math.PI,i[3])/i[4];Math.abs(n-a)>1e-15&&console.log(`fail testApproxAll: 1 * pi ^ ${r} / ${e} ) . obtained: ${i}`)}for(let r=1;r<=2;r++)for(let e=1;e<=12;e++){console.log(`approxRationalsOfPowersOfPI testing with 4 digits: 1 * pi ^ ${r} / ${e}`);let o=r/e,n=Math.pow(Math.PI,r)/e,i=n.toFixed(4),a=sf(Number(i)),m=a[2]*Math.pow(Math.PI,a[3])/a[4];Math.abs(n-m)>1e-15&&console.log(`fail approxRationalsOfPowersOfPI with 4 digits: 1 * pi ^ ${r} / ${e} ) . obtained: ${a}`)}for(let r=1;r<=4;r++)for(let e=1;e<=4;e++){console.log(`testApproxAll testing: 1 * sin( ${r}/${e} )}`);let o=r/e,n=Math.sin(o),i=At(n),a=i[3]/i[4],m=i[2]*Math.sin(a);Math.abs(n-m)>1e-15&&console.log(`fail testApproxAll: 1 * sin( ${r}/${e} ) . obtained: ${i}`)}for(let r=1;r<=4;r++)for(let e=1;e<=4;e++){console.log(`testApproxAll testing with 5 digits: 1 * sin( ${r}/${e} )`);let o=r/e,n=Math.sin(o),i=n.toFixed(5),a=At(Number(i));a==null&&console.log(`fail testApproxAll with 5 digits: 1 * sin( ${r}/${e} ) . obtained:  undefined `);let m=a[3]/a[4],p=a[2]*Math.sin(m),g=Math.abs(n-p);g>1e-14&&console.log(`fail testApproxAll with 5 digits: 1 * sin( ${r}/${e} ) . obtained: ${a} error: ${g}`)}for(let r=1;r<=4;r++)for(let e=1;e<=4;e++){console.log(`testApproxAll testing with 4 digits: 1 * sin( ${r}/${e} )`);let o=r/e,n=Math.sin(o),i=n.toFixed(4),a=At(Number(i));a==null&&console.log(`fail testApproxAll with 4 digits: 1 * sin( ${r}/${e} ) . obtained:  undefined `);let m=a[3]/a[4],p=a[2]*Math.sin(m),g=Math.abs(n-p);g>1e-14&&console.log(`fail testApproxAll with 4 digits: 1 * sin( ${r}/${e} ) . obtained: ${a} error: ${g}`)}let t=0;At(t)[0]!=="0"&&console.log("fail testApproxAll: 0"),t=0,At(t)[0]!=="0"&&console.log("fail testApproxAll: 0.0"),t=0,At(t)[0]!=="0"&&console.log("fail testApproxAll: 0.00"),t=0,At(t)[0]!=="0"&&console.log("fail testApproxAll: 0.000"),t=0,At(t)[0]!=="0"&&console.log("fail testApproxAll: 0.0000"),t=1,At(t)[0]!=="1"&&console.log("fail testApproxAll: 1"),t=1,At(t)[0]!=="1"&&console.log("fail testApproxAll: 1.0"),t=1,At(t)[0]!=="1"&&console.log("fail testApproxAll: 1.00"),t=1,At(t)[0]!=="1"&&console.log("fail testApproxAll: 1.000"),t=1,At(t)[0]!=="1"&&console.log("fail testApproxAll: 1.0000"),t=1,At(t)[0]!=="1"&&console.log("fail testApproxAll: 1.00000"),t=Math.sqrt(2),At(t)[0]!=="1 * sqrt( 2 ) / 1"&&console.log("fail testApproxAll: Math.sqrt(2)"),t=1.41,At(t)[0]!=="1 * sqrt( 2 ) / 1"&&console.log("fail testApproxAll: 1.41"),t=1.4,mn(t)[0]!=="1 * sqrt( 2 ) / 1"&&console.log("fail approxRadicals: 1.4"),t=.6,cs(t)[0]!=="1 * log( 2 ) / 1"&&console.log("fail approxLogs: 0.6"),t=.69,cs(t)[0]!=="1 * log( 2 ) / 1"&&console.log("fail approxLogs: 0.69"),t=.7,cs(t)[0]!=="1 * log( 2 ) / 1"&&console.log("fail approxLogs: 0.7"),t=1.09,cs(t)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxLogs: 1.09"),t=1.09,At(t)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.09"),t=1.098,At(t)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.098"),t=1.1,At(t)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.1"),t=1.11,At(t)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.11"),t=Math.sqrt(3),At(t)[0]!=="1 * sqrt( 3 ) / 1"&&console.log("fail testApproxAll: Math.sqrt(3)"),t=1,At(t)[0]!=="1"&&console.log("fail testApproxAll: 1.0000"),t=3.141592,At(t)[0]!=="1 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 3.141592"),t=31.41592,At(t)[0]!=="10 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 31.41592"),t=314.1592,At(t)[0]!=="100 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 314.1592"),t=3141592653589793e-8,At(t)[0]!=="10000000 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 31415926.53589793"),t=Math.sqrt(2),ds(t)[0]!=="2 * sin( 1/4 * pi )"&&console.log("fail approxTrigonometric: Math.sqrt(2)"),t=Math.sqrt(3),ds(t)[0]!=="2 * sin( 1/3 * pi )"&&console.log("fail approxTrigonometric: Math.sqrt(3)"),t=(Math.sqrt(6)-Math.sqrt(2))/4,At(t)[0]!=="1 * sin( 1/12 * pi )"&&console.log("fail testApproxAll: (Math.sqrt(6) - Math.sqrt(2))/4"),t=Math.sqrt(2-Math.sqrt(2))/2,At(t)[0]!=="1 * sin( 1/8 * pi )"&&console.log("fail testApproxAll: Math.sqrt(2 - Math.sqrt(2))/2"),t=(Math.sqrt(6)+Math.sqrt(2))/4,At(t)[0]!=="1 * sin( 5/12 * pi )"&&console.log("fail testApproxAll: (Math.sqrt(6) + Math.sqrt(2))/4"),t=Math.sqrt(2+Math.sqrt(3))/2,At(t)[0]!=="1 * sin( 5/12 * pi )"&&console.log("fail testApproxAll: Math.sqrt(2 + Math.sqrt(3))/2"),t=(Math.sqrt(5)-1)/4,At(t)[0]!=="1 * sin( 1/10 * pi )"&&console.log("fail testApproxAll: (Math.sqrt(5) - 1)/4"),t=Math.sqrt(10-2*Math.sqrt(5))/4,At(t)[0]!=="1 * sin( 1/5 * pi )"&&console.log("fail testApproxAll: Math.sqrt(10 - 2*Math.sqrt(5))/4"),t=Math.sin(Math.PI/7),At(t)[0]!=="1 * sin( 1/7 * pi )"&&console.log("fail testApproxAll: Math.sin(Math.PI/7)"),t=Math.sin(Math.PI/9),At(t)[0]!=="1 * sin( 1/9 * pi )"&&console.log("fail testApproxAll: Math.sin(Math.PI/9)"),t=1836.15267,sf(t)[0]!=="6 * (pi ^ 5 ) / 1 )"&&console.log("fail approxRationalsOfPowersOfPI: 1836.15267");for(let r=1;r<=13;r++)for(let e=1;e<=13;e++){console.log(`approxTrigonometric testing: 1 * sin( ${r}/${e} * pi )`);let o=r/e;t=Math.sin(Math.PI*o);let n=ds(t),i=n[3]/n[4],a=n[2]*Math.sin(Math.PI*i);Math.abs(t-a)>1e-15&&console.log(`fail approxTrigonometric: 1 * sin( ${r}/${e} * pi ) . obtained: ${n}`)}for(let r=1;r<=13;r++)for(let e=1;e<=13;e++){if(r===5&&e===11||r===6&&e===11)continue;console.log(`approxTrigonometric testing with 4 digits: 1 * sin( ${r}/${e} * pi )`);let o=r/e,n=Math.sin(Math.PI*o),i=n.toFixed(4),a=ds(Number(i)),m=a[3]/a[4],p=a[2]*Math.sin(Math.PI*m),g=Math.abs(n-p);g>1e-14&&console.log(`fail approxTrigonometric with 4 digits: 1 * sin( ${r}/${e} * pi ) . obtained: ${a} error: ${g}`)}return console.log("testApprox done")}function $c(t){return p_(_(l(t)))}function p_(t){if(u(t)===s(ur))return l(t);if(K(t))return tt(Math.acos(t.d));if(Ln(t)||Y(t)&&zt(u(c(t)),1,2)&&u(u(c(c(t))))===s(ut)&&St(u(c(u(c(c(t))))),2)&&zt(u(c(c(u(c(c(t)))))),1,2))return h.evaluatingAsFloats?tt(Math.PI/4):x(P(1,4),s(vt));if(hi(t)||Y(t)&&zt(u(c(t)),-1,2)&&u(u(c(c(t))))===s(ut)&&St(u(c(u(c(c(t))))),2)&&zt(u(c(c(u(c(c(t)))))),1,2))return h.evaluatingAsFloats?tt(Math.PI*3/4):x(P(3,4),s(vt));if(Sa(t))return h.evaluatingAsFloats?tt(Math.PI/6):x(P(1,6),s(vt));if(Oa(t))return h.evaluatingAsFloats?tt(5*Math.PI/6):x(P(5,6),s(vt));if(!lt(t))return q(s(We),t);switch(et(x(t,y(2)))){case-2:return f.Pi();case-1:return h.evaluatingAsFloats?tt(Math.PI*2/3):x(P(2,3),s(vt));case 0:return h.evaluatingAsFloats?tt(Math.PI/2):x(P(1,2),s(vt));case 1:return h.evaluatingAsFloats?tt(Math.PI/3):x(P(1,3),s(vt));case 2:return f.Zero();default:return q(s(We),t)}}function Cc(t){return x_(_(l(t)))}function x_(t){if(u(t)===s(go))return l(t);if(K(t)){let{d:r}=t;return r<1&&N("arccosh function argument is less than 1.0"),r=Math.log(r+Math.sqrt(r*r-1)),tt(r)}return Et(t)?f.zero:q(s(tn),t)}function Pc(t){return g_(_(l(t)))}function g_(t){if(u(t)===s(fr))return l(t);if(K(t))return tt(Math.asin(t.d));if(Ln(t)||Y(t)&&zt(u(c(t)),1,2)&&u(u(c(c(t))))===s(ut)&&St(u(c(u(c(c(t))))),2)&&zt(u(c(c(u(c(c(t)))))),1,2))return x(P(1,4),s(vt));if(hi(t)||Y(t)&&zt(u(c(t)),-1,2)&&u(u(c(c(t))))===s(ut)&&St(u(c(u(c(c(t))))),2)&&zt(u(c(c(u(c(c(t)))))),1,2))return h.evaluatingAsFloats?tt(-Math.PI/4):x(P(-1,4),s(vt));if(Sa(t))return h.evaluatingAsFloats?tt(Math.PI/3):x(P(1,3),s(vt));if(Oa(t))return h.evaluatingAsFloats?tt(-Math.PI/3):x(P(-1,3),s(vt));if(!lt(t))return q(s(Je),t);switch(et(x(t,y(2)))){case-2:return h.evaluatingAsFloats?tt(-Math.PI/2):x(P(-1,2),s(vt));case-1:return h.evaluatingAsFloats?tt(-Math.PI/6):x(P(-1,6),s(vt));case 0:return f.Zero();case 1:return h.evaluatingAsFloats?tt(Math.PI/6):x(P(1,6),s(vt));case 2:return h.evaluatingAsFloats?tt(Math.PI/2):x(P(1,2),s(vt));default:return q(s(Je),t)}}function kc(t){return b_(_(l(t)))}function b_(t){if(u(t)===s(Ao))return l(t);if(K(t)){let{d:r}=t;return r=Math.log(r+Math.sqrt(r*r+1)),tt(r)}return V(t)?f.zero:q(s(sn),t)}function Dc(t){return __(_(l(t)))}function __(t){if(u(t)===s(qo))return l(t);if(K(t)){let{d:r}=t;return(r<-1||r>1)&&N("arctanh function argument is not in the interval [-1,1]"),r=Math.log((1+r)/(1-r))/2,tt(r)}return V(t)?f.zero:q(s(an),t)}function Bc(t){let r=_(l(t)),e=_(A(t));return h_(r,e)}function h_(t,r){return v_(t,r)}function v_(t,r){return y_(t,r)?$($(Ar(t),Ar(r)),Ar(Q(t,r))):f.zero}function y_(t,r){return C(t)&&mr(t,f.zero)||C(r)&&mr(r,f.zero)?!1:!(C(t)&&C(r)&&mr(t,r))}function Uc(t){return E_(_(l(t)))}function E_(t){return A_(t)}function A_(t){if(!C(t))return q(s(Ei),t);if(K(t))return tt(Math.ceil(t.d));if(qt(t))return t;let r=new Tt(kr(t.q.a,t.q.b));return It(t)||(r=I(r,f.one)),r}function Gc(t){let r=_(l(t)),e=_(A(t));return q_(r,e)}function q_(t,r){return M_(t,r)?$($(Ar(t),Ar(r)),Ar(Q(t,r))):f.zero}function M_(t,r){return C(t)&&mr(t,f.zero)||C(r)&&mr(r,f.zero)?!1:!(C(t)&&C(r)&&mr(t,r))}function Fc(t){return af(_(l(t)))}function af(t){return I(x(lr(x(f.imaginaryunit,t)),P(1,2)),x(lr(x(U(f.imaginaryunit),t)),P(1,2)))}function zc(t){return lf(_(l(t)))}function lf(t){return Q(x($(lr(x(f.imaginaryunit,t)),f.imaginaryunit),P(1,2)),x($(lr(x(U(f.imaginaryunit),t)),f.imaginaryunit),P(1,2)))}function Vc(t){let r=ff(_(l(t)));return _(r)}function ff(t){if(u(t)===s(ur))return af(l(t));if(u(t)===s(fr))return lf(l(t));if(u(t)===s(ve)){t=l(t);let r=lr(x(f.imaginaryunit,t)),e=lr(U(x(f.imaginaryunit,t)));return $(x(Q(e,r),f.imaginaryunit),I(r,e))}return u(t)===s(go)?(t=l(t),x(I(lr(t),lr(U(t))),P(1,2))):u(t)===s(Ao)?(t=l(t),x(Q(lr(t),lr(U(t))),P(1,2))):u(t)===s(qo)?(t=lr(x(l(t),y(2))),$(Q(t,f.one),I(t,f.one))):M(t)?t.map(ff):(t.k===un&&(t=ro(t),t.tensor.elem=t.tensor.elem.map(ff)),t)}function Zc(t){let r=_(l(t)),e,o;return Er(t)===s(L)?(e=f.one,o=y(2)):(e=_(A(t)),o=_(Ft(t))),w_(r,e,o)}function w_(t,r,e){let o=[],n=[];if(!H(t))return V(t)||N("contract: tensor expected, 1st arg is not a tensor"),f.zero;let i=et(r),a=et(e),{ndim:m}=t.tensor;(i<1||i>m||a<1||a>m||i===a||t.tensor.dim[i-1]!==t.tensor.dim[a-1])&&N("contract: index out of range"),i--,a--;let p=t.tensor.dim[i],g=1;for(let J=0;J<m;J++)J!==i&&J!==a&&(g*=t.tensor.dim[J]);r=ct(g),r.tensor.ndim=m-2;let v=0;for(let J=0;J<m;J++)J!==i&&J!==a&&(r.tensor.dim[v++]=t.tensor.dim[J]);let F=t.tensor.elem,B=r.tensor.elem;for(let J=0;J<m;J++)o[J]=0,n[J]=t.tensor.dim[J];for(let J=0;J<g;J++){let nt=f.zero;for(let ht=0;ht<p;ht++){o[i]=ht,o[a]=ht;let $t=0;for(let pr=0;pr<m;pr++)$t=$t*n[pr]+o[pr];nt=I(nt,F[$t])}B[J]=nt;for(let ht=m-1;ht>=0;ht--)if(!(ht===i||ht===a)){if(++o[ht]<n[ht])break;o[ht]=0}}return g===1?B[0]:r}function Yc(t){let r=_(l(t));for(t=Er(t);M(t);){let e=_(u(t));t=c(t);let o=_(u(t));t=c(t);let n=_(u(t));t=c(t),r=Tn(r,e);let i=_(Gt(r,e,n)),a=_(Gt(r,e,o));r=Q(i,a)}return r}function jc(t){let r=_(l(t));t=_(A(t));let e=t===s(L)?cr(r):t;return Ai(r,e)}function Ai(t,r){return Hc(t,r,f.zero)}function Hc(t,r,e){return ot(t,r)?V(e)&&(e=f.one):rt(t)?ot(l(t),r)&&C(A(t))&&mr(e,A(t))&&(e=A(t)):M(t)&&(e=t.tail().reduce((o,n)=>Hc(n,r,o),e)),e}var mt=0,Nr=[],Fo=[];function Qc(t){let{arg:r}=uf(t);r||N("eigen: argument is not a square matrix");let[e,o]=mf(qi,r);return t=Ue("D"),Jt(t,e),t=Ue("Q"),Jt(t,o),s(L)}function Jc(t){let{arg:r,invalid:e}=uf(t);if(e)return q(s(Mi),e);let[o,n]=mf(Mi,r);return o}function Wc(t){let{arg:r,invalid:e}=uf(t);if(e)return q(s(wi),e);let[o,n]=mf(wi,r);return n}function uf(t){if(t=_(Tr(_(l(t)))),!H(t))return{invalid:t};(t.tensor.ndim!==2||t.tensor.dim[0]!==t.tensor.dim[1])&&N("eigen: argument is not a square matrix"),mt=t.tensor.dim[0],S_(t)||N("eigen: matrix is not numerical");for(let r=0;r<mt-1;r++)for(let e=r+1;e<mt;e++){let o=t.tensor.elem[mt*r+e],n=t.tensor.elem[mt*e+r];Math.abs(o.d-n.d)>1e-10&&N("eigen: matrix is not symmetrical")}return{arg:t}}function S_(t){for(let r=0;r<mt;r++)for(let e=0;e<mt;e++)if(!K(t.tensor.elem[mt*r+e]))return!1;return!0}function mf(t,r){for(let i=0;i<mt*mt;i++)Nr[i]=0;for(let i=0;i<mt*mt;i++)Fo[i]=0;for(let i=0;i<mt;i++){Nr[mt*i+i]=r.tensor.elem[mt*i+i].d;for(let a=i+1;a<mt;a++)Nr[mt*i+a]=r.tensor.elem[mt*i+a].d,Nr[mt*a+i]=r.tensor.elem[mt*i+a].d}for(let i=0;i<mt;i++){Fo[mt*i+i]=1;for(let a=i+1;a<mt;a++)Fo[mt*i+a]=0,Fo[mt*a+i]=0}let e=0;for(e=0;e<100&&O_()!==0;e++);e===100&&k(`
note: eigen did not converge
`);let o;if(t===qi||t===Mi){o=ro(r);for(let i=0;i<mt;i++)for(let a=0;a<mt;a++)o.tensor.elem[mt*i+a]=tt(Nr[mt*i+a])}let n;if(t===qi||t===wi){n=ro(r);for(let i=0;i<mt;i++)for(let a=0;a<mt;a++)n.tensor.elem[mt*i+a]=tt(Fo[mt*i+a])}return[o,n]}function O_(){let t=0;for(let r=0;r<mt-1;r++)for(let e=r+1;e<mt;e++)Nr[mt*r+e]!==0&&(T_(r,e),t++);return t}function T_(t,r){let e=.5*(Nr[mt*t+t]-Nr[mt*r+r])/Nr[mt*t+r],o=1/(Math.abs(e)+Math.sqrt(e*e+1));e<0&&(o=-o);let n=1/Math.sqrt(o*o+1),i=o*n;for(let a=0;a<mt;a++){let m=Nr[mt*t+a],p=Nr[mt*r+a];Nr[mt*t+a]=n*m+i*p,Nr[mt*r+a]=n*p-i*m}for(let a=0;a<mt;a++){let m=Nr[mt*a+t],p=Nr[mt*a+r];Nr[mt*a+t]=n*m+i*p,Nr[mt*a+r]=n*p-i*m}for(let a=0;a<mt;a++){let m=Fo[mt*t+a],p=Fo[mt*r+a];Fo[mt*t+a]=n*m+i*p,Fo[mt*r+a]=n*p-i*m}Nr[mt*t+r]=0,Nr[mt*r+t]=0}function Xc(t){return N_(_(l(t)))}function N_(t){if(K(t)){let r=cf(t.d);return tt(r)}return V(t)?f.one:q(s(gi),t)}function cf(t){if(t===0)return 1;let r=Math.abs(t),e=1/(1+.5*r),o=e*Math.exp(-r*r-1.26551223+e*(1.00002368+e*(.37409196+e*(.09678418+e*(-.18628806+e*(.27886807+e*(-1.13520398+e*(1.48851587+e*(-.82215223+e*.17087277)))))))));return t>=0?o:2-o}function Kc(t){return I_(_(l(t)))}function I_(t){return K(t)?tt(1-cf(t.d)):V(t)?f.zero:Ct(t)?U(q(s(Rn),U(t))):q(s(Rn),t)}function df(t){let r=[];return X(t)?t.tail().forEach(e=>r.push(...td(e))):r.push(...td(t)),r}function td(t){return Y(t)?t.tail():[t]}function rd(t){let r=_(l(t)),e=_(A(t)),o=e===s(L)?cr(r):e;return pf(r,o)}function pf(t,r){if(H(t))return R_(t,r);if(X(t))return t.tail().reduce((m,p)=>I(m,pf(p,r)),f.zero);let e=Zr(t),o=Cr(t);if([o,e]=L_(o,e,r),(Xe(e)||Xe(o))&&(!Dr(o,r)||Xe(o)))return t;let n=Hi(e,o,r);if(e=Q(e,x(o,n)),V(e))return n;o=_e(o,r);let i=$_(o,r);e=P_(e,i,r),o=k_(o,i,r);let a;if(H(i)){let m=$r(xo,i);a=Ur(Ur(m,e),o)}else{let m=$r($,e,i);a=x(m,o)}return I(a,n)}function R_(t,r){return t=ro(t),t.tensor.elem=t.tensor.elem.map(e=>pf(e,r)),t}function L_(t,r,e){let o=[...df(t),...df(r)],n=0;for(let i=0;i<o.length;i++){let a=o[i];if(!rt(a)||l(a)!==e)continue;let m=et(A(a));isNaN(m)||m<n&&(n=m)}return n===0?[t,r]:(t=x(t,T(e,y(-n))),r=x(r,T(e,y(-n))),[t,r])}function $_(t,r){let e=[];Y(t)?t.tail().forEach(i=>e.push(...ed(t,i,r))):e.push(...ed(t,t,r));let o=e.length;if(o===1)return e[0];let n=ct(o*o);n.tensor.ndim=2,n.tensor.dim[0]=o,n.tensor.dim[1]=o;for(let i=0;i<o;i++)for(let a=0;a<o;a++){let m=T(r,y(i)),p=$r($,e[a],m);n.tensor.elem[o*i+a]=so(p,r)}return n}function ed(t,r,e){let o,n=0;if(!it(r,e))return[];let i=$r(C_,t,r);rt(r)?(n=et(A(r)),o=l(r)):(n=1,o=r);let a=[],m=et(Ai(o,e));for(let p=0;p<n;p++)for(let g=0;g<m;g++){let v=T(o,y(p)),F=$r(x,i,v);v=T(e,y(g));let B=$r(x,F,v);a.push(B)}return a}function C_(t,r){let e=f.one;if(Y(t)){let o=[];t.tail().forEach(n=>{ot(n,r)||o.push(_(n))}),e=se(o)}return e}function P_(t,r,e){if(!H(r))return t;let o=r.tensor.dim[0],n=ct(o);n.tensor.ndim=1,n.tensor.dim[0]=o;for(let i=0;i<o;i++){let a=T(e,y(i)),m=$r($,t,a);n.tensor.elem[i]=so(m,e)}return n}function k_(t,r,e){if(!H(r))return he(t);let o=[];Y(t)?t.tail().forEach(a=>{o.push(...od(a,e))}):o=od(t,e);let n=o.length,i=ct(n);return i.tensor.ndim=1,i.tensor.dim[0]=n,i.tensor.elem=o,i}function od(t,r){let e=1;if(!it(t,r))return[];rt(t)&&(e=et(A(t)),t=l(t));let o=[],n=et(Ai(t,r));for(let i=e;i>0;i--)for(let a=0;a<n;a++)o.push(x(he(T(t,y(i))),T(r,y(a))));return o}function nd(t){return D_(_(l(t)))}function D_(t){return B_(t)}function B_(t){if(!C(t))return q(s(Si),t);if(K(t))return tt(Math.floor(t.d));if(qt(t))return t;let r=new Tt(kr(t.q.a,t.q.b));return It(t)&&(r=I(r,f.negOne)),r}function id(t){let r=A(t);xt(r)||N("for: 2nd arg should be the variable to loop over");let e=Hr(Ft(t));if(isNaN(e))return t;let o=Hr(pe(t));if(isNaN(o))return t;let n=pt(r);for(let i=e;i<=o;i++)Jt(r,y(i)),_(l(t));return Jt(r,n),s(L)}function sd(t){return Ca(_(l(t)))}function Ca(t){return U_(t)}function U_(t){return lt(t)&&Wt(t.q.a,1)&&Wt(t.q.b,2)?T(f.Pi(),P(1,2)):lt(t)&&Wt(t.q.a,3)&&Wt(t.q.b,2)?x(T(f.Pi(),P(1,2)),P(1,2)):Ct(t)?$(x(f.Pi(),f.negOne),x(x(br(x(f.Pi(),t)),t),Ca(U(t)))):X(t)?G_(t):q(s(ps),t)}function G_(t){let r=c(t);return lt(u(r))&&Wt(u(r).q.a,1)&&Wt(u(r).q.b,1)?x(l(r),Ca(l(r))):lt(u(r))&&Wt(u(r).q.a,-1)&&Wt(u(r).q.b,1)?$(Ca(l(r)),I(l(r),f.negOne)):q(s(ps),t)}function ad(t){return F_(_(l(t)))}function F_(t){return qa(t)&&Ps(t.q.a)?f.one:f.zero}function ld(t){let r=_(l(t)),e=_(A(t)),o=_(Ft(t)),n=o===s(L)?f.zero:o;return z_(r,e,n)}function z_(t,r,e){let o=et(r);return o<0||isNaN(o)?q(s(Pa),t,r,e):xt(t)?fd(o,t,e):_(Gt(fd(o,s(Pt),e),s(Pt),t))}function fd(t,r,e){let o=f.zero,n=f.one;for(let i=0;i<t;i++){let a=$(Q(x(I(Q(y(2*i+1),r),e),n),x(I(y(i),e),o)),y(i+1));o=n,n=a}return n}function ud(t){let r=_(l(t));t=_(A(t));let e=t===s(L)?cr(r):t;return V_(r,e)}function V_(t,r){let e=Ai(t,r);return so($(t,T(r,e)),r)}function md(t){let r=_(l(t)),e=_(A(t)),o=_(Ft(t)),n=o===s(L)?f.zero:o;return Z_(r,e,n)}function Z_(t,r,e){return Y_(t,r,e)}function Y_(t,r,e){let o=et(r),n=et(e);if(o<0||isNaN(o)||n<0||isNaN(n))return q(s(Da),t,r,e);let i;if(xt(t))i=cd(o,n,t);else{let a=cd(o,n,s(Pt));i=_(Gt(a,s(Pt),t))}return i=j_(i,n,t)||i,i}function cd(t,r,e){let o=f.zero,n=f.one;for(let i=0;i<t;i++){let a=$(Q(x(x(y(2*i+1),e),n),x(y(i),o)),y(i+1));o=n,n=a}for(let i=0;i<r;i++)n=wt(n,e);return n}function j_(t,r,e){if(r===0)return;let o=Q(f.one,ka(e));u(e)===s(ur)?o=ka(br(l(e))):u(e)===s(fr)&&(o=ka(Sr(l(e))));let n=x(t,T(o,x(y(r),P(1,2))));return r%2&&(n=U(n)),n}function dd(t){return t=l(t),!M(t)&&l(t).k===Fr&&(t=pt(t)),t}function pd(t){let r=_(l(t)),e=_(A(t));return H_(r,e)}function H_(t,r){if(V(r)&&N("mod function: divide by zero"),!C(t)||!C(r))return q(s(Ba),t,r);if(K(t)){let e=et(t);isNaN(e)&&N("mod function: cannot convert float value to integer"),t=y(e)}if(K(r)){let e=et(r);isNaN(e)&&N("mod function: cannot convert float value to integer"),r=y(e)}return(!qt(t)||!qt(r))&&N("mod function: integer arguments expected"),new Tt(Vn(t.q.a,r.q.a))}var xd=101,Ua=1e-6,Q_=1e-9;function xs(t){return Math.sqrt(t.r*t.r+t.i*t.i)}function Ga(){return 4*Math.random()-2}var Mo=class{constructor(){this.r=0,this.i=0}},jt=new Mo,wo=new Mo,dr=new Mo,Jr=new Mo,xe=new Mo,qe=new Mo,Oi=new Mo,So=new Mo,Lt=[];for(let t=0;t<xd;t++)Lt[t]=new Mo;function gd(t){let r=_(A(t));t=_(l(t)),r=r===s(L)?cr(t):r,Dr(t,r)||N("nroots: polynomial?");let e=Te(t,r),o=e.length;o>xd&&N("nroots: degree?");for(let i=0;i<o;i++)t=_(Tr(Yr(e[i]))),r=_(Tr(Ho(e[i]))),(!K(t)||!K(r))&&N("nroots: coefficients?"),Lt[i].r=t.d,Lt[i].i=r.d;J_(o);let n=[];for(let i=o;i>1;i--)W_(i),Math.abs(jt.r)<Ua&&(jt.r=0),Math.abs(jt.i)<Ua&&(jt.i=0),n.push(I(tt(jt.r),x(tt(jt.i),f.imaginaryunit))),X_(i);if(o=n.length,o==1)return n[0];if(o>1)return n.sort(Ie),t=ct(o),t.tensor.ndim=1,t.tensor.dim[0]=o,t.tensor.elem=n,t}function J_(t){Jr.r=Lt[t-1].r,Jr.i=Lt[t-1].i;let r=Jr.r*Jr.r+Jr.i*Jr.i;for(let e=0;e<t-1;e++)Lt[e].r=(Lt[e].r*Jr.r+Lt[e].i*Jr.i)/r,Lt[e].i=(Lt[e].i*Jr.r-Lt[e].r*Jr.i)/r;Lt[t-1].r=1,Lt[t-1].i=0}function W_(t){if(xs(Lt[0])<Ua){jt.r=0,jt.i=0;return}for(let r=0;r<100;r++){jt.r=Ga(),jt.i=Ga(),bd(t),wo.r=jt.r,wo.i=jt.i,qe.r=xe.r,qe.i=xe.i,jt.r=Ga(),jt.i=Ga();for(let e=0;e<1e3;e++){bd(t);let o=xs(xe);if(D&&console.log(`nrabs: ${o}`),o<Q_)return;xs(xe)<xs(qe)&&(dr.r=jt.r,dr.i=jt.i,jt.r=wo.r,jt.i=wo.i,wo.r=dr.r,wo.i=dr.i,dr.r=xe.r,dr.i=xe.i,xe.r=qe.r,xe.i=qe.i,qe.r=dr.r,qe.i=dr.i),Oi.r=wo.r-jt.r,Oi.i=wo.i-jt.i,So.r=qe.r-xe.r,So.i=qe.i-xe.i;let n=So.r*So.r+So.i*So.i;if(n===0)break;Jr.r=(Oi.r*So.r+Oi.i*So.i)/n,Jr.i=(Oi.i*So.r-Oi.r*So.i)/n,jt.r=wo.r-(Jr.r*qe.r-Jr.i*qe.i),jt.i=wo.i-(Jr.r*qe.i+Jr.i*qe.r)}}N("nroots: convergence error")}function bd(t){dr.r=jt.r,dr.i=jt.i,xe.r=Lt[0].r+Lt[1].r*dr.r-Lt[1].i*dr.i,xe.i=Lt[0].i+Lt[1].r*dr.i+Lt[1].i*dr.r;for(let r=2;r<t;r++){let e=jt.r*dr.r-jt.i*dr.i;dr.i=jt.r*dr.i+jt.i*dr.r,dr.r=e,xe.r+=Lt[r].r*dr.r-Lt[r].i*dr.i,xe.i+=Lt[r].r*dr.i+Lt[r].i*dr.r}}function X_(t){for(let r=t-1;r>0;r--)Lt[r-1].r+=Lt[r].r*jt.r-Lt[r].i*jt.i,Lt[r-1].i+=Lt[r].i*jt.r+Lt[r].r*jt.i;xs(Lt[0])>Ua&&N("nroots: residual error");for(let r=0;r<t-1;r++)Lt[r].r=Lt[r+1].r,Lt[r].i=Lt[r+1].i}function _d(t){t=c(t);let r=_(u(t));return M(t)?t.tail().reduce((o,n)=>K_(o,_(n)),r):r}function K_(t,r){return H(t)&&H(r)?th(t,r):H(t)?Kn(t,r):H(r)?ti(t,r):x(t,r)}function th(t,r){let e=t.tensor.ndim+r.tensor.ndim;e>ye&&N("outer: rank of result exceeds maximum");let o=t.tensor.nelem*r.tensor.nelem,n=ct(o);n.tensor.ndim=e,n.tensor.dim=[...t.tensor.dim,...r.tensor.dim];let i=0;for(let a=0;a<t.tensor.nelem;a++)for(let m=0;m<r.tensor.nelem;m++)n.tensor.elem[i++]=x(t.tensor.elem[a],r.tensor.elem[m]);return n}function hd(t){return xf(t),s(L)}function xf(t){let r;M(c(t))||N("pattern needs at least a template and a transformed version");let e=u(c(t)),o=u(c(c(t)));o===s(L)&&N("pattern needs at least a template and a transformed version"),M(c(c(t)))?r=u(c(c(c(t)))):r=s(L),ot(e,o)&&N("recursive pattern");let n="template: "+Kr(e);n+=" tests: "+Kr(r),D&&console.log(`pattern stringkey: ${n}`);let i=h.userSimplificationsInStringForm.indexOf(n);return i===-1?(h.userSimplificationsInStringForm.push(n),h.userSimplificationsInListForm.push(c(t))):(D&&console.log(`pattern already exists, replacing. ${c(t)}`),h.userSimplificationsInStringForm[i]=n,h.userSimplificationsInListForm[i]=c(t)),q(s(on),c(t))}function gf(){h.userSimplificationsInListForm=[],h.userSimplificationsInStringForm=[]}function vd(){return gf(),s(L)}function yd(){let t=rh();return t!==""?new Bo(t):s(L)}function rh(){let t="";for(let r of Array.from(h.userSimplificationsInListForm))t+=h.userSimplificationsInListForm+`
`;return t}function Ed(t){return eh(_(l(t)))}function eh(t){let r=et(t);return(r<1||r>jn)&&N("prime: Argument out of range."),r=Yn[r-1],y(r)}function Ad(t){let r=l(t),e=A(t);xt(e)||N("sum: 2nd arg?");let o=Hr(Ft(t));if(isNaN(o))return t;let n=Hr(pe(t));if(isNaN(n))return t;let i=pt(e),a=f.one;for(let m=o;m<=n;m++){Jt(e,y(m));let p=_(r),g=x(a,p);D&&(console.log(`product - factor 1: ${p}`),console.log(`product - factor 2: ${a}`),console.log(`product - result: ${g}`)),a=g}return Jt(e,i),a}function qd(t){return oh(_(l(t)))}function oh(t){return C(t)?K(t)?tt(Math.round(t.d)):qt(t)?t:(t=Tr(t),y(Math.round(t.d))):q(s(Ti),t)}function Md(t){return nh(_(l(t)))}function nh(t){if(!H(t))return V(t)||N("transpose: tensor expected, 1st arg is not a tensor"),f.zero;let{ndim:r}=t.tensor,e=ct(r);e.tensor.ndim=1,e.tensor.dim[0]=r;for(let o=0;o<r;o++)e.tensor.elem[o]=y(t.tensor.dim[o]);return e}function wd(t){let r=l(t),e=A(t);xt(e)||N("sum: 2nd arg?");let o=Hr(Ft(t));if(isNaN(o))return t;let n=Hr(pe(t));if(isNaN(n))return t;let i=pt(e),a=f.zero;for(let m=o;m<=n;m++)Jt(e,y(m)),a=I(a,_(r));return Jt(e,i),a}function Sd(t){return Od(_(l(t)))}function Od(t){if(u(t)===s(zr))return l(t);if(K(t)){let e=Math.tan(t.d);return Math.abs(e)<1e-10&&(e=0),tt(e)}if(ie(t))return U(Od(U(t)));let r=et($(x(t,y(180)),f.Pi()));if(r<0||isNaN(r))return q(s(ve),t);switch(r%360){case 0:case 180:return f.zero;case 30:case 210:return x(P(1,3),T(y(3),P(1,2)));case 150:case 330:return x(P(-1,3),T(y(3),P(1,2)));case 45:case 225:return f.one;case 135:case 315:return f.negOne;case 60:case 240:return T(y(3),P(1,2));case 120:case 300:return U(T(y(3),P(1,2)));default:return q(s(ve),t)}}function Td(t){return ih(_(l(t)))}function ih(t){if(u(t)===s(an))return l(t);if(K(t)){let r=Math.tanh(t.d);return Math.abs(r)<1e-10&&(r=0),tt(r)}return V(t)?f.zero:q(s(qo),t)}function Nd(t){t=c(t);let r=_(u(t));t=c(t);let e=_(u(t)),o=e===s(L)?cr(r):e;t=c(t),e=_(u(t));let n=e===s(L)?y(24):e;t=c(t),e=_(u(t));let i=e===s(L)?f.zero:e;return sh(r,o,n,i)}function sh(t,r,e,o){let n=et(e);if(isNaN(n))return q(s(Fa),t,r,e,o);let i=f.one,a=_(Gt(t,r,o));for(let m=1;m<=n&&(t=wt(t,r),!V(t));m++){i=x(i,Q(r,o));let p=_(Gt(t,r,o));a=I(a,$(x(p,i),Ar(y(m))))}return a}function Id(t){let r=t;for(t=c(t);M(t);){if(c(t)===s(L))return _(u(t));let e=Go(u(t));if(e==null)return r;if(e)return _(l(t));t=Er(t)}return f.zero}function Rd(t){let r=t,e=Q(_(l(t)),_(A(t))),o=Go(e);if(o)return f.zero;if(o!=null&&!o)return f.one;let n=Mt(_(l(t))),i=Mt(_(A(t)));return e=Q(n,i),o=Go(e),o?f.zero:o!=null&&!o?f.one:r}function Ld(t){let r=t,e=za(t);return e==null?r:e>=0?f.one:f.zero}function $d(t){let r=t,e=za(t);return e==null?r:e>0?f.one:f.zero}function Cd(t){let r=t,e=za(t);return e==null?r:e<=0?f.one:f.zero}function Pd(t){let r=t,e=za(t);return e==null?r:e<0?f.one:f.zero}function kd(t){let r=t,e=Go(l(t));return e==null?r:e?f.zero:f.one}function Dd(t){let r=t,e=c(r),o=!1;for(;M(e);){let n=Go(u(e));if(n==null)o=!0,e=c(e);else if(n)e=c(e);else if(!n)return f.zero}return o?r:f.one}function Bd(t){let r=t,e=c(r),o=!1;for(;M(e);){let n=Go(u(e));if(n==null)o=!0,e=c(e);else{if(n)return f.one;n||(e=c(e))}}return o?r:f.zero}function za(t){let r=0,e=Mt(_(l(t))),o=Mt(_(A(t)));if(t=Q(e,o),t.k!==Zt&&t.k!==Ut&&(t=_(Tr(t))),V(t))return 0;switch(t.k){case Zt:Ke(t.q.a)===-1?r=-1:r=1;break;case Ut:t.d<0?r=-1:r=1;break;default:r=null}return r}function Ud(t){let r=Array(ye).fill(0),e=1,o=0;if(M(t))for(let n of t.tail()){let i=Hr(n);if(i<1||isNaN(i))return f.zero;e*=i,r[o++]=i}if(o===0)return f.zero;t=ct(e),t.tensor.ndim=o;for(let n=0;n<o;n++)t.tensor.dim[n]=r[n];return t}var bf=0;function $n(){bf=0,Cn(),h.chainOfUserSymbolsNotFunctionsBeingEvaluated=[],!bf&&(bf=1,Zd(),_f())}var Gd=['version="'+Va+'"',"e=exp(1)","i=sqrt(-1)","autoexpand=1","assumeRealVariables=1","trange=[-pi,pi]","xrange=[-10,10]","yrange=[-10,10]","last=0","trace=0","forceFixedPrintout=1","maxFixedPrintoutDigits=6","printLeaveEAlone=1","printLeaveXAlone=0","cross(u,v)=[u[2]*v[3]-u[3]*v[2],u[3]*v[1]-u[1]*v[3],u[1]*v[2]-u[2]*v[1]]","curl(v)=[d(v[3],y)-d(v[2],z),d(v[1],z)-d(v[3],x),d(v[2],x)-d(v[1],y)]","div(v)=d(v[1],x)+d(v[2],y)+d(v[3],z)","ln(x)=log(x)"];function _f(){w(Ce,pc),w(Pr,cc),w(Xd,ju),w(Kd,Dd),w($a,Oc),w(We,$c),w(tn,Cc),w(Je,Pc),w(sn,kc),w(zr,vu),w(an,Dc),w(Wi,Au),w(tp),w(Ko,Wu),w(Mn,Ku),w(rp,Bm),w(Za,Bc),w(Ei,Uc),w(ep,Um),w(op,Gc),w(np,Vc),w(ip,zd),w(sp,Fd),w(ap,vd),w(lp,Ff),w(fp,Gf),w(up,Yu),w(mp,du),w(cp,Zf),w(dp,Zc),w(ur,nu),w(go,rm),w(pp,ym),w(Ya,Yc),w(xp,jc),w(gp,_u),w(js,Gm),w(Qr,_a),w(bp,Fm),w(ei,em),w(_p,zm),w(ja,Vm),w(hf,Js),w(hp),w(vp),w(Rn,Kc),w(gi,Xc),w(qi,Qc),w(Mi,Jc),w(wi,Wc),w(io,Zm),w(ba,Ym),w(yp,rd),w(Ep,Fc),w(Ap,zc),w(qp,Wf),w(Br,jm),w(Mp,Hm),w(wp,Uf),w(Ta,pm),w(Si,nd),w(yi,id),w(He,Df),w(ps,sd),w(Sp,lu),w(ri,Qm),w(Qs,Jm),w(Op,yu),w(ho,Wm),w(Po,Js),w(yo,Nm),w(ns,Xm),w(Xs,Km),w(Ea,tc),w(Tp,ad),w(Pa,ld),w(Np,Bf),w(Ip,ud),w(Da,md),w(Jo,Lm),w(Rp,dd),w(Ba,pd),w(Ht,ku),w(sa,kd),w(Lp,gd),w($p,rc),w(Cp,hu),w(Wo,ec),w(Pp,Bd),w(kp,_d),w(on,xf),w(Dp,yd),w(Bp,zf),w(ut,Ru),w(Up,Ed),w(Gp,Yd),w(Fp,jd),w(zp,Hd),w(Vp,Qd),w(Zp,Wd),w(Yp,Jd),w(Ha),w(Qa),w(Ja,Ad),w(aa,oc),w(jp,ru),w(Hp,nc),w(Qp,pu),w(Jp,Eu),w(Bs,su),w(Wp,gm),w(Ti,qd),w(Ee,ic),w(In,$m),w(Xp,hd),w(Kp,Mm),w(fr,eu),w(Ao,Cm),w(tx,Md),w(xi,sc),w(rx,ac),w(ex,lc),w(Wa,wd),w(ox,Vd),w(ve,Sd),w(qo,Td),w(Fa,Nd),w(Xa,Id),w(Ge,Rd),w(si,Ld),w(ai,$d),w(li,Cd),w(fi,Pd),w(to,Am),w(Ka,fc),w(nx,Ud),w(L),w(il),w(sl),w(fo),w(_i),w(ix),w(tl),w(rl),w(el),w(ol),w(nl),w(sx),w(Ia),w(Ra),w(vf),w(ax),w(fe),w(ue),w(re),w(Pt),w(lx),w(vt),w(fx),w(ux),w(mx),w(bi),w(Ni),w(Ii),w(cx),w(dx),w(Zo),w(Yo),w(Xr),w(ao),w(lo),w(Pe),w(ca),w(da),w(pa),w(px),w(xx),w(gx),w(bx),w(_x),w(hx),ah();let t=h.codeGen;h.codeGen=!1;for(let r=0;r<Gd.length;r++){let e=Gd[r],[,o]=bo(e);D&&(console.log(`... evaling ${e}`),console.log("top of stack:"),console.log(Kr(o))),_(o)}h.codeGen=t}function ah(){let t=q(s(ut),y(-1),P(1,2));D&&console.log(Kr(t)),f.imaginaryunit=t}function Fd(){return vx(),s(L)}function vx(){return h.test_flag||qc(),gf(),yx(),_f(),h.codeGen=!1}function zd(t){let r;for(r=c(t);M(r);){let e=u(r);e.k!==Fr&&N("symbol error"),Ex(e),r=c(r)}return s(L)}var Ax=1e4,qx=class{constructor(){this.c=0,this.x=0,this.y=0}},sr=[];for(let t=0;t<Ax;t++)sr[t]=new qx;var tr=0,Oo=0,To=0,Mx=0;function Ef(t){let r="";return r+=t,r}function lh(t){return Ef(t)}function al(t){tr=0,Oo=0,To=0,fh(t);let[r,e,o]=Array.from($i(0,tr));if(e>100){_s(t);return}return Eh()}function fh(t){if(u(t)===s(Ee)){Wr(l(t)),Mf(" = "),Wr(A(t));return}H(t)?qh(t):Wr(t)}function wx(t){if(Oo>0)return!1;if(or(t))return!0;if(!Y(t))return!1;if(or(l(t)))return!0;for(;M(t);){if(Pn(u(t)))return!0;t=c(t)}return!1}function Wr(t){if(Mx++,X(t))for(t=c(t),Ri(u(t))&&(dt("-"),wx(u(t))&&dt(" ")),Li(u(t)),t=c(t);M(t);)Ri(u(t))?(dt(" "),dt("-"),dt(" ")):(dt(" "),dt("+"),dt(" ")),Li(u(t)),t=c(t);else Ri(t)&&(dt("-"),wx(t)&&dt(" ")),Li(t);Mx--}function uh(t){if(X(t))for(t=c(t),Li(u(t)),t=c(t);M(t);)Ri(u(t))?(dt(" "),dt("-"),dt(" ")):(dt(" "),dt("+"),dt(" ")),Li(u(t)),t=c(t);else Li(t)}function Ri(t){return!!(It(t)||Y(t)&&It(l(t)))}function Li(t){if(Y(t)){let r=mh(t);r&&Oo===0?dh(t,r):ch(t,r)}else eo(t)}function Pn(t){return rt(t)&&l(t)!==s(rr)&&Ri(A(t))}function mh(t){let r=0;for(t=c(t);M(t);){let e=u(t);Pn(e)&&r++,t=c(t)}return r}function ch(t,r){if(r===0)for(t=c(t),(Et(u(t))||Nt(u(t)))&&(t=c(t)),eo(u(t)),t=c(t);M(t);)dt(" "),eo(u(t)),t=c(t);else ph(t),dt("/"),r>1||or(l(t))?(dt("("),Sx(t),dt(")")):Sx(t)}function dh(t,r){let e,o,n=0,i=0,a=0,m=0,p=0,g=f.one,v=f.one;for(lt(l(t))&&(g=me(Le(l(t))),v=Re(l(t))),K(l(t))&&(g=me(l(t))),m=Et(g)?0:1,e=c(t),C(u(e))&&(e=c(e));M(e);)o=u(e),Pn(o)||m++,e=c(e);for(p=To,i=tr,n=0,Et(g)||(zo(g,0),n++),e=c(t),C(u(e))&&(e=c(e));M(e);)o=u(e),Pn(o)||(n>0&&dt(" "),m===1?Wr(o):eo(o),n++),e=c(e);for(n===0&&dt("1"),a=tr,n=0,Et(v)||(zo(v,0),n++,r++),e=c(t),lt(u(e))&&(e=c(e));M(e);)o=u(e),Pn(o)&&(n>0&&dt(" "),Af(o,r),n++),e=c(e);qf(p,i,a)}function ph(t){let r=f.one;t=c(t),lt(u(t))?(r=me(Le(u(t))),t=c(t)):K(u(t))&&(r=me(u(t)),t=c(t));let e=0;for(Et(r)||(zo(r,0),e++);M(t);)Pn(u(t))||(e>0&&dt(" "),eo(u(t)),e++),t=c(t);e===0&&dt("1")}function Sx(t){let r=0;if(t=c(t),or(u(t))){let e=Re(u(t));zo(e,0),r++,t=c(t)}for(;M(t);)Pn(u(t))&&(r>0&&dt(" "),Af(u(t),0),r++),t=c(t)}function eo(t){if(H(t)){ll(t);return}if(K(t)){zo(t,0);return}if(X(t)||Y(t)){cn(t);return}if(rt(t)){gh(t);return}if(M(t)){bh(t);return}if(C(t)){Oo===0?xh(t):zo(t,0);return}if(xt(t)){Ox(t);return}ee(t)&&vh(t)}function xh(t){let r=me(Le(t)),e=Re(t);if(Et(e)){zo(r,0);return}let o=To,n=tr;zo(r,0);let i=tr;zo(e,0),qf(o,n,i)}function gs(t){return M(t)&&!X(t)&&!Y(t)&&!rt(t)||xt(t)?!0:or(t)||It(t)?!1:!!C(t)}function gh(t){let r=0,e=0,o=0;if(l(t)===s(rr)){Mf("exp("),Wr(A(t)),dt(")");return}if(Oo>0){Nt(A(t))?(dt("1"),dt("/"),gs(l(t))?eo(l(t)):cn(l(t))):(gs(l(t))?eo(l(t)):cn(l(t)),dt("^"),gs(A(t))?eo(A(t)):cn(A(t)));return}if(Ri(A(t))){o=To,r=tr,dt("1"),e=tr,Af(t,1),qf(o,r,e);return}r=tr,gs(l(t))?eo(l(t)):cn(l(t)),e=tr,Oo++,Wr(A(t)),Oo--,Tx(r,e)}function Af(t,r){let e=0,o=0;if(Nt(A(t))){r===1?Wr(l(t)):eo(l(t));return}e=tr,gs(l(t))?eo(l(t)):cn(l(t)),o=tr,Oo++,uh(A(t)),Oo--,Tx(e,o)}function bh(t){if(u(t)===s(ho)&&xt(l(t))){_h(t);return}if(ae(t)){hh(t);return}if(u(t)===s(Qr)?dt("d"):Ox(u(t)),dt("("),t=c(t),M(t))for(Wr(u(t)),t=c(t);M(t);)dt(","),Wr(u(t)),t=c(t);dt(")")}function _h(t){if(t=c(t),jr(t)===s(Pr)||jr(t)===s(Ht)||jr(t)===s(ut)||jr(t)===s(Br)?cn(u(t)):Wr(u(t)),dt("["),t=c(t),M(t))for(Wr(u(t)),t=c(t);M(t);)dt(","),Wr(u(t)),t=c(t);dt("]")}function hh(t){t=l(t),or(t)||X(t)||Y(t)||rt(t)||ae(t)?cn(t):Wr(t),dt("!")}function cn(t){dt("("),Wr(t),dt(")")}function Ox(t){if(t===s(rr)){Mf("exp(1)");return}let r=dn(t);for(let e=0;e<r.length;e++)dt(r[e])}function vh(t){let r=t.str;dt('"');for(let e=0;e<r.length;e++)dt(r[e]);dt('"')}function qf(t,r,e){let o=0,n=0,[i,a,m]=Array.from($i(r,e)),[p,g,v]=Array.from($i(e,tr));g>a?o=(g-a)/2:o=0,o++,n=-(m+i-1)-1,bs(r,e,o,n),g>a?o=-a:o=-a+(a-g)/2,o++,n=-v+1,bs(e,tr,o,n);let B=0;g>a?B=g:B=a,B+=2,To=t;for(let J=0;J<B;J++)dt("-")}function Tx(t,r){let e=0,o=0,n=0,i=0,a=0,m=0,p=0;[o,n,i]=Array.from($i(t,r)),[a,m,p]=Array.from($i(r,tr)),e=-p-a+1,e+=i-1,bs(r,tr,0,e)}function bs(t,r,e,o){for(let n=t;n<r;n++)sr[n].x+=e,sr[n].y+=o}function $i(t,r){let e=sr[t].x,o=sr[t].x,n=sr[t].y,i=sr[t].y;for(let g=t+1;g<r;g++)sr[g].x<e&&(e=sr[g].x),sr[g].x>o&&(o=sr[g].x),sr[g].y<n&&(n=sr[g].y),sr[g].y>i&&(i=sr[g].y);let a=i-n+1,m=o-e+1;return[a,m,n]}function dt(t){if(tr!==Ax)return sr[tr]==null&&er,sr[tr].c=t,sr[tr].x=To,sr[tr].y=0,tr++,To++}function Mf(t){for(let r=0;r<t.length;r++)dt(t[r])}function zo(t,r){let e="";switch(t.k){case Zt:e=t.q.a.toString(),e[0]==="-"&&r===0&&(e=e.substring(1));for(let o=0;o<e.length;o++)dt(e[o]);if(e=t.q.b.toString(),e==="1")break;dt("/");for(let o=0;o<e.length;o++)dt(e[o]);break;case Ut:e=Na(t.d),e[0]==="-"&&r===0&&(e=e.substring(1));for(let o=0;o<e.length;o++)dt(e[o]);break}}function yh(t,r){return t.y<r.y?-1:t.y>r.y?1:t.x<r.x?-1:t.x>r.x?1:0}function Eh(){let t="",r=sr.slice(0,tr);r.sort(yh),sr=[].concat(r).concat(sr.slice(tr));let e=0,{y:o}=sr[0];for(let n=0;n<tr;n++){for(;sr[n].y>o;)t+=lh(`
`),e=0,o++;for(;sr[n].x>e;)t+=Ef(" "),e++;t+=Ef(sr[n].c),e++}return t}var Ah=100,Nx=class{constructor(){this.x=0,this.y=0,this.h=0,this.w=0,this.index=0,this.count=0}},xr=[];for(let t=0;t<1e4;t++)xr[t]=new Nx;var Ix=3,Rx=1;function qh(t){let r=0,e=0,o=0;if(t.tensor.ndim>2){ll(t);return}let n=t.tensor.dim[0];t.tensor.ndim===2?r=t.tensor.dim[1]:r=1;let i=n*r;if(i>Ah){ll(t);return}let a=To;for(let B=0;B<i;B++)xr[B].index=tr,xr[B].x=To,Wr(t.tensor.elem[B]),xr[B].count=tr-xr[B].index,[xr[B].h,xr[B].w,xr[B].y]=Array.from($i(xr[B].index,tr));let m=0,p=0;for(let B=0;B<i;B++)xr[B].h>m&&(m=xr[B].h),xr[B].w>p&&(p=xr[B].w);let g=n*m+(n-1)*Rx,v=r*p+(r-1)*Ix,F=-(g/2);for(let B=0;B<n;B++)for(let J=0;J<r;J++){let nt=B*r+J;e=a-xr[nt].x,o=F-xr[nt].y,bs(xr[nt].index,xr[nt].index+xr[nt].count,e,o),e=0,J>0&&(e=J*(p+Ix)),o=0,B>0&&(o=B*(m+Rx)),e+=(p-xr[nt].w)/2,o+=(m-xr[nt].h)/2,bs(xr[nt].index,xr[nt].index+xr[nt].count,e,o)}To=a+v}function ll(t){Lx(t,0,0)}function Lx(t,r,e){dt("(");for(let o=0;o<t.tensor.dim[r];o++)r+1===t.tensor.ndim?(Wr(t.tensor.elem[e]),e=e+1):e=Lx(t,r+1,e),o+1<t.tensor.dim[r]&&dt(",");return dt(")"),e}function N(t){h.errorMessage+="Stop: ",h.errorMessage+=t;let r=h.errorMessage;throw h.errorMessage="",new Error(r)}var Mh="\\rlap{\\large\\color{red}\\bigtriangleup}{\\ \\ \\tiny\\color{red}!}";function $x(t){return t=t.replace(/\n/g,""),t=t.replace(/_/g,"} \\_ \\text{"),t=t.replace(new RegExp(String.fromCharCode(fa),"g"),"}{}^{T}\\text{"),t=t.replace(new RegExp(String.fromCharCode(vo),"g"),"}\\cdot \\text{"),t=t.replace("Stop:","}  \\quad \\text{Stop:"),t=t.replace("->","}  \\rightarrow \\text{"),t=t.replace("?","}\\enspace "+Mh+" \\enspace  \\text{"),t="$$\\text{"+t.replace(/\n/g,"")+"}$$",t}function wh(t){return t=t.replace(new RegExp(String.fromCharCode(8901),"g"),String.fromCharCode(vo)),t=t.replace(new RegExp(String.fromCharCode(8226),"g"),String.fromCharCode(vo)),t=t.replace(new RegExp(String.fromCharCode(12539),"g"),String.fromCharCode(vo)),t=t.replace(new RegExp(String.fromCharCode(55296),"g"),String.fromCharCode(vo)),t=t.replace(new RegExp(String.fromCharCode(65381),"g"),String.fromCharCode(vo)),t}var Sh=!1;function yf(t,r=!1){let e,o,n,i=new Date().getTime();t=wh(t),h.inited||(h.inited=!0,$n());let a=0,m=0,p="",g="",v,F;for(;;){try{h.errorMessage="",kn(),[a,e]=bo(t.substring(m)),kn()}catch(J){vs&&console.log(J),p+=J.message,r&&(g+=$x(J.message)),Cn();break}if(a===0)break;m+=a;let B=!1;try{h.stringsEmittedByUserPrintouts="",o=wf(e),kn(),ee(o)&&(D&&console.log(o.str),D&&console.log(`
`)),o===s(L)?(F=h.stringsEmittedByUserPrintouts,r&&(v="$$"+h.stringsEmittedByUserPrintouts+"$$")):(F=G(o),F+=`
`,r&&(v="$$"+fl(o)+"$$",D&&console.log(`collectedLatexResult: ${v}`))),p+=F,r&&(g+=v),vs&&(D&&console.log("printline"),D&&console.log(F)),vs&&(D&&console.log("display:"),al(o)),r&&(g+=`
`)}catch(J){B=!0,F=J.message,r&&(v=$x(J.message)),vs&&console.log(F),p+=F,F!==""&&(p+=`
`),r&&(g+=v,g+=`
`),$n()}}if(p[p.length-1]===`
`&&(p=p.substring(0,p.length-1)),r&&g[g.length-1]===`
`&&(g=g.substring(0,g.length-1)),r?(D&&console.log(`allReturnedLatexStrings: ${g}`),n=[p,g]):n=p,Sh){let B="run time on: "+t+" : "+(new Date().getTime()-i)+"ms";console.log(B)}return p="",g="",n}function kn(){h.chainOfUserSymbolsNotFunctionsBeingEvaluated.length!==0&&(er,N("symbols evaluation still ongoing?")),h.evaluatingAsFloats&&(er,N("numeric evaluation still ongoing?")),h.evaluatingPolar&&(er,N("evaluation of polar still ongoing?"))}function wf(t){D&&console.log("#### top level eval"),h.trigmode=0;let r=s(il);h.expanding=!V(pt(r));let e=t,o=_(t);return o===s(L)||(Jt(s(_i),o),V(pt(s(sl)))||(o=ef(o)),(e===s(Ni)||e===s(Ii))&&Se(o))?o:Se(pt(s(Ii)))?Gt(o,f.imaginaryunit,s(Ii)):Se(pt(s(Ni)))?Gt(o,f.imaginaryunit,s(Ni)):o}function va(){h.esc_flag&&N("esc key")}function mc(t){Dt(t);let{nelem:r,ndim:e}=t.tensor,o=ct(r);return o.tensor.ndim=e,o.tensor.dim=Array.from(t.tensor.dim),Dt(o),o.tensor.elem=t.tensor.elem.map(_),Dt(t),Dt(o),Oh(o)}function dc(t,r){if(t.tensor.ndim!==r.tensor.ndim)return s(L);if(t.tensor.dim.some((p,g)=>p!==r.tensor.dim[g]))return s(L);let{nelem:e,ndim:o}=t.tensor,n=ct(e);n.tensor.ndim=o,n.tensor.dim=Array.from(t.tensor.dim);let i=t.tensor.elem,a=r.tensor.elem,m=n.tensor.elem;for(let p=0;p<e;p++)m[p]=I(i[p],a[p]);return n}function Kn(t,r){let{ndim:e,nelem:o}=t.tensor,n=ct(o);return n.tensor.ndim=e,n.tensor.dim=Array.from(t.tensor.dim),n.tensor.elem=t.tensor.elem.map(i=>x(i,r)),n}function ti(t,r){let{ndim:e,nelem:o}=r.tensor,n=ct(o);return n.tensor.ndim=e,n.tensor.dim=Array.from(r.tensor.dim),n.tensor.elem=r.tensor.elem.map(i=>x(t,i)),n}function Dt(t){if(t.tensor.nelem!==t.tensor.elem.length)return console.log("something wrong in tensor dimensions"),er}function Co(t){return H(t)&&t.tensor.ndim===2&&t.tensor.dim[0]===t.tensor.dim[1]}function Pm(t,r){let{ndim:e,nelem:o}=t.tensor;if(e+1>=ye)return q(s(Qr),t,r);let n=ct(o*r.tensor.nelem);n.tensor.ndim=e+1,n.tensor.dim=[...t.tensor.dim,r.tensor.dim[0]];let i=t.tensor.elem,a=r.tensor.elem,m=n.tensor.elem;for(let p=0;p<o;p++)for(let g=0;g<r.tensor.nelem;g++)m[p*r.tensor.nelem+g]=wt(i[p],a[g]);return n}function km(t,r){let e=ct(r.tensor.nelem);return e.tensor.ndim=1,e.tensor.dim[0]=r.tensor.dim[0],e.tensor.elem=r.tensor.elem.map(o=>wt(t,o)),e}function Dm(t,r){let e=ct(t.tensor.nelem);return e.tensor.ndim=t.tensor.ndim,e.tensor.dim=[...t.tensor.dim],e.tensor.elem=t.tensor.elem.map(o=>wt(o,r)),e}function Cx(t,r){if(t.tensor.ndim<r.tensor.ndim)return-1;if(t.tensor.ndim>r.tensor.ndim)return 1;for(let e=0;e<t.tensor.ndim;e++){if(t.tensor.dim[e]<r.tensor.dim[e])return-1;if(t.tensor.dim[e]>r.tensor.dim[e])return 1}for(let e=0;e<t.tensor.nelem;e++)if(!ot(t.tensor.elem[e],r.tensor.elem[e]))return mr(t.tensor.elem[e],r.tensor.elem[e])?-1:1;return 0}function Cu(t,r){let e=t.tensor.ndim-1;if(t.tensor.dim[0]!==t.tensor.dim[e])return q(s(ut),t,r);let o=et(r);if(isNaN(o))return q(s(ut),t,r);if(o===0){t.tensor.ndim!==2&&N("power(tensor,0) with tensor rank not equal to 2"),o=t.tensor.dim[0],t=ct(o*o),t.tensor.ndim=2,t.tensor.dim[0]=o,t.tensor.dim[1]=o;for(let a=0;a<o;a++)t.tensor.elem[o*a+a]=f.one;return Dt(t),t}let n=t;o<0&&(o=-o,n=xo(n));let i=n;for(let a=1;a<o&&(i=Ur(i,n),!V(i));a++);return i}function ro(t){let r=ct(t.tensor.nelem);return r.tensor.ndim=t.tensor.ndim,r.tensor.dim=[...t.tensor.dim],r.tensor.elem=[...t.tensor.elem],Dt(t),Dt(r),r}function Oh(t){if(!H(t))return t;let r=t.tensor.elem[0];if(t.tensor.elem.some(i=>!Th(r,i))&&N("Cannot promote tensor due to inconsistent tensor components."),!H(r))return t;let e=t.tensor.ndim+r.tensor.ndim;e>ye&&N("tensor rank > "+ye);let o=t.tensor.nelem*r.tensor.nelem,n=ct(o);return n.tensor.ndim=e,n.tensor.dim=[...t.tensor.dim,...r.tensor.dim],n.tensor.elem=[].concat(...t.tensor.elem.map(i=>i.tensor.elem)),Dt(r),Dt(n),n}function Th(t,r){if(!H(t)&&!H(r))return!0;if(!H(t)||!H(r)||t.tensor.ndim!==r.tensor.ndim)return!1;for(let e=0;e<t.tensor.ndim;e++)if(t.tensor.dim[e]!==r.tensor.dim[e])return!1;return!0}function ct(t){let r=new ys;for(let e=0;e<t;e++)r.tensor.elem[e]=f.zero;return Dt(r),r}function Zu(t,r){let e=ct(t*r);return e.ndim=2,e.dim[0]=t,e.dim[1]=r,e}function ot(t,r){return Ie(t,r)===0}function mr(t,r){return Ie(t,r)<0}function yn(t){return t<0?-1:t>0?1:0}function Ie(t,r){let e=0;if(t===r)return 0;if(t===s(L))return-1;if(r===s(L))return 1;if(C(t)&&C(r))return yn(Fs(t,r));if(C(t))return-1;if(C(r))return 1;if(ee(t)&&ee(r))return yn(tf(t.str,r.str));if(ee(t))return-1;if(ee(r))return 1;if(xt(t)&&xt(r))return yn(tf(dn(t),dn(r)));if(xt(t))return-1;if(xt(r))return 1;if(H(t)&&H(r))return Cx(t,r);if(H(t))return-1;if(H(r))return 1;for(;M(t)&&M(r);){if(e=Ie(u(t),u(r)),e!==0)return e;t=c(t),r=c(r)}return M(r)?-1:M(t)?1:0}function _r(t){return M(t)?[...t].length:0}function vl(t){return $r(_,t)}function lr(t){return T(s(rr),t)}function ka(t){return T(t,y(2))}function hm(t){t.sort(Ie)}var Sf=t=>t.reduce((r,e)=>r+e,0);function Kt(t){let r;if(M(t)){let e=[...t];r=Sf(e.map(Kt))+e.length}else r=1;return r}function ls(t,r){let e=0;return M(r)?e=Sf([...r].map(o=>ls(t,o))):ot(t,r)&&(e=1),e}function Px(t){let r=0;if(H(t))for(let e=0;e<t.tensor.nelem;e++)r+=Kt(t.tensor.elem[e]);else if(M(t)){let e=[...t];r=Sf(e.map(Kt))+e.length}else r=1;return r}function Vd(){let t=Nh();return t!==""?new Bo(t):s(L)}function Nh(){return[...pn.symbolinfo()].join(`
`)}var Ci=class{constructor(r){this.parent=r,this.symbols=new Map,this.bindings=new Map}getOrCreate(r){let e=this.getExisting(r);if(e)return e;let o=new Es(r);return this.symbols.set(r,o),o}getExisting(r){var e;return((e=this.parent)===null||e===void 0?void 0:e.getExisting(r))||this.symbols.get(r)}mustGet(r){var e;return this.symbols.get(r)||((e=this.parent)===null||e===void 0?void 0:e.mustGet(r))||N(`${r} not defined`)}has(r){return this.symbols.has(r.printname)}binding(r){var e;return this.bindings.get(r.printname)||((e=this.parent)===null||e===void 0?void 0:e.binding(r))||r}set(r,e){this.bindings.set(r.printname,e)}clear(){this.bindings.clear()}delete(r){var e;this.symbols.delete(r.printname),this.bindings.delete(r.printname),(e=this.parent)===null||e===void 0||e.delete(r)}*symbolinfo(){this.parent&&(yield*this.parent.symbolinfo());for(let[r,e]of this.symbols.entries()){let o=this.bindings.get(r)||e,n=(o+"").substring(0,4);yield`symbol: ${e} size: ${Px(o)} value: ${n}...`}}clearRenamedVariablesToAvoidBindingToExternalScope(){var r;for(let e of this.symbols.keys())e.indexOf("AVOID_BINDING_TO_EXTERNAL_SCOPE_VALUE")!==-1&&this.symbols.delete(e);for(let e of this.bindings.keys())e.indexOf("AVOID_BINDING_TO_EXTERNAL_SCOPE_VALUE")!==-1&&this.bindings.delete(e);(r=this.parent)===null||r===void 0||r.clearRenamedVariablesToAvoidBindingToExternalScope()}},Dn=new Ci,pn=new Ci(Dn);function w(t,r){let e=Dn.getOrCreate(t);e.latexPrint=t,e.keyword=r}function Ue(t){return pn.getOrCreate(t)}function dn(t){return t.k!==Fr&&N("symbol error"),t.printname}function Jt(t,r){t.k!==Fr&&N("symbol error"),pn.set(t,r)}function pt(t){return t.k!==Fr&&N("symbol error"),pn.binding(t)}function Ih(t){return t.k!==Fr?!1:/^[abcdjnrstxyz]_?$/.test(t.printname)||!Dn.has(t)}function Zd(){Dn=new Ci,pn=new Ci(Dn)}function yx(){pn=new Ci(Dn),Dn.clear()}function hs(t,r){if(r==null&&(r=[]),Ih(t)&&r.indexOf(t)===-1){r.push(t);return}if(H(t)){for(let e=0;e<t.tensor.nelem;e++)hs(t.tensor.elem[e],r);return}for(;M(t);)hs(u(t),r),t=c(t)}function s(t){return pn.mustGet(t)}function ya(t){return xt(t)&&t.keyword!=null}function Ex(t){pn.delete(t)}var Rh="^";function Yd(t){return h.stringsEmittedByUserPrintouts+=Pi(c(t),h.printMode),s(L)}function jd(t){return h.stringsEmittedByUserPrintouts+=Pi(c(t),ml),s(L)}function Hd(t){return h.stringsEmittedByUserPrintouts+=Pi(c(t),ws),s(L)}function Qd(t){return h.stringsEmittedByUserPrintouts+=Pi(c(t),ft),s(L)}function Jd(t){let r=h.test_flag;return h.test_flag=!1,h.stringsEmittedByUserPrintouts+=Pi(c(t),Ve),h.test_flag=r,s(L)}function Wd(t){let r=Pi(c(t),cl);return h.stringsEmittedByUserPrintouts+=r,s(L)}function Pi(t,r){let e="";for(;M(t);){let o=_(u(t)),n=h.printMode;r===ws?(h.printMode=ws,e=_s(o),As(e,rl)):r===Ve?(h.printMode=Ve,e=_s(o),As(e,nl)):r===ml?(h.printMode=ml,e=al(o),As(e,tl)):r===ft?(h.printMode=ft,e=_s(o),As(e,el)):r===cl&&(h.printMode=cl,e=Kr(o),As(e,ol)),h.printMode=n,t=c(t)}return D&&console.log(`emttedString from display: ${h.stringsEmittedByUserPrintouts}`),e}function As(t,r){let[,e]=bo('"'+t+'"');Jt(s(r),e)}function k(t){return D&&console.log(`emttedString from print_str: ${h.stringsEmittedByUserPrintouts}`),t}function Me(t){return t}function fl(t){let r=h.printMode;h.printMode=ft;let e=h.codeGen;h.codeGen=!1;let o=G(t);return o=o.replace(/_/g,"\\_"),h.printMode=r,h.codeGen=e,D&&console.log(`emttedString from collectLatexStringFromReturnValue: ${h.stringsEmittedByUserPrintouts}`),o}function _s(t){let r="";return r+=G(t),r}function kx(t){let r="";return or(t)||X(t)||Y(t)||rt(t)||mr(t,f.zero)?(r+=Me("("),r+=G(t),r+=Me(")")):r+=G(t),r}function Dx(t){let r="";return or(t)||X(t)||Y(t)||rt(t)?(r+=Me("("),r+=G(t),r+=Me(")")):r+=G(t),r}function Lh(t,r){let e="",o=l(t),n=A(t);return Nt(n)?(e+=kx(o),e):(r===1&&(e+=Me("(")),n=U(n),e+=Ms(o,n),r===1&&(e+=Me(")")),e)}function $h(t){let r,e,o="",n=0,i=0,a=0,m=c(t),p=u(m);for(lt(p)?(r=me(Le(p)),e=Re(p),Et(r)||i++,Et(e)||a++,m=c(m)):(r=f.one,e=f.one);M(m);)p=u(m),ul(p)?a++:i++,m=c(m);if(h.printMode===ft&&(o+=k("\\frac{")),i===0)o+=Me("1");else for(n=0,m=c(t),lt(u(m))&&(m=c(m)),Et(r)||(o+=oo(r),n=1);M(m);)p=u(m),ul(p)||(n&&(o+=Tf()),o+=oo(p),n=1),m=c(m);for(h.printMode===ft?o+=k("}{"):h.printMode===Ve&&!h.test_flag?o+=k(" / "):o+=k("/"),a>1&&h.printMode!==ft&&(o+=Me("(")),n=0,m=c(t),lt(u(m))&&(m=c(m)),Et(e)||(o+=oo(e),n=1);M(m);)p=u(m),ul(p)&&(n&&(o+=Tf()),o+=Lh(p,a),n=1),m=c(m);return a>1&&h.printMode!==ft&&(o+=Me(")")),h.printMode===ft&&(o+=k("}")),o}function G(t){let r="";if(X(t))for(t=c(t),qs(u(t))==="-"&&(r+=k("-")),r+=Of(u(t)),t=c(t);M(t);)qs(u(t))==="+"?h.printMode===Ve&&!h.test_flag?r+=k(" + "):r+=k("+"):h.printMode===Ve&&!h.test_flag?r+=k(" - "):r+=k("-"),r+=Of(u(t)),t=c(t);else qs(t)==="-"&&(r+=k("-")),r+=Of(t);return r}function qs(t){let r="";return Y(t)&&C(l(t))&&mr(l(t),f.zero)||C(t)&&mr(t,f.zero)?r+="-":r+="+",r}function Of(t){let r="";if(Y(t)&&gv(t))return r+=$h(t),r;if(Y(t)){let e,o;t=c(t),Nt(u(t))&&(t=c(t));let n=!1;C(u(t))&&(n=!0);let i=!1;for(h.printMode===ft&&M(c(t))&&yc(u(t))&&(i=!0,e=u(t).q.b.toString()),i?(o=r,r=""):r+=oo(u(t)),t=c(t);M(t);)h.printMode===ft&&n&&jr(t)===s(ut)&&C(u(c(u(t))))&&(or(u(c(c(u(t)))))||(r+=" \\cdot ")),r+=Tf(),r+=oo(u(t),!1,!0),n=!1,C(u(t))&&(n=!0),t=c(t);i&&(r=o+"\\frac{"+r+"}{"+e+"}")}else r+=oo(t);return r}function Bx(t){let r="";return r+=Me("("),r+=G(t),r+=Me(")"),r}function Ch(t){let r="";return t=l(t),or(t)||X(t)||Y(t)||rt(t)||ae(t)?r+=Bx(t):r+=G(t),r+=Me("!"),r}function Ph(t){let r="";return r+=k("\\left |"),r+=G(l(t)),r+=k(" \\right |"),r}function kh(t){let r="";return r+=k("\\binom{"),r+=G(l(t)),r+=k("}{"),r+=G(A(t)),r+=k("} "),r}function Dh(t){let r="";return r+=G(l(t)),r+=k(" \\cdot "),r+=G(A(t)),r}function Bh(t){let r="dot(";return r+=G(l(t)),r+=", ",r+=G(A(t)),r+=")",r}function Uh(t){let r="Math.sin(";return r+=G(l(t)),r+=")",r}function Gh(t){let r="Math.cos(";return r+=G(l(t)),r+=")",r}function Fh(t){let r="Math.tan(";return r+=G(l(t)),r+=")",r}function zh(t){let r="Math.asin(";return r+=G(l(t)),r+=")",r}function Vh(t){let r="Math.acos(";return r+=G(l(t)),r+=")",r}function Zh(t){let r="Math.atan(";return r+=G(l(t)),r+=")",r}function Yh(t){let r="";return r+=k("\\sqrt{"),r+=G(l(t)),r+=k("} "),r}function jh(t){let r="";return r+=k("{"),M(l(t))&&(r+=k("(")),r+=G(l(t)),M(l(t))&&(r+=k(")")),r+=k("}"),r+=k("^T"),r}function Hh(t){let r="";return r+=k("transpose("),r+=G(l(t)),r+=k(")"),r}function Qh(t){let r="";return r+=k("identity("),r+=G(l(t)),r+=k(")"),r}function Jh(t){let r="";return r+=k("{"),M(l(t))&&(r+=k("(")),r+=G(l(t)),M(l(t))&&(r+=k(")")),r+=k("}"),r+=k("^{-1}"),r}function Wh(t){let r="";return r+=k("inv("),r+=G(l(t)),r+=k(")"),r}function Xh(t){let r="",e=u(c(t));t=c(t);let o=t,n=0;for(;M(c(c(t)));){n++;let i=c(c(t));r+=k("\\int^{"),r+=G(u(c(i))),r+=k("}_{"),r+=G(u(i)),r+=k("} \\! "),t=c(i)}r+=G(e),r+=k(" \\,"),t=o;for(let i=1;i<=n;i++){let a=c(t);r+=k(" \\mathrm{d} "),r+=G(u(a)),i<n&&(r+=k(" \\, ")),t=c(c(a))}return r}function Kh(t){let r="";return r+=Ux(t,0,0)[1],r}function Ux(t,r,e){let o="";if(o+=k("["),r<t.tensor.ndim-1)for(let n=0;n<t.tensor.dim[r];n++){let i;[e,i]=Array.from(Ux(t,r+1,e)),o+=i,n!==t.tensor.dim[r]-1&&(o+=k(","))}else for(let n=0;n<t.tensor.dim[r];n++)o+=G(t.tensor.elem[e]),n!==t.tensor.dim[r]-1&&(o+=k(",")),e++;return o+=k("]"),[e,o]}function tv(t){let r="";return t.tensor.ndim<=2&&(r+=Gx(!0,t,0,0)[1]),r}function Gx(t,r,e,o){let n="";if(t&&(n+="\\begin{bmatrix} "),e<r.tensor.ndim-1)for(let i=0;i<r.tensor.dim[e];i++){let a;[o,a]=Array.from(Gx(!1,r,e+1,o)),n+=a,i!==r.tensor.dim[e]-1&&(n+=k(" \\\\ "))}else for(let i=0;i<r.tensor.dim[e];i++)n+=G(r.tensor.elem[o]),i!==r.tensor.dim[e]-1&&(n+=k(" & ")),o++;return t&&(n+=" \\end{bmatrix}"),[o,n]}function rv(t){let r="\\sum_{";return r+=G(A(t)),r+="=",r+=G(Ft(t)),r+="}^{",r+=G(pe(t)),r+="}{",r+=G(l(t)),r+="}",r}function ev(t){let r=l(t),e=A(t),o=Ft(t),n=pe(t);return"(function(){ var "+e+";  var holderSum = 0;  var lowerlimit = "+G(o)+";  var upperlimit = "+G(n)+";  for ("+e+" = lowerlimit; "+e+" < upperlimit; "+e+"++) {    holderSum += "+G(r)+"; }  return holderSum;})()"}function ov(t){let r="\\left\\{ \\begin{array}{ll}";for(t=c(t);M(t);){if(c(t)===s(L)){r+="{",r+=G(u(t)),r+="} & otherwise ",r+=" \\\\\\\\";break}r+="{",r+=G(l(t)),r+="} & if & ",r+=G(u(t)),r+=" \\\\\\\\",t=Er(t)}return r=r.substring(0,r.length-4),r+="\\end{array} \\right."}function nv(t){let r="(function(){";t=c(t);let e=0;for(;M(t);){if(c(t)===s(L)){r+="else {",r+="return ("+G(u(t))+");",r+="}";break}e&&(r+=" else "),r+="if ("+G(u(t))+"){",r+="return ("+G(l(t))+");",r+="}",e++,t=Er(t)}return r+="})()",r}function iv(t){let r="{";return r+=G(l(t)),r+="}",r+=" < ",r+="{",r+=G(A(t)),r+="}"}function sv(t){let r="{";return r+=G(l(t)),r+="}",r+=" \\leq ",r+="{",r+=G(A(t)),r+="}"}function av(t){let r="{";return r+=G(l(t)),r+="}",r+=" > ",r+="{",r+=G(A(t)),r+="}"}function lv(t){let r="{";return r+=G(l(t)),r+="}",r+=" \\geq ",r+="{",r+=G(A(t)),r+="}"}function fv(t){let r="{";return r+=G(l(t)),r+="}",r+=" = ",r+="{",r+=G(A(t)),r+="}"}function uv(t){let r=l(t),e=A(t),o=Ft(t),n=pe(t);return"(function(){ var "+e+";  var lowerlimit = "+G(o)+";  var upperlimit = "+G(n)+";  for ("+e+" = lowerlimit; "+e+" < upperlimit; "+e+"++) {    "+G(r)+" } })()"}function mv(t){let r="";for(t=c(t);M(t);)r+=G(u(t)),t=c(t);return r}function cv(t){let r="";return r+=G(l(t)),r+=" = ",r+=G(A(t)),r+="; ",r}function dv(t){let r="\\prod_{";return r+=G(A(t)),r+="=",r+=G(Ft(t)),r+="}^{",r+=G(pe(t)),r+="}{",r+=G(l(t)),r+="}",r}function pv(t){let r=l(t),e=A(t),o=Ft(t),n=pe(t);return"(function(){ var "+e+";  var holderProduct = 1;  var lowerlimit = "+G(o)+";  var upperlimit = "+G(n)+";  for ("+e+" = lowerlimit; "+e+" < upperlimit; "+e+"++) {    holderProduct *= "+G(r)+"; }  return holderProduct;})()"}function Ms(t,r){let e="";if(D&&console.log("power base: "+t+"  exponent: "+r),$e(r))if(St(t,2)){if(h.codeGen)return e+=k("Math.SQRT2"),e}else{if(h.printMode===ft)return e+=k("\\sqrt{"),e+=G(t),e+=k("}"),e;if(h.codeGen)return e+=k("Math.sqrt("),e+=G(t),e+=k(")"),e}if(St(pt(s(Ha)),1)&&t===s(rr))return h.codeGen?(e+=k("Math.exp("),e+=Dx(r),e+=k(")"),e):(h.printMode===ft?(e+=k("e^{"),e+=G(r),e+=k("}")):(e+=k("exp("),e+=G(r),e+=k(")")),e);if(h.codeGen)return e+=k("Math.pow("),e+=kx(t),e+=k(", "),e+=Dx(r),e+=k(")"),e;if(St(pt(s(Qa)),0)||t.printname!=="x"){if(t!==s(rr)){if(Nt(r))return h.printMode===ft?e+=k("\\frac{1}{"):h.printMode===Ve&&!h.test_flag?e+=k("1 / "):e+=k("1/"),M(t)&&h.printMode!==ft?(e+=k("("),e+=G(t),e+=k(")")):e+=G(t),h.printMode===ft&&(e+=k("}")),e;if(Ct(r)){h.printMode===ft?e+=k("\\frac{1}{"):h.printMode===Ve&&!h.test_flag?e+=k("1 / "):e+=k("1/");let o=x(r,f.negOne);return M(t)&&h.printMode!==ft?(e+=k("("),e+=Ms(t,o),e+=k(")")):e+=Ms(t,o),h.printMode===ft&&(e+=k("}")),e}}if(or(r)&&h.printMode===ft){e+=k("\\sqrt");let o=Cr(r);return Uo(o)||(e+=k("["),e+=G(o),e+=k("]")),e+=k("{"),r=Zr(r),e+=Ms(t,r),e+=k("}"),e}}return h.printMode===ft&&Et(r)?e+=G(t):(X(t)||It(t)?(e+=k("("),e+=G(t),e+=k(")")):Y(t)||rt(t)?(h.printMode!==ft&&(e+=k("(")),e+=oo(t,!0),h.printMode!==ft&&(e+=k(")"))):C(t)&&(mr(t,f.zero)||or(t))?(e+=k("("),e+=oo(t),e+=k(")")):e+=oo(t),h.printMode===Ve&&!h.test_flag?e+=k(Rh):e+=k("^"),h.printMode===ft?G(r).length>1?(e+=k("{"),e+=G(r),e+=k("}")):e+=G(r):M(r)||or(r)||C(r)&&mr(r,f.zero)?(e+=k("("),e+=G(r),e+=k(")")):e+=oo(r)),e}function xv(t){let r="";if(t=c(t),jr(t)===s(Pr)||jr(t)===s(Ht)||jr(t)===s(ut)||jr(t)===s(Br)?r+=Bx(u(t)):r+=G(u(t)),r+=k("["),t=c(t),M(t))for(r+=G(u(t)),t=c(t);M(t);)r+=k(","),r+=G(u(t)),t=c(t);return r+=k("]"),r}function oo(t,r=!1,e=!1){let o="";if(C(t))return e&&mr(t,f.zero)&&(o+="("),o+=rf(t,e),e&&mr(t,f.zero)&&(o+=")"),o;if(ee(t))return o+=k('"'),o+=k(t.str),o+=k('"'),o;if(H(t))return h.printMode===ft?o+=tv(t):o+=Kh(t),o;if(Y(t))return r||(qs(t)==="-"||h.printMode!==ft)&&(h.printMode===ft?o+=k(" \\left ("):o+=k("(")),o+=G(t),r||(qs(t)==="-"||h.printMode!==ft)&&(h.printMode===ft?o+=k(" \\right ) "):o+=k(")")),o;if(X(t))return r||(o+=k("(")),o+=G(t),r||(o+=k(")")),o;if(rt(t)){let n=l(t),i=A(t);return o+=Ms(n,i),o}if(u(t)===s(He)){let n=l(t);if(!h.codeGen){let i=A(t);o+=k("function "),D&&console.log(`emittedString from print_factor ${h.stringsEmittedByUserPrintouts}`),o+=Kr(i),o+=k(" -> ")}return o+=G(n),o}if(u(t)===s(on))return o+=G(Oe(t)),h.printMode===ft?o+=k(" \\rightarrow "):h.printMode===Ve&&!h.test_flag?o+=k(" -> "):o+=k("->"),o+=G(u(c(l(t)))),o;if(u(t)===s(ho)&&xt(l(t)))return o+=xv(t),o;if(ae(t))return o+=Ch(t),o;if(u(t)===s(Ce)&&h.printMode===ft)return o+=Ph(t),o;if(u(t)===s(xi)&&h.printMode===ft)return o+=Yh(t),o;if(ae(t)){if(h.printMode===ft)return o+=jh(t),o;if(h.codeGen)return o+=Hh(t),o}else if(u(t)===s(Ka)){if(h.codeGen)return o+=Qh(t),o}else if(Ks(t)){if(h.printMode===ft)return o+=Jh(t),o;if(h.codeGen)return o+=Wh(t),o}else{if(u(t)===s(Za)&&h.printMode===ft)return o+=kh(t),o;if(u(t)===s(Ya)&&h.printMode===ft)return o+=Xh(t),o;if(De(t)){if(h.printMode===ft)return o+=Dh(t),o;if(h.codeGen)return o+=Bh(t),o}else if(u(t)===s(fr)){if(h.codeGen)return o+=Uh(t),o}else if(u(t)===s(ur)){if(h.codeGen)return o+=Gh(t),o}else if(u(t)===s(ve)){if(h.codeGen)return o+=Fh(t),o}else if(u(t)===s(Je)){if(h.codeGen)return o+=zh(t),o}else if(u(t)===s(We)){if(h.codeGen)return o+=Vh(t),o}else if(u(t)===s(zr)){if(h.codeGen)return o+=Zh(t),o}else if(u(t)===s(Wa)){if(h.printMode===ft)return o+=rv(t),o;if(h.codeGen)return o+=ev(t),o}else if(u(t)===s(Ja)){if(h.printMode===ft)return o+=dv(t),o;if(h.codeGen)return o+=pv(t),o}else if(u(t)===s(yi)){if(h.codeGen)return o+=uv(t),o}else if(u(t)===s(ja)){if(h.codeGen)return o+=mv(t),o}else if(u(t)===s(Xa)){if(h.codeGen)return o+=nv(t),o;if(h.printMode===ft)return o+=ov(t),o}else if(u(t)===s(fi)){if(h.codeGen)return o+="(("+G(l(t))+") < ("+G(A(t))+"))",o;if(h.printMode===ft)return o+=iv(t),o}else if(u(t)===s(li)){if(h.codeGen)return o+="(("+G(l(t))+") <= ("+G(A(t))+"))",o;if(h.printMode===ft)return o+=sv(t),o}else if(u(t)===s(ai)){if(h.codeGen)return o+="(("+G(l(t))+") > ("+G(A(t))+"))",o;if(h.printMode===ft)return o+=av(t),o}else if(u(t)===s(si)){if(h.codeGen)return o+="(("+G(l(t))+") >= ("+G(A(t))+"))",o;if(h.printMode===ft)return o+=lv(t),o}else if(u(t)===s(Ge)){if(h.codeGen)return o+="(("+G(l(t))+") === ("+G(A(t))+"))",o;if(h.printMode===ft)return o+=fv(t),o}else if(u(t)===s(Si)){if(h.codeGen)return o+="Math.floor("+G(l(t))+")",o;if(h.printMode===ft)return o+=" \\lfloor {"+G(l(t))+"} \\rfloor ",o}else if(u(t)===s(Ei)){if(h.codeGen)return o+="Math.ceiling("+G(l(t))+")",o;if(h.printMode===ft)return o+=" \\lceil {"+G(l(t))+"} \\rceil ",o}else if(u(t)===s(Ti)){if(h.codeGen)return o+="Math.round("+G(l(t))+")",o}else if(u(t)===s(Ee))return h.codeGen?(o+=cv(t),o):(o+=G(l(t)),o+=k("="),o+=G(A(t)),o)}if(M(t)){if(o+=oo(u(t)),t=c(t),r||(o+=k("(")),M(t))for(o+=G(u(t)),t=c(t);M(t);)o+=k(","),o+=G(u(t)),t=c(t);return r||(o+=k(")")),o}return t===s(Qr)?o+=Me("d"):t===s(rr)?h.codeGen?o+=k("Math.E"):o+=k("e"):t===s(vt)?h.printMode===ft?o+=k("\\pi"):o+=k("pi"):o+=k(dn(t)),o}function Kr(t){let r="";switch(t.k){case ln:for(r+="(",r+=Kr(u(t)),t===c(t)&&(console.log("oh no recursive!"),er),t=c(t);M(t);)r+=" ",r+=Kr(u(t)),t=c(t),t===c(t)&&t!==s(L)&&(console.log("oh no recursive!"),er);t!==s(L)&&(r+=" . ",r+=Kr(t)),r+=")";break;case fn:r+=t.str;break;case Zt:case Ut:r+=rf(t,!0);break;case Fr:r+=dn(t);break;default:r+="<tensor>"}return r}function Tf(){let t="";return h.printMode===ft||(h.printMode===Ve&&!h.test_flag&&!h.codeGen?t+=k(" "):t+=k("*")),t}function ul(t){return rt(t)&&l(t)!==s(rr)&&Ct(A(t))}function gv(t){for(t=c(t);M(t);){let r=u(t);if(ul(r))return!0;t=c(t)}return!1}function er(){}var Va="2.0.1";var D=!1,vs=!1,ft="PRINTMODE_LATEX",ml="PRINTMODE_2DASCII",ws="PRINTMODE_COMPUTER",Ve="PRINTMODE_HUMAN",cl="PRINTMODE_LIST",Fx=class{constructor(){this.printMode=ws,this.recursionLevelNestedRadicalsRemoval=0,this.errorMessage="",this.symbolsDependencies={},this.symbolsHavingReassignments=[],this.symbolsInExpressionsWithoutAssignments=[],this.patternHasBeenFound=!1,this.inited=!1,this.chainOfUserSymbolsNotFunctionsBeingEvaluated=[],this.stringsEmittedByUserPrintouts="",this.called_from_Algebra_block=!1,this.expanding=!1,this.evaluatingAsFloats=!1,this.evaluatingPolar=!1,this.esc_flag=!1,this.trigmode=0,this.out_count=0,this.test_flag=!1,this.codeGen=!1,this.userSimplificationsInListForm=[],this.userSimplificationsInStringForm=[],this.fullDoubleOutput=!1}},h=new Fx,Fu=!0,Tm=!0,Pu=!0,Bn=class{toString(){return G(this)}toLatexString(){return fl(this)}},Rr=class extends Bn{constructor(r,e){super();this.k=ln,this.cons={car:r,cdr:e}}*[Symbol.iterator](){let r=this;for(;M(r);)yield u(r),r=c(r)}tail(){return M(this.cons.cdr)?[...this.cons.cdr]:[]}map(r){let e=u(this),o=c(this);return M(o)&&(o=o.map(r)),new Rr(r(e),o)}},Tt=class extends Bn{constructor(r,e=Ss.default.one){super();this.a=r,this.b=e,this.q=this,this.k=Zt}},de=class extends Bn{constructor(r){super();this.d=r,this.k=Ut}},Bo=class extends Bn{constructor(r){super();this.str=r,this.k=fn}},ys=class extends Bn{constructor(){super(...arguments);this.tensor=this,this.k=un,this.ndim=0,this.dim=[],this.elem=[]}get nelem(){return this.elem.length}},Es=class extends Bn{constructor(r){super();this.printname=r,this.k=Fr}},ln=0,Zt=1,Ut=2,fn=3,un=4,Fr=5;var Ce="abs",Pr="add",Xd="adj",Kd="and",$a="approxratio",We="arccos",tn="arccosh",Je="arcsin",sn="arcsinh",zr="arctan",an="arctanh",Wi="arg",tp="atomize",Ko="besselj",Mn="bessely",rp="binding",Za="binomial",Ei="ceiling",ep="check",op="choose",np="circexp",ip="clear",sp="clearall",ap="clearpatterns",lp="clock",fp="coeff",up="cofactor",mp="condense",cp="conj",dp="contract",ur="cos",go="cosh",pp="decomp",Ya="defint",xp="deg",gp="denominator",Qr="derivative",js="det",bp="dim",ei="dirac",_p="divisors",ja="do",hf="dot",hp="draw",vp="dsolve",qi="eigen",Mi="eigenval",wi="eigenvec",Rn="erf",gi="erfc",io="eval",ba="exp",yp="expand",Ep="expcos",Ap="expsin",qp="factor",Br="factorial",Mp="factorpoly",wp="filter",Ta="float",Si="floor",yi="for",He="function",ps="Gamma",Sp="gcd",ri="hermite",Qs="hilbert",Op="imag",ho="component",Po="inner",yo="integral",ns="inv",Xs="invg",Ea="isinteger",Tp="isprime",Pa="laguerre",Np="lcm",Ip="leading",Da="legendre",Jo="log",Rp="lookup",Ba="mod",Ht="multiply",sa="not",Lp="nroots",$p="number",Cp="numerator",Wo="operator",Pp="or",kp="outer",on="pattern",Dp="patternsinfo",Bp="polar",ut="power",Up="prime",Ha="printLeaveEAlone",Qa="printLeaveXAlone",Gp="print",Fp="print2dascii",zp="printcomputer",Vp="printlatex",Zp="printlist",Yp="printhuman",Ja="product",aa="quote",jp="quotient",Hp="rank",Qp="rationalize",Jp="real",Ti="round",Bs="rect",Wp="roots",Ee="equals",In="sgn",Xp="silentpattern",Kp="simplify",fr="sin",Ao="sinh",tx="shape",xi="sqrt",rx="stop",ex="subst",Wa="sum",ox="symbolsinfo",ve="tan",qo="tanh",Fa="taylor",Xa="test",Ge="testeq",si="testge",ai="testgt",li="testle",fi="testlt",to="transpose",Ka="unit",nx="zero",L="nil",_i="last",ix="lastprint",tl="last2dasciiprint",rl="lastfullprint",el="lastlatexprint",ol="lastlistprint",nl="lastplainprint",il="autoexpand",sl="bake",fo="assumeRealVariables",sx="trace",Ia="forceFixedPrintout",Ra="maxFixedPrintoutDigits",vf="~",ax="$DRAWX",fe="$METAA",ue="$METAB",re="$METAX",Pt="$SECRETX",lx="version",vt="pi",fx="a",ux="b",mx="c",bi="d",Ni="i",Ii="j",cx="n",dx="r",Zo="s",Yo="t",Xr="x",ao="y",lo="z",Pe="I",ca="a_",da="b_",pa="x_",px="$C1",xx="$C2",gx="$C3",bx="$C4",_x="$C5",hx="$C6",rr=vf,jn=1e4,zl=5,Vl=10,ye=24,la=["rationalize","abs","e","i","pi","sin","ceiling","cos","roots","integral","derivative","defint","sqrt","eig","cov","deig","dcov","float","floor","product","root","round","sum","test","unit"],Dl=!0,Yn=function(){let t=[2],r=3;for(;t.length<jn;){let e=0,o=Math.sqrt(r);for(;e<t.length&&t[e]<=o;){if(r%t[e]==0){e=-1;break}e++}e!==-1&&t.push(r),r+=2}return t[jn]=0,t}(),bv=!1;var fa=7488,vo=183;function M(t){return t.k===ln}function lt(t){return t.k===Zt}function K(t){return t.k===Ut}function C(t){return lt(t)||K(t)}function ee(t){return t.k===fn}function H(t){return t.k===un}function ke(t){if(C(t)||t===s(Pe))return!0;if(!H(t))return!1;let r=t.tensor.nelem,e=t.tensor.elem;for(let o=0;o<r;o++)if(!ke(e[o]))return!1;return!0}function xt(t){return t.k===Fr}function u(t){return M(t)?t.cons.car:s(L)}function c(t){return M(t)?t.cons.cdr:s(L)}function jr(t){return u(u(t))}function l(t){return u(c(t))}function os(t){return c(u(t))}function Er(t){return c(c(t))}function Oe(t){return u(u(c(t)))}function A(t){return u(c(c(t)))}function zx(t){return u(c(u(t)))}function zn(t){return c(u(c(t)))}function Vx(t){return c(c(u(t)))}function jo(t){return c(c(c(t)))}function Zx(t){return u(u(c(c(t))))}function ci(t){return u(c(u(c(t))))}function Yx(t){return u(c(c(u(t))))}function jx(t){return c(u(c(c(t))))}function Ft(t){return u(c(c(c(t))))}function Hx(t){return c(c(c(c(t))))}function pe(t){return u(c(c(c(c(t)))))}function Qx(t){return u(c(u(c(c(t)))))}function Jx(t){return c(c(u(c(c(t)))))}function Wx(t){return u(c(c(u(c(t)))))}function Xx(t){return c(c(c(u(c(c(t))))))}function Kx(t){return u(c(c(u(c(c(t))))))}function X(t){return u(t)===s(Pr)}function Y(t){return u(t)===s(Ht)}function rt(t){return u(t)===s(ut)}function ae(t){return u(t)===s(Br)}function De(t){return u(t)===s(Po)||u(t)===s(hf)}function qm(t){return u(t)===s(to)}function Ks(t){return u(t)===s(ns)}function ta(t){return t===s(Pe)}function Ke(t){return t.isPositive()?1:t.isZero()?0:-1}function le(t){return t.isZero()}function Wt(t,r){return t==null,t.equals(r)}function Cn(){h.esc_flag=!1,bv=!1,h.evaluatingAsFloats=!1,h.evaluatingPolar=!1}var f=class{static One(){return h.evaluatingAsFloats?f.oneAsDouble:f.one}static NegOne(){return h.evaluatingAsFloats?f.negOneAsDouble:f.negOne}static Zero(){return h.evaluatingAsFloats?f.zeroAsDouble:f.zero}static Pi(){return h.evaluatingAsFloats?f.piAsDouble:s(vt)}};f.one=new Tt((0,Ss.default)(1));f.oneAsDouble=new de(1);f.negOne=new Tt((0,Ss.default)(-1));f.negOneAsDouble=new de(-1);f.zero=new Tt((0,Ss.default)(0));f.zeroAsDouble=new de(0);f.piAsDouble=new de(Math.PI);function Vr(t,...r){let e=h.expanding;h.expanding=!1;try{return t(...r)}finally{h.expanding=e}}function $r(t,...r){let e=h.expanding;h.expanding=!0;try{return t(...r)}finally{h.expanding=e}}function Vf(t,...r){let e=h.evaluatingPolar;h.evaluatingPolar=!0;try{return t(...r)}finally{h.evaluatingPolar=e}}function ua(t,...r){let e=h.evaluatingAsFloats;h.evaluatingAsFloats=!0;try{return t(...r)}finally{h.evaluatingAsFloats=e}}h.inited||(h.inited=!0,$n());function tg(t){if(typeof t=="string"){let[,r]=bo(t);return r}else return typeof t=="number"?t%1==0?y(t):tt(t):typeof t.k=="number"?t:(console.warn("unknown argument type",t),s(L))}function rg(t){let r;try{r=tg(t),kn()}catch(e){throw Cn(),e}return r}function Nf(t,...r){let e,o=pt(Ue(t));kn();let n=q(o,...r.map(tg));try{e=wf(n),kn()}catch(i){throw Cn(),i}return e}var W={};W.version=Va;W.isadd=X;W.ismultiply=Y;W.ispower=rt;W.isfactorial=ae;W.car=u;W.cdr=c;W.caar=jr;W.cadr=l;W.cdar=os;W.cddr=Er;W.caadr=Oe;W.caddr=A;W.cadar=zx;W.cdadr=zn;W.cddar=Vx;W.cdddr=jo;W.caaddr=Zx;W.cadadr=ci;W.caddar=Yx;W.cdaddr=jx;W.cadddr=Ft;W.cddddr=Hx;W.caddddr=pe;W.cadaddr=Qx;W.cddaddr=Jx;W.caddadr=Wx;W.cdddaddr=Xx;W.caddaddr=Kx;W.symbol=s;W.iscons=M;W.isrational=lt;W.isdouble=K;W.isNumericAtom=C;W.isstr=ee;W.istensor=H;W.issymbol=xt;W.iskeyword=ya;W.CONS=ln;W.Cons=Rr;W.NUM=Zt;W.Num=Tt;W.DOUBLE=Ut;W.Double=de;W.STR=fn;W.Str=Bo;W.TENSOR=un;W.Tensor=ys;W.SYM=Fr;W.Sym=Es;W.approxRadicals=mn;W.approxRationalsOfLogs=nf;W.approxAll=At;W.testApprox=Lc;W.make_hashed_itab=Rm;W.isZeroAtomOrTensor=V;W.isnegativenumber=It;W.isplusone=Et;W.isminusone=Nt;W.isinteger=qt;W.isnonnegativeinteger=qa;W.isposint=On;W.isnegativeterm=Ct;W.isimaginarynumber=wa;W.iscomplexnumber=Qo;W.iseveninteger=qn;W.isnegative=ie;W.issymbolic=Kl;W.isintegerfactor=vc;W.isoneover=Ec;W.isfraction=or;W.isoneoversqrttwo=Ln;W.isminusoneoversqrttwo=hi;W.isfloating=En;W.isimaginaryunit=Se;W.isquarterturn=rs;W.isnpi=Hn;W.equal=ot;W.length=_r;W.scan=bo;W.Find=it;W.get_binding=pt;W.set_binding=Jt;W.usr_symbol=Ue;W.collectUserSymbols=hs;W.init=$n;W.exec=Nf;W.parse=rg;W.run=yf;var _v=["abs","add","adj","and","approxratio","arccos","arccosh","arcsin","arcsinh","arctan","arctanh","arg","atomize","besselj","bessely","binding","binomial","ceiling","check","choose","circexp","clear","clearall","clearpatterns","clock","coeff","cofactor","condense","conj","contract","cos","cosh","decomp","defint","deg","denominator","det","derivative","dim","dirac","divisors","do","dot","draw","dsolve","eigen","eigenval","eigenvec","erf","erfc","eval","exp","expand","expcos","expsin","factor","factorial","factorpoly","filter","float","floor","for","Gamma","gcd","hermite","hilbert","imag","component","inner","integral","inv","invg","isinteger","isprime","laguerre","lcm","leading","legendre","log","mod","multiply","not","nroots","number","numerator","operator","or","outer","pattern","patternsinfo","polar","power","prime","print","print2dascii","printcomputer","printlatex","printlist","printhuman","product","quote","quotient","rank","rationalize","real","rect","roots","round","equals","shape","sgn","silentpattern","simplify","sin","sinh","sqrt","stop","subst","sum","symbolsinfo","tan","tanh","taylor","test","testeq","testge","testgt","testle","testlt","transpose","unit","zero"];Array.from(_v).map(t=>W[t]=Nf.bind(void 0,t));var eg=W;globalThis.Algebrite=eg;})();
//# sourceMappingURL=algebrite.bundle-for-browser-min.js.map
