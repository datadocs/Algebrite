(()=>{var Qx=Object.create;var Ld=Object.defineProperty;var Wx=Object.getOwnPropertyDescriptor;var Jx=Object.getOwnPropertyNames;var Kx=Object.getPrototypeOf,e0=Object.prototype.hasOwnProperty;var t0=e=>Ld(e,"__esModule",{value:!0});var A=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var r0=(e,t,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Jx(t))!e0.call(e,n)&&n!=="default"&&Ld(e,n,{get:()=>t[n],enumerable:!(r=Wx(t,n))||r.enumerable});return e},n0=e=>r0(t0(Ld(e!=null?Qx(Kx(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var Ti=A((HU,Mu)=>{var Ft=function(e){"use strict";var t=1e7,r=7,n=9007199254740992,i=T(n),o="0123456789abcdefghijklmnopqrstuvwxyz",s=typeof BigInt=="function";function u(f,m,b,q){return typeof f=="undefined"?u[0]:typeof m!="undefined"?+m==10&&!b?qe(f):Zx(f,m,b,q):qe(f)}function c(f,m){this.value=f,this.sign=m,this.isSmall=!1}c.prototype=Object.create(u.prototype);function d(f){this.value=f,this.sign=f<0,this.isSmall=!0}d.prototype=Object.create(u.prototype);function _(f){this.value=f}_.prototype=Object.create(u.prototype);function w(f){return-n<f&&f<n}function T(f){return f<1e7?[f]:f<1e14?[f%1e7,Math.floor(f/1e7)]:[f%1e7,Math.floor(f/1e7)%1e7,Math.floor(f/1e14)]}function k(f){Z(f);var m=f.length;if(m<4&&Xn(f,i)<0)switch(m){case 0:return 0;case 1:return f[0];case 2:return f[0]+f[1]*t;default:return f[0]+(f[1]+f[2]*t)*t}return f}function Z(f){for(var m=f.length;f[--m]===0;);f.length=m+1}function Y(f){for(var m=new Array(f),b=-1;++b<f;)m[b]=0;return m}function Ae(f){return f>0?Math.floor(f):Math.ceil(f)}function tt(f,m){var b=f.length,q=m.length,O=new Array(b),x=0,P=t,L,$;for($=0;$<q;$++)L=f[$]+m[$]+x,x=L>=P?1:0,O[$]=L-x*P;for(;$<b;)L=f[$]+x,x=L===P?1:0,O[$++]=L-x*P;return x>0&&O.push(x),O}function Ze(f,m){return f.length>=m.length?tt(f,m):tt(m,f)}function ke(f,m){var b=f.length,q=new Array(b),O=t,x,P;for(P=0;P<b;P++)x=f[P]-O+m,m=Math.floor(x/O),q[P]=x-m*O,m+=1;for(;m>0;)q[P++]=m%O,m=Math.floor(m/O);return q}c.prototype.add=function(f){var m=qe(f);if(this.sign!==m.sign)return this.subtract(m.negate());var b=this.value,q=m.value;return m.isSmall?new c(ke(b,Math.abs(q)),this.sign):new c(Ze(b,q),this.sign)},c.prototype.plus=c.prototype.add,d.prototype.add=function(f){var m=qe(f),b=this.value;if(b<0!==m.sign)return this.subtract(m.negate());var q=m.value;if(m.isSmall){if(w(b+q))return new d(b+q);q=T(Math.abs(q))}return new c(ke(q,Math.abs(b)),b<0)},d.prototype.plus=d.prototype.add,_.prototype.add=function(f){return new _(this.value+qe(f).value)},_.prototype.plus=_.prototype.add;function st(f,m){var b=f.length,q=m.length,O=new Array(b),x=0,P=t,L,$;for(L=0;L<q;L++)$=f[L]-x-m[L],$<0?($+=P,x=1):x=0,O[L]=$;for(L=q;L<b;L++){if($=f[L]-x,$<0)$+=P;else{O[L++]=$;break}O[L]=$}for(;L<b;L++)O[L]=f[L];return Z(O),O}function Oe(f,m,b){var q;return Xn(f,m)>=0?q=st(f,m):(q=st(m,f),b=!b),q=k(q),typeof q=="number"?(b&&(q=-q),new d(q)):new c(q,b)}function at(f,m,b){var q=f.length,O=new Array(q),x=-m,P=t,L,$;for(L=0;L<q;L++)$=f[L]+x,x=Math.floor($/P),$%=P,O[L]=$<0?$+P:$;return O=k(O),typeof O=="number"?(b&&(O=-O),new d(O)):new c(O,b)}c.prototype.subtract=function(f){var m=qe(f);if(this.sign!==m.sign)return this.add(m.negate());var b=this.value,q=m.value;return m.isSmall?at(b,Math.abs(q),this.sign):Oe(b,q,this.sign)},c.prototype.minus=c.prototype.subtract,d.prototype.subtract=function(f){var m=qe(f),b=this.value;if(b<0!==m.sign)return this.add(m.negate());var q=m.value;return m.isSmall?new d(b-q):at(q,Math.abs(b),b>=0)},d.prototype.minus=d.prototype.subtract,_.prototype.subtract=function(f){return new _(this.value-qe(f).value)},_.prototype.minus=_.prototype.subtract,c.prototype.negate=function(){return new c(this.value,!this.sign)},d.prototype.negate=function(){var f=this.sign,m=new d(-this.value);return m.sign=!f,m},_.prototype.negate=function(){return new _(-this.value)},c.prototype.abs=function(){return new c(this.value,!1)},d.prototype.abs=function(){return new d(Math.abs(this.value))},_.prototype.abs=function(){return new _(this.value>=0?this.value:-this.value)};function ir(f,m){var b=f.length,q=m.length,O=b+q,x=Y(O),P=t,L,$,xe,Fe,Me;for(xe=0;xe<b;++xe){Fe=f[xe];for(var nt=0;nt<q;++nt)Me=m[nt],L=Fe*Me+x[xe+nt],$=Math.floor(L/P),x[xe+nt]=L-$*P,x[xe+nt+1]+=$}return Z(x),x}function Gt(f,m){var b=f.length,q=new Array(b),O=t,x=0,P,L;for(L=0;L<b;L++)P=f[L]*m+x,x=Math.floor(P/O),q[L]=P-x*O;for(;x>0;)q[L++]=x%O,x=Math.floor(x/O);return q}function qr(f,m){for(var b=[];m-- >0;)b.push(0);return b.concat(f)}function It(f,m){var b=Math.max(f.length,m.length);if(b<=30)return ir(f,m);b=Math.ceil(b/2);var q=f.slice(b),O=f.slice(0,b),x=m.slice(b),P=m.slice(0,b),L=It(O,P),$=It(q,x),xe=It(Ze(O,q),Ze(P,x)),Fe=Ze(Ze(L,qr(st(st(xe,L),$),b)),qr($,2*b));return Z(Fe),Fe}function co(f,m){return-.012*f-.012*m+15e-6*f*m>0}c.prototype.multiply=function(f){var m=qe(f),b=this.value,q=m.value,O=this.sign!==m.sign,x;if(m.isSmall){if(q===0)return u[0];if(q===1)return this;if(q===-1)return this.negate();if(x=Math.abs(q),x<t)return new c(Gt(b,x),O);q=T(x)}return co(b.length,q.length)?new c(It(b,q),O):new c(ir(b,q),O)},c.prototype.times=c.prototype.multiply;function Zn(f,m,b){return f<t?new c(Gt(m,f),b):new c(ir(m,T(f)),b)}d.prototype._multiplyBySmall=function(f){return w(f.value*this.value)?new d(f.value*this.value):Zn(Math.abs(f.value),T(Math.abs(this.value)),this.sign!==f.sign)},c.prototype._multiplyBySmall=function(f){return f.value===0?u[0]:f.value===1?this:f.value===-1?this.negate():Zn(Math.abs(f.value),this.value,this.sign!==f.sign)},d.prototype.multiply=function(f){return qe(f)._multiplyBySmall(this)},d.prototype.times=d.prototype.multiply,_.prototype.multiply=function(f){return new _(this.value*qe(f).value)},_.prototype.times=_.prototype.multiply;function el(f){var m=f.length,b=Y(m+m),q=t,O,x,P,L,$;for(P=0;P<m;P++){L=f[P],x=0-L*L;for(var xe=P;xe<m;xe++)$=f[xe],O=2*(L*$)+b[P+xe]+x,x=Math.floor(O/q),b[P+xe]=O-x*q;b[P+m]=x}return Z(b),b}c.prototype.square=function(){return new c(el(this.value),!1)},d.prototype.square=function(){var f=this.value*this.value;return w(f)?new d(f):new c(el(T(Math.abs(this.value))),!1)},_.prototype.square=function(f){return new _(this.value*this.value)};function xu(f,m){var b=f.length,q=m.length,O=t,x=Y(m.length),P=m[q-1],L=Math.ceil(O/(2*P)),$=Gt(f,L),xe=Gt(m,L),Fe,Me,nt,Lr,Ar,wd,Rd;for($.length<=b&&$.push(0),xe.push(0),P=xe[q-1],Me=b-q;Me>=0;Me--){for(Fe=O-1,$[Me+q]!==P&&(Fe=Math.floor(($[Me+q]*O+$[Me+q-1])/P)),nt=0,Lr=0,wd=xe.length,Ar=0;Ar<wd;Ar++)nt+=Fe*xe[Ar],Rd=Math.floor(nt/O),Lr+=$[Me+Ar]-(nt-Rd*O),nt=Rd,Lr<0?($[Me+Ar]=Lr+O,Lr=-1):($[Me+Ar]=Lr,Lr=0);for(;Lr!==0;){for(Fe-=1,nt=0,Ar=0;Ar<wd;Ar++)nt+=$[Me+Ar]-O+xe[Ar],nt<0?($[Me+Ar]=nt+O,nt=0):($[Me+Ar]=nt,nt=1);Lr+=nt}x[Me]=Fe}return $=tl($,L)[0],[k(x),k($)]}function pu(f,m){for(var b=f.length,q=m.length,O=[],x=[],P=t,L,$,xe,Fe,Me;b;){if(x.unshift(f[--b]),Z(x),Xn(x,m)<0){O.push(0);continue}$=x.length,xe=x[$-1]*P+x[$-2],Fe=m[q-1]*P+m[q-2],$>q&&(xe=(xe+1)*P),L=Math.ceil(xe/Fe);do{if(Me=Gt(m,L),Xn(Me,x)<=0)break;L--}while(L);O.push(L),x=st(x,Me)}return O.reverse(),[k(O),k(x)]}function tl(f,m){var b=f.length,q=Y(b),O=t,x,P,L,$;for(L=0,x=b-1;x>=0;--x)$=L*O+f[x],P=Ae($/m),L=$-P*m,q[x]=P|0;return[q,L|0]}function on(f,m){var b,q=qe(m);if(s)return[new _(f.value/q.value),new _(f.value%q.value)];var O=f.value,x=q.value,P;if(x===0)throw new Error("Cannot divide by zero");if(f.isSmall)return q.isSmall?[new d(Ae(O/x)),new d(O%x)]:[u[0],f];if(q.isSmall){if(x===1)return[f,u[0]];if(x==-1)return[f.negate(),u[0]];var L=Math.abs(x);if(L<t){b=tl(O,L),P=k(b[0]);var $=b[1];return f.sign&&($=-$),typeof P=="number"?(f.sign!==q.sign&&(P=-P),[new d(P),new d($)]):[new c(P,f.sign!==q.sign),new d($)]}x=T(L)}var xe=Xn(O,x);if(xe===-1)return[u[0],f];if(xe===0)return[u[f.sign===q.sign?1:-1],u[0]];O.length+x.length<=200?b=xu(O,x):b=pu(O,x),P=b[0];var Fe=f.sign!==q.sign,Me=b[1],nt=f.sign;return typeof P=="number"?(Fe&&(P=-P),P=new d(P)):P=new c(P,Fe),typeof Me=="number"?(nt&&(Me=-Me),Me=new d(Me)):Me=new c(Me,nt),[P,Me]}c.prototype.divmod=function(f){var m=on(this,f);return{quotient:m[0],remainder:m[1]}},_.prototype.divmod=d.prototype.divmod=c.prototype.divmod,c.prototype.divide=function(f){return on(this,f)[0]},_.prototype.over=_.prototype.divide=function(f){return new _(this.value/qe(f).value)},d.prototype.over=d.prototype.divide=c.prototype.over=c.prototype.divide,c.prototype.mod=function(f){return on(this,f)[1]},_.prototype.mod=_.prototype.remainder=function(f){return new _(this.value%qe(f).value)},d.prototype.remainder=d.prototype.mod=c.prototype.remainder=c.prototype.mod,c.prototype.pow=function(f){var m=qe(f),b=this.value,q=m.value,O,x,P;if(q===0)return u[1];if(b===0)return u[0];if(b===1)return u[1];if(b===-1)return m.isEven()?u[1]:u[-1];if(m.sign)return u[0];if(!m.isSmall)throw new Error("The exponent "+m.toString()+" is too large.");if(this.isSmall&&w(O=Math.pow(b,q)))return new d(Ae(O));for(x=this,P=u[1];q&!0&&(P=P.times(x),--q),q!==0;)q/=2,x=x.square();return P},d.prototype.pow=c.prototype.pow,_.prototype.pow=function(f){var m=qe(f),b=this.value,q=m.value,O=BigInt(0),x=BigInt(1),P=BigInt(2);if(q===O)return u[1];if(b===O)return u[0];if(b===x)return u[1];if(b===BigInt(-1))return m.isEven()?u[1]:u[-1];if(m.isNegative())return new _(O);for(var L=this,$=u[1];(q&x)===x&&($=$.times(L),--q),q!==O;)q/=P,L=L.square();return $},c.prototype.modPow=function(f,m){if(f=qe(f),m=qe(m),m.isZero())throw new Error("Cannot take modPow with modulus 0");var b=u[1],q=this.mod(m);for(f.isNegative()&&(f=f.multiply(u[-1]),q=q.modInv(m));f.isPositive();){if(q.isZero())return u[0];f.isOdd()&&(b=b.multiply(q).mod(m)),f=f.divide(2),q=q.square().mod(m)}return b},_.prototype.modPow=d.prototype.modPow=c.prototype.modPow;function Xn(f,m){if(f.length!==m.length)return f.length>m.length?1:-1;for(var b=f.length-1;b>=0;b--)if(f[b]!==m[b])return f[b]>m[b]?1:-1;return 0}c.prototype.compareAbs=function(f){var m=qe(f),b=this.value,q=m.value;return m.isSmall?1:Xn(b,q)},d.prototype.compareAbs=function(f){var m=qe(f),b=Math.abs(this.value),q=m.value;return m.isSmall?(q=Math.abs(q),b===q?0:b>q?1:-1):-1},_.prototype.compareAbs=function(f){var m=this.value,b=qe(f).value;return m=m>=0?m:-m,b=b>=0?b:-b,m===b?0:m>b?1:-1},c.prototype.compare=function(f){if(f===1/0)return-1;if(f===-1/0)return 1;var m=qe(f),b=this.value,q=m.value;return this.sign!==m.sign?m.sign?1:-1:m.isSmall?this.sign?-1:1:Xn(b,q)*(this.sign?-1:1)},c.prototype.compareTo=c.prototype.compare,d.prototype.compare=function(f){if(f===1/0)return-1;if(f===-1/0)return 1;var m=qe(f),b=this.value,q=m.value;return m.isSmall?b==q?0:b>q?1:-1:b<0!==m.sign?b<0?-1:1:b<0?1:-1},d.prototype.compareTo=d.prototype.compare,_.prototype.compare=function(f){if(f===1/0)return-1;if(f===-1/0)return 1;var m=this.value,b=qe(f).value;return m===b?0:m>b?1:-1},_.prototype.compareTo=_.prototype.compare,c.prototype.equals=function(f){return this.compare(f)===0},_.prototype.eq=_.prototype.equals=d.prototype.eq=d.prototype.equals=c.prototype.eq=c.prototype.equals,c.prototype.notEquals=function(f){return this.compare(f)!==0},_.prototype.neq=_.prototype.notEquals=d.prototype.neq=d.prototype.notEquals=c.prototype.neq=c.prototype.notEquals,c.prototype.greater=function(f){return this.compare(f)>0},_.prototype.gt=_.prototype.greater=d.prototype.gt=d.prototype.greater=c.prototype.gt=c.prototype.greater,c.prototype.lesser=function(f){return this.compare(f)<0},_.prototype.lt=_.prototype.lesser=d.prototype.lt=d.prototype.lesser=c.prototype.lt=c.prototype.lesser,c.prototype.greaterOrEquals=function(f){return this.compare(f)>=0},_.prototype.geq=_.prototype.greaterOrEquals=d.prototype.geq=d.prototype.greaterOrEquals=c.prototype.geq=c.prototype.greaterOrEquals,c.prototype.lesserOrEquals=function(f){return this.compare(f)<=0},_.prototype.leq=_.prototype.lesserOrEquals=d.prototype.leq=d.prototype.lesserOrEquals=c.prototype.leq=c.prototype.lesserOrEquals,c.prototype.isEven=function(){return(this.value[0]&1)==0},d.prototype.isEven=function(){return(this.value&1)==0},_.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},c.prototype.isOdd=function(){return(this.value[0]&1)==1},d.prototype.isOdd=function(){return(this.value&1)==1},_.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},c.prototype.isPositive=function(){return!this.sign},d.prototype.isPositive=function(){return this.value>0},_.prototype.isPositive=d.prototype.isPositive,c.prototype.isNegative=function(){return this.sign},d.prototype.isNegative=function(){return this.value<0},_.prototype.isNegative=d.prototype.isNegative,c.prototype.isUnit=function(){return!1},d.prototype.isUnit=function(){return Math.abs(this.value)===1},_.prototype.isUnit=function(){return this.abs().value===BigInt(1)},c.prototype.isZero=function(){return!1},d.prototype.isZero=function(){return this.value===0},_.prototype.isZero=function(){return this.value===BigInt(0)},c.prototype.isDivisibleBy=function(f){var m=qe(f);return m.isZero()?!1:m.isUnit()?!0:m.compareAbs(2)===0?this.isEven():this.mod(m).isZero()},_.prototype.isDivisibleBy=d.prototype.isDivisibleBy=c.prototype.isDivisibleBy;function hu(f){var m=f.abs();if(m.isUnit())return!1;if(m.equals(2)||m.equals(3)||m.equals(5))return!0;if(m.isEven()||m.isDivisibleBy(3)||m.isDivisibleBy(5))return!1;if(m.lesser(49))return!0}function rl(f,m){for(var b=f.prev(),q=b,O=0,x,P,L,$;q.isEven();)q=q.divide(2),O++;e:for(L=0;L<m.length;L++)if(!f.lesser(m[L])&&($=Ft(m[L]).modPow(q,f),!($.isUnit()||$.equals(b)))){for(x=O-1;x!=0;x--){if($=$.square().mod(f),$.isUnit())return!1;if($.equals(b))continue e}return!1}return!0}c.prototype.isPrime=function(f){var m=hu(this);if(m!==e)return m;var b=this.abs(),q=b.bitLength();if(q<=64)return rl(b,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var O=Math.log(2)*q.toJSNumber(),x=Math.ceil(f===!0?2*Math.pow(O,2):O),P=[],L=0;L<x;L++)P.push(Ft(L+2));return rl(b,P)},_.prototype.isPrime=d.prototype.isPrime=c.prototype.isPrime,c.prototype.isProbablePrime=function(f,m){var b=hu(this);if(b!==e)return b;for(var q=this.abs(),O=f===e?5:f,x=[],P=0;P<O;P++)x.push(Ft.randBetween(2,q.minus(2),m));return rl(q,x)},_.prototype.isProbablePrime=d.prototype.isProbablePrime=c.prototype.isProbablePrime,c.prototype.modInv=function(f){for(var m=Ft.zero,b=Ft.one,q=qe(f),O=this.abs(),x,P,L;!O.isZero();)x=q.divide(O),P=m,L=q,m=b,q=O,b=P.subtract(x.multiply(b)),O=L.subtract(x.multiply(O));if(!q.isUnit())throw new Error(this.toString()+" and "+f.toString()+" are not co-prime");return m.compare(0)===-1&&(m=m.add(f)),this.isNegative()?m.negate():m},_.prototype.modInv=d.prototype.modInv=c.prototype.modInv,c.prototype.next=function(){var f=this.value;return this.sign?at(f,1,this.sign):new c(ke(f,1),this.sign)},d.prototype.next=function(){var f=this.value;return f+1<n?new d(f+1):new c(i,!1)},_.prototype.next=function(){return new _(this.value+BigInt(1))},c.prototype.prev=function(){var f=this.value;return this.sign?new c(ke(f,1),!0):at(f,1,this.sign)},d.prototype.prev=function(){var f=this.value;return f-1>-n?new d(f-1):new c(i,!0)},_.prototype.prev=function(){return new _(this.value-BigInt(1))};for(var sn=[1];2*sn[sn.length-1]<=t;)sn.push(2*sn[sn.length-1]);var fo=sn.length,Hn=sn[fo-1];function Au(f){return Math.abs(f)<=t}c.prototype.shiftLeft=function(f){var m=qe(f).toJSNumber();if(!Au(m))throw new Error(String(m)+" is too large for shifting.");if(m<0)return this.shiftRight(-m);var b=this;if(b.isZero())return b;for(;m>=fo;)b=b.multiply(Hn),m-=fo-1;return b.multiply(sn[m])},_.prototype.shiftLeft=d.prototype.shiftLeft=c.prototype.shiftLeft,c.prototype.shiftRight=function(f){var m,b=qe(f).toJSNumber();if(!Au(b))throw new Error(String(b)+" is too large for shifting.");if(b<0)return this.shiftLeft(-b);for(var q=this;b>=fo;){if(q.isZero()||q.isNegative()&&q.isUnit())return q;m=on(q,Hn),q=m[1].isNegative()?m[0].prev():m[0],b-=fo-1}return m=on(q,sn[b]),m[1].isNegative()?m[0].prev():m[0]},_.prototype.shiftRight=d.prototype.shiftRight=c.prototype.shiftRight;function nl(f,m,b){m=qe(m);for(var q=f.isNegative(),O=m.isNegative(),x=q?f.not():f,P=O?m.not():m,L=0,$=0,xe=null,Fe=null,Me=[];!x.isZero()||!P.isZero();)xe=on(x,Hn),L=xe[1].toJSNumber(),q&&(L=Hn-1-L),Fe=on(P,Hn),$=Fe[1].toJSNumber(),O&&($=Hn-1-$),x=xe[0],P=Fe[0],Me.push(b(L,$));for(var nt=b(q?1:0,O?1:0)!==0?Ft(-1):Ft(0),Lr=Me.length-1;Lr>=0;Lr-=1)nt=nt.multiply(Hn).add(Ft(Me[Lr]));return nt}c.prototype.not=function(){return this.negate().prev()},_.prototype.not=d.prototype.not=c.prototype.not,c.prototype.and=function(f){return nl(this,f,function(m,b){return m&b})},_.prototype.and=d.prototype.and=c.prototype.and,c.prototype.or=function(f){return nl(this,f,function(m,b){return m|b})},_.prototype.or=d.prototype.or=c.prototype.or,c.prototype.xor=function(f){return nl(this,f,function(m,b){return m^b})},_.prototype.xor=d.prototype.xor=c.prototype.xor;var il=1<<30,Sd=(t&-t)*(t&-t)|il;function is(f){var m=f.value,b=typeof m=="number"?m|il:typeof m=="bigint"?m|BigInt(il):m[0]+m[1]*t|Sd;return b&-b}function Ou(f,m){if(m.compareTo(f)<=0){var b=Ou(f,m.square(m)),q=b.p,O=b.e,x=q.multiply(m);return x.compareTo(f)<=0?{p:x,e:O*2+1}:{p:q,e:O*2}}return{p:Ft(1),e:0}}c.prototype.bitLength=function(){var f=this;return f.compareTo(Ft(0))<0&&(f=f.negate().subtract(Ft(1))),f.compareTo(Ft(0))===0?Ft(0):Ft(Ou(f,Ft(2)).e).add(Ft(1))},_.prototype.bitLength=d.prototype.bitLength=c.prototype.bitLength;function ol(f,m){return f=qe(f),m=qe(m),f.greater(m)?f:m}function os(f,m){return f=qe(f),m=qe(m),f.lesser(m)?f:m}function zb(f,m){if(f=qe(f).abs(),m=qe(m).abs(),f.equals(m))return f;if(f.isZero())return m;if(m.isZero())return f;for(var b=u[1],q,O;f.isEven()&&m.isEven();)q=os(is(f),is(m)),f=f.divide(q),m=m.divide(q),b=b.multiply(q);for(;f.isEven();)f=f.divide(is(f));do{for(;m.isEven();)m=m.divide(is(m));f.greater(m)&&(O=m,m=f,f=O),m=m.subtract(f)}while(!m.isZero());return b.isUnit()?f:f.multiply(b)}function Yx(f,m){return f=qe(f).abs(),m=qe(m).abs(),f.divide(zb(f,m)).multiply(m)}function Vx(f,m,b){f=qe(f),m=qe(m);var q=b||Math.random,O=os(f,m),x=ol(f,m),P=x.subtract(O).add(1);if(P.isSmall)return O.add(Math.floor(q()*P));for(var L=sl(P,t).value,$=[],xe=!0,Fe=0;Fe<L.length;Fe++){var Me=xe?L[Fe]+(Fe+1<L.length?L[Fe+1]/t:0):t,nt=Ae(q()*Me);$.push(nt),nt<L[Fe]&&(xe=!1)}return O.add(u.fromArray($,t,!1))}var Zx=function(f,m,b,q){b=b||o,f=String(f),q||(f=f.toLowerCase(),b=b.toLowerCase());var O=f.length,x,P=Math.abs(m),L={};for(x=0;x<b.length;x++)L[b[x]]=x;for(x=0;x<O;x++){var $=f[x];if($!=="-"&&$ in L&&L[$]>=P){if($==="1"&&P===1)continue;throw new Error($+" is not a valid digit in base "+m+".")}}m=qe(m);var xe=[],Fe=f[0]==="-";for(x=Fe?1:0;x<f.length;x++){var $=f[x];if($ in L)xe.push(qe(L[$]));else if($==="<"){var Me=x;do x++;while(f[x]!==">"&&x<f.length);xe.push(qe(f.slice(Me+1,x)))}else throw new Error($+" is not a valid character")}return Yb(xe,m,Fe)};function Yb(f,m,b){var q=u[0],O=u[1],x;for(x=f.length-1;x>=0;x--)q=q.add(f[x].times(O)),O=O.times(m);return b?q.negate():q}function Xx(f,m){return m=m||o,f<m.length?m[f]:"<"+f+">"}function sl(f,m){if(m=Ft(m),m.isZero()){if(f.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(m.equals(-1)){if(f.isZero())return{value:[0],isNegative:!1};if(f.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-f.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var b=Array.apply(null,Array(f.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return b.unshift([1]),{value:[].concat.apply([],b),isNegative:!1}}var q=!1;if(f.isNegative()&&m.isPositive()&&(q=!0,f=f.abs()),m.isUnit())return f.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(f.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:q};for(var O=[],x=f,P;x.isNegative()||x.compareAbs(m)>=0;){P=x.divmod(m),x=P.quotient;var L=P.remainder;L.isNegative()&&(L=m.minus(L).abs(),x=x.next()),O.push(L.toJSNumber())}return O.push(x.toJSNumber()),{value:O.reverse(),isNegative:q}}function Vb(f,m,b){var q=sl(f,m);return(q.isNegative?"-":"")+q.value.map(function(O){return Xx(O,b)}).join("")}c.prototype.toArray=function(f){return sl(this,f)},d.prototype.toArray=function(f){return sl(this,f)},_.prototype.toArray=function(f){return sl(this,f)},c.prototype.toString=function(f,m){if(f===e&&(f=10),f!==10)return Vb(this,f,m);for(var b=this.value,q=b.length,O=String(b[--q]),x="0000000",P;--q>=0;)P=String(b[q]),O+=x.slice(P.length)+P;var L=this.sign?"-":"";return L+O},d.prototype.toString=function(f,m){return f===e&&(f=10),f!=10?Vb(this,f,m):String(this.value)},_.prototype.toString=d.prototype.toString,_.prototype.toJSON=c.prototype.toJSON=d.prototype.toJSON=function(){return this.toString()},c.prototype.valueOf=function(){return parseInt(this.toString(),10)},c.prototype.toJSNumber=c.prototype.valueOf,d.prototype.valueOf=function(){return this.value},d.prototype.toJSNumber=d.prototype.valueOf,_.prototype.valueOf=_.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};function Zb(f){if(w(+f)){var m=+f;if(m===Ae(m))return s?new _(BigInt(m)):new d(m);throw new Error("Invalid integer: "+f)}var b=f[0]==="-";b&&(f=f.slice(1));var q=f.split(/e/i);if(q.length>2)throw new Error("Invalid integer: "+q.join("e"));if(q.length===2){var O=q[1];if(O[0]==="+"&&(O=O.slice(1)),O=+O,O!==Ae(O)||!w(O))throw new Error("Invalid integer: "+O+" is not a valid exponent.");var x=q[0],P=x.indexOf(".");if(P>=0&&(O-=x.length-P-1,x=x.slice(0,P)+x.slice(P+1)),O<0)throw new Error("Cannot include negative exponent part for integers");x+=new Array(O+1).join("0"),f=x}var L=/^([0-9][0-9]*)$/.test(f);if(!L)throw new Error("Invalid integer: "+f);if(s)return new _(BigInt(b?"-"+f:f));for(var $=[],xe=f.length,Fe=r,Me=xe-Fe;xe>0;)$.push(+f.slice(Me,xe)),Me-=Fe,Me<0&&(Me=0),xe-=Fe;return Z($),new c($,b)}function Hx(f){if(s)return new _(BigInt(f));if(w(f)){if(f!==Ae(f))throw new Error(f+" is not an integer.");return new d(f)}return Zb(f.toString())}function qe(f){return typeof f=="number"?Hx(f):typeof f=="string"?Zb(f):typeof f=="bigint"?new _(f):f}for(var mo=0;mo<1e3;mo++)u[mo]=qe(mo),mo>0&&(u[-mo]=qe(-mo));return u.one=u[1],u.zero=u[0],u.minusOne=u[-1],u.max=ol,u.min=os,u.gcd=zb,u.lcm=Yx,u.isInstance=function(f){return f instanceof c||f instanceof d||f instanceof _},u.randBetween=Vx,u.fromArray=function(f,m,b){return Yb(f.map(qe),qe(m||10),b)},u}();typeof Mu!="undefined"&&Mu.hasOwnProperty("exports")&&(Mu.exports=Ft);typeof define=="function"&&define.amd&&define(function(){return Ft})});var Tu=A(ss=>{"use strict";var i0=ss&&ss.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ss,"__esModule",{value:!0});ss.mcmp=void 0;var QU=i0(Ti());function o0(e,t){return e.compare(t)}ss.mcmp=o0});var or=A(Ni=>{"use strict";Object.defineProperty(Ni,"__esModule",{value:!0});Ni.findPossibleExponentialForm=Ni.findPossibleClockForm=Ni.Find=void 0;var Nu=Q(),s0=Ie(),Ht=N(),a0=U();function al(e,t){if(s0.equal(e,t))return!0;if(Ht.istensor(e)){for(let r=0;r<e.tensor.nelem;r++)if(al(e.tensor.elem[r],t))return!0;return!1}return Ht.iscons(e)?[...e].some(r=>al(r,t)):!1}Ni.Find=al;function Cd(e,t){if(Nu.isimaginaryunit(e))return!1;if(Ht.ispower(e)&&!Nu.isinteger(Ht.caddr(t))&&al(Ht.cadr(e),Ht.Constants.imaginaryunit)||Ht.ispower(e)&&Nu.equaln(Ht.cadr(e),-1)&&!Nu.isinteger(Ht.caddr(t)))return!0;if(Ht.istensor(e)){for(let r=0;r<e.tensor.nelem;r++)if(Cd(e.tensor.elem[r],t))return!0;return!1}return Ht.iscons(e)?[...e].some(r=>Cd(r,t)):!1}Ni.findPossibleClockForm=Cd;function Pd(e){if(Ht.ispower(e)&&Ht.cadr(e)===a0.symbol(Ht.E))return al(Ht.caddr(e),Ht.Constants.imaginaryunit);if(Ht.istensor(e)){for(let t=0;t<e.tensor.nelem;t++)if(Pd(e.tensor.elem[t]))return!0;return!1}return Ht.iscons(e)?[...e].some(Pd):!1}Ni.findPossibleExponentialForm=Pd});var Qb=A(as=>{"use strict";Object.defineProperty(as,"__esModule",{value:!0});as.set_component=as.index_function=void 0;var Xb=St(),Dd=N(),pn=Ee(),Hb=j(),_o=Et();function l0(e,t){let{ndim:r}=e.tensor,n=t.length;n>r&&pn.stop("too many indices for tensor");let i=0;for(let u=0;u<n;u++){let c=Hb.nativeInt(t[u]);(c<1||c>e.tensor.dim[u])&&pn.stop("index out of range"),i=i*e.tensor.dim[u]+c-1}if(r===n)return e.tensor.elem[i];i=e.tensor.dim.slice(n).reduce((u,c)=>u*c,i);let o=e.tensor.dim.slice(n).reduce((u,c)=>u*c,1),s=Xb.alloc_tensor(o);s.tensor.ndim=r-n,s.tensor.dim=e.tensor.dim.slice(n);for(let u=0;u<o;u++)s.tensor.elem[u]=e.tensor.elem[i+u];return _o.check_tensor_dimensions(e),_o.check_tensor_dimensions(s),s}as.index_function=l0;function u0(e,...t){t.length<2&&pn.stop("error in indexed assign");let[r,...n]=t;Dd.istensor(r)||pn.stop("error in indexed assign: assigning to something that is not a tensor");let{ndim:i}=r.tensor,o=n.length;o>i&&pn.stop("error in indexed assign");let s=0;for(let c=0;c<o;c++){let d=Hb.nativeInt(n[c]);(d<1||d>r.tensor.dim[c])&&pn.stop(`error in indexed assign
`),s=s*r.tensor.dim[c]+d-1}for(let c=o;c<i;c++)s=s*r.tensor.dim[c]+0;let u=Xb.alloc_tensor(r.tensor.nelem);if(u.tensor.ndim=r.tensor.ndim,u.tensor.dim=Array.from(r.tensor.dim),u.tensor.elem=Array.from(r.tensor.elem),_o.check_tensor_dimensions(r),_o.check_tensor_dimensions(u),r=u,i===o)return Dd.istensor(e)&&pn.stop("error in indexed assign"),r.tensor.elem[s]=e,_o.check_tensor_dimensions(r),r;Dd.istensor(e)||pn.stop("error in indexed assign"),i-o!==e.tensor.ndim&&pn.stop("error in indexed assign");for(let c=0;c<e.tensor.ndim;c++)r.tensor.dim[o+c]!==e.tensor.dim[c]&&pn.stop("error in indexed assign");for(let c=0;c<e.tensor.nelem;c++)r.tensor.elem[s+c]=e.tensor.elem[c];return _o.check_tensor_dimensions(r),_o.check_tensor_dimensions(e),r}as.set_component=u0});var ee=A(Iu=>{"use strict";Object.defineProperty(Iu,"__esModule",{value:!0});Iu.makeList=void 0;var Wb=N(),c0=U();function f0(...e){let t=c0.symbol(Wb.NIL);for(let r=e.length-1;r>=0;r--)t=new Wb.Cons(e[r],t);return t}Iu.makeList=f0});var kd=A(ls=>{"use strict";Object.defineProperty(ls,"__esModule",{value:!0});ls.Eval_function_reference=ls.define_user_function=void 0;var Qn=N(),d0=Ee(),Su=U(),m0=G(),_0=ee();function b0(e){let t=Qn.caadr(e),r=Qn.cdadr(e),n=Qn.caddr(e);return Qn.issymbol(t)||d0.stop("function name?"),Qn.car(n)===Su.symbol(Qn.EVAL)&&(n=m0.Eval(Qn.cadr(n))),n=_0.makeList(Su.symbol(Qn.FUNCTION),n,r),Su.set_binding(t,n),Su.symbol(Qn.NIL)}ls.define_user_function=b0;function g0(e){return e}ls.Eval_function_reference=g0});var Ud=A(us=>{"use strict";Object.defineProperty(us,"__esModule",{value:!0});us.lcm=us.Eval_lcm=void 0;var wu=N(),Jb=G(),y0=bo(),$d=X();function v0(e){e=wu.cdr(e);let t=Jb.Eval(wu.car(e));return wu.iscons(e)&&(t=e.tail().reduce((r,n)=>Kb(r,Jb.Eval(n)),t)),t}us.Eval_lcm=v0;function Kb(e,t){return wu.doexpand(q0,e,t)}us.lcm=Kb;function q0(e,t){return $d.inverse($d.divide($d.divide(y0.gcd(e,t),e),t))}});var ll=A(cs=>{"use strict";Object.defineProperty(cs,"__esModule",{value:!0});cs.filter=cs.Eval_filter=void 0;var E0=St(),Wn=N(),x0=or(),p0=ce(),eg=G();function h0(e){e=Wn.cdr(e);let t=eg.Eval(Wn.car(e));return Wn.iscons(e)&&(t=e.tail().reduce((r,n)=>Ru(r,eg.Eval(n)),t)),t}cs.Eval_filter=h0;function Ru(e,t){return A0(e,t)}cs.filter=Ru;function A0(e,t){return Wn.isadd(e)?O0(e,t):Wn.istensor(e)?M0(e,t):x0.Find(e,t)?Wn.Constants.zero:e}function O0(e,t){return Wn.iscons(e)?e.tail().reduce((r,n)=>p0.add(r,Ru(n,t)),Wn.Constants.zero):Wn.Constants.zero}function M0(e,t){let r=e.tensor.nelem,n=E0.alloc_tensor(r);return n.tensor.ndim=e.tensor.ndim,n.tensor.dim=Array.from(e.tensor.dim),n.tensor.elem=e.tensor.elem.map(i=>Ru(i,t)),n}});var Zr=A(Cu=>{"use strict";Object.defineProperty(Cu,"__esModule",{value:!0});Cu.subst=void 0;var T0=St(),go=N(),N0=Ie(),I0=Et(),tg=U();function Lu(e,t,r){if(t===tg.symbol(go.NIL)||r===tg.symbol(go.NIL))return e;if(go.istensor(e)){let n=T0.alloc_tensor(e.tensor.nelem);return n.tensor.ndim=e.tensor.ndim,n.tensor.dim=Array.from(e.tensor.dim),n.tensor.elem=e.tensor.elem.map(i=>{let o=Lu(i,t,r);return I0.check_tensor_dimensions(n),o}),n}return N0.equal(e,t)?r:go.iscons(e)?new go.Cons(Lu(go.car(e),t,r),Lu(go.cdr(e),t,r)):e}Cu.subst=Lu});var yo=A(fs=>{"use strict";Object.defineProperty(fs,"__esModule",{value:!0});fs.coeff=fs.Eval_coeff=void 0;var Ii=N(),rg=U(),S0=Ie(),w0=ce(),Pu=G(),R0=ll(),ng=X(),L0=xt(),C0=Zr();function P0(e){let t=Pu.Eval(Ii.cadddr(e)),r=Pu.Eval(Ii.caddr(e)),n=Pu.Eval(Ii.cadr(e));return t===rg.symbol(Ii.NIL)&&(t=r,r=rg.symbol(Ii.SYMBOL_X)),R0.filter(ng.divide(n,L0.power(r,t)),r)}fs.Eval_coeff=P0;function D0(e,t){let r=[];for(;;){let n=Pu.Eval(C0.subst(e,t,Ii.Constants.zero));if(r.push(n),e=w0.subtract(e,n),S0.equal(e,Ii.Constants.zero))return r;e=Ii.doexpand(ng.divide,e,t)}}fs.coeff=D0});var Du=A(ds=>{"use strict";Object.defineProperty(ds,"__esModule",{value:!0});ds.clockform=ds.Eval_clock=void 0;var ul=N(),k0=U(),ig=an(),Bd=ms(),$0=G(),U0=ee(),Gd=X(),B0=!1;function G0(e){return og($0.Eval(ul.cadr(e)))}ds.Eval_clock=G0;function og(e){let t=U0.makeList(k0.symbol(ul.POWER),ul.Constants.negOne,Gd.divide(Bd.arg(e),ul.Constants.Pi())),r=Gd.multiply(ig.abs(e),t);return B0&&(console.log(`clockform: abs of ${e} : ${ig.abs(e)}`),console.log(`clockform: arg of ${e} : ${Bd.arg(e)}`),console.log(`clockform: divide : ${Gd.divide(Bd.arg(e),ul.Constants.Pi())}`),console.log(`clockform: power : ${t}`),console.log(`clockform: multiply : ${r}`)),r}ds.clockform=og});var ku=A(_s=>{"use strict";Object.defineProperty(_s,"__esModule",{value:!0});_s.polar=_s.Eval_polar=void 0;var Fd=N(),F0=Ie(),j0=an(),z0=ms(),Y0=G(),sg=X();function V0(e){return ag(Y0.Eval(Fd.cadr(e)))}_s.Eval_polar=V0;function ag(e){return Fd.evalPolar(()=>sg.multiply(j0.abs(e),F0.exponential(sg.multiply(Fd.Constants.imaginaryunit,z0.arg(e)))))}_s.polar=ag});var vo=A(bs=>{"use strict";Object.defineProperty(bs,"__esModule",{value:!0});bs.conjugate=bs.Eval_conj=void 0;var $u=N(),Z0=or(),X0=Du(),lg=G(),H0=X(),Q0=ku(),W0=Zr();function J0(e){return e=lg.Eval($u.cadr(e)),Z0.Find(e,$u.Constants.imaginaryunit)?jd(e):X0.clockform(jd(Q0.polar(e)))}bs.Eval_conj=J0;function jd(e){return lg.Eval(W0.subst(e,$u.Constants.imaginaryunit,H0.negate($u.Constants.imaginaryunit)))}bs.conjugate=jd});var Xr=A(Uu=>{"use strict";Object.defineProperty(Uu,"__esModule",{value:!0});Uu.guess=void 0;var ln=N(),cl=or(),un=U();function K0(e){return cl.Find(e,un.symbol(ln.SYMBOL_X))?un.symbol(ln.SYMBOL_X):cl.Find(e,un.symbol(ln.SYMBOL_Y))?un.symbol(ln.SYMBOL_Y):cl.Find(e,un.symbol(ln.SYMBOL_Z))?un.symbol(ln.SYMBOL_Z):cl.Find(e,un.symbol(ln.SYMBOL_T))?un.symbol(ln.SYMBOL_T):cl.Find(e,un.symbol(ln.SYMBOL_S))?un.symbol(ln.SYMBOL_S):un.symbol(ln.SYMBOL_X)}Uu.guess=K0});var zd=A(gs=>{"use strict";Object.defineProperty(gs,"__esModule",{value:!0});gs.msub=gs.madd=void 0;function ep(e,t){return e.add(t)}gs.madd=ep;function tp(e,t){return e.subtract(t)}gs.msub=tp});var vs=A(ys=>{"use strict";var rp=ys&&ys.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ys,"__esModule",{value:!0});ys.mgcd=void 0;var np=rp(Ti());function ip(e,t){return np.default.gcd(e,t)}ys.mgcd=ip});var cn=A(hn=>{"use strict";Object.defineProperty(hn,"__esModule",{value:!0});hn.mdivrem=hn.mmod=hn.mdiv=hn.mmul=void 0;function op(e,t){return e.multiply(t)}hn.mmul=op;function sp(e,t){return e.divide(t)}hn.mdiv=sp;function ap(e,t){return e.mod(t)}hn.mmod=ap;function lp(e,t){let r=e.divmod(t);return[r.quotient,r.remainder]}hn.mdivrem=lp});var Yd=A(Bu=>{"use strict";Object.defineProperty(Bu,"__esModule",{value:!0});Bu.mprime=void 0;function up(e){return e.isProbablePrime()}Bu.mprime=up});var mg=A(Es=>{"use strict";var cp=Es&&Es.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Es,"__esModule",{value:!0});Es.factor_number=void 0;var fp=cp(Ti()),Si=N(),ug=Tu(),dp=Ee(),cg=U(),wi=j(),Vd=Q(),fg=ee(),dg=zd(),mp=vs(),qs=cn(),_p=Yd(),jt=fp.default(0);function bp(e){if(Vd.equaln(e,0)||Vd.equaln(e,1)||Vd.equaln(e,-1))return e;jt=e.q.a;let t=gp();return t.length==1?t[0]:fg.makeList(cg.symbol(Si.MULTIPLY),...t)}Es.factor_number=bp;function gp(){let e=[];jt.isNegative()&&(jt=wi.setSignTo(jt,1),e.push(Si.Constants.negOne));for(let t=0;t<1e4;t++)if(e.push(...yp(t)),jt.compare(1)===0)return e;return e.push(...vp()),e}function yp(e){let t=[],r,n=wi.mint(Si.primetab[e]),i=0;for(;;){if(jt.compare(1)===0)return i&&t.push(fl(n,i)),t;let o;if([r,o]=Array.from(qs.mdivrem(jt,n)),o.isZero())i++,jt=r;else break}return i&&t.push(fl(n,i)),ug.mcmp(r,n)===-1&&(t.push(fl(jt,1)),jt=wi.mint(1)),t}function vp(){let e=[],t=wi.mint(1),r=wi.mint(5),n=wi.mint(2),i=1,o=1;for(;;){if(_p.mprime(jt))return e.push(fl(jt,1)),e;for(;;){Si.defs.esc_flag&&dp.stop("esc");let s=dg.msub(n,r);s=wi.setSignTo(s,1);let u=mp.mgcd(s,jt);if(Si.MEQUAL(u,1)){--i==0&&(n=r,o*=2,i=o),s=qs.mmul(r,r),r=dg.madd(s,t),s=qs.mmod(r,jt),r=s;continue}if(e.push(fl(u,1)),ug.mcmp(u,jt)===0)return e;s=qs.mdiv(jt,u),jt=s,s=qs.mmod(r,jt),r=s,s=qs.mmod(n,jt),n=s;break}}}function fl(e,t){let r=new Si.Num(e);return t>1&&(r=fg.makeList(cg.symbol(Si.POWER),r,new Si.Num(wi.mint(t)))),r}});var dl=A(Ri=>{"use strict";Object.defineProperty(Ri,"__esModule",{value:!0});Ri.factor_small_number=Ri.factor=Ri.Eval_factor=void 0;var An=N(),qp=Ee(),Ep=U(),Zd=j(),Xd=G(),_g=xs(),xp=Xr(),pp=Q(),hp=X(),Ap=mg();function Op(e){let t=Xd.Eval(An.cadr(e)),r=Xd.Eval(An.caddr(e)),n=r===Ep.symbol(An.NIL)?xp.guess(t):r,i=gg(t,n);return e=An.cdddr(e),An.iscons(e)&&(i=[...e].reduce((o,s)=>Mp(o,Xd.Eval(s)),i)),i}Ri.Eval_factor=Op;function Mp(e,t){if(An.ismultiply(e)){let n=[];return e.tail().forEach(i=>bg(n,i,t)),hp.multiply_all_noexpand(n)}let r=[];return bg(r,e,t),r[0]}function bg(e,t,r){let n=_g.factorpoly(t,r);if(An.ismultiply(n)){e.push(...n.tail());return}e.push(n)}function gg(e,t){return pp.isinteger(e)?Ap.factor_number(e):_g.factorpoly(e,t)}Ri.factor=gg;function Tp(e){isNaN(e)&&qp.stop("number too big to factor");let t=[];e<0&&(e=-e);for(let r=0;r<An.MAXPRIMETAB;r++){let n=An.primetab[r];if(n>e/n)break;let i=0;for(;e%n==0;)e/=n,i++;i&&(t.push(Zd.integer(n)),t.push(Zd.integer(i)))}return e>1&&(t.push(Zd.integer(e)),t.push(An.Constants.one)),t}Ri.factor_small_number=Tp});var Qd=A(hs=>{"use strict";Object.defineProperty(hs,"__esModule",{value:!0});hs.ydivisors=hs.divisors=void 0;var Np=bo(),Ip=St(),$e=N(),yg=Ie(),Sp=ce(),ps=j(),Gu=dl(),wp=Q(),Hd=X(),Rp=xt();function Lp(e){let t=vg(e),r=t.length;t.sort(yg.cmp_expr);let n=Ip.alloc_tensor(r);return n.tensor.ndim=1,n.tensor.dim[0]=r,n.tensor.elem=t,n}hs.divisors=Lp;var Cp=e=>[].concat(...e);function vg(e){let t=[];if($e.isNumericAtom(e))t.push(...Gu.factor_small_number(ps.nativeInt(e)));else if($e.isadd(e))t.push(...Pp(e));else if($e.ismultiply(e)){if(e=$e.cdr(e),$e.isNumericAtom($e.car(e))&&(t.push(...Gu.factor_small_number(ps.nativeInt($e.car(e)))),e=$e.cdr(e)),$e.iscons(e)){let n=[...e].map(i=>$e.ispower(i)?[$e.cadr(i),$e.caddr(i)]:[i,$e.Constants.one]);t.push(...Cp(n))}}else $e.ispower(e)?t.push($e.cadr(e),$e.caddr(e)):t.push(e,$e.Constants.one);let r=t.length;return t.push($e.Constants.one),qg(t,0,r),t.slice(r)}hs.ydivisors=vg;function qg(e,t,r){let n=e.pop();if(t===r){e.push(n);return}let i=e[t+0],o=e[t+1],s=ps.nativeInt(o);if(!isNaN(s))for(let u=0;u<=Math.abs(s);u++)e.push(Hd.multiply(n,Rp.power(i,ps.integer(yg.sign(s)*u)))),qg(e,t+2,r)}function Pp(e){let t=$e.iscons(e)?e.tail().reduce(Np.gcd):$e.car(e),r=[],n=t;if(wp.isplusone(n))return r.push(e,$e.Constants.one),r;if($e.isNumericAtom(n))r.push(...Gu.factor_small_number(ps.nativeInt(n)));else if($e.ismultiply(n)){let o=$e.cdr(n);$e.isNumericAtom($e.car(o))?r.push(...Gu.factor_small_number(ps.nativeInt($e.car(o)))):r.push($e.car(o),$e.Constants.one),$e.iscons(o)&&o.tail().forEach(s=>r.push(s,$e.Constants.one))}else r.push(n,$e.Constants.one);n=Hd.inverse(n);let i=$e.iscons(e)?e.tail().reduce((o,s)=>Sp.add(o,Hd.multiply(n,s)),$e.Constants.zero):$e.cdr(e);return r.push(i,$e.Constants.one),r}});var Fu=A(Os=>{"use strict";Object.defineProperty(Os,"__esModule",{value:!0});Os.divpoly=Os.Eval_quotient=void 0;var As=N(),Eg=U(),xg=ce(),Dp=j(),pg=yo(),Wd=G(),Jd=X(),kp=xt();function $p(e){let t=Wd.Eval(As.cadr(e)),r=Wd.Eval(As.caddr(e)),n=Wd.Eval(As.cadddr(e));return n===Eg.symbol(As.NIL)&&(n=Eg.symbol(As.SYMBOL_X)),hg(t,r,n)}Os.Eval_quotient=$p;function hg(e,t,r){let n=pg.coeff(e,r),i=n.length-1,o=pg.coeff(t,r),s=o.length-1,u=i-s,c=As.Constants.zero;for(;u>=0;){let d=Jd.divide(n[i],o[s]);for(let _=0;_<=s;_++)n[u+_]=xg.subtract(n[u+_],Jd.multiply(o[_],d));c=xg.add(c,Jd.multiply(d,kp.power(r,Dp.integer(u)))),i--,u--}return c}Os.divpoly=hg});var Jn=A(Ts=>{"use strict";Object.defineProperty(Ts,"__esModule",{value:!0});Ts.sine=Ts.Eval_sin=void 0;var Pt=N(),ju=U(),Kd=ce(),zt=j(),Ag=Li(),Up=G(),Og=Q(),Mg=ee(),fn=X(),Ms=xt();function Bp(e){return ml(Up.Eval(Pt.cadr(e)))}Ts.Eval_sin=Bp;function ml(e){return Pt.isadd(e)?Gp(e):Tg(e)}Ts.sine=ml;function Gp(e){let t=Pt.cdr(e);for(;Pt.iscons(t);){let r=Pt.car(t);if(Og.isnpi(r)){let n=Kd.subtract(e,r);return Kd.add(fn.multiply(ml(n),Ag.cosine(r)),fn.multiply(Ag.cosine(n),ml(r)))}t=Pt.cdr(t)}return Tg(e)}function Tg(e){if(Pt.car(e)===ju.symbol(Pt.ARCSIN))return Pt.cadr(e);if(Pt.isdouble(e)){let r=Math.sin(e.d);return Math.abs(r)<1e-10&&(r=0),zt.double(r)}if(Og.isnegative(e))return fn.negate(ml(fn.negate(e)));if(Pt.car(e)===ju.symbol(Pt.ARCTAN))return fn.multiply(Pt.cadr(e),Ms.power(Kd.add(Pt.Constants.one,Ms.power(Pt.cadr(e),zt.integer(2))),zt.rational(-1,2)));let t=zt.nativeInt(fn.divide(fn.multiply(e,zt.integer(180)),Pt.Constants.Pi()));if(t<0||isNaN(t))return Mg.makeList(ju.symbol(Pt.SIN),e);switch(t%360){case 0:case 180:return Pt.Constants.zero;case 30:case 150:return zt.rational(1,2);case 210:case 330:return zt.rational(-1,2);case 45:case 135:return fn.multiply(zt.rational(1,2),Ms.power(zt.integer(2),zt.rational(1,2)));case 225:case 315:return fn.multiply(zt.rational(-1,2),Ms.power(zt.integer(2),zt.rational(1,2)));case 60:case 120:return fn.multiply(zt.rational(1,2),Ms.power(zt.integer(3),zt.rational(1,2)));case 240:case 300:return fn.multiply(zt.rational(-1,2),Ms.power(zt.integer(3),zt.rational(1,2)));case 90:return Pt.Constants.one;case 270:return Pt.Constants.negOne;default:return Mg.makeList(ju.symbol(Pt.SIN),e)}}});var Li=A(Is=>{"use strict";Object.defineProperty(Is,"__esModule",{value:!0});Is.cosine=Is.Eval_cos=void 0;var sr=N(),zu=U(),em=ce(),Yt=j(),Fp=G(),Ng=Q(),Ig=ee(),Kn=X(),Ns=xt(),Sg=Jn();function jp(e){return Yu(Fp.Eval(sr.cadr(e)))}Is.Eval_cos=jp;function Yu(e){return sr.isadd(e)?zp(e):wg(e)}Is.cosine=Yu;function zp(e){if(sr.iscons(e)){for(let t of e.tail())if(Ng.isnpi(t)){let r=em.subtract(e,t);return em.subtract(Kn.multiply(Yu(r),Yu(t)),Kn.multiply(Sg.sine(r),Sg.sine(t)))}}return wg(e)}function wg(e){if(sr.car(e)===zu.symbol(sr.ARCCOS))return sr.cadr(e);if(sr.isdouble(e)){let r=Math.cos(e.d);return Math.abs(r)<1e-10&&(r=0),Yt.double(r)}if(Ng.isnegative(e)&&(e=Kn.negate(e)),sr.car(e)===zu.symbol(sr.ARCTAN)){let r=em.add(sr.Constants.one,Ns.power(sr.cadr(e),Yt.integer(2)));return Ns.power(r,Yt.rational(-1,2))}let t=Yt.nativeInt(Kn.divide(Kn.multiply(e,Yt.integer(180)),sr.Constants.Pi()));if(t<0||isNaN(t))return Ig.makeList(zu.symbol(sr.COS),e);switch(t%360){case 90:case 270:return sr.Constants.zero;case 60:case 300:return Yt.rational(1,2);case 120:case 240:return Yt.rational(-1,2);case 45:case 315:return Kn.multiply(Yt.rational(1,2),Ns.power(Yt.integer(2),Yt.rational(1,2)));case 135:case 225:return Kn.multiply(Yt.rational(-1,2),Ns.power(Yt.integer(2),Yt.rational(1,2)));case 30:case 330:return Kn.multiply(Yt.rational(1,2),Ns.power(Yt.integer(3),Yt.rational(1,2)));case 150:case 210:return Kn.multiply(Yt.rational(-1,2),Ns.power(Yt.integer(3),Yt.rational(1,2)));case 0:return sr.Constants.one;case 180:return sr.Constants.negOne;default:return Ig.makeList(zu.symbol(sr.COS),e)}}});var ti=A(ws=>{"use strict";Object.defineProperty(ws,"__esModule",{value:!0});ws.rect=ws.Eval_rect=void 0;var _r=N(),Ss=or(),ei=U(),Rg=an(),tm=ce(),qo=ms(),rm=Li(),Yp=G(),Vu=Q(),Vp=ee(),Zu=X(),Xu=Jn(),_l=!1;function Zp(e){return nm(Yp.Eval(_r.cadr(e)))}ws.Eval_rect=Zp;function nm(e){let t=e;if(_l&&(console.log(`RECT of ${t}`),console.log(`any clock forms in : ${t} ? ${Ss.findPossibleClockForm(t,e)}`)),_r.issymbol(e))return _l&&console.log(` rect: simple symbol: ${t}`),Vu.isZeroAtomOrTensor(ei.get_binding(ei.symbol(_r.ASSUME_REAL_VARIABLES)))?Vp.makeList(ei.symbol(_r.YYRECT),e):e;if(!Vu.isZeroAtomOrTensor(ei.get_binding(ei.symbol(_r.ASSUME_REAL_VARIABLES)))&&!Ss.findPossibleExponentialForm(e)&&!Ss.findPossibleClockForm(e,e)&&!(Ss.Find(e,ei.symbol(_r.SIN))&&Ss.Find(e,ei.symbol(_r.COS))&&Ss.Find(e,_r.Constants.imaginaryunit)))return _l&&console.log(` rect: simple symbol: ${t}`),e;if(_r.ismultiply(e)&&Vu.isimaginaryunit(_r.cadr(e))&&!Vu.isZeroAtomOrTensor(ei.get_binding(ei.symbol(_r.ASSUME_REAL_VARIABLES))))return e;if(_r.isadd(e))return _l&&console.log(` rect - ${t} is a sum `),e.tail().reduce((n,i)=>tm.add(n,nm(i)),_r.Constants.zero);let r=Zu.multiply(Rg.abs(e),tm.add(rm.cosine(qo.arg(e)),Zu.multiply(_r.Constants.imaginaryunit,Xu.sine(qo.arg(e)))));return _l&&(console.log(` rect - ${t} is NOT a sum `),console.log(` rect - ${t} abs: ${Rg.abs(e)}`),console.log(` rect - ${t} arg of ${e} : ${e}`),console.log(` rect - ${t} cosine: ${rm.cosine(qo.arg(e))}`),console.log(` rect - ${t} sine: ${Xu.sine(qo.arg(e))}`),console.log(` rect - ${t} i * sine: ${Zu.multiply(_r.Constants.imaginaryunit,Xu.sine(qo.arg(e)))}`),console.log(` rect - ${t} cos + i * sine: ${tm.add(rm.cosine(qo.arg(e)),Zu.multiply(_r.Constants.imaginaryunit,Xu.sine(qo.arg(e))))}`),console.log(`rect of ${t} : ${r}`)),r}ws.rect=nm});var xs=A(Hu=>{"use strict";Object.defineProperty(Hu,"__esModule",{value:!0});Hu.factorpoly=void 0;var Xp=Ud(),we=N(),Hp=or(),Qp=Ee(),Wp=Ie(),On=ce(),Ci=j(),Lg=yo(),Cg=gl(),Jp=vo(),Kp=Tn(),Pg=Qd(),Mn=Q(),Mt=X(),Rs=xt(),eh=ri(),th=Fu(),im=ti();function rh(e,t){return!Hp.Find(e,t)||!Mn.ispolyexpandedform(e,t)||!we.issymbol(t)?e:nh(e,t)}Hu.factorpoly=rh;function nh(e,t){let r,n,i,o;Mn.isfloating(e)&&Qp.stop("floating point numbers in polynomial");let s=Lg.coeff(e,t),u=s.length-1,c=ih(s),d="real",_=null;for(;u>0;){var w,T;if(Mn.isZeroAtomOrTensor(s[0])?(r=we.Constants.one,n=we.Constants.zero):d==="real"?[T,r,n]=oh(s,u,t,r,n):d==="complex"&&([w,r]=sh(_,s,u)),d==="real")if(T===!1){d="complex";continue}else{for(i=On.add(Mt.multiply(r,t),n),we.DEBUG&&console.log(`success
FACTOR=${i}`),c=Mt.multiply_noexpand(c,i),ah(r,n,s,u);u&&Mn.isZeroAtomOrTensor(s[u]);)u--;let Z=we.Constants.zero;for(let Y=0;Y<=u;Y++)Z=On.add(Z,Mt.multiply(s[Y],Rs.power(t,Ci.integer(Y))));_=Z}else if(d==="complex"){if(w===!1)break;{let Z=On.subtract(r,t),Y=On.subtract(Jp.conjugate(r),t);i=Mt.multiply(Z,Y),we.DEBUG&&console.log(`success
FACTOR=${i}`);let Ae=c;if(c=Mt.multiply_noexpand(c,i),_==null){let Oe=we.Constants.zero;for(let at=0;at<=u;at++)Oe=On.add(Oe,Mt.multiply(s[at],Rs.power(t,Ci.integer(at))));_=Oe}let tt=t,Ze=i,ke=_;_=th.divpoly(ke,Ze,tt);let st=Mt.multiply(_,i);if(!Wp.equal(st,ke))return we.DEBUG&&(console.log("we found a polynomial based on complex root and its conj but it doesn't divide the poly, quitting"),console.log(`so just returning previousFactorisation times dividend: ${Ae} * ${ke}`)),Mt.multiply_noexpand(Ae,we.noexpand(Cg.yycondense,ke));for(let Oe=0;Oe<=u;Oe++)s.pop();s.push(...Lg.coeff(_,t)),u-=2}}}let k=we.Constants.zero;for(let Z=0;Z<=u;Z++)k=On.add(k,Mt.multiply(s[Z],Rs.power(t,Ci.integer(Z))));return e=k,we.DEBUG&&console.log(`POLY=${e}`),e=we.noexpand(Cg.yycondense,e),u>0&&Mn.isnegativeterm(s[u])&&(e=Mt.negate(e),c=Mt.negate_noexpand(c)),c=Mt.multiply_noexpand(c,e),we.DEBUG&&console.log(`RESULT=${c}`),c}function ih(e){let t=we.Constants.one;for(let r of e)t=Xp.lcm(Kp.denominator(r),t);for(let r=0;r<e.length;r++)e[r]=Mt.multiply(t,e[r]);return t=Mt.reciprocate(t),we.DEBUG&&console.log("rationalize_coefficients result"),t}function oh(e,t,r,n,i){let o,s,u;if(we.DEBUG){let _=we.Constants.zero;for(let w=0;w<=t;w++)_=On.add(_,Mt.multiply(e[w],Rs.power(r,Ci.integer(w))));o=_,console.log(`POLY=${o}`)}let c=Pg.ydivisors(e[t]),d=Pg.ydivisors(e[0]);if(we.DEBUG){console.log("divisors of base term");for(let _=0;_<d.length;_++)console.log(`, ${d[_]}`);console.log("divisors of leading term");for(let _=0;_<c.length;_++)console.log(`, ${c[_]}`)}for(let _=0;_<c.length;_++)for(let w=0;w<d.length;w++){if(n=c[_],i=d[w],s=Mt.negate(Mt.divide(i,n)),u=bl(s,e,t),we.DEBUG&&console.log(`try A=${n}
, B=${i}
, root ${r}
=-B/A=${s}
, POLY(${s}
)=${u}`),Mn.isZeroAtomOrTensor(u))return we.DEBUG&&console.log("get_factor_from_real_root returning true"),[!0,n,i];if(i=Mt.negate(i),s=Mt.negate(s),u=bl(s,e,t),we.DEBUG&&console.log(`try A=${n}
, B=${i}
, root ${r}
=-B/A=${s}
, POLY(${s}
)=${u}`),Mn.isZeroAtomOrTensor(u))return we.DEBUG&&console.log("get_factor_from_real_root returning true"),[!0,n,i]}return we.DEBUG&&console.log("get_factor_from_real_root returning false"),[!1,n,i]}function sh(e,t,r){let n,i,o,s;if(r<=2)return we.DEBUG&&console.log("no more factoring via complex roots to be found in polynomial of degree <= 2"),[!1,i];if(n=e,we.DEBUG&&console.log(`complex root finding for POLY=${n}`),i=im.rect(Rs.power(we.Constants.negOne,Ci.rational(2,3))),we.DEBUG&&console.log(`complex root finding: trying with ${i}`),o=i,s=bl(o,t,r),we.DEBUG&&console.log(`complex root finding result: ${s}`),Mn.isZeroAtomOrTensor(s))return we.DEBUG&&console.log("get_factor_from_complex_root returning true"),[!0,i];if(i=im.rect(Rs.power(we.Constants.one,Ci.rational(2,3))),we.DEBUG&&console.log(`complex root finding: trying with ${i}`),o=i,s=bl(o,t,r),we.DEBUG&&console.log(`complex root finding result: ${s}`),Mn.isZeroAtomOrTensor(s))return we.DEBUG&&console.log("get_factor_from_complex_root returning true"),[!0,i];for(let u=-10;u<=10;u++)for(let c=1;c<=5;c++){i=im.rect(On.add(Ci.integer(u),Mt.multiply(Ci.integer(c),we.Constants.imaginaryunit)));let _=bl(i,t,r);if(Mn.isZeroAtomOrTensor(_))return we.DEBUG&&console.log(`found complex root: ${_}`),[!0,i]}return we.DEBUG&&console.log("get_factor_from_complex_root returning false"),[!1,i]}function ah(e,t,r,n){let i=we.Constants.zero;for(let o=n;o>0;o--){let s=Mt.divide(r[o],e);r[o]=i,i=s,r[o-1]=On.subtract(r[o-1],Mt.multiply(i,t))}r[0]=i,we.DEBUG&&console.log("yydivpoly Q:")}function bl(e,t,r){let n=we.Constants.zero;for(let i=r;i>=0;i--)we.DEBUG&&(console.log("Evalpoly top of stack:"),console.log(eh.print_list(n))),n=On.add(Mt.multiply(n,e),t[i]);return n}});var bo=A(Di=>{"use strict";Object.defineProperty(Di,"__esModule",{value:!0});Di.areunivarpolysfactoredorexpandedform=Di.gcd=Di.Eval_gcd=void 0;var H=N(),Dg=U(),Eo=Ie(),lh=ce(),uh=j(),kg=G(),$g=xs(),om=Q(),Ug=ee(),Pi=X(),sm=xt();function ch(e){e=H.cdr(e);let t=kg.Eval(H.car(e));return H.iscons(e)&&(t=e.tail().reduce((r,n)=>ni(r,kg.Eval(n)),t)),t}Di.Eval_gcd=ch;function ni(e,t){return H.doexpand(fh,e,t)}Di.gcd=ni;function fh(e,t){let r;return Eo.equal(e,t)?e:H.isrational(e)&&H.isrational(t)?uh.gcd_numbers(e,t):(r=Bg(e,t))?dh(e,t,r):H.isadd(e)&&H.isadd(t)?mh(e,t):(H.isadd(e)&&(e=jg(e)),H.isadd(t)&&(t=jg(t)),H.ismultiply(e)?_h(e,t):H.ismultiply(t)?bh(e,t):H.ismultiply(e)&&H.ismultiply(t)?Gg(e,t):Fg(e,t))}function Bg(e,t){let r;if((r=om.isunivarpolyfactoredorexpandedform(e))&&om.isunivarpolyfactoredorexpandedform(t,r))return r}Di.areunivarpolysfactoredorexpandedform=Bg;function dh(e,t,r){return e=$g.factorpoly(e,r),t=$g.factorpoly(t,r),(H.ismultiply(e)||H.ismultiply(t))&&(H.ismultiply(e)||(e=Ug.makeList(Dg.symbol(H.MULTIPLY),e,H.Constants.one)),H.ismultiply(t)||(t=Ug.makeList(Dg.symbol(H.MULTIPLY),t,H.Constants.one))),H.ismultiply(e)&&H.ismultiply(t)?Gg(e,t):Fg(e,t)}function Gg(e,t){let r=H.cdr(e),n=H.cdr(t);if(H.iscons(r))return[...r].reduce((i,o)=>{if(H.iscons(n))return Pi.multiply(i,[...n].reduce((s,u)=>Pi.multiply(s,ni(o,u)),H.Constants.one))},H.Constants.one)}function Fg(e,t){let r,n,i;if(H.ispower(e)?(r=H.caddr(e),e=H.cadr(e)):r=H.Constants.one,H.ispower(t)?(n=H.caddr(t),t=H.cadr(t)):n=H.Constants.one,!Eo.equal(e,t))return H.Constants.one;if(H.isNumericAtom(r)&&H.isNumericAtom(n)){let u=Eo.lessp(r,n)?r:n;return sm.power(e,u)}let o=Pi.divide(r,n);if(H.isNumericAtom(o)){o=H.ismultiply(r)&&H.isNumericAtom(H.cadr(r))?H.cadr(r):H.Constants.one,i=H.ismultiply(n)&&H.isNumericAtom(H.cadr(n))?H.cadr(n):H.Constants.one;let u=Eo.lessp(o,i)?r:n;return sm.power(e,u)}if(o=lh.subtract(r,n),!H.isNumericAtom(o))return H.Constants.one;let s=om.isnegativenumber(o)?r:n;return sm.power(e,s)}function mh(e,t){let r,n,i,o;return Eo.length(e)!==Eo.length(t)?H.Constants.one:(r=H.iscons(e)?e.tail().reduce(ni):H.car(H.cdr(e)),n=H.iscons(t)?t.tail().reduce(ni):H.car(H.cdr(t)),i=Pi.divide(e,r),o=Pi.divide(t,n),Eo.equal(i,o)?Pi.multiply(i,ni(r,n)):H.Constants.one)}function jg(e){return H.iscons(e)?e.tail().reduce(ni):H.car(H.cdr(e))}function _h(e,t){return H.iscons(e)?e.tail().reduce((r,n)=>Pi.multiply(r,ni(n,t)),H.Constants.one):H.Constants.one}function bh(e,t){return H.iscons(t)?t.tail().reduce((r,n)=>Pi.multiply(r,ni(e,n)),H.Constants.one):H.Constants.one}});var gl=A(ki=>{"use strict";Object.defineProperty(ki,"__esModule",{value:!0});ki.yycondense=ki.Condense=ki.Eval_condense=void 0;var Qu=N(),gh=Ie(),yh=ce(),vh=G(),qh=bo(),am=X();function Eh(e){return zg(vh.Eval(Qu.cadr(e)))}ki.Eval_condense=Eh;function zg(e){return Qu.noexpand(Yg,e)}ki.Condense=zg;function Yg(e){if(!Qu.isadd(e))return e;let t=e.tail().reduce(qh.gcd),r=am.inverse(t),n=e.tail().reduce((o,s)=>yh.add(o,am.multiply_noexpand(r,s)),Qu.Constants.zero),i=gh.yyexpand(n);return am.divide(i,r)}ki.yycondense=Yg});var yl=A(Cs=>{"use strict";Object.defineProperty(Cs,"__esModule",{value:!0});Cs.rationalize=Cs.Eval_rationalize=void 0;var ar=N(),xh=ce(),ph=gl(),Vg=G(),hh=bo(),Zg=Q(),Ls=X(),Ah=Et();function Oh(e){return lm(Vg.Eval(ar.cadr(e)))}Cs.Eval_rationalize=Oh;function lm(e){let t=ar.defs.expanding,r=Mh(e);return ar.defs.expanding=t,r}Cs.rationalize=lm;function Mh(e){if(ar.istensor(e))return Nh(e);if(ar.defs.expanding=!1,!ar.isadd(e))return e;let t=Th(e),r=ar.Constants.zero;return ar.iscons(e)&&(r=e.tail().reduce((n,i)=>xh.add(n,Ls.multiply(t,i)),r)),Ls.divide(ph.Condense(r),t)}function Th(e){return ar.isadd(e)?e.tail().reduce((t,r)=>Xg(r,t),ar.Constants.one):Xg(e,ar.Constants.one)}function Xg(e,t){return ar.ismultiply(e)?e.tail().reduce((r,n)=>Hg(n,r),t):Hg(e,t)}function Hg(e,t){if(!ar.ispower(e))return t;let r=e;return e=ar.caddr(e),Zg.isnegativenumber(e)||ar.ismultiply(e)&&Zg.isnegativenumber(ar.cadr(e))?Qg(t,Ls.inverse(r)):t}function Nh(e){return e=Vg.Eval(e),ar.istensor(e)&&(e.tensor.elem=e.tensor.elem.map(lm),Ah.check_tensor_dimensions(e)),e}function Qg(e,t){return Ls.divide(Ls.multiply(e,t),hh.gcd(e,t))}});var Tn=A(Ps=>{"use strict";Object.defineProperty(Ps,"__esModule",{value:!0});Ps.denominator=Ps.Eval_denominator=void 0;var ii=N(),Ih=j(),Sh=G(),Wg=Q(),Jg=X(),wh=yl();function Rh(e){return um(Sh.Eval(ii.cadr(e)))}Ps.Eval_denominator=Rh;function um(e){return ii.isadd(e)&&(e=wh.rationalize(e)),ii.ismultiply(e)&&!Wg.isplusone(ii.car(ii.cdr(e)))?Jg.multiply_all(e.tail().map(um)):ii.isrational(e)?Ih.mp_denominator(e):ii.ispower(e)&&Wg.isnegativeterm(ii.caddr(e))?Jg.reciprocate(e):ii.Constants.one}Ps.denominator=um});var si=A(Ds=>{"use strict";Object.defineProperty(Ds,"__esModule",{value:!0});Ds.numerator=Ds.Eval_numerator=void 0;var oi=N(),Lh=j(),Ch=G(),Kg=Q(),Ph=X(),Dh=yl();function kh(e){return cm(Ch.Eval(oi.cadr(e)))}Ds.Eval_numerator=kh;function cm(e){return oi.isadd(e)&&(e=Dh.rationalize(e)),oi.ismultiply(e)&&!Kg.isplusone(oi.car(oi.cdr(e)))?Ph.multiply_all(e.tail().map(cm)):oi.isrational(e)?Lh.mp_numerator(e):oi.ispower(e)&&Kg.isnegativeterm(oi.caddr(e))?oi.Constants.one:e}Ds.numerator=cm});var dm=A(ks=>{"use strict";Object.defineProperty(ks,"__esModule",{value:!0});ks.arctan=ks.Eval_arctan=void 0;var pe=N(),ey=or(),xo=U(),$h=Ie(),Wu=j(),Uh=Tn(),Bh=G(),Nn=Q(),Gh=ee(),vl=X(),Fh=si();function jh(e){return fm(Bh.Eval(pe.cadr(e)))}ks.Eval_arctan=jh;function fm(e){if(pe.car(e)===xo.symbol(pe.TAN))return pe.cadr(e);if(pe.isdouble(e))return Wu.double(Math.atan(e.d));if(Nn.isZeroAtomOrTensor(e))return pe.Constants.zero;if(Nn.isnegative(e))return vl.negate(fm(vl.negate(e)));if(ey.Find(e,xo.symbol(pe.SIN))&&ey.Find(e,xo.symbol(pe.COS))){let t=Fh.numerator(e),r=Uh.denominator(e);if(pe.car(t)===xo.symbol(pe.SIN)&&pe.car(r)===xo.symbol(pe.COS)&&$h.equal(pe.cadr(t),pe.cadr(r)))return pe.cadr(t)}return pe.ispower(e)&&Nn.equaln(pe.cadr(e),3)&&Nn.equalq(pe.caddr(e),-1,2)||pe.ismultiply(e)&&Nn.equalq(pe.car(pe.cdr(e)),1,3)&&pe.car(pe.car(pe.cdr(pe.cdr(e))))===xo.symbol(pe.POWER)&&Nn.equaln(pe.car(pe.cdr(pe.car(pe.cdr(pe.cdr(e))))),3)&&Nn.equalq(pe.car(pe.cdr(pe.cdr(pe.car(pe.cdr(pe.cdr(e)))))),1,2)?vl.multiply(Wu.rational(1,6),pe.Constants.Pi()):Nn.equaln(e,1)?vl.multiply(Wu.rational(1,4),pe.Constants.Pi()):pe.ispower(e)&&Nn.equaln(pe.cadr(e),3)&&Nn.equalq(pe.caddr(e),1,2)?vl.multiply(Wu.rational(1,3),pe.Constants.Pi()):Gh.makeList(xo.symbol(pe.ARCTAN),e)}ks.arctan=fm});var ql=A($s=>{"use strict";Object.defineProperty($s,"__esModule",{value:!0});$s.imag=$s.Eval_imag=void 0;var ty=N(),zh=ce(),Yh=j(),Vh=vo(),Zh=G(),ry=X(),Xh=ti(),Hh=!1;function Qh(e){return ny(Zh.Eval(ty.cadr(e)))}$s.Eval_imag=Qh;function ny(e){let t=Xh.rect(e),r=Vh.conjugate(t),n=ry.divide(zh.subtract(t,r),Yh.integer(2)),i=ry.divide(n,ty.Constants.imaginaryunit);return Hh&&(console.log(`IMAGE of ${t}`),console.log(` image: conjugate result: ${r}`),console.log(` image: 1st divide result: ${n}`),console.log(` image: 2nd divide result: ${i}`)),i}$s.imag=ny});var Bs=A(Us=>{"use strict";Object.defineProperty(Us,"__esModule",{value:!0});Us.real=Us.Eval_real=void 0;var Wh=N(),Jh=ce(),Kh=j(),e2=vo(),t2=G(),r2=X(),n2=ti();function i2(e){return iy(t2.Eval(Wh.cadr(e)))}Us.Eval_real=i2;function iy(e){let t=n2.rect(e);return r2.divide(Jh.add(t,e2.conjugate(t)),Kh.integer(2))}Us.real=iy});var ms=A(Gs=>{"use strict";Object.defineProperty(Gs,"__esModule",{value:!0});Gs.arg=Gs.Eval_arg=void 0;var je=N(),po=U(),Ju=ce(),o2=dm(),s2=Tn(),a2=G(),oy=ql(),ai=Q(),sy=ee(),El=X(),l2=si(),u2=Bs(),c2=ti(),f2=!1;function d2(e){return Ku(a2.Eval(je.cadr(e)))}Gs.Eval_arg=d2;function Ku(e){return Ju.subtract(ay(l2.numerator(e)),ay(s2.denominator(e)))}Gs.arg=Ku;function ay(e){if(ai.ispositivenumber(e)||e===po.symbol(je.PI))return je.isdouble(e)||je.defs.evaluatingAsFloats?je.Constants.zeroAsDouble:je.Constants.zero;if(ai.isnegativenumber(e)){let t=je.isdouble(e)||je.defs.evaluatingAsFloats?je.Constants.piAsDouble:po.symbol(je.PI);return El.negate(t)}if(je.issymbol(e))return sy.makeList(po.symbol(je.ARG),e);if(je.ispower(e)&&ai.equaln(je.cadr(e),-1))return El.multiply(je.Constants.Pi(),je.caddr(e));if(je.ispower(e)&&je.cadr(e)===po.symbol(je.E))return oy.imag(je.caddr(e));if(je.ispower(e)&&ai.isoneovertwo(je.caddr(e))){let t=Ku(je.cadr(e));return f2&&(console.log(`arg of a sqrt: ${e}`),je.breakpoint,console.log(` = 1/2 * ${t}`)),El.multiply(t,je.caddr(e))}if(je.ismultiply(e))return e.tail().map(Ku).reduce(Ju.add,je.Constants.zero);if(je.isadd(e)){e=c2.rect(e);let t=u2.real(e),r=oy.imag(e);if(ai.isZeroAtomOrTensor(t))return ai.isnegative(r)?El.negate(je.Constants.Pi()):je.Constants.Pi();{let n=o2.arctan(El.divide(r,t));return ai.isnegative(t)?ai.isnegative(r)?Ju.subtract(n,je.Constants.Pi()):Ju.add(n,je.Constants.Pi()):n}}return ai.isZeroAtomOrTensor(po.get_binding(po.symbol(je.ASSUME_REAL_VARIABLES)))?sy.makeList(po.symbol(je.ARG),e):je.Constants.zero}});var ly=A(ec=>{"use strict";Object.defineProperty(ec,"__esModule",{value:!0});ec.dpow=void 0;var m2=N(),_2=Ee(),b2=ce(),mm=j(),g2=X();function y2(e,t){if(e===0&&t<0&&_2.stop("divide by zero"),e>=0||t%1==0)return mm.double(Math.pow(e,t));let r=Math.pow(Math.abs(e),t),n=Math.PI*t,i=0,o=0;return t%.5==0?(i=0,o=Math.sin(n)):(i=Math.cos(n),o=Math.sin(n)),b2.add(mm.double(i*r),g2.multiply(mm.double(o*r),m2.Constants.imaginaryunit))}ec.dpow=y2});var ho=A(tc=>{"use strict";Object.defineProperty(tc,"__esModule",{value:!0});tc.factorial=void 0;var v2=N(),RB=Ie(),LB=ce(),uy=j(),q2=ee(),CB=X(),PB=xt(),E2=U();function x2(e){let t=uy.nativeInt(e);return t<0||isNaN(t)?q2.makeList(E2.symbol(v2.FACTORIAL),e):uy.bignum_factorial(t)}tc.factorial=x2});var nc=A(rc=>{"use strict";Object.defineProperty(rc,"__esModule",{value:!0});rc.mpow=void 0;function p2(e,t){return e.pow(t)}rc.mpow=p2});var cy=A(Fs=>{"use strict";var h2=Fs&&Fs.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Fs,"__esModule",{value:!0});Fs.mroot=void 0;var ic=h2(Ti()),A2=Tu(),O2=Ee(),M2=j(),T2=nc();function N2(e,t){e=e.abs(),t===0&&O2.stop("root index is zero");let r=0;for(;e.shiftRight(r).toJSNumber()>0;)r++;if(r===0)return M2.mint(0);r=Math.floor((r-1)/t);let n=Math.floor(r/32+1),i=ic.default(n);for(let o=0;o<n;o++)i=i.and(ic.default(1).shiftLeft(o).not());for(;r>=0;){i=i.or(ic.default(1).shiftLeft(r));let o=T2.mpow(i,t);switch(A2.mcmp(o,e)){case 0:return i;case 1:i=i.and(ic.default(1).shiftLeft(r).not());break}r--}return 0}Fs.mroot=N2});var gy=A(js=>{"use strict";Object.defineProperty(js,"__esModule",{value:!0});js.quickpower=js.quickfactor=void 0;var fy=N(),I2=ce(),oc=j(),S2=dl(),w2=Q(),dy=ee(),my=X(),_y=U();function R2(e,t){let r=S2.factor_small_number(oc.nativeInt(e)),n=r.length;for(let i=0;i<n;i+=2)r.push(...by(r[i],my.multiply(r[i+1],t)));return my.multiply_all(r.slice(n))}js.quickfactor=R2;function by(e,t){let r=oc.bignum_truncate(t),n=I2.subtract(t,r),i;w2.isZeroAtomOrTensor(n)||(i=dy.makeList(_y.symbol(fy.POWER),e,n));let o=oc.nativeInt(r);if(isNaN(o)){let u=dy.makeList(_y.symbol(fy.POWER),e,r);return i?[i,u]:[u]}if(o===0)return[i];let s=oc.bignum_power_number(e,o);return i?[i,s]:[s]}js.quickpower=by});var vy=A(zs=>{"use strict";var L2=zs&&zs.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(zs,"__esModule",{value:!0});zs.qpow=void 0;var C2=L2(Ti()),Er=N(),P2=Ee(),yy=ce(),li=j(),Cr=Q(),sc=ee(),_m=nc(),D2=cy(),xl=X(),k2=gy(),ac=U();function pl(e,t){return $2(e,t)}zs.qpow=pl;function $2(e,t){if(Cr.isplusone(e)||Cr.isZeroAtomOrTensor(t))return Er.Constants.one;if(Cr.isminusone(e)&&Cr.isoneovertwo(t))return Er.Constants.imaginaryunit;if(Cr.isZeroAtomOrTensor(e))return Cr.isnegativenumber(t)&&P2.stop("divide by zero"),Er.Constants.zero;if(Cr.isplusone(t))return e;let r=0,n,i;if(Cr.isinteger(t)){if(r=li.nativeInt(t),isNaN(r))return sc.makeList(ac.symbol(Er.POWER),e,t);if(n=_m.mpow(e.q.a,Math.abs(r)),i=_m.mpow(e.q.b,Math.abs(r)),r<0){let u=n;n=i,i=u,n=li.makeSignSameAs(n,i),i=li.makePositive(i)}return new Er.Num(n,i)}if(Cr.isminusone(e))return U2(t);if(Cr.isnegativenumber(e))return xl.multiply(pl(xl.negate(e),t),pl(Er.Constants.negOne,t));if(!Cr.isinteger(e))return xl.multiply(pl(li.mp_numerator(e),t),pl(li.mp_denominator(e),xl.negate(t)));if(B2(e))return k2.quickfactor(e,t);if(!li.isSmall(t.q.a)||!li.isSmall(t.q.b))return sc.makeList(ac.symbol(Er.POWER),e,t);let{a:o,b:s}=t.q;return n=D2.mroot(e.q.a,s.toJSNumber()),n===0?sc.makeList(ac.symbol(Er.POWER),e,t):(i=_m.mpow(n,o),t.q.a.isNegative()?new Er.Num(C2.default.one,i):new Er.Num(i))}function U2(e){if(Cr.isinteger(e))return e.q.a.isOdd()?Er.Constants.negOne:Er.Constants.one;let t=li.bignum_truncate(e);Cr.isnegativenumber(e)&&(t=yy.add(t,Er.Constants.negOne));let r=yy.subtract(e,t),n=sc.makeList(ac.symbol(Er.POWER),Er.Constants.negOne,r);return t.q.a.isOdd()&&(n=xl.negate(n)),n}function B2(e){return li.isSmall(e.q.a)}});var xt=A(Vs=>{"use strict";Object.defineProperty(Vs,"__esModule",{value:!0});Vs.power=Vs.Eval_power=void 0;var B=N(),lc=or(),Vt=U(),hl=Ie(),qy=an(),uc=ce(),G2=ms(),Or=j(),F2=vo(),j2=Li(),z2=ly(),Ey=G(),xy=ho(),pt=Q(),Ys=ee(),Qt=X(),Y2=vy(),py=ti(),V2=Jn(),Z2=Et(),Je=!1;function X2(e){Je&&B.breakpoint;let t=Ey.Eval(B.cadr(e)),r=Ey.Eval(B.caddr(e));return Mr(t,r)}Vs.Eval_power=X2;function Mr(e,t){return H2(e,t)}Vs.power=Mr;function H2(e,t){Je&&B.breakpoint;let r=t,n=e;if(Je&&console.log(`POWER: ${e} ^ ${t}`),hl.equal(e,B.Constants.one)||pt.isZeroAtomOrTensor(t)){let d=B.Constants.One();return Je&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}if(hl.equal(t,B.Constants.one))return Je&&console.log(`   power of ${n} ^ ${r}: ${e}`),e;if(pt.isminusone(e)&&pt.isminusone(t)){let d=Qt.negate(B.Constants.One());return Je&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}if(pt.isminusone(e)&&pt.isoneovertwo(t)){let d=B.Constants.imaginaryunit;return Je&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}if(pt.isminusone(e)&&pt.isminusoneovertwo(t)){let d=Qt.negate(B.Constants.imaginaryunit);return Je&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}let i;if(pt.isminusone(e)&&!B.isdouble(e)&&B.isrational(t)&&!pt.isinteger(t)&&pt.ispositivenumber(t)&&!B.defs.evaluatingAsFloats){Je&&(console.log("   power: -1 ^ rational"),console.log(` trick: exponent.q.a , exponent.q.b ${t.q.a} , ${t.q.b}`)),t.q.a<t.q.b?i=Ys.makeList(Vt.symbol(B.POWER),e,t):(i=Ys.makeList(Vt.symbol(B.MULTIPLY),e,Ys.makeList(Vt.symbol(B.POWER),e,Or.rational(t.q.a.mod(t.q.b),t.q.b))),Je&&console.log(` trick applied : ${i}`));let d=py.rect(i);return Je&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}if(B.isrational(e)&&B.isrational(t)){Je&&console.log("   power: isrational(base) && isrational(exponent)");let d=Y2.qpow(e,t);return Je&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}if(B.isNumericAtom(e)&&B.isNumericAtom(t)){let d=z2.dpow(Or.nativeDouble(e),Or.nativeDouble(t));return Je&&(console.log("   power: both base and exponent are either rational or double "),console.log("POWER - isNumericAtom(base) && isNumericAtom(exponent)"),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}if(B.istensor(e)){let d=Z2.power_tensor(e,t);return Je&&(console.log("   power: istensor(base) "),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}if(B.car(e)===Vt.symbol(B.ABS)&&pt.iseveninteger(t)&&!pt.isZeroAtomOrTensor(Vt.get_binding(Vt.symbol(B.ASSUME_REAL_VARIABLES)))){let d=Mr(B.cadr(e),t);return Je&&(console.log("   power: even power of absolute of real value "),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}if(e===Vt.symbol(B.E)&&B.car(t)===Vt.symbol(B.LOG)){let d=B.cadr(t);return Je&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}if(e===Vt.symbol(B.E)&&B.isdouble(t)){let d=Or.double(Math.exp(t.d));return Je&&(console.log("   power: base == symbol(E) && isdouble(exponent) "),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}if(e===Vt.symbol(B.E)&&lc.Find(t,B.Constants.imaginaryunit)&&lc.Find(t,Vt.symbol(B.PI))&&!B.defs.evaluatingPolar){let d=Ys.makeList(Vt.symbol(B.POWER),e,t);Je&&console.log(`   power: turning complex exponential to rect: ${d}`);let _=py.rect(d);if(!lc.Find(_,Vt.symbol(B.PI)))return Je&&console.log(`   power: turned complex exponential to rect: ${_}`),_}if(B.ismultiply(e)&&pt.isinteger(t)){e=B.cdr(e);let d=Mr(B.car(e),t);return B.iscons(e)&&(d=e.tail().reduce((_,w)=>Qt.multiply(_,Mr(w,t)),d)),Je&&(console.log("   power: (a * b) ^ c  ->  (a ^ c) * (b ^ c) "),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}let o=!1;if(B.isNumericAtom(B.cadr(e))&&(o=hl.sign(Or.compare_numbers(B.cadr(e),B.Constants.zero))>0),B.ispower(e)&&(pt.isinteger(t)||o)){let d=Mr(B.cadr(e),Qt.multiply(B.caddr(e),t));return Je&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}let s=!1;if(pt.iseveninteger(B.caddr(e))){let d=Qt.multiply(B.caddr(e),t);pt.isone(d)&&(s=!0)}if(B.ispower(e)&&s){let d=qy.abs(B.cadr(e));return Je&&(console.log("   power: car(base) == symbol(POWER) && b_isEven_and_c_isItsInverse "),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}if(B.defs.expanding&&B.isadd(e)&&B.isNumericAtom(t)){let d=Or.nativeInt(t);if(d>1&&!isNaN(d)){Je&&console.log("   power: expanding && isadd(base) && isNumericAtom(exponent) ");let _=Q2(d,e);return Je&&console.log(`   power of ${n} ^ ${r}: ${_}`),_}}if(B.defs.trigmode===1&&B.car(e)===Vt.symbol(B.SIN)&&pt.iseveninteger(t)){let d=Mr(uc.subtract(B.Constants.one,Mr(j2.cosine(B.cadr(e)),Or.integer(2))),Qt.multiply(t,Or.rational(1,2)));return Je&&(console.log("   power: trigmode == 1 && car(base) == symbol(SIN) && iseveninteger(exponent) "),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}if(B.defs.trigmode===2&&B.car(e)===Vt.symbol(B.COS)&&pt.iseveninteger(t)){let d=Mr(uc.subtract(B.Constants.one,Mr(V2.sine(B.cadr(e)),Or.integer(2))),Qt.multiply(t,Or.rational(1,2)));return Je&&(console.log("   power: trigmode == 2 && car(base) == symbol(COS) && iseveninteger(exponent) "),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}if(pt.iscomplexnumber(e)){if(Je&&console.log(" power - handling the case (a + ib) ^ n"),pt.isinteger(t)){let d=F2.conjugate(e),_=Qt.divide(d,Qt.multiply(d,e));return pt.isone(t)||(_=Mr(_,Qt.negate(t))),Je&&console.log(`   power of ${n} ^ ${r}: ${_}`),_}if(B.isNumericAtom(t)){let d=B.defs.evaluatingAsFloats||pt.iscomplexnumberdouble(e)&&B.isdouble(t)?Or.double(Math.PI):Vt.symbol(B.PI),_=Qt.multiply(Mr(qy.abs(e),t),Mr(B.Constants.negOne,Qt.divide(Qt.multiply(G2.arg(e),t),d)));return B.avoidCalculatingPowersIntoArctans&&lc.Find(_,Vt.symbol(B.ARCTAN))&&(_=Ys.makeList(Vt.symbol(B.POWER),e,t)),Je&&console.log(`   power of ${n} ^ ${r}: ${_}`),_}}let u=W2(t);if(u!==void 0)return Je&&console.log("   power: using simplify_polar"),u;let c=Ys.makeList(Vt.symbol(B.POWER),e,t);return Je&&(console.log("   power: nothing can be done "),console.log(`   power of ${n} ^ ${r}: ${c}`)),c}function Q2(e,t){let r=[],n=hl.length(t)-1,i=[];t=B.cdr(t);for(let o=0;o<n;o++){for(let s=0;s<=e;s++)i[o*(e+1)+s]=Mr(B.car(t),Or.integer(s));t=B.cdr(t)}t=xy.factorial(Or.integer(e));for(let o=0;o<n;o++)r[o]=0;return hy(n,e,r,0,e,i,t,B.Constants.zero)}function hy(e,t,r,n,i,o,s,u){if(n<e-1){for(let d=0;d<=i;d++)r[n]=d,u=hy(e,t,r,n+1,i-d,o,s,u);return u}r[n]=i;let c=s;for(let d=0;d<e;d++)c=Qt.divide(c,xy.factorial(Or.integer(r[d])));for(let d=0;d<e;d++)c=Qt.multiply(c,o[d*(t+1)+r[d]]);return uc.add(u,c)}function W2(e){let t=pt.isquarterturn(e);switch(t){case 0:break;case 1:return B.Constants.one;case 2:return B.Constants.negOne;case 3:return B.Constants.imaginaryunit;case 4:return Qt.negate(B.Constants.imaginaryunit)}if(B.isadd(e)){let r=B.cdr(e);for(;B.iscons(r)&&(t=pt.isquarterturn(B.car(r)),!t);)r=B.cdr(r);let n;switch(t){case 0:return;case 1:n=B.Constants.one;break;case 2:n=B.Constants.negOne;break;case 3:n=B.Constants.imaginaryunit;break;case 4:n=Qt.negate(B.Constants.imaginaryunit);break}return Qt.multiply(n,hl.exponential(uc.subtract(e,B.car(r))))}}});var X=A(wt=>{"use strict";Object.defineProperty(wt,"__esModule",{value:!0});wt.negate_noexpand=wt.negate=wt.reciprocate=wt.inverse=wt.divide=wt.multiply_all_noexpand=wt.multiply_all=wt.multiply_noexpand=wt.multiply=wt.Eval_multiply=void 0;var D=N(),J2=ci(),Ay=Ee(),$i=U(),K2=Ie(),Al=ce(),ui=j(),Oy=G(),lr=Q(),Zs=ee(),My=xt(),Ty=Et();function eA(e){let t=Oy.Eval(D.cadr(e));return e=D.cddr(e),D.iscons(e)&&(t=[...e].reduce((r,n)=>Ui(r,Oy.Eval(n)),t)),t}wt.Eval_multiply=eA;function Ui(e,t){return D.defs.esc_flag&&Ay.stop("escape key stop"),D.isNumericAtom(e)&&D.isNumericAtom(t)?ui.multiply_numbers(e,t):tA(e,t)}wt.multiply=Ui;function tA(e,t){if(lr.isZeroAtom(e)||lr.isZeroAtom(t))return D.Constants.Zero();if(D.defs.expanding&&D.isadd(e))return e.tail().reduce((c,d)=>Al.add(c,Ui(d,t)),D.Constants.Zero());if(D.defs.expanding&&D.isadd(t))return t.tail().reduce((c,d)=>Al.add(c,Ui(e,d)),D.Constants.Zero());if(!D.istensor(e)&&D.istensor(t))return Ty.scalar_times_tensor(e,t);if(D.istensor(e)&&!D.istensor(t))return Ty.tensor_times_scalar(e,t);e=D.ismultiply(e)?D.cdr(e):Zs.makeList(e),t=D.ismultiply(t)?D.cdr(t):Zs.makeList(t);let r=[];if(D.isNumericAtom(D.car(e))&&D.isNumericAtom(D.car(t))){let c=D.car(e),d=D.car(t);r.push(ui.multiply_numbers(c,d)),e=D.cdr(e),t=D.cdr(t)}else D.isNumericAtom(D.car(e))?(r.push(D.car(e)),e=D.cdr(e)):D.isNumericAtom(D.car(t))?(r.push(D.car(t)),t=D.cdr(t)):r.push(D.Constants.One());let[n,i]=cc(e),[o,s]=fc(t);for(;D.iscons(e)&&D.iscons(t);){if(D.caar(e)===$i.symbol(D.OPERATOR)&&D.caar(t)===$i.symbol(D.OPERATOR)){r.push(new D.Cons($i.symbol(D.OPERATOR),J2.append(D.cdar(e),D.cdar(t)))),e=D.cdr(e),t=D.cdr(t),[n,i]=cc(e),[o,s]=fc(t);continue}switch(K2.cmp_expr(n,o)){case-1:r.push(D.car(e)),e=D.cdr(e),[n,i]=cc(e);break;case 1:r.push(D.car(t)),t=D.cdr(t),[o,s]=fc(t);break;case 0:rA(r,o,i,s),e=D.cdr(e),t=D.cdr(t),[n,i]=cc(e),[o,s]=fc(t);break;default:Ay.stop("internal error 2")}}if(D.iscons(e)&&r.push(...e),D.iscons(t)&&r.push(...t),aA(r),D.defs.expanding){for(let c=0;c<r.length;c++)if(D.isadd(r[c]))return bm(r)}let u=r.length;return u===1?r.pop():D.isrational(r[0])&&lr.equaln(r[0],1)?u===2?r.pop():(r[0]=$i.symbol(D.MULTIPLY),Zs.makeList(...r)):new D.Cons($i.symbol(D.MULTIPLY),Zs.makeList(...r))}function cc(e){let t=D.car(e),r=D.Constants.One();return D.ispower(t)&&(r=D.caddr(t),t=D.cadr(t)),[t,r]}function fc(e){let t=D.car(e),r=D.Constants.One();return D.ispower(t)&&(r=D.caddr(t),t=D.cadr(t)),[t,r]}function rA(e,t,r,n){let i=My.power(t,Al.add(r,n));if(D.isNumericAtom(i))e[0]=ui.multiply_numbers(e[0],i);else if(D.ismultiply(i))if(D.isNumericAtom(D.cadr(i))&&D.cdddr(i)===$i.symbol(D.NIL)){let o=e[0],s=D.cadr(i);e[0]=ui.multiply_numbers(o,s),e.push(D.caddr(i))}else e.push(i);else e.push(i)}function nA(e,t){return D.noexpand(Ui,e,t)}wt.multiply_noexpand=nA;function bm(e){if(e.length===1)return e[0];if(e.length===0)return D.Constants.One();let t=e[0];for(let r=1;r<e.length;r++)t=Ui(t,e[r]);return t}wt.multiply_all=bm;function iA(e){return D.noexpand(bm,e)}wt.multiply_all_noexpand=iA;function Ol(e,t){return D.isNumericAtom(e)&&D.isNumericAtom(t)?ui.divide_numbers(e,t):Ui(e,gm(t))}wt.divide=Ol;function gm(e){return D.isNumericAtom(e)?ui.invert_number(e):My.power(e,D.Constants.negOne)}wt.inverse=gm;function oA(e){return gm(e)}wt.reciprocate=oA;function Ny(e){return D.isNumericAtom(e)?ui.negate_number(e):Ui(e,D.Constants.NegOne())}wt.negate=Ny;function sA(e){return D.noexpand(Ny,e)}wt.negate_noexpand=sA;function aA(e){let t=0;if(lr.isplusone(e[0])||lr.isminusone(e[0])||D.isdouble(e[0]))return;for(t=1;t<e.length&&!ym(e[t]);t++);if(t===e.length)return;let r=ui.mp_numerator(e[0]);for(let i=1;i<e.length&&!(lr.isplusone(r)||lr.isminusone(r));i++){if(!ym(e[i]))continue;let o=D.cadr(e[i]),s=D.caddr(e[i]);if(!lr.isnegativenumber(s))continue;let u=Ol(r,o);!lr.isinteger(u)||(r=u,e[i]=Zs.makeList($i.symbol(D.POWER),o,Al.add(D.Constants.One(),s)))}let n=ui.mp_denominator(e[0]);for(let i=1;i<e.length&&!lr.isplusone(n);i++){if(!ym(e[i]))continue;let o=D.cadr(e[i]),s=D.caddr(e[i]);if(lr.isnegativenumber(s))continue;let u=Ol(n,o);if(!lr.isinteger(u))continue;n=u;let c=Al.subtract(s,D.Constants.one);if(D.dontCreateNewRadicalsInDenominatorWhenEvalingMultiplication&&lr.isinteger(o)&&!lr.isinteger(c)&&lr.isnegativenumber(c)){r=Ol(r,o);break}e[i]=Zs.makeList($i.symbol(D.POWER),o,c)}e[0]=Ol(r,n)}function ym(e){return D.ispower(e)&&D.isNumericAtom(D.cadr(e))&&lr.isfraction(D.caddr(e))&&!lr.isminusone(D.cadr(e))}});var mc=A(Xs=>{"use strict";Object.defineProperty(Xs,"__esModule",{value:!0});Xs.determinant=Xs.det=void 0;var Bi=N(),Iy=Ie(),Sy=ce(),lA=j(),uA=ee(),Ao=X(),cA=Et(),fA=U();function dA(e){if(!cA.is_square_matrix(e))return uA.makeList(fA.symbol(Bi.DET),e);let t=e.tensor.elem;return t.every(n=>Bi.isNumericAtom(n))?mA(e):wy(t,e.tensor.dim[0])}Xs.det=dA;function wy(e,t){let r=0,n=[];for(let s=0;s<t;s++)n[s]=s,n[s+t]=0,n[s+t+t]=1;let i=1,o=Bi.Constants.zero;for(;;){let s=lA.integer(i);for(let w=0;w<t;w++){let T=t*n[w]+w;s=Ao.multiply(s,e[T])}o=Sy.add(o,s);let u=t-1,c=0,d=!1;for(;;){if(r=n[t+u]+n[t+t+u],r<0){n[t+t+u]=-n[t+t+u],u--;continue}if(r===u+1){if(u===0){d=!0;break}c++,n[t+t+u]=-n[t+t+u],u--;continue}break}if(d)break;let _=n[u-n[t+u]+c];n[u-n[t+u]+c]=n[u-r+c],n[u-r+c]=_,n[t+u]=r,i=i===1?-1:1}return o}Xs.determinant=wy;function mA(e){let t=e.tensor.dim[0],r=[...e.tensor.elem];return _A(r,t)}function In(e,t,r,n){return e[t*r+n]}function dc(e,t,r,n,i){e[t*r+n]=i}function _A(e,t){let r=Bi.Constants.one;for(let n=0;n<t-1;n++){if(Iy.equal(In(e,t,n,n),Bi.Constants.zero)){let i=0;for(i=n+1;i<t&&Iy.equal(In(e,t,i,n),Bi.Constants.zero);i++);if(i===t){r=Bi.Constants.zero;break}for(let o=n;o<t;o++){let s=In(e,t,n,o);dc(e,t,n,o,In(e,t,i,o)),dc(e,t,i,o,s)}r=Ao.negate(r)}r=Ao.multiply(r,In(e,t,n,n));for(let i=n+1;i<t;i++){let o=Ao.negate(Ao.divide(In(e,t,i,n),In(e,t,n,n)));dc(e,t,i,n,Bi.Constants.zero);for(let s=n+1;s<t;s++){let u=Sy.add(Ao.multiply(In(e,t,n,s),o),In(e,t,i,s));dc(e,t,i,s,u)}}}return Ao.multiply(r,In(e,t,t-1,t-1))}});var xm=A(_c=>{"use strict";Object.defineProperty(_c,"__esModule",{value:!0});_c.hermite=void 0;var Hs=N(),vm=U(),bA=ce(),qm=j(),gA=G(),yA=ee(),Em=X(),vA=Zr();function qA(e,t){return EA(e,t)}_c.hermite=qA;function EA(e,t){let r=qm.nativeInt(t);return r<0||isNaN(r)?yA.makeList(vm.symbol(Hs.HERMITE),e,t):Hs.issymbol(e)?Ry(r,e):gA.Eval(vA.subst(Ry(r,vm.symbol(Hs.SECRETX)),vm.symbol(Hs.SECRETX),e))}function Ry(e,t){let r=Hs.Constants.zero,n=Hs.Constants.one;for(let i=0;i<e;i++){let o=r;r=n,n=Em.multiply(bA.subtract(Em.multiply(t,r),Em.multiply(qm.integer(i),o)),qm.integer(2))}return n}});var Cy=A(bc=>{"use strict";Object.defineProperty(bc,"__esModule",{value:!0});bc.hilbert=void 0;var xA=N(),pA=Ie(),Ly=j(),hA=ee(),AA=X(),OA=U();function MA(e){let t=Ly.nativeInt(e);if(t<2)return hA.makeList(OA.symbol(xA.HILBERT),e);let r=pA.zero_matrix(t,t);for(let n=0;n<t;n++)for(let i=0;i<t;i++)r.tensor.elem[n*t+i]=AA.inverse(Ly.integer(n+i+1));return r}bc.hilbert=MA});var Om=A(Qs=>{"use strict";Object.defineProperty(Qs,"__esModule",{value:!0});Qs.cofactor=Qs.Eval_cofactor=void 0;var pm=N(),hm=Ee(),TA=mc(),Am=G(),NA=X(),IA=Et();function SA(e){let t=Am.Eval(pm.cadr(e));IA.is_square_matrix(t)||hm.stop("cofactor: 1st arg: square matrix expected");let r=t.tensor.dim[0],n=Am.evaluate_integer(pm.caddr(e));(n<1||n>r)&&hm.stop("cofactor: 2nd arg: row index expected");let i=Am.evaluate_integer(pm.cadddr(e));return(i<1||i>r)&&hm.stop("cofactor: 3rd arg: column index expected"),Py(t,r,n-1,i-1)}Qs.Eval_cofactor=SA;function Py(e,t,r,n){let i=[];for(let s=0;s<t;s++)for(let u=0;u<t;u++)s!==r&&u!==n&&i.push(e.tensor.elem[t*s+u]);let o=TA.determinant(i,t-1);return(r+n)%2&&(o=NA.negate(o)),o}Qs.cofactor=Py});var Mm=A(Ws=>{"use strict";Object.defineProperty(Ws,"__esModule",{value:!0});Ws.adj=Ws.Eval_adj=void 0;var wA=St(),RA=N(),LA=Ee(),CA=Om(),PA=G(),DA=Et();function kA(e){return Dy(PA.Eval(RA.cadr(e)))}Ws.Eval_adj=kA;function Dy(e){DA.is_square_matrix(e)||LA.stop("adj: square matrix expected");let t=e.tensor.dim[0],r=wA.alloc_tensor(t*t);r.tensor.ndim=2,r.tensor.dim[0]=t,r.tensor.dim[1]=t;for(let n=0;n<t;n++)for(let i=0;i<t;i++)r.tensor.elem[t*i+n]=CA.cofactor(e,t,n,i);return r}Ws.adj=Dy});var Gi=A(Js=>{"use strict";Object.defineProperty(Js,"__esModule",{value:!0});Js.inner=Js.Eval_inner=void 0;var $A=St(),fe=N(),Tm=Ee(),Hr=U(),Ml=ce(),Nm=G(),ky=Il(),Tl=Q(),Im=ee(),gc=X(),$y=Et();function Uy(e){let t=[];t.push(fe.car(fe.cdr(e))),fe.car(fe.cdr(fe.cdr(e)))===Hr.symbol(fe.NIL)&&Tm.stop("pattern needs at least a template and a transformed version");let n=fe.cdr(fe.cdr(e));for(;n!==Hr.symbol(fe.NIL);)t.push(fe.car(n)),n=fe.cdr(n);if(t.length>2){let s=Im.makeList(Hr.symbol(fe.INNER),t[t.length-2],t[t.length-1]);for(let u=2;u<t.length;u++)s=Im.makeList(Hr.symbol(fe.INNER),t[t.length-u-1],s);return Uy(s)}let i=[];yc(e,i);let o=[];for(let s=0;s<i.length;s++)i[s]!==Hr.symbol(fe.SYMBOL_IDENTITY_MATRIX)&&o.push(i[s]);if(i=o,o=[],i.length>1){let s=0;for(let u=0;u<i.length&&u+s+1<=i.length-1;u++){if(fe.isNumericAtomOrTensor(i[u+s])||fe.isNumericAtomOrTensor(i[u+s+1]))o.push(i[u+s]);else{let c=ky.inv(Nm.Eval(i[u+s])),d=Nm.Eval(i[u+s+1]),_=Ml.subtract(c,d);Tl.isZeroAtomOrTensor(_)?s+=1:o.push(i[u+s])}if(u+s===i.length-2&&o.push(i[i.length-1]),u+s>=i.length-1)break}i=o}return i.length==0?Hr.symbol(fe.SYMBOL_IDENTITY_MATRIX):(i=i.map(Nm.Eval),i.reduce(Nl))}Js.Eval_inner=Uy;function Nl(e,t){if(Tl.isnegativeterm(t)&&Tl.isnegativeterm(e)&&(t=gc.negate(t),e=gc.negate(e)),fe.isinnerordot(e)&&(t=Nl(fe.car(fe.cdr(fe.cdr(e))),t),e=fe.car(fe.cdr(e))),e===Hr.symbol(fe.SYMBOL_IDENTITY_MATRIX))return t;if(t===Hr.symbol(fe.SYMBOL_IDENTITY_MATRIX))return e;if(fe.istensor(e)&&fe.istensor(t))return UA(e,t);if(!(fe.isNumericAtomOrTensor(e)||fe.isNumericAtomOrTensor(t))){let r=Ml.subtract(e,ky.inv(t));if(Tl.isZeroAtomOrTensor(r))return Hr.symbol(fe.SYMBOL_IDENTITY_MATRIX)}return fe.defs.expanding&&fe.isadd(e)?e.tail().reduce((r,n)=>Ml.add(r,Nl(n,t)),fe.Constants.zero):fe.defs.expanding&&fe.isadd(t)?t.tail().reduce((r,n)=>Ml.add(r,Nl(e,n)),fe.Constants.zero):fe.istensor(e)&&fe.isNumericAtom(t)?$y.tensor_times_scalar(e,t):fe.isNumericAtom(e)&&fe.istensor(t)?$y.scalar_times_tensor(e,t):fe.isNumericAtom(e)||fe.isNumericAtom(t)?gc.multiply(e,t):Im.makeList(Hr.symbol(fe.INNER),e,t)}Js.inner=Nl;function UA(e,t){let r=e.tensor.dim[e.tensor.ndim-1];r!==t.tensor.dim[0]&&(fe.breakpoint,Tm.stop("inner: tensor dimension check"));let n=e.tensor.ndim+t.tensor.ndim-2;n>fe.MAXDIM&&Tm.stop("inner: rank of result exceeds maximum");let i=e.tensor.elem,o=t.tensor.elem,s=e.tensor.dim.slice(0,e.tensor.dim.length-1).reduce((_,w)=>_*w,1),u=t.tensor.dim.slice(1).reduce((_,w)=>_*w,1),c=$A.alloc_tensor(s*u),d=c.tensor.elem;for(let _=0;_<s;_++)for(let w=0;w<r;w++)if(!Tl.isZeroAtomOrTensor(i[_*r+w]))for(let T=0;T<u;T++)d[_*u+T]=Ml.add(gc.multiply(i[_*r+w],o[w*u+T]),d[_*u+T]);return n===0?c.tensor.elem[0]:(c.tensor.ndim=n,c.tensor.dim=[...e.tensor.dim.slice(0,e.tensor.ndim-1),...t.tensor.dim.slice(1,t.tensor.ndim)],c)}function yc(e,t){if(!fe.iscons(e)){By(e,t);return}if(fe.cdr(e)===Hr.symbol(fe.NIL)){yc(fe.car(e),t);return}if(fe.isinnerordot(e)){yc(fe.car(fe.cdr(e)),t),yc(fe.cdr(fe.cdr(e)),t);return}By(e,t)}function By(e,t){e!==Hr.symbol(fe.NIL)&&t.push(e)}});var Il=A(Ks=>{"use strict";Object.defineProperty(Ks,"__esModule",{value:!0});Ks.invg=Ks.inv=void 0;var BA=St(),Tr=N(),Gy=Ee(),Fy=Ie(),jy=ce(),GA=Mm(),FA=mc(),jA=Gi(),zA=Q(),zy=ee(),Sl=X(),Yy=Et(),Vy=U();function Zy(e){if(Tr.isinv(e))return Tr.car(Tr.cdr(e));if(Tr.isidentitymatrix(e))return e;if(Tr.defs.expanding&&Tr.isinnerordot(e)){let n=(Tr.iscons(e)?e.tail():[]).map(Zy);for(let i=n.length-1;i>0;i--)n[i-1]=jA.inner(n[i],n[i-1]);return n[0]}if(!Yy.is_square_matrix(e))return zy.makeList(Vy.symbol(Tr.INV),e);if(Tr.isNumericAtomOrTensor(e))return Xy(e);let t=FA.det(e);return zA.isZeroAtomOrTensor(t)&&Gy.stop("inverse of singular matrix"),Sl.divide(GA.adj(e),t)}Ks.inv=Zy;function YA(e){return Yy.is_square_matrix(e)?Xy(e):zy.makeList(Vy.symbol(Tr.INVG),e)}Ks.invg=YA;function Xy(e){let t=e.tensor.dim[0],r=new Array(t*t);r.fill(Tr.Constants.zero);for(let o=0;o<t;o++)r[o*t+o]=Tr.Constants.one;let n=VA(r,e.tensor.elem,t),i=BA.alloc_tensor(t*t);return i.tensor.ndim=2,i.tensor.dim[0]=t,i.tensor.dim[1]=t,i.tensor.elem=n,i}function VA(e,t,r){for(let n=0;n<r;n++){if(Fy.equal(t[r*n+n],Tr.Constants.zero)){let o=0;for(o=n+1;o<r&&Fy.equal(t[r*o+n],Tr.Constants.zero);o++);o===r&&Gy.stop("inverse of singular matrix");for(let s=0;s<r;s++){let u=t[r*n+s];t[r*n+s]=t[r*o+s],t[r*o+s]=u,u=e[r*n+s],e[r*n+s]=e[r*o+s],e[r*o+s]=u}}let i=t[r*n+n];for(let o=0;o<r;o++)o>n&&(t[r*n+o]=Sl.divide(t[r*n+o],i)),e[r*n+o]=Sl.divide(e[r*n+o],i);for(let o=0;o<r;o++){if(o===n)continue;let s=t[r*o+n];for(let u=0;u<r;u++)u>n&&(t[r*o+u]=jy.subtract(t[r*o+u],Sl.multiply(t[r*n+u],s))),e[r*o+u]=jy.subtract(e[r*o+u],Sl.multiply(e[r*n+u],s))}}return e}});var wm=A(ea=>{"use strict";Object.defineProperty(ea,"__esModule",{value:!0});ea.besselj=ea.Eval_besselj=void 0;var Wt=N(),ZA=ci(),wl=U(),vc=ce(),dn=j(),XA=Li(),Hy=G(),Rl=Q(),Sm=ee(),ur=X(),Ll=xt(),HA=Jn();function QA(e){return qc(Hy.Eval(Wt.cadr(e)),Hy.Eval(Wt.caddr(e)))}ea.Eval_besselj=QA;function qc(e,t){return WA(e,t)}ea.besselj=qc;function WA(e,t){let r=dn.nativeInt(t);if(Wt.isdouble(e)&&!isNaN(r)){let n=ZA.jn(r,e.d);return dn.double(n)}if(Rl.isZeroAtomOrTensor(e)&&Rl.isZeroAtomOrTensor(t))return Wt.Constants.one;if(Rl.isZeroAtomOrTensor(e)&&!isNaN(r))return Wt.Constants.zero;if(t.k===Wt.NUM&&Wt.MEQUAL(t.q.b,2)){if(Wt.MEQUAL(t.q.a,1)){let i=Wt.defs.evaluatingAsFloats?dn.double(2/Math.PI):ur.divide(dn.integer(2),wl.symbol(Wt.PI));return ur.multiply(Ll.power(ur.divide(i,e),dn.rational(1,2)),HA.sine(e))}if(Wt.MEQUAL(t.q.a,-1)){let i=Wt.defs.evaluatingAsFloats?dn.double(2/Math.PI):ur.divide(dn.integer(2),wl.symbol(Wt.PI));return ur.multiply(Ll.power(ur.divide(i,e),dn.rational(1,2)),XA.cosine(e))}let n=dn.integer(Wt.MSIGN(t.q.a));return vc.subtract(ur.multiply(ur.multiply(ur.divide(dn.integer(2),e),vc.subtract(t,n)),qc(e,vc.subtract(t,n))),qc(e,vc.subtract(t,ur.multiply(dn.integer(2),n))))}return Rl.isnegativeterm(e)?ur.multiply(ur.multiply(Ll.power(ur.negate(e),t),Ll.power(e,ur.negate(t))),Sm.makeList(wl.symbol(Wt.BESSELJ),ur.negate(e),t)):Rl.isnegativeterm(t)?ur.multiply(Ll.power(Wt.Constants.negOne,t),Sm.makeList(wl.symbol(Wt.BESSELJ),e,ur.negate(t))):Sm.makeList(wl.symbol(Wt.BESSELJ),e,t)}});var Rm=A(ra=>{"use strict";Object.defineProperty(ra,"__esModule",{value:!0});ra.bessely=ra.Eval_bessely=void 0;var ta=N(),JA=ci(),Qy=U(),Wy=j(),Jy=G(),KA=Q(),Ky=ee(),ev=X(),eO=xt();function tO(e){return tv(Jy.Eval(ta.cadr(e)),Jy.Eval(ta.caddr(e)))}ra.Eval_bessely=tO;function tv(e,t){return rO(e,t)}ra.bessely=tv;function rO(e,t){let r=Wy.nativeInt(t);if(ta.isdouble(e)&&!isNaN(r)){let n=JA.yn(r,e.d);return Wy.double(n)}return KA.isnegativeterm(t)?ev.multiply(eO.power(ta.Constants.negOne,t),Ky.makeList(Qy.symbol(ta.BESSELY),e,ev.negate(t))):Ky.makeList(Qy.symbol(ta.BESSELY),e,t)}});var Lm=A(na=>{"use strict";Object.defineProperty(na,"__esModule",{value:!0});na.ycosh=na.Eval_cosh=void 0;var Oo=N(),rv=U(),nO=j(),iO=G(),oO=Q(),sO=ee();function aO(e){return nv(iO.Eval(Oo.cadr(e)))}na.Eval_cosh=aO;function nv(e){if(Oo.car(e)===rv.symbol(Oo.ARCCOSH))return Oo.cadr(e);if(Oo.isdouble(e)){let t=Math.cosh(e.d);return Math.abs(t)<1e-10&&(t=0),nO.double(t)}return oO.isZeroAtomOrTensor(e)?Oo.Constants.one:sO.makeList(rv.symbol(Oo.COSH),e)}na.ycosh=nv});var km=A(ia=>{"use strict";Object.defineProperty(ia,"__esModule",{value:!0});ia.dirac=ia.Eval_dirac=void 0;var xr=N(),Cm=U(),lO=G(),Pm=Q(),Dm=ee(),uO=cn(),iv=X();function cO(e){return ov(lO.Eval(xr.cadr(e)))}ia.Eval_dirac=cO;function ov(e){return fO(e)}ia.dirac=ov;function fO(e){return xr.isdouble(e)?e.d===0?xr.Constants.one:xr.Constants.zero:xr.isrational(e)?xr.MZERO(uO.mmul(e.q.a,e.q.b))?xr.Constants.one:xr.Constants.zero:xr.ispower(e)?Dm.makeList(Cm.symbol(xr.DIRAC),xr.cadr(e)):Pm.isnegativeterm(e)?Dm.makeList(Cm.symbol(xr.DIRAC),iv.negate(e)):((Pm.isnegativeterm(e)||xr.isadd(e)&&Pm.isnegativeterm(xr.cadr(e)))&&(e=iv.negate(e)),Dm.makeList(Cm.symbol(xr.DIRAC),e))}});var av=A(Ec=>{"use strict";Object.defineProperty(Ec,"__esModule",{value:!0});Ec.partition=void 0;var $m=N(),dO=or(),sv=X();function mO(e,t){let r=$m.Constants.one,n=r;if(e=$m.cdr(e),!$m.iscons(e))return[r,n];for(let i of e)dO.Find(i,t)?n=sv.multiply(n,i):r=sv.multiply(r,i);return[r,n]}Ec.partition=mO});var Yi=A(la=>{"use strict";Object.defineProperty(la,"__esModule",{value:!0});la.scan_meta=la.scan=void 0;var _O=St(),W=N(),Fi=ci(),bO=Ee(),dt=U(),lv=j(),gO=Q(),Zt=ee(),xc=X(),yO=Et(),Um=1001,Bm=1002,pc=1003,Gm=1004,Fm=1006,jm=1007,uv=1008,cv=1009,fv=1010,dv=1011,zm=1012,te="",Cl=0,Ym=0,Qr=0,J=0,oa=0,mt="",hc=null,Xe=null,Pl=null,ji=null,sa=null,Ke=null,zi=!1,Vm=null,ye="";function vO(e){W.DEBUG&&console.log(`#### scanning ${e}`),hc=null,Xe=[],Pl=[],ji=!0,sa=[],Ke=[""],Vm=!1,ye=e,Ym=0;let t=W.defs.expanding;if(W.defs.expanding=!0,Qr=0,J=0,Pe(),te==="")return W.defs.expanding=t,[0,dt.symbol(W.NIL)];let r=fi();return W.defs.expanding=t,Vm||(W.defs.symbolsInExpressionsWithoutAssignments=W.defs.symbolsInExpressionsWithoutAssignments.concat(Pl)),[oa-Qr,r]}la.scan=vO;function qO(e){ye=e,Ym=1;let t=W.defs.expanding;if(W.defs.expanding=!0,Qr=0,J=0,Pe(),te==="")return W.defs.expanding=t,dt.symbol(W.NIL);let r=fi();return W.defs.expanding=t,r}la.scan_meta=qO;function fi(){let e=mv(),t=!1;if(te===zm&&(t=!0),te===zm||te==="="){let r=hc;W.DEBUG&&console.log("assignment!"),Vm=!0,ji=!1,Pe();let n=mv();if(t&&(n=Zt.makeList(dt.symbol(W.QUOTE),n)),e=Zt.makeList(dt.symbol(W.SETQ),e,n),ji=!0,W.defs.codeGen){let i=Xe.indexOf(r);if(i!==-1&&(Xe.splice(i,1),W.defs.symbolsHavingReassignments.push(r)),W.DEBUG){console.log(`locally, ${r} depends on: `);for(let s of Array.from(Xe))console.log(`  ${s}`)}W.defs.symbolsDependencies[r]==null&&(W.defs.symbolsDependencies[r]=[]);let o=W.defs.symbolsDependencies[r];for(let s of Array.from(Xe))o.indexOf(s)===-1&&o.push(s);Xe=[]}}return e}function mv(){let e=di(),t;switch(te){case fv:return Pe(),t=di(),Zt.makeList(dt.symbol(W.TESTEQ),e,t);case dv:return Pe(),t=di(),Zt.makeList(dt.symbol(W.NOT),Zt.makeList(dt.symbol(W.TESTEQ),e,t));case cv:return Pe(),t=di(),Zt.makeList(dt.symbol(W.TESTLE),e,t);case uv:return Pe(),t=di(),Zt.makeList(dt.symbol(W.TESTGE),e,t);case"<":return Pe(),t=di(),Zt.makeList(dt.symbol(W.TESTLT),e,t);case">":return Pe(),t=di(),Zt.makeList(dt.symbol(W.TESTGT),e,t)}return e}function di(){let e=[dt.symbol(W.ADD)];switch(te){case"+":Pe(),e.push(Dl());break;case"-":Pe(),e.push(xc.negate(Dl()));break;default:e.push(Dl())}for(;Cl===0&&(te==="+"||te==="-");)te==="+"?(Pe(),e.push(Dl())):(Pe(),e.push(xc.negate(Dl())));return e.length===2?e[1]:Zt.makeList(...e)}function Zm(){if(typeof te=="string")return te.charCodeAt(0)}function EO(){if(Zm()===W.dotprod_unicode)return!0;switch(te){case"*":case"/":return!0;case"(":case pc:case Gm:case Um:case Bm:case jm:return Cl?(J=oa,!1):!0}return!1}function Xm(e){e.length>0&&W.isrational(e[e.length-1])&&gO.equaln(e[e.length-1],1)&&e.pop()}function xO(e){if(e.length>1&&W.isNumericAtom(e[e.length-2])&&W.isNumericAtom(e[e.length-1])){let t=e.pop(),r=e.pop();e.push(xc.multiply(r,t))}}function Dl(){let e=[aa()];for(W.parse_time_simplifications&&Xm(e);EO();)te==="*"?(Pe(),e.push(aa())):te==="/"?(Xm(e),Pe(),e.push(xc.inverse(aa()))):Zm()===W.dotprod_unicode?(Pe(),e.push(Zt.makeList(dt.symbol(W.INNER),e.pop(),aa()))):e.push(aa()),W.parse_time_simplifications&&(xO(e),Xm(e));return e.length===0?W.Constants.one:e.length==1?e[0]:Zt.makeList(dt.symbol(W.MULTIPLY),...e)}function pO(e){return te==="^"?(Pe(),Zt.makeList(dt.symbol(W.POWER),e,aa())):e}function hO(e){Pe();let t=[dt.symbol(W.INDEX),e,di()];for(;te===",";)Pe(),t.push(di());return te!=="]"&&Sn("] expected"),Pe(),Zt.makeList(...t)}function aa(){let e=!1,t;for(te==="("?t=IO():te===pc?t=OO():te===Gm?t=TO():te==="["?t=SO():te===Um?(e=!0,t=lv.bignum_scan_integer(mt),te=Pe()):te===Bm?(e=!0,t=lv.bignum_scan_float(mt),te=Pe()):te===jm?t=MO():Sn("syntax error");te==="["||te==="("&&Cl===0&&!e;)te==="["?t=hO(t):te==="("&&(t=NO(t));for(;te==="!";)Pe(),t=Zt.makeList(dt.symbol(W.FACTORIAL),t);for(;Zm()===W.transpose_unicode;)Pe(),t=Zt.makeList(dt.symbol(W.TRANSPOSE),t);return pO(t)}function Hm(e){if(W.predefinedSymbolsInGlobalScope_doNotTrackInDependencies.indexOf(e)===-1&&Xe.indexOf(e)===-1&&Xe.indexOf("'"+e)===-1&&!zi){W.DEBUG&&console.log(`... adding symbol: ${e} to the set of the symbols right of assignment`);let t="";for(let r=1;r<Ke.length;r++)Ke[r]!==""&&(t+=Ke[r]+"_"+r+"_");e=t+e,Xe.push(e)}}function AO(e){if(W.predefinedSymbolsInGlobalScope_doNotTrackInDependencies.indexOf(e)===-1&&Pl.indexOf(e)===-1&&Pl.indexOf("'"+e)===-1&&!zi){W.DEBUG&&console.log(`... adding symbol: ${e} to the set of the symbols left of assignment`);let t="";for(let r=1;r<Ke.length;r++)Ke[r]!==""&&(t+=Ke[r]+"_"+r+"_");e=t+e,Pl.push(e)}}function OO(){te!==pc&&Sn("symbol expected");let e;if(Ym&&typeof mt=="string"&&mt.length===1)switch(mt[0]){case"a":e=dt.symbol(W.METAA);break;case"b":e=dt.symbol(W.METAB);break;case"x":e=dt.symbol(W.METAX);break;default:e=dt.usr_symbol(mt)}else e=dt.usr_symbol(mt);return sa.length===0?(W.DEBUG&&console.log(`out of scanning parameters, processing ${mt}`),hc=mt,ji&&AO(mt)):(W.DEBUG&&console.log(`still scanning parameters, skipping ${mt}`),ji&&Hm("'"+mt)),W.DEBUG&&console.log(`found symbol: ${mt} left of assignment: ${ji}`),ji||Hm(mt),Pe(),e}function MO(){let e=new W.Str(mt);return Pe(),e}function TO(){W.DEBUG&&console.log("-- scan_function_call_with_function_name start");let e=1,r=[dt.usr_symbol(mt)],n=mt;if((n==="roots"||n==="defint"||n==="sum"||n==="product"||n==="for")&&Ke.push(mt),hc=mt,ji||Hm(mt),Pe(),Pe(),sa.push(!0),te!==")"){for(r.push(fi()),e++;te===",";)Pe(),e===2&&Ke[Ke.length-1].indexOf("roots")!==-1&&(Xe=Xe.filter(i=>!new RegExp("roots_"+(Ke.length-1)+"_"+mt).test(i)),zi=!0),e===2&&Ke[Ke.length-1].indexOf("sum")!==-1&&(Xe=Xe.filter(i=>!new RegExp("sum_"+(Ke.length-1)+"_"+mt).test(i)),zi=!0),e===2&&Ke[Ke.length-1].indexOf("product")!==-1&&(Xe=Xe.filter(i=>!new RegExp("product_"+(Ke.length-1)+"_"+mt).test(i)),zi=!0),e===2&&Ke[Ke.length-1].indexOf("for")!==-1&&(Xe=Xe.filter(i=>!new RegExp("for_"+(Ke.length-1)+"_"+mt).test(i)),zi=!0),Ke[Ke.length-1].indexOf("defint")!==-1&&(e===2||e>2&&(e-2)%3==0)&&(Xe=Xe.filter(i=>!new RegExp("defint_"+(Ke.length-1)+"_"+mt).test(i)),zi=!0),r.push(fi()),zi=!1,e++;e===2&&Ke[Ke.length-1].indexOf("roots")!==-1&&(Xe=Xe.filter(i=>!new RegExp("roots_"+(Ke.length-1)+"_x").test(i)))}sa.pop();for(let i=0;i<=Xe.length;i++)Xe[i]!=null&&(n==="roots"&&(Xe[i]=Xe[i].replace(new RegExp("roots_"+(Ke.length-1)+"_"),"")),n==="defint"&&(Xe[i]=Xe[i].replace(new RegExp("defint_"+(Ke.length-1)+"_"),"")),n==="sum"&&(Xe[i]=Xe[i].replace(new RegExp("sum_"+(Ke.length-1)+"_"),"")),n==="product"&&(Xe[i]=Xe[i].replace(new RegExp("product_"+(Ke.length-1)+"_"),"")),n==="for"&&(Xe[i]=Xe[i].replace(new RegExp("for_"+(Ke.length-1)+"_"),"")));return te!==")"&&Sn(") expected"),Pe(),(n==="roots"||n==="defint"||n==="sum"||n==="product"||n==="for")&&Ke.pop(),n===dt.symbol(W.PATTERN).printname&&(W.defs.patternHasBeenFound=!0),W.DEBUG&&console.log("-- scan_function_call_with_function_name end"),Zt.makeList(...r)}function NO(e){W.DEBUG&&console.log("-- scan_function_call_without_function_name start");let r=[Zt.makeList(dt.symbol(W.EVAL),e)];if(Pe(),sa.push(!0),te!==")")for(r.push(fi());te===",";)Pe(),r.push(fi());return sa.pop(),te!==")"&&Sn(") expected"),Pe(),W.DEBUG&&console.log(`-- scan_function_call_without_function_name end: ${r[r.length-1]}`),Zt.makeList(...r)}function IO(){let e=0;te!=="("&&Sn("( expected"),te=Pe();let t=fi();return te!==")"&&Sn(") expected"),Pe(),t}function SO(){te!=="["&&Sn("[ expected"),Pe();let e=[fi()];for(;te===",";)te=Pe(),e.push(fi());let t=wO(e);return te!=="]"&&Sn("] expected"),Pe(),t}function Sn(e){for(W.defs.errorMessage="";Qr!==J&&!((ye[Qr]===`
`||ye[Qr]==="\r")&&Qr+1===J);)W.defs.errorMessage+=ye[Qr++];for(W.defs.errorMessage+=" ? ";ye[Qr]&&ye[Qr]!==`
`&&ye[Qr]!=="\r";)W.defs.errorMessage+=ye[Qr++];W.defs.errorMessage+=`
`,bO.stop(e)}function wO(e){let t=_O.alloc_tensor(e.length);t.tensor.ndim=1,t.tensor.dim[0]=e.length;for(let r=0;r<e.length;r++)t.tensor.elem[r]=e[r];return yO.check_tensor_dimensions(t),t}function Pe(){for(Cl=0;RO(),te===Fm;)Cl=1;return W.DEBUG&&console.log(`get_next_token token: ${te}`),te}function RO(){for(;Fi.isspace(ye[J]);){if(ye[J]===`
`||ye[J]==="\r"){te=Fm,J++;return}J++}if(oa=J,J===ye.length){te="";return}if(Fi.isdigit(ye[J])||ye[J]==="."){for(;Fi.isdigit(ye[J]);)J++;if(ye[J]==="."){for(J++;Fi.isdigit(ye[J]);)J++;if(ye[J]==="e"&&(ye[J+1]==="+"||ye[J+1]==="-"||Fi.isdigit(ye[J+1])))for(J+=2;Fi.isdigit(ye[J]);)J++;te=Bm}else te=Um;Qm(oa,J);return}if(Fi.isalpha(ye[J])){for(;Fi.isalnumorunderscore(ye[J]);)J++;ye[J]==="("?te=Gm:te=pc,Qm(oa,J);return}if(ye[J]==='"'){for(J++;ye[J]!=='"';)J===ye.length-1&&(J++,Sn("runaway string"),J--),J++;J++,te=jm,Qm(oa+1,J-1);return}if(ye[J]==="#"||ye[J]==="-"&&ye[J+1]==="-"){for(;ye[J]&&ye[J]!==`
`&&ye[J]!=="\r";)J++;ye[J]&&J++,te=Fm;return}if(ye[J]===":"&&ye[J+1]==="="){J+=2,te=zm;return}if(ye[J]==="="&&ye[J+1]==="="){J+=2,te=fv;return}if(ye[J]==="!"&&ye[J+1]==="="){J+=2,te=dv;return}if(ye[J]==="<"&&ye[J+1]==="="){J+=2,te=cv;return}if(ye[J]===">"&&ye[J+1]==="="){J+=2,te=uv;return}te=ye[J++]}function Qm(e,t){mt=ye.substring(e,t)}});var Rn=A(Vi=>{"use strict";Object.defineProperty(Vi,"__esModule",{value:!0});Vi.yyfloat=Vi.zzfloat=Vi.Eval_float=void 0;var r4=Oc(),wn=N(),n4=Ee(),_v=U(),bv=j(),Ac=G(),LO=ee(),CO=Et();function PO(e){return wn.evalFloats(()=>Ac.Eval(Wm(Ac.Eval(wn.cadr(e)))))}Vi.Eval_float=PO;function DO(e){return wn.evalFloats(()=>{e=Ac.Eval(e),e=Wm(e),e=Ac.Eval(e)}),e}Vi.zzfloat=DO;function Wm(e){return wn.evalFloats(Jm,e)}Vi.yyfloat=Wm;function Jm(e){return wn.iscons(e)?LO.makeList(...e.map(Jm)):wn.istensor(e)?(e=CO.copy_tensor(e),e.tensor.elem=e.tensor.elem.map(Jm),e):wn.isrational(e)?bv.bignum_float(e):e===_v.symbol(wn.PI)?wn.Constants.piAsDouble:e===_v.symbol(wn.E)?bv.double(Math.E):e}});var Km=A(ca=>{"use strict";Object.defineProperty(ca,"__esModule",{value:!0});ca.roots=ca.Eval_roots=void 0;var kO=St(),Le=N(),gv=Ee(),cr=U(),$O=Ie(),Mc=an(),he=ce(),z=j(),UO=yo(),ua=G(),BO=xs(),GO=Xr(),br=Q(),M=X(),He=xt(),Jt=Zi(),it={debug:e=>{Le.DEBUG&&console.log(e)}},FO=e=>[].concat(...e);function jO(e){let t=Le.cadr(e),r;Le.car(t)===cr.symbol(Le.SETQ)||Le.car(t)===cr.symbol(Le.TESTEQ)?r=he.subtract(ua.Eval(Le.cadr(t)),ua.Eval(Le.caddr(t))):(t=ua.Eval(t),Le.car(t)===cr.symbol(Le.SETQ)||Le.car(t)===cr.symbol(Le.TESTEQ)?r=he.subtract(ua.Eval(Le.cadr(t)),ua.Eval(Le.caddr(t))):r=t),t=ua.Eval(Le.caddr(e));let n=t===cr.symbol(Le.NIL)?GO.guess(r):t;return br.ispolyexpandedform(r,n)||gv.stop("roots: 1st argument is not a polynomial in the variable "+n),kl(r,n)}ca.Eval_roots=jO;function zO(e){return e.some(t=>br.iscomplexnumber(t))}function YO(e){return e.length<=2||br.isZeroAtomOrTensor(e[0])?!1:e.slice(1,e.length-1).every(t=>br.isZeroAtomOrTensor(t))}function Tc(e,t){let r=UO.coeff(e,t),n=r[r.length-1];return r.map(i=>M.divide(i,n))}function kl(e,t){if(Le.defs.recursionLevelNestedRadicalsRemoval>1)return cr.symbol(Le.NIL);it.debug(`checking if ${e} is a case of simple roots`);let r=Tc(e,t),n=[];if(YO(r)){it.debug(`yes, ${r[r.length-1]} is a case of simple roots`);let s=r.length,u=r[0],c=r.pop(),d=VO(s,c,u);n.push(...d)}else{let s=ZO(e,t);n.push(...s)}let i=n.length;if(i===0&&gv.stop("roots: the polynomial is not factorable, try nroots"),i===1)return n[0];$O.sort(n);let o=kO.alloc_tensor(i);o.tensor.ndim=1,o.tensor.dim[0]=i;for(let s=0;s<i;s++)o.tensor.elem[s]=n[s];return console.log(`roots returning ${o}`),o}ca.roots=kl;function VO(e,t,r){it.debug("getSimpleRoots"),e=e-1;let n=M.divide(He.power(r,z.rational(1,e)),He.power(t,z.rational(1,e))),i=[];if(e%2==0){for(let o=1;o<=e;o+=2){let s=M.multiply(n,He.power(Le.Constants.negOne,z.rational(o,e)));i.push(s),i.push(M.negate(s))}return i}for(let o=1;o<=e;o++){let s=M.multiply(n,He.power(Le.Constants.negOne,z.rational(o,e)));o%2==0&&(s=M.negate(s)),i.push(s)}return i}function ZO(e,t){let r=Tc(e,t);if(zO(r)||(e=BO.factorpoly(e,t)),Le.ismultiply(e)){let n=e.tail().map(i=>yv(i,t));return FO(n)}return yv(e,t)}function yv(e,t){if(Le.ispower(e)&&br.ispolyexpandedform(Le.cadr(e),t)&&br.isposint(Le.caddr(e))){let r=Tc(Le.cadr(e),t);return vv(r)}if(br.ispolyexpandedform(e,t)){let r=Tc(e,t);return vv(r)}return[]}function vv(e){let t=e.length;if(t===2){let r=e.pop(),n=e.pop();return XO(r,n)}if(t===3){let r=e.pop(),n=e.pop(),i=e.pop();return HO(r,n,i)}if(t===4){let r=e.pop(),n=e.pop(),i=e.pop(),o=e.pop();return QO(r,n,i,o)}if(t===5){let r=e.pop(),n=e.pop(),i=e.pop(),o=e.pop(),s=e.pop();return JO(r,n,i,o,s)}return[]}function XO(e,t){return[M.negate(M.divide(t,e))]}function HO(e,t,r){let n=He.power(he.subtract(He.power(t,z.integer(2)),M.multiply(M.multiply(z.integer(4),e),r)),z.rational(1,2)),i=M.divide(he.subtract(n,t),M.multiply(e,z.integer(2))),o=M.multiply(M.divide(M.negate(he.add(n,t)),e),z.rational(1,2));return[i,o]}function QO(e,t,r,n){let i=M.multiply(M.multiply(r,r),r),o=M.multiply(t,t),s=M.multiply(o,t),u=M.multiply(M.multiply(s,n),z.integer(-4)),c=M.multiply(s,z.integer(2)),d=M.multiply(z.integer(3),e),_=M.multiply(M.multiply(e,e),n),w=M.multiply(_,z.integer(27)),T=M.multiply(M.multiply(_,n),z.integer(-27)),k=M.multiply(M.multiply(e,r),t),Z=M.multiply(M.multiply(e,r),z.integer(3)),Y=M.multiply(z.integer(-4),M.multiply(e,i)),Ae=M.negate(M.multiply(k,z.integer(9))),tt=M.multiply(M.multiply(k,n),z.integer(18)),Ze=he.subtract(o,Z),ke=M.multiply(o,M.multiply(r,r)),st=M.divide(M.negate(t),d),Oe=M.multiply(He.power(Ze,z.integer(3)),z.integer(4)),at=Mc.absValFloat(Jt.simplify(Ze)),ir=Mc.absValFloat(Jt.simplify(he.add_all([tt,u,ke,Y,T]))),Gt=he.add_all([c,Ae,w]),qr=Jt.simplify(He.power(he.subtract(He.power(Gt,z.integer(2)),Oe),z.rational(1,2)));if(it.debug(">>>>>>>>>>>>>>>> actually using cubic formula <<<<<<<<<<<<<<< "),it.debug(`cubic: D0: ${Ze}`),it.debug(`cubic: D0 as float: ${at}`),it.debug(`cubic: DETERMINANT: ${ir}`),it.debug(`cubic: D1: ${Gt}`),br.isZeroAtomOrTensor(ir))return WO(e,t,r,n,{R_DELTA0_toBeCheckedIfZero:at,R_m_b_over_3a:st,R_DELTA0:Ze,R_b3:s,R_a_b_c:k});let It=!1,co=!1,Zn;for(;!It;){let ol=co?M.negate(qr):qr;Zn=Jt.simplify(He.power(M.multiply(he.add(ol,Gt),z.rational(1,2)),z.rational(1,3)));let os=Mc.absValFloat(Jt.simplify(Zn));it.debug(`cubic: C: ${Zn}`),it.debug(`cubic: C as absval and float: ${os}`),br.isZeroAtomOrTensor(os)?(it.debug(" cubic: C IS ZERO flipping the sign"),co=!0):It=!0}let el=M.multiply(M.multiply(Zn,d),z.integer(2)),xu=M.multiply(Le.Constants.imaginaryunit,He.power(z.integer(3),z.rational(1,2))),pu=he.add(Le.Constants.one,xu),tl=he.subtract(Le.Constants.one,xu),on=M.divide(Zn,d),Xn=st,hu=M.negate(on),rl=M.negate(M.divide(Ze,M.multiply(Zn,d))),sn=Jt.simplify(he.add_all([Xn,hu,rl])),fo=st,Hn=M.divide(M.multiply(on,pu),z.integer(2)),Au=M.divide(M.multiply(tl,Ze),el),nl=Jt.simplify(he.add_all([fo,Hn,Au])),il=st,Sd=M.divide(M.multiply(on,tl),z.integer(2)),is=M.divide(M.multiply(pu,Ze),el),Ou=Jt.simplify(he.add_all([il,Sd,is]));return[sn,nl,Ou]}function WO(e,t,r,n,i){let{R_DELTA0_toBeCheckedIfZero:o,R_m_b_over_3a:s,R_DELTA0:u,R_b3:c,R_a_b_c:d}=i;if(br.isZeroAtomOrTensor(o))return it.debug(" cubic: DETERMINANT IS ZERO and delta0 is zero"),[s];it.debug(" cubic: DETERMINANT IS ZERO and delta0 is not zero");let _=M.divide(he.subtract(M.multiply(e,M.multiply(n,z.integer(9))),M.multiply(t,r)),M.multiply(u,z.integer(2))),w=M.negate(c),T=M.negate(M.multiply(e,M.multiply(e,M.multiply(n,z.integer(9))))),k=M.multiply(d,z.integer(4)),Z=M.divide(he.add_all([k,T,w]),M.multiply(e,u));return[_,_,Z]}function JO(e,t,r,n,i){return it.debug(">>>>>>>>>>>>>>>> actually using quartic formula <<<<<<<<<<<<<<< "),br.isZeroAtomOrTensor(t)&&br.isZeroAtomOrTensor(n)&&!br.isZeroAtomOrTensor(r)&&!br.isZeroAtomOrTensor(i)?KO(e,t,r,n,i):br.isZeroAtomOrTensor(t)?eM(e,t,r,n,i):tM(e,t,r,n,i)}function KO(e,t,r,n,i){it.debug("biquadratic case");let o=kl(he.add(M.multiply(e,He.power(cr.symbol(Le.SECRETX),z.integer(2))),he.add(M.multiply(r,cr.symbol(Le.SECRETX)),i)),cr.symbol(Le.SECRETX)),s=[];for(let u of o.tensor.elem)s.push(Jt.simplify(He.power(u,z.rational(1,2)))),s.push(Jt.simplify(M.negate(He.power(u,z.rational(1,2)))));return s}function eM(e,t,r,n,i){let o=r,s=n,u=i,c=M.multiply(z.rational(5,2),o),d=he.subtract(M.multiply(z.integer(2),He.power(o,z.integer(2))),u),_=he.add(M.multiply(z.rational(-1,2),M.multiply(o,u)),he.add(M.divide(He.power(o,z.integer(3)),z.integer(2)),M.multiply(z.rational(-1,8),He.power(s,z.integer(2))))),w=he.add(He.power(cr.symbol(Le.SECRETX),z.integer(3)),he.add(M.multiply(c,He.power(cr.symbol(Le.SECRETX),z.integer(2))),he.add(M.multiply(d,cr.symbol(Le.SECRETX)),_)));it.debug(`resolventCubic: ${w}`);let T=kl(w,cr.symbol(Le.SECRETX));it.debug(`resolventCubicSolutions: ${T}`);let k=null;for(let qr of T.tensor.elem){it.debug(`examining solution: ${qr}`);let It=Mc.absValFloat(he.add(M.multiply(qr,z.integer(2)),o));if(it.debug(`abs value is: ${qr}`),!br.isZeroAtomOrTensor(It)){k=qr;break}}it.debug(`chosen solution: ${k}`);let Z=Jt.simplify(He.power(he.add(M.multiply(k,z.integer(2)),o),z.rational(1,2))),Y=Jt.simplify(M.divide(M.multiply(s,z.integer(2)),Z)),Ae=he.add(M.multiply(o,z.integer(3)),M.multiply(k,z.integer(2))),tt=Jt.simplify(He.power(M.negate(he.add(Ae,Y)),z.rational(1,2))),Ze=M.divide(he.add(Z,tt),z.integer(2)),ke=Jt.simplify(He.power(M.negate(he.add(Ae,Y)),z.rational(1,2))),st=M.divide(he.subtract(Z,ke),z.integer(2)),Oe=Jt.simplify(He.power(M.negate(he.subtract(Ae,Y)),z.rational(1,2))),at=M.divide(he.add(M.negate(Z),Oe),z.integer(2)),ir=Jt.simplify(He.power(M.negate(he.subtract(Ae,Y)),z.rational(1,2))),Gt=M.divide(he.subtract(M.negate(Z),ir),z.integer(2));return[Ze,st,at,Gt]}function tM(e,t,r,n,i){let o=M.divide(he.add(M.multiply(z.integer(8),M.multiply(r,e)),M.multiply(z.integer(-3),He.power(t,z.integer(2)))),M.multiply(z.integer(8),He.power(e,z.integer(2)))),s=M.divide(he.add(He.power(t,z.integer(3)),he.add(M.multiply(z.integer(-4),M.multiply(e,M.multiply(t,r))),M.multiply(z.integer(8),M.multiply(n,He.power(e,z.integer(2)))))),M.multiply(z.integer(8),He.power(e,z.integer(3)))),u=M.multiply(M.multiply(e,e),e),c=M.multiply(t,t),d=M.multiply(M.multiply(e,e),n),_=M.divide(he.add(M.multiply(He.power(t,z.integer(4)),z.integer(-3)),he.add(M.multiply(z.integer(256),M.multiply(u,i)),he.add(M.multiply(z.integer(-64),M.multiply(d,t)),M.multiply(z.integer(16),M.multiply(c,M.multiply(e,r)))))),M.multiply(z.integer(256),He.power(e,z.integer(4)))),w=He.power(cr.symbol(Le.SECRETX),z.integer(4)),T=M.multiply(o,He.power(cr.symbol(Le.SECRETX),z.integer(2))),k=M.multiply(s,cr.symbol(Le.SECRETX)),Z=Jt.simplify(he.add_all([w,T,k,_])),Y=kl(Z,cr.symbol(Le.SECRETX));return it.debug(`p for depressed quartic: ${o}`),it.debug(`q for depressed quartic: ${s}`),it.debug(`r for depressed quartic: ${_}`),it.debug(`4 * x^4: ${w}`),it.debug(`R_p * x^2: ${T}`),it.debug(`R_q * x: ${k}`),it.debug(`R_r: ${_}`),it.debug(`solving depressed quartic: ${Z}`),it.debug(`depressedSolutions: ${Y}`),Y.tensor.elem.map(Ae=>{let tt=Jt.simplify(he.subtract(Ae,M.divide(t,M.multiply(z.integer(4),e))));return it.debug(`solution from depressed: ${tt}`),tt})}});var xv=A(Ic=>{"use strict";Object.defineProperty(Ic,"__esModule",{value:!0});Ic.simfac=void 0;var be=N(),e_=U(),qv=Ie(),Xi=ce(),s4=G(),Nc=ho(),mn=Q(),fa=X();function rM(e){if(be.isadd(e)){let t=e.tail().map(Ev);return Xi.add_all(t)}return Ev(e)}Ic.simfac=rM;function Ev(e){if(!be.ismultiply(e))return e;let t=e.tail();for(;nM(t););return fa.multiply_all_noexpand(t)}function nM(e){for(let t=0;t<e.length;t++){let r=e[t];for(let n=0;n<e.length;n++){if(t===n)continue;let i=e[n];if(be.isfactorial(r)&&be.ispower(i)&&mn.isminusone(be.caddr(i))&&qv.equal(be.cadr(r),be.cadr(i)))return e[t]=Nc.factorial(Xi.subtract(be.cadr(r),be.Constants.one)),e[n]=be.Constants.one,!0;if(be.ispower(i)&&mn.isminusone(be.caddr(i))&&be.caadr(i)===e_.symbol(be.FACTORIAL)&&qv.equal(r,be.cadadr(i)))return e[t]=fa.reciprocate(Nc.factorial(Xi.add(r,be.Constants.negOne))),e[n]=be.Constants.one,!0;if(be.isfactorial(i)){let o=Xi.subtract(r,be.cadr(i));if(mn.isplusone(o))return e[t]=Nc.factorial(r),e[n]=be.Constants.one,!0}if(be.ispower(r)&&mn.isminusone(be.caddr(r))&&be.ispower(i)&&mn.isminusone(be.caddr(i))&&be.caadr(i)===e_.symbol(be.FACTORIAL)){let o=Xi.subtract(be.cadr(r),be.cadr(be.cadr(i)));if(mn.isplusone(o))return e[t]=fa.reciprocate(Nc.factorial(be.cadr(r))),e[n]=be.Constants.one,!0}if(be.isfactorial(r)&&be.ispower(i)&&mn.isminusone(be.caddr(i))&&be.caadr(i)===e_.symbol(be.FACTORIAL)){let o=Xi.subtract(be.cadr(r),be.cadr(be.cadr(i)));if(mn.isplusone(o))return e[t]=be.cadr(r),e[n]=be.Constants.one,!0;if(mn.isminusone(o))return e[t]=fa.reciprocate(be.cadr(be.cadr(i))),e[n]=be.Constants.one,!0;if(mn.equaln(o,2))return e[t]=be.cadr(r),e[n]=Xi.add(be.cadr(r),be.Constants.negOne),!0;if(mn.equaln(o,-2))return e[t]=fa.reciprocate(be.cadr(be.cadr(i))),e[n]=fa.reciprocate(Xi.add(be.cadr(be.cadr(i)),be.Constants.negOne)),!0}}}return!1}});var t_=A(da=>{"use strict";Object.defineProperty(da,"__esModule",{value:!0});da.decomp=da.Eval_decomp=void 0;var ze=N(),$l=or(),pv=U(),hv=Ie(),iM=ce(),Av=G(),oM=Xr(),sM=ee(),Ov=X();function aM(e){console.log("Eval_decomp is being called!!!!!!!!!!!!!!!!!!!!");let t=Av.Eval(ze.cadr(e));e=Av.Eval(ze.caddr(e));let r=e===pv.symbol(ze.NIL)?oM.guess(t):e,n=Ul(!1,t,r);return sM.makeList(pv.symbol(ze.NIL),...n)}da.Eval_decomp=aM;function lM(e,t){return e.length>0&&hv.equal(t,e[e.length-1])?!1:(e.push(t),!0)}function Ul(e,t,r){if(ze.DEBUG&&console.log(`DECOMPOSING ${t}`),e){if(!ze.iscons(t))return ze.DEBUG&&console.log(` ground thing: ${t}`),[t]}else if(!$l.Find(t,r))return ze.DEBUG&&console.log(" entire expression is constant"),[t];if(ze.isadd(t))return uM(e,t,r);if(ze.ismultiply(t))return cM(e,t,r);let n=ze.cdr(t);ze.DEBUG&&(console.log(" naive decomp"),console.log(`startig p3: ${n}`));let i=[];for(;ze.iscons(n);)e&&i.push(ze.car(n)),ze.DEBUG&&(console.log("recursive decomposition"),console.log(`car(p3): ${ze.car(n)}`),console.log(`p2: ${r}`)),i.push(...Ul(e,ze.car(n),r)),n=ze.cdr(n);return i}da.decomp=Ul;function uM(e,t,r){ze.DEBUG&&console.log(" decomposing the sum ");let n=ze.cdr(t),i=[];for(;ze.iscons(n);)($l.Find(ze.car(n),r)||e)&&i.push(...Ul(e,ze.car(n),r)),n=ze.cdr(n);n=ze.cdr(t);let o=[...n].filter(s=>!$l.Find(s,r));return o.length&&(n=iM.add_all(o),lM(i,n),i.push(Ov.negate(n))),i}function cM(e,t,r){ze.DEBUG&&console.log(" decomposing the product ");let n=ze.cdr(t),i=[];for(;ze.iscons(n);)($l.Find(ze.car(n),r)||e)&&i.push(...Ul(e,ze.car(n),r)),n=ze.cdr(n);n=ze.cdr(t);let o=[];for(;ze.iscons(n);){let s=ze.car(n);$l.Find(s,r)||(o.length<1||!hv.equal(s,o[o.length-1]))&&o.push(s),n=ze.cdr(n)}return o.length>0&&i.push(Ov.multiply_all(o)),i}});var n_=A(wc=>{"use strict";Object.defineProperty(wc,"__esModule",{value:!0});wc.transform=void 0;var ie=N(),Te=U(),fM=ce(),dM=i_(),mM=t_(),Sc=G(),Mv=Q(),_M=ee(),bM=Yi(),r_=Zr();function Tv(e,t,r,n){ie.DEBUG&&console.log(`         !!!!!!!!!   transform on: ${e}`);let i=gM();Te.set_binding(Te.symbol(ie.METAX),t);let o=dM.polyform(e,t),s=mM.decomp(n,o,t);if(ie.DEBUG){console.log(`  ${s.length} decomposed elements ====== `);for(let _=0;_<s.length;_++)console.log(`  decomposition element ${_}: ${s[_]}`)}let u=!1,c;if(n){if(!ie.isNumericAtom(e)){let _=r;ie.DEBUG&&(console.log(`applying transform: ${_}`),console.log(`scanning table entry ${_}`));let w=r_.subst(_,Te.symbol(ie.SYMBOL_A_UNDERSCORE),Te.symbol(ie.METAA));w=r_.subst(w,Te.symbol(ie.SYMBOL_B_UNDERSCORE),Te.symbol(ie.METAB));let T=r_.subst(w,Te.symbol(ie.SYMBOL_X_UNDERSCORE),Te.symbol(ie.METAX)),k=ie.car(T);ie.DEBUG&&console.log(`template expression: ${k}`),c=ie.cadr(T);let Z=ie.cddr(T);if(Nv([ie.Constants.one,...s],n,e,k,Z))u=!0;else{ie.DEBUG&&(console.log(`p3 at this point: ${e}`),console.log(`car(p3): ${ie.car(e)}`));let Y=[],Ae=e;for(ie.iscons(Ae)&&(Y.push(ie.car(e)),Ae=ie.cdr(e));ie.iscons(Ae);){let tt=ie.car(Ae);Ae=ie.cdr(Ae),ie.DEBUG&&(console.log(`testing: ${tt}`),console.log(`about to try to simplify other term: ${tt}`));let[Ze,ke]=Tv(tt,Te.symbol(ie.NIL),r,n);u=u||ke,Y.push(Ze),ie.DEBUG&&console.log(`tried to simplify other term: ${tt} ...successful?: ${ke} ...transformed: ${Y[Y.length-1]}`)}Y.length!==0&&(c=_M.makeList(...Y))}}}else for(let _ of Array.from(r))if(ie.DEBUG&&(console.log(`scanning table entry ${_}`),(_+"").indexOf("f(sqrt(a+b*x),2/3*1/b*sqrt((a+b*x)^3))")!==-1&&ie.breakpoint),_){let w=bM.scan_meta(_),T=ie.cadr(w);c=ie.caddr(w);let k=ie.cdddr(w);if(Nv([ie.Constants.one,...s],n,e,T,k)){u=!0;break}}let d=u?Sc.Eval(c):n?e:Te.symbol(ie.NIL);return yM(i),[d,u]}wc.transform=Tv;function gM(){return{METAA:Te.get_binding(Te.symbol(ie.METAA)),METAB:Te.get_binding(Te.symbol(ie.METAB)),METAX:Te.get_binding(Te.symbol(ie.METAX))}}function yM(e){Te.set_binding(Te.symbol(ie.METAX),e.METAX),Te.set_binding(Te.symbol(ie.METAB),e.METAB),Te.set_binding(Te.symbol(ie.METAA),e.METAA)}function Nv(e,t,r,n,i){for(let o of e){Te.set_binding(Te.symbol(ie.METAA),o),ie.DEBUG&&console.log(`  binding METAA to ${Te.get_binding(Te.symbol(ie.METAA))}`);for(let s of e){Te.set_binding(Te.symbol(ie.METAB),s),ie.DEBUG&&console.log(`  binding METAB to ${Te.get_binding(Te.symbol(ie.METAB))}`);let u=i;for(;ie.iscons(u);){let d=Sc.Eval(ie.car(u));if(Mv.isZeroAtomOrTensor(d))break;u=ie.cdr(u)}if(ie.iscons(u))continue;let c=t?ie.noexpand(Sc.Eval,n):Sc.Eval(n);if(ie.DEBUG&&(console.log(`about to evaluate template expression: ${n} binding METAA to ${Te.get_binding(Te.symbol(ie.METAA))} and binding METAB to ${Te.get_binding(Te.symbol(ie.METAB))} and binding METAX to ${Te.get_binding(Te.symbol(ie.METAX))}`),console.log(`  comparing ${c} to: ${r}`)),Mv.isZeroAtomOrTensor(fM.subtract(r,c)))return ie.DEBUG&&(console.log(`binding METAA to ${Te.get_binding(Te.symbol(ie.METAA))}`),console.log(`binding METAB to ${Te.get_binding(Te.symbol(ie.METAB))}`),console.log(`binding METAX to ${Te.get_binding(Te.symbol(ie.METAX))}`),console.log(`comparing ${r} to: ${n}`)),!0}}return!1}});var a_=A(ba=>{"use strict";Object.defineProperty(ba,"__esModule",{value:!0});ba.transpose=ba.Eval_transpose=void 0;var vM=St(),Ue=N(),qM=Ee(),ma=U(),_a=Ie(),EM=ce(),o_=j(),s_=G(),xM=Gi(),Pr=Q(),Iv=ee(),pM=X();function hM(e){let t=s_.Eval(Ue.cadr(e)),r=Ue.Constants.one,n=o_.integer(2);return Ue.cddr(e)!==ma.symbol(Ue.NIL)&&(r=s_.Eval(Ue.caddr(e)),n=s_.Eval(Ue.cadddr(e))),Bl(t,r,n)}ba.Eval_transpose=hM;function Bl(e,t,r){let n=0,i=Array(Ue.MAXDIM).fill(0),o=Array(Ue.MAXDIM).fill(0);if(Ue.isNumericAtom(e)||(Pr.isplusone(t)&&Pr.isplustwo(r)||Pr.isplusone(r)&&Pr.isplustwo(t))&&Ue.isidentitymatrix(e))return e;if(Ue.istranspose(e)){let T=Ue.car(Ue.cdr(Ue.cdr(e))),k=Ue.car(Ue.cdr(Ue.cdr(Ue.cdr(e))));if(_a.equal(T,r)&&_a.equal(k,t)||_a.equal(k,r)&&_a.equal(T,t)||_a.equal(T,ma.symbol(Ue.NIL))&&_a.equal(k,ma.symbol(Ue.NIL))&&(Pr.isplusone(r)&&Pr.isplustwo(t)||Pr.isplusone(t)&&Pr.isplustwo(r)))return Ue.car(Ue.cdr(e))}if(Ue.defs.expanding&&Ue.isadd(e))return e.tail().reduce((T,k)=>EM.add(T,Bl(k,t,r)),Ue.Constants.zero);if(Ue.defs.expanding&&Ue.ismultiply(e))return e.tail().reduce((T,k)=>pM.multiply(T,Bl(k,t,r)),Ue.Constants.one);if(Ue.defs.expanding&&Ue.isinnerordot(e)){let T=[];return Ue.iscons(e)&&T.push(...e.tail().map(k=>[k,t,r])),T.reverse(),T.reduce((k,Z)=>xM.inner(k,Bl(Z[0],Z[1],Z[2])),ma.symbol(Ue.SYMBOL_IDENTITY_MATRIX))}if(!Ue.istensor(e))return Pr.isZeroAtomOrTensor(e)?Ue.Constants.zero:(!Pr.isplusone(t)||!Pr.isplustwo(r))&&(!Pr.isplusone(r)||!Pr.isplustwo(t))?Iv.makeList(ma.symbol(Ue.TRANSPOSE),e,t,r):Iv.makeList(ma.symbol(Ue.TRANSPOSE),e);let{ndim:s,nelem:u}=e.tensor;if(s===1)return e;let c=o_.nativeInt(t),d=o_.nativeInt(r);(c<1||c>s||d<1||d>s)&&qM.stop("transpose: index out of range"),c--,d--,t=vM.alloc_tensor(u),t.tensor.ndim=s,t.tensor.dim=[...e.tensor.dim],t.tensor.dim[c]=e.tensor.dim[d],t.tensor.dim[d]=e.tensor.dim[c];let _=e.tensor.elem,w=t.tensor.elem;for(let T=0;T<s;T++)i[T]=0,o[T]=e.tensor.dim[T];for(let T=0;T<u;T++){n=i[c],i[c]=i[d],i[d]=n,n=o[c],o[c]=o[d],o[d]=n;let k=0;for(let Z=0;Z<s;Z++)k=k*o[Z]+i[Z];n=i[c],i[c]=i[d],i[d]=n,n=o[c],o[c]=o[d],o[d]=n,w[k]=_[T];for(let Z=s-1;Z>=0&&!(++i[Z]<o[Z]);Z--)i[Z]=0}return t}ba.transpose=Bl});var Zi=A(Ln=>{"use strict";Object.defineProperty(Ln,"__esModule",{value:!0});Ln.simplify_trig=Ln.simplify=Ln.simplifyForCodeGeneration=Ln.Eval_simplify=void 0;var AM=St(),_t=Oc(),I=N(),Mo=or(),l_=Ee(),Qe=U(),mi=ce(),Dt=j(),OM=Du(),u_=gl(),To=G(),No=Rn(),MM=Gi(),Ut=Q(),Sv=ee(),ga=Ie(),Be=X(),TM=ku(),_n=xt(),Hi=yl(),Io=Bs(),NM=ti(),IM=Km(),wv=xv(),SM=Et(),wM=n_(),RM=a_(),LM=Tn(),Rv=bo(),c_=dl(),CM=si();function PM(e){let t=Lv(I.cadr(e));return Wr(To.Eval(t))}Ln.Eval_simplify=PM;function Lv(e){if(I.defs.userSimplificationsInListForm.length===0||Mo.Find(e,Qe.symbol(I.INTEGRAL)))return e;I.DEBUG&&console.log(`runUserDefinedSimplifications passed: ${e}`);let t=I.noexpand(To.Eval,e);if(I.DEBUG){console.log(`runUserDefinedSimplifications after eval no expanding: ${t}`),console.log("patterns to be checked: ");for(let i of Array.from(I.defs.userSimplificationsInListForm))console.log(`...${i}`)}let r=!0,n=0;for(;r&&n<I.MAX_CONSECUTIVE_APPLICATIONS_OF_ALL_RULES;){r=!1,n++;for(let i of Array.from(I.defs.userSimplificationsInListForm)){let o=!0,s=0;for(;o&&s<I.MAX_CONSECUTIVE_APPLICATIONS_OF_SINGLE_RULE;)s++,I.DEBUG&&console.log(`simplify - checking pattern: ${i} on: ${t}`),[t,o]=wM.transform(t,Qe.symbol(I.NIL),i,!0),o&&(r=!0),I.DEBUG&&console.log(`p1 at this stage of simplification: ${t}`);s===I.MAX_CONSECUTIVE_APPLICATIONS_OF_SINGLE_RULE&&l_.stop(`maximum application of single transformation rule exceeded: ${i}`)}}return n===I.MAX_CONSECUTIVE_APPLICATIONS_OF_ALL_RULES&&l_.stop("maximum application of all transformation rules exceeded "),I.DEBUG&&(console.log(`METAX = ${Qe.get_binding(Qe.symbol(I.METAX))}`),console.log(`METAA = ${Qe.get_binding(Qe.symbol(I.METAA))}`),console.log(`METAB = ${Qe.get_binding(Qe.symbol(I.METAB))}`)),t}function DM(e){let t=Lv(e);I.defs.codeGen=!0;let r=Wr(t);return I.defs.codeGen=!1,r}Ln.simplifyForCodeGeneration=DM;function Wr(e){if(I.defs.codeGen&&I.car(e)===Qe.symbol(I.FUNCTION)){let t=I.cadr(e),r=Wr(To.Eval(t)),n=I.caddr(e);e=Sv.makeList(Qe.symbol(I.FUNCTION),r,n)}if(I.istensor(e))return kM(e);if(Mo.Find(e,Qe.symbol(I.FACTORIAL))){let t=wv.simfac(e),r=wv.simfac(Hi.rationalize(e));e=_t.count(t)<_t.count(r)?t:r}if(e=GM(e),e=$M(e),e=UM(e),e=BM(e),e=FM(e),e=Cv(e),e=zM(e),e=VM(e),I.do_simplify_nested_radicals){let t;if([t,e]=ZM(e),t)return I.DEBUG&&console.log("de-nesting successful into: "+e.toString()),Wr(e)}return e=YM(e),e=Pv(e),e}Ln.simplify=Wr;function kM(e){let t=AM.alloc_tensor(e.tensor.nelem);return t.tensor.ndim=e.tensor.ndim,t.tensor.dim=Array.from(e.tensor.dim),t.tensor.elem=e.tensor.elem.map(Wr),SM.check_tensor_dimensions(t),Ut.isZeroAtomOrTensor(t)&&(t=I.Constants.zero),t}function $M(e){if(!I.isadd(e))return e;let t=Hi.rationalize(e);return _t.count(t)<_t.count(e)&&(e=t),e}function UM(e){if(!I.isadd(e))return e;let t=u_.Condense(e);return _t.count(t)<=_t.count(e)&&(e=t),e}function BM(e){let t=Hi.rationalize(Be.negate(Hi.rationalize(Be.negate(Hi.rationalize(e)))));return _t.count(t)<_t.count(e)&&(e=t),e}function GM(e){let t=I.car(e);if((t===Qe.symbol(I.MULTIPLY)||I.isinnerordot(e))&&I.car(I.car(I.cdr(e)))===Qe.symbol(I.TRANSPOSE)&&I.car(I.car(I.cdr(I.cdr(e))))===Qe.symbol(I.TRANSPOSE)){I.DEBUG&&console.log(`maybe collecting a transpose ${e}`);let r=I.cadr(I.car(I.cdr(e))),n=I.cadr(I.car(I.cdr(I.cdr(e)))),i;t===Qe.symbol(I.MULTIPLY)?i=Be.multiply(r,n):I.isinnerordot(e)?i=MM.inner(n,r):i=l_.stop("f10: nothing to pop.");let o=I.noexpand(()=>RM.transpose(i,I.Constants.one,Dt.integer(2)));_t.count(o)<_t.count(e)&&(e=o),I.DEBUG&&console.log(`collecting a transpose ${o}`)}return e}function FM(e){if(Ut.isZeroAtomOrTensor(e))return e;let t=Hi.rationalize(Be.inverse(Hi.rationalize(Be.inverse(Hi.rationalize(e)))));return _t.count(t)<_t.count(e)&&(e=t),e}function jM(e){return Cv(e)}Ln.simplify_trig=jM;function Cv(e){if(!Mo.Find(e,Qe.symbol(I.SIN))&&!Mo.Find(e,Qe.symbol(I.COS)))return e;let t=e;I.defs.trigmode=1;let r=To.Eval(t);I.defs.trigmode=2;let n=To.Eval(t);return I.defs.trigmode=0,(_t.count(n)<_t.count(r)||Rc(n)<Rc(r))&&(r=n),(_t.count(r)<_t.count(e)||Rc(r)<Rc(e))&&(e=r),e}function zM(e){if(!I.isadd(e))return e;let t=I.cdr(e);return I.iscons(t)&&(t=[...t].reduce((r,n)=>Pv(mi.add(r,Wr(n))),I.Constants.zero)),_t.count(t)<_t.count(e)&&(e=t),e}function Pv(e){var t,r,n,i,o;if(t=LM.denominator(e),Ut.isone(t)||(r=CM.numerator(e),Ut.isone(r))||!(i=Rv.areunivarpolysfactoredorexpandedform(r,t))||(o=c_.factor(Rv.gcd(r,t),i),Ut.isone(o)))return e;let s=c_.factor(r,i),u=Be.inverse(o),c=Be.multiply_noexpand(s,u),d=Wr(c),_=c_.factor(t,i),w=Be.multiply_noexpand(_,u),T=Wr(w),k=Be.divide(d,T);return n=u_.Condense(k),_t.count(n)<_t.count(e)?n:e}function YM(e){let t;return!Mo.Find(e,Qe.symbol(I.SIN))&&!Mo.Find(e,Qe.symbol(I.COS))||(t=OM.clockform(To.Eval(e)),I.DEBUG&&console.log(`before simplification clockform: ${e} after: ${t}`),_t.count(t)<_t.count(e)&&(e=t)),e}function VM(e){let t=f_(e),r=To.Eval(t);return _t.count(r)<_t.count(e)&&(e=r),e}function f_(e){if(Ut.isimaginaryunit(e))return e;if(ga.equal(I.car(e),Qe.symbol(I.POWER))&&Ut.isminusone(I.cadr(e))){let t=Be.negate(I.Constants.one),r=f_(I.caddr(e));return NM.rect(TM.polar(_n.power(t,r)))}else return I.iscons(e)?e.map(f_):e}function Rc(e){return I.isadd(e)?ga.length(e)-1:1}function ZM(e){if(I.defs.recursionLevelNestedRadicalsRemoval>0)return I.DEBUG&&console.log("denesting bailing out because of too much recursion"),[!1,e];let[t,r]=Lc(e),n=I.noexpand(u_.yycondense,t);return e=_t.countOccurrencesOfSymbol(Qe.symbol(I.POWER),t)<_t.countOccurrencesOfSymbol(Qe.symbol(I.POWER),n)?t:n,[r,e]}function Lc(e){return I.defs.recursionLevelNestedRadicalsRemoval>0?(I.DEBUG&&console.log("denesting bailing out because of too much recursion"),[e,!1]):ga.equal(I.car(e),Qe.symbol(I.POWER))?XM(e):I.iscons(e)?QM(e):[e,!1]}function XM(e){let t=I.cadr(e),r=I.caddr(e);if(Ut.isminusone(r)||!ga.equal(I.car(t),Qe.symbol(I.ADD))||!Ut.isfraction(r)||!Ut.equalq(r,1,3)&&!Ut.equalq(r,1,2))return[e,!1];let n=I.cadr(t);Lc(n);let i=I.caddr(t);Lc(i);let o=0,s=t;for(;I.cdr(s)!==Qe.symbol(I.NIL);)o++,s=I.cdr(s);if(o>2)return[e,!1];let{commonBases:u,termsThatAreNotPowers:c}=HM(i);if(u.length===0)return[e,!1];let d=n,_=u.reduce(Be.multiply,I.Constants.one),w=c.reduce(Be.multiply,I.Constants.one),T;if(Ut.equalq(r,1,3)){let ke=Be.divide(Be.multiply(Be.negate(d),_),w),st=Dt.nativeDouble(No.yyfloat(Io.real(ke)));if(Math.abs(st)>Math.pow(2,32))return[e,!1];let Oe=Be.multiply(Dt.integer(3),_),at=Dt.nativeDouble(No.yyfloat(Io.real(Oe)));if(Math.abs(at)>Math.pow(2,32))return[e,!1];let ir=Be.multiply(Oe,Qe.symbol(I.SECRETX)),Gt=Be.divide(Be.multiply(Dt.integer(-3),d),w),qr=Dt.nativeDouble(No.yyfloat(Io.real(Gt)));if(Math.abs(qr)>Math.pow(2,32))return[e,!1];T=mi.add_all([ke,ir,Be.multiply(Gt,_n.power(Qe.symbol(I.SECRETX),Dt.integer(2))),Be.multiply(I.Constants.one,_n.power(Qe.symbol(I.SECRETX),Dt.integer(3)))])}else if(Ut.equalq(r,1,2)){let ke=Dt.nativeDouble(No.yyfloat(Io.real(_)));if(Math.abs(ke)>Math.pow(2,32))return[e,!1];let st=Be.divide(Be.multiply(Dt.integer(-2),d),w),Oe=Dt.nativeDouble(No.yyfloat(Io.real(st)));if(Math.abs(Oe)>Math.pow(2,32))return[e,!1];T=mi.add(_,mi.add(Be.multiply(st,Qe.symbol(I.SECRETX)),Be.multiply(I.Constants.one,_n.power(Qe.symbol(I.SECRETX),Dt.integer(2)))))}I.defs.recursionLevelNestedRadicalsRemoval++;let k=IM.roots(T,Qe.symbol(I.SECRETX));if(I.defs.recursionLevelNestedRadicalsRemoval--,ga.equal(k,Qe.symbol(I.NIL)))return I.DEBUG&&console.log("roots bailed out because of too much recursion"),[e,!1];let Z=k.elem.filter(ke=>!Mo.Find(ke,Qe.symbol(I.POWER)));if(Z.length===0)return[e,!1];let Y=[],Ae=[];for(let ke of Array.from(Z)){let st=Dt.nativeDouble(No.yyfloat(Io.real(ke)));Y.push(ke),Ae.push(st)}let tt=Ae.indexOf(Math.max.apply(Math,Ae)),Ze=Y[tt];if(!Ut.equalq(r,1,3)&&!Ut.equalq(r,1,2))return[e,!1];if(Ut.equalq(r,1,3)){let ke=_n.power(Be.divide(d,mi.add(_n.power(Ze,Dt.integer(3)),Be.multiply(Be.multiply(Dt.integer(3),_),Ze))),Dt.rational(1,3)),st=Be.multiply(ke,Ze);return[Wr(mi.add(Be.multiply(ke,_n.power(_,Dt.rational(1,2))),st)),!0]}if(Ut.equalq(r,1,2)){let ke=_n.power(Be.divide(d,mi.add(_n.power(Ze,Dt.integer(2)),_)),Dt.rational(1,2)),st=Be.multiply(ke,Ze),Oe=Wr(mi.add(Be.multiply(ke,_n.power(_,Dt.rational(1,2))),st)),at=No.yyfloat(Io.real(Oe));return Ut.isnegativenumber(at)?[Wr(mi.add(Be.multiply(Be.negate(ke),_n.power(_,Dt.rational(1,2))),Be.negate(st))),!0]:[Oe,!0]}return[null,!0]}function HM(e){let t=null,r=[],n=[];if(I.ismultiply(e)){let i=I.cdr(e);if(I.iscons(i))for(;I.iscons(i);){let o=I.car(i);if(I.ispower(o)){let s=I.cadr(o),u=I.caddr(o);Ut.equalq(u,1,2)&&(t==null?(t=u,r.push(s)):ga.equal(u,t)&&r.push(s))}else n.push(o);i=I.cdr(i)}}else if(I.ispower(e)){let i=I.cadr(e),o=I.caddr(e);t==null&&Ut.equalq(o,1,2)&&(t=o,r.push(i))}return{commonBases:r,termsThatAreNotPowers:n}}function QM(e){let t=!1,r=[];if(I.iscons(e)){let n=Array.from(e).map(i=>{if(!t){let o;return[o,t]=Lc(i),o}return i});r.push(...n)}return[Sv.makeList(...r),t]}});var Fl=A(Qi=>{"use strict";Object.defineProperty(Qi,"__esModule",{value:!0});Qi.make_hashed_itab=Qi.integral=Qi.Eval_integral=void 0;var me=N(),ya=or(),Dv=Ee(),Cn=U(),WM=Ie(),JM=ce(),kv=j(),KM=Ro(),So=G(),$v=Xr(),Gl=Q(),Uv=ee(),eT=X(),tT=av(),rT=Yi(),nT=Zi(),iT=n_(),oT=["f(a,a*x)","f(1/x,log(x))","f(x^a,x^(a+1)/(a+1))","f(x^(-2),-x^(-1))","f(x^(-1/2),2*x^(1/2))","f(x^(1/2),2/3*x^(3/2))","f(x,x^2/2)","f(x^2,x^3/3)","f(exp(a*x),1/a*exp(a*x))","f(exp(a*x+b),1/a*exp(a*x+b))","f(x*exp(a*x^2),exp(a*x^2)/(2*a))","f(x*exp(a*x^2+b),exp(a*x^2+b)/(2*a))","f(log(a*x),x*log(a*x)-x)","f(a^x,a^x/log(a),or(not(number(a)),a>0))","f(1/(a+x^2),1/sqrt(a)*arctan(x/sqrt(a)),or(not(number(a)),a>0))","f(1/(a-x^2),1/sqrt(a)*arctanh(x/sqrt(a)))","f(1/sqrt(a-x^2),arcsin(x/(sqrt(a))))","f(1/sqrt(a+x^2),log(x+sqrt(a+x^2)))","f(1/(a+b*x),1/b*log(a+b*x))","f(1/(a+b*x)^2,-1/(b*(a+b*x)))","f(1/(a+b*x)^3,-1/(2*b)*1/(a+b*x)^2)","f(x/(a+b*x),x/b-a*log(a+b*x)/b/b)","f(x/(a+b*x)^2,1/b^2*(log(a+b*x)+a/(a+b*x)))","f(x^2/(a+b*x),1/b^2*(1/2*(a+b*x)^2-2*a*(a+b*x)+a^2*log(a+b*x)))","f(x^2/(a+b*x)^2,1/b^3*(a+b*x-2*a*log(a+b*x)-a^2/(a+b*x)))","f(x^2/(a+b*x)^3,1/b^3*(log(a+b*x)+2*a/(a+b*x)-1/2*a^2/(a+b*x)^2))","f(1/x*1/(a+b*x),-1/a*log((a+b*x)/x))","f(1/x*1/(a+b*x)^2,1/a*1/(a+b*x)-1/a^2*log((a+b*x)/x))","f(1/x*1/(a+b*x)^3,1/a^3*(1/2*((2*a+b*x)/(a+b*x))^2+log(x/(a+b*x))))","f(1/x^2*1/(a+b*x),-1/(a*x)+b/a^2*log((a+b*x)/x))","f(1/x^3*1/(a+b*x),(2*b*x-a)/(2*a^2*x^2)+b^2/a^3*log(x/(a+b*x)))","f(1/x^2*1/(a+b*x)^2,-(a+2*b*x)/(a^2*x*(a+b*x))+2*b/a^3*log((a+b*x)/x))","f(1/(a+b*x^2),1/sqrt(a*b)*arctan(x*sqrt(a*b)/a),or(not(number(a*b)),a*b>0))","f(1/(a+b*x^2),1/(2*sqrt(-a*b))*log((a+x*sqrt(-a*b))/(a-x*sqrt(-a*b))),or(not(number(a*b)),a*b<0))","f(x/(a+b*x^2),1/2*1/b*log(a+b*x^2))","f(x^2/(a+b*x^2),x/b-a/b*integral(1/(a+b*x^2),x))","f(1/(a+b*x^2)^2,x/(2*a*(a+b*x^2))+1/2*1/a*integral(1/(a+b*x^2),x))","f(1/x*1/(a+b*x^2),1/2*1/a*log(x^2/(a+b*x^2)))","f(1/x^2*1/(a+b*x^2),-1/(a*x)-b/a*integral(1/(a+b*x^2),x))","f(1/(a+b*x^3),1/3*1/a*(a/b)^(1/3)*(1/2*log(((a/b)^(1/3)+x)^3/(a+b*x^3))+sqrt(3)*arctan((2*x-(a/b)^(1/3))*(a/b)^(-1/3)/sqrt(3))))","f(x^2/(a+b*x^3),1/3*1/b*log(a+b*x^3))","f(x/(a+b*x^4),1/2*sqrt(b/a)/b*arctan(x^2*sqrt(b/a)),or(not(number(a*b)),a*b>0))","f(x/(a+b*x^4),1/4*sqrt(-b/a)/b*log((x^2-sqrt(-a/b))/(x^2+sqrt(-a/b))),or(not(number(a*b)),a*b<0))","f(x^3/(a+b*x^4),1/4*1/b*log(a+b*x^4))","f(sqrt(a+b*x),2/3*1/b*sqrt((a+b*x)^3))","f(x*sqrt(a+b*x),-2*(2*a-3*b*x)*sqrt((a+b*x)^3)/15/b^2)","f(x^2*sqrt(a+b*x),2*(8*a^2-12*a*b*x+15*b^2*x^2)*sqrt((a+b*x)^3)/105/b^3)","f(sqrt(a+b*x)/x,2*sqrt(a+b*x)+a*integral(1/x*1/sqrt(a+b*x),x))","f(sqrt(a+b*x)/x^2,-sqrt(a+b*x)/x+b/2*integral(1/x*1/sqrt(a+b*x),x))","f(1/sqrt(a+b*x),2*sqrt(a+b*x)/b)","f(x/sqrt(a+b*x),-2/3*(2*a-b*x)*sqrt(a+b*x)/b^2)","f(x^2/sqrt(a+b*x),2/15*(8*a^2-4*a*b*x+3*b^2*x^2)*sqrt(a+b*x)/b^3)","f(1/x*1/sqrt(a+b*x),1/sqrt(a)*log((sqrt(a+b*x)-sqrt(a))/(sqrt(a+b*x)+sqrt(a))),or(not(number(a)),a>0))","f(1/x*1/sqrt(a+b*x),2/sqrt(-a)*arctan(sqrt(-(a+b*x)/a)),or(not(number(a)),a<0))","f(1/x^2*1/sqrt(a+b*x),-sqrt(a+b*x)/a/x-1/2*b/a*integral(1/x*1/sqrt(a+b*x),x))","f(sqrt(x^2+a),1/2*(x*sqrt(x^2+a)+a*log(x+sqrt(x^2+a))))","f(1/sqrt(x^2+a),log(x+sqrt(x^2+a)))","f(1/x*1/sqrt(x^2+a),arcsec(x/sqrt(-a))/sqrt(-a),or(not(number(a)),a<0))","f(1/x*1/sqrt(x^2+a),-1/sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(-a)*arcsec(x/sqrt(-a)),or(not(number(a)),a<0))","f(x/sqrt(x^2+a),sqrt(x^2+a))","f(x*sqrt(x^2+a),1/3*sqrt((x^2+a)^3))","f(sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2+a^(1/3))^3)+3/2*a^(1/3)*x*sqrt(x^2+a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2+a^(1/3)))))","f(sqrt(-a+x^6-3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2-a^(1/3))^3)-3/2*a^(1/3)*x*sqrt(x^2-a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2-a^(1/3)))))","f(1/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),x/a^(1/3)/sqrt(x^2+a^(1/3)))","f(x/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),-1/sqrt(x^2+a^(1/3)))","f(x*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/5*sqrt((x^2+a^(1/3))^5))","f(x^2*sqrt(x^2+a),1/4*x*sqrt((x^2+a)^3)-1/8*a*x*sqrt(x^2+a)-1/8*a^2*log(x+sqrt(x^2+a)))","f(x^3*sqrt(x^2+a),(1/5*x^2-2/15*a)*sqrt((x^2+a)^3),and(number(a),a>0))","f(x^3*sqrt(x^2+a),sqrt((x^2+a)^5)/5-a*sqrt((x^2+a)^3)/3,and(number(a),a<0))","f(x^2/sqrt(x^2+a),1/2*x*sqrt(x^2+a)-1/2*a*log(x+sqrt(x^2+a)))","f(x^3/sqrt(x^2+a),1/3*sqrt((x^2+a)^3)-a*sqrt(x^2+a))","f(1/x^2*1/sqrt(x^2+a),-sqrt(x^2+a)/a/x)","f(1/x^3*1/sqrt(x^2+a),-1/2*sqrt(x^2+a)/a/x^2+1/2*log((sqrt(a)+sqrt(x^2+a))/x)/a^(3/2),or(not(number(a)),a>0))","f(1/x^3*1/sqrt(x^2-a),1/2*sqrt(x^2-a)/a/x^2+1/2*1/(a^(3/2))*arcsec(x/(a^(1/2))),or(not(number(a)),a>0))","f(x^2*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/6*x*sqrt((x^2+a^(1/3))^5)-1/24*a^(1/3)*x*sqrt((x^2+a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2+a^(1/3))-1/16*a*log(x+sqrt(x^2+a^(1/3))),or(not(number(a)),a>0))","f(x^2*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/6*x*sqrt((x^2-a^(1/3))^5)+1/24*a^(1/3)*x*sqrt((x^2-a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2-a^(1/3))+1/16*a*log(x+sqrt(x^2-a^(1/3))),or(not(number(a)),a>0))","f(x^3*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/7*sqrt((x^2+a^(1/3))^7)-1/5*a^(1/3)*sqrt((x^2+a^(1/3))^5),or(not(number(a)),a>0))","f(x^3*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/7*sqrt((x^2-a^(1/3))^7)+1/5*a^(1/3)*sqrt((x^2-a^(1/3))^5),or(not(number(a)),a>0))","f(1/(x-a)/sqrt(x^2-a^2),-sqrt(x^2-a^2)/a/(x-a))","f(1/(x+a)/sqrt(x^2-a^2),sqrt(x^2-a^2)/a/(x+a))","f(sqrt(a-x^2),1/2*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(abs(a)))))","f(1/x*1/sqrt(a-x^2),-1/sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x,sqrt(a-x^2)-sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))","f(x/sqrt(a-x^2),-sqrt(a-x^2))","f(x*sqrt(a-x^2),-1/3*sqrt((a-x^2)^3))","f(x^2*sqrt(a-x^2),-x/4*sqrt((a-x^2)^3)+1/8*a*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(a))),or(not(number(a)),a>0))","f(x^3*sqrt(a-x^2),(-1/5*x^2-2/15*a)*sqrt((a-x^2)^3),or(not(number(a)),a>0))","f(x^2/sqrt(a-x^2),-x/2*sqrt(a-x^2)+a/2*arcsin(x/sqrt(a)),or(not(number(a)),a>0))","f(1/x^2*1/sqrt(a-x^2),-sqrt(a-x^2)/a/x,or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^2,-sqrt(a-x^2)/x-arcsin(x/sqrt(a)),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^3,-1/2*sqrt(a-x^2)/x^2+1/2*log((sqrt(a)+sqrt(a-x^2))/x)/sqrt(a),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^4,-1/3*sqrt((a-x^2)^3)/a/x^3,or(not(number(a)),a>0))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*log(x*sqrt(a)+sqrt(a*x^2+b))/2/sqrt(a),and(number(a),a>0))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*arcsin(x*sqrt(-a/b))/2/sqrt(-a),and(number(a),a<0))","f(sin(a*x),-cos(a*x)/a)","f(cos(a*x),sin(a*x)/a)","f(tan(a*x),-log(cos(a*x))/a)","f(1/tan(a*x),log(sin(a*x))/a)","f(1/cos(a*x),log(tan(pi/4+a*x/2))/a)","f(1/sin(a*x),log(tan(a*x/2))/a)","f(sin(a*x)^2,x/2-sin(2*a*x)/(4*a))","f(sin(a*x)^3,-cos(a*x)*(sin(a*x)^2+2)/(3*a))","f(sin(a*x)^4,3/8*x-sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))","f(cos(a*x)^2,x/2+sin(2*a*x)/(4*a))","f(cos(a*x)^3,sin(a*x)*(cos(a*x)^2+2)/(3*a))","f(cos(a*x)^4,3/8*x+sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))","f(1/sin(a*x)^2,-1/(a*tan(a*x)))","f(1/cos(a*x)^2,tan(a*x)/a)","f(sin(a*x)*cos(a*x),sin(a*x)^2/(2*a))","f(sin(a*x)^2*cos(a*x)^2,-sin(4*a*x)/(32*a)+x/8)","f(sin(a*x)/cos(a*x)^2,1/(a*cos(a*x)))","f(sin(a*x)^2/cos(a*x),(log(tan(pi/4+a*x/2))-sin(a*x))/a)","f(cos(a*x)/sin(a*x)^2,-1/(a*sin(a*x)))","f(1/(sin(a*x)*cos(a*x)),log(tan(a*x))/a)","f(1/(sin(a*x)*cos(a*x)^2),(1/cos(a*x)+log(tan(a*x/2)))/a)","f(1/(sin(a*x)^2*cos(a*x)),(log(tan(pi/4+a*x/2))-1/sin(a*x))/a)","f(1/(sin(a*x)^2*cos(a*x)^2),-2/(a*tan(2*a*x)))","f(sin(a+b*x),-cos(a+b*x)/b)","f(cos(a+b*x),sin(a+b*x)/b)","f(1/(b+b*sin(a*x)),-tan(pi/4-a*x/2)/a/b)","f(1/(b-b*sin(a*x)),tan(pi/4+a*x/2)/a/b)","f(1/(b+b*cos(a*x)),tan(a*x/2)/a/b)","f(1/(b-b*cos(a*x)),-1/tan(a*x/2)/a/b)","f(1/(a+b*sin(x)),1/sqrt(b^2-a^2)*log((a*tan(x/2)+b-sqrt(b^2-a^2))/(a*tan(x/2)+b+sqrt(b^2-a^2))),b^2-a^2)","f(1/(a+b*cos(x)),1/sqrt(b^2-a^2)*log((sqrt(b^2-a^2)*tan(x/2)+a+b)/(sqrt(b^2-a^2)*tan(x/2)-a-b)),b^2-a^2)","f(x*sin(a*x),sin(a*x)/a^2-x*cos(a*x)/a)","f(x^2*sin(a*x),2*x*sin(a*x)/a^2-(a^2*x^2-2)*cos(a*x)/a^3)","f(x*cos(a*x),cos(a*x)/a^2+x*sin(a*x)/a)","f(x^2*cos(a*x),2*x*cos(a*x)/a^2+(a^2*x^2-2)*sin(a*x)/a^3)","f(arcsin(a*x),x*arcsin(a*x)+sqrt(1-a^2*x^2)/a)","f(arccos(a*x),x*arccos(a*x)-sqrt(1-a^2*x^2)/a)","f(arctan(a*x),x*arctan(a*x)-1/2*log(1+a^2*x^2)/a)","f(x*log(a*x),x^2*log(a*x)/2-x^2/4)","f(x^2*log(a*x),x^3*log(a*x)/3-1/9*x^3)","f(log(x)^2,x*log(x)^2-2*x*log(x)+2*x)","f(1/x*1/(a+log(x)),log(a+log(x)))","f(log(a*x+b),(a*x+b)*log(a*x+b)/a-x)","f(log(a*x+b)/x^2,a/b*log(x)-(a*x+b)*log(a*x+b)/b/x)","f(sinh(x),cosh(x))","f(cosh(x),sinh(x))","f(tanh(x),log(cosh(x)))","f(x*sinh(x),x*cosh(x)-sinh(x))","f(x*cosh(x),x*sinh(x)-cosh(x))","f(sinh(x)^2,sinh(2*x)/4-x/2)","f(tanh(x)^2,x-tanh(x))","f(cosh(x)^2,sinh(2*x)/4+x/2)","f(x^3*exp(a*x^2),exp(a*x^2)*(x^2/a-1/(a^2))/2)","f(x^3*exp(a*x^2+b),exp(a*x^2)*exp(b)*(x^2/a-1/(a^2))/2)","f(exp(a*x^2),-i*sqrt(pi)*erf(i*sqrt(a)*x)/sqrt(a)/2)","f(erf(a*x),x*erf(a*x)+exp(-a^2*x^2)/a/sqrt(pi))","f(x^2*(1-x^2)^(3/2),(x*sqrt(1-x^2)*(-8*x^4+14*x^2-3)+3*arcsin(x))/48)","f(x^2*(1-x^2)^(5/2),(x*sqrt(1-x^2)*(48*x^6-136*x^4+118*x^2-15)+15*arcsin(x))/384)","f(x^4*(1-x^2)^(3/2),(-x*sqrt(1-x^2)*(16*x^6-24*x^4+2*x^2+3)+3*arcsin(x))/128)","f(x*exp(a*x),exp(a*x)*(a*x-1)/(a^2))","f(x*exp(a*x+b),exp(a*x+b)*(a*x-1)/(a^2))","f(x^2*exp(a*x),exp(a*x)*(a^2*x^2-2*a*x+2)/(a^3))","f(x^2*exp(a*x+b),exp(a*x+b)*(a^2*x^2-2*a*x+2)/(a^3))","f(x^3*exp(a*x),exp(a*x)*x^3/a-3/a*integral(x^2*exp(a*x),x))","f(x^3*exp(a*x+b),exp(a*x+b)*x^3/a-3/a*integral(x^2*exp(a*x+b),x))"];function sT(e){let t=0;e=me.cdr(e);let r=So.Eval(me.car(e));e=me.cdr(e);let n=So.Eval(me.car(e)),i,o;for(n===Cn.symbol(me.NIL)?(o=$v.guess(r),i=Cn.symbol(me.NIL)):me.isNumericAtom(n)?(o=$v.guess(r),i=n):(o=n,e=me.cdr(e),i=So.Eval(me.car(e)));;){me.isNumericAtom(i)?(t=kv.nativeInt(i),isNaN(t)&&Dv.stop("nth integral: check n")):t=1;let s=r;if(t>=0)for(let u=0;u<t;u++)s=Cc(s,o);else{t=-t;for(let u=0;u<t;u++)s=KM.derivative(s,o)}if(r=s,i===Cn.symbol(me.NIL))break;if(me.isNumericAtom(i)){if(e=me.cdr(e),i=So.Eval(me.car(e)),i===Cn.symbol(me.NIL))break;me.isNumericAtom(i)||(o=i,e=me.cdr(e),i=So.Eval(me.car(e)))}else o=i,e=me.cdr(e),i=So.Eval(me.car(e))}return r}Qi.Eval_integral=sT;function Cc(e,t){let r;return me.isadd(e)?r=aT(e,t):me.ismultiply(e)?r=lT(e,t):r=Bv(e,t),ya.Find(r,Cn.symbol(me.INTEGRAL))&&Dv.stop("integral: sorry, could not find a solution"),So.Eval(nT.simplify(r))}Qi.integral=Cc;function aT(e,t){e=me.cdr(e);let r=Cc(me.car(e),t);return me.iscons(e)&&(r=e.tail().reduce((n,i)=>JM.add(n,Cc(i,t)),r)),r}function lT(e,t){let[r,n]=tT.partition(e,t);return eT.multiply(r,Bv(n,t))}function Bv(e,t){let r=wo(e,t).toFixed(6),n=mT[r];if(!n)return Uv.makeList(Cn.symbol(me.INTEGRAL),e,t);let[i,o]=iT.transform(e,t,n,!1);return i===Cn.symbol(me.NIL)?Uv.makeList(Cn.symbol(me.INTEGRAL),e,t):i}var Pn={x:.95532,constexp:1.43762,constant:1.1441659362941434,constbase:1.2036412230421882,sin:1.7330548251830322,arcsin:1.6483368529465805,cos:1.0586721236863401,arccos:1.8405225918106694,tan:1.1224943776292506,arctan:1.1297397925394963,sinh:1.8176164926060079,cosh:1.9404934661708022,tanh:1.6421307715103122,log:1.477443701354924,erf:1.0825269225702916};function wo(e,t){if(me.issymbol(e))return WM.equal(e,t)?Pn.x:Pn.constant;if(me.iscons(e)){let n=me.car(e);switch(me.issymbol(n)&&n.printname){case me.ADD:return cT(me.cdr(e),t);case me.MULTIPLY:return fT(me.cdr(e),t);case me.POWER:return d_(me.cadr(e),me.caddr(e),t);case me.EXP:return d_(Cn.symbol(me.E),me.cadr(e),t);case me.SQRT:var r=kv.double(.5);return d_(me.cadr(e),r,t);default:return uT(e,t)}}return Pn.constant}function uT(e,t){if(!ya.Find(me.cadr(e),t))return Pn.constant;let r=me.car(e),n=wo(me.cadr(e),t),i=Pn[r.printname];if(!i)throw new Error("Unsupported function "+r.printname);return Math.pow(i,n)}function cT(e,t){let r={};for(;me.iscons(e);){let i=me.car(e);e=me.cdr(e);let o=0;ya.Find(i,t)?o=wo(i,t):o=Pn.constant,r[o.toFixed(6)]=!0}let n=0;for(let i of Object.keys(r||{})){let o=r[i];n=n+Number(i)}return n}function fT(e,t){let r=1;return me.iscons(e)&&[...e].forEach(n=>{ya.Find(n,t)&&(r=r*wo(n,t))}),r}function d_(e,t,r){let n=Pn.constant,i=Pn.constexp;if(ya.Find(e,r)&&(n=wo(e,r)),ya.Find(t,r))i=wo(t,r);else{if(n===Pn.constant)return Pn.constant;Gl.isminusone(t)?i=-1:Gl.isoneovertwo(t)?i=.5:Gl.isminusoneovertwo(t)?i=-.5:Gl.equalq(t,2,1)?i=2:Gl.equalq(t,-2,1)&&(i=-2)}return Math.pow(n,i)}function dT(){let e={};for(let t of Array.from(oT)){let r=rT.scan_meta(t),n=me.cadr(r),o=wo(n,Cn.symbol(me.METAX)).toFixed(6);e[o]||(e[o]=[]),e[o].push(t)}return console.log(`hashed_itab = ${JSON.stringify(e,null,2)}`),e}Qi.make_hashed_itab=dT;var mT={"1.144166":["f(a,a*x)"],"1.046770":["f(1/x,log(x))"],"0.936400":["f(x^a,x^(a+1)/(a+1))"],"1.095727":["f(x^(-2),-x^(-1))"],"1.023118":["f(x^(-1/2),2*x^(1/2))"],"0.977405":["f(x^(1/2),2/3*x^(3/2))"],"0.955320":["f(x,x^2/2)"],"0.912636":["f(x^2,x^3/3)"],"1.137302":["f(exp(a*x),1/a*exp(a*x))","f(a^x,a^x/log(a),or(not(number(a)),a>0))"],"1.326774":["f(exp(a*x+b),1/a*exp(a*x+b))"],"1.080259":["f(x*exp(a*x^2),exp(a*x^2)/(2*a))"],"1.260228":["f(x*exp(a*x^2+b),exp(a*x^2+b)/(2*a))"],"1.451902":["f(log(a*x),x*log(a*x)-x)"],"0.486192":["f(1/(a+x^2),1/sqrt(a)*arctan(x/sqrt(a)),or(not(number(a)),a>0))","f(1/(a-x^2),1/sqrt(a)*arctanh(x/sqrt(a)))","f(1/(a+b*x^2),1/sqrt(a*b)*arctan(x*sqrt(a*b)/a),or(not(number(a*b)),a*b>0))","f(1/(a+b*x^2),1/(2*sqrt(-a*b))*log((a+x*sqrt(-a*b))/(a-x*sqrt(-a*b))),or(not(number(a*b)),a*b<0))"],"0.697274":["f(1/sqrt(a-x^2),arcsin(x/(sqrt(a))))","f(1/sqrt(a+x^2),log(x+sqrt(a+x^2)))","f(1/sqrt(x^2+a),log(x+sqrt(x^2+a)))"],"0.476307":["f(1/(a+b*x),1/b*log(a+b*x))"],"0.226868":["f(1/(a+b*x)^2,-1/(b*(a+b*x)))"],"2.904531":["f(1/(a+b*x)^3,-1/(2*b)*1/(a+b*x)^2)"],"0.455026":["f(x/(a+b*x),x/b-a*log(a+b*x)/b/b)"],"0.216732":["f(x/(a+b*x)^2,1/b^2*(log(a+b*x)+a/(a+b*x)))"],"0.434695":["f(x^2/(a+b*x),1/b^2*(1/2*(a+b*x)^2-2*a*(a+b*x)+a^2*log(a+b*x)))"],"0.207048":["f(x^2/(a+b*x)^2,1/b^3*(a+b*x-2*a*log(a+b*x)-a^2/(a+b*x)))"],"2.650781":["f(x^2/(a+b*x)^3,1/b^3*(log(a+b*x)+2*a/(a+b*x)-1/2*a^2/(a+b*x)^2))"],"0.498584":["f(1/x*1/(a+b*x),-1/a*log((a+b*x)/x))"],"0.237479":["f(1/x*1/(a+b*x)^2,1/a*1/(a+b*x)-1/a^2*log((a+b*x)/x))"],"3.040375":["f(1/x*1/(a+b*x)^3,1/a^3*(1/2*((2*a+b*x)/(a+b*x))^2+log(x/(a+b*x))))"],"0.521902":["f(1/x^2*1/(a+b*x),-1/(a*x)+b/a^2*log((a+b*x)/x))"],"0.446014":["f(1/x^3*1/(a+b*x),(2*b*x-a)/(2*a^2*x^2)+b^2/a^3*log(x/(a+b*x)))"],"0.248586":["f(1/x^2*1/(a+b*x)^2,-(a+2*b*x)/(a^2*x*(a+b*x))+2*b/a^3*log((a+b*x)/x))"],"0.464469":["f(x/(a+b*x^2),1/2*1/b*log(a+b*x^2))"],"0.443716":["f(x^2/(a+b*x^2),x/b-a/b*integral(1/(a+b*x^2),x))"],"0.236382":["f(1/(a+b*x^2)^2,x/(2*a*(a+b*x^2))+1/2*1/a*integral(1/(a+b*x^2),x))"],"0.508931":["f(1/x*1/(a+b*x^2),1/2*1/a*log(x^2/(a+b*x^2)))"],"0.532733":["f(1/x^2*1/(a+b*x^2),-1/(a*x)-b/a*integral(1/(a+b*x^2),x))"],"0.480638":["f(1/(a+b*x^3),1/3*1/a*(a/b)^(1/3)*(1/2*log(((a/b)^(1/3)+x)^3/(a+b*x^3))+sqrt(3)*arctan((2*x-(a/b)^(1/3))*(a/b)^(-1/3)/sqrt(3))))"],"0.438648":["f(x^2/(a+b*x^3),1/3*1/b*log(a+b*x^3))"],"0.459164":["f(x/(a+b*x^4),1/2*sqrt(b/a)/b*arctan(x^2*sqrt(b/a)),or(not(number(a*b)),a*b>0))","f(x/(a+b*x^4),1/4*sqrt(-b/a)/b*log((x^2-sqrt(-a/b))/(x^2+sqrt(-a/b))),or(not(number(a*b)),a*b<0))"],"0.450070":["f(x^3/(a+b*x^4),1/4*1/b*log(a+b*x^4))"],"1.448960":["f(sqrt(a+b*x),2/3*1/b*sqrt((a+b*x)^3))"],"1.384221":["f(x*sqrt(a+b*x),-2*(2*a-3*b*x)*sqrt((a+b*x)^3)/15/b^2)"],"1.322374":["f(x^2*sqrt(a+b*x),2*(8*a^2-12*a*b*x+15*b^2*x^2)*sqrt((a+b*x)^3)/105/b^3)"],"1.516728":["f(sqrt(a+b*x)/x,2*sqrt(a+b*x)+a*integral(1/x*1/sqrt(a+b*x),x))"],"1.587665":["f(sqrt(a+b*x)/x^2,-sqrt(a+b*x)/x+b/2*integral(1/x*1/sqrt(a+b*x),x))"],"0.690150":["f(1/sqrt(a+b*x),2*sqrt(a+b*x)/b)"],"0.659314":["f(x/sqrt(a+b*x),-2/3*(2*a-b*x)*sqrt(a+b*x)/b^2)"],"0.629856":["f(x^2/sqrt(a+b*x),2/15*(8*a^2-4*a*b*x+3*b^2*x^2)*sqrt(a+b*x)/b^3)"],"0.722428":["f(1/x*1/sqrt(a+b*x),1/sqrt(a)*log((sqrt(a+b*x)-sqrt(a))/(sqrt(a+b*x)+sqrt(a))),or(not(number(a)),a>0))","f(1/x*1/sqrt(a+b*x),2/sqrt(-a)*arctan(sqrt(-(a+b*x)/a)),or(not(number(a)),a<0))"],"0.756216":["f(1/x^2*1/sqrt(a+b*x),-sqrt(a+b*x)/a/x-1/2*b/a*integral(1/x*1/sqrt(a+b*x),x))"],"1.434156":["f(sqrt(x^2+a),1/2*(x*sqrt(x^2+a)+a*log(x+sqrt(x^2+a))))","f(sqrt(a-x^2),1/2*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(abs(a)))))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*log(x*sqrt(a)+sqrt(a*x^2+b))/2/sqrt(a),and(number(a),a>0))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*arcsin(x*sqrt(-a/b))/2/sqrt(-a),and(number(a),a<0))"],"0.729886":["f(1/x*1/sqrt(x^2+a),arcsec(x/sqrt(-a))/sqrt(-a),or(not(number(a)),a<0))","f(1/x*1/sqrt(x^2+a),-1/sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(1/x*1/sqrt(a-x^2),-1/sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))"],"1.501230":["f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(-a)*arcsec(x/sqrt(-a)),or(not(number(a)),a<0))","f(sqrt(a-x^2)/x,sqrt(a-x^2)-sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))"],"0.666120":["f(x/sqrt(x^2+a),sqrt(x^2+a))","f(x/sqrt(a-x^2),-sqrt(a-x^2))"],"1.370077":["f(x*sqrt(x^2+a),1/3*sqrt((x^2+a)^3))","f(x*sqrt(a-x^2),-1/3*sqrt((a-x^2)^3))"],"1.730087":["f(sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2+a^(1/3))^3)+3/2*a^(1/3)*x*sqrt(x^2+a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2+a^(1/3)))))","f(sqrt(-a+x^6-3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2-a^(1/3))^3)-3/2*a^(1/3)*x*sqrt(x^2-a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2-a^(1/3)))))"],"0.578006":["f(1/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),x/a^(1/3)/sqrt(x^2+a^(1/3)))"],"0.552180":["f(x/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),-1/sqrt(x^2+a^(1/3)))"],"1.652787":["f(x*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/5*sqrt((x^2+a^(1/3))^5))"],"1.308862":["f(x^2*sqrt(x^2+a),1/4*x*sqrt((x^2+a)^3)-1/8*a*x*sqrt(x^2+a)-1/8*a^2*log(x+sqrt(x^2+a)))","f(x^2*sqrt(a-x^2),-x/4*sqrt((a-x^2)^3)+1/8*a*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(a))),or(not(number(a)),a>0))"],"1.342944":["f(x^3*sqrt(x^2+a),(1/5*x^2-2/15*a)*sqrt((x^2+a)^3),and(number(a),a>0))","f(x^3*sqrt(x^2+a),sqrt((x^2+a)^5)/5-a*sqrt((x^2+a)^3)/3,and(number(a),a<0))","f(x^3*sqrt(a-x^2),(-1/5*x^2-2/15*a)*sqrt((a-x^2)^3),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^3,-1/2*sqrt(a-x^2)/x^2+1/2*log((sqrt(a)+sqrt(a-x^2))/x)/sqrt(a),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^4,-1/3*sqrt((a-x^2)^3)/a/x^3,or(not(number(a)),a>0))"],"0.636358":["f(x^2/sqrt(x^2+a),1/2*x*sqrt(x^2+a)-1/2*a*log(x+sqrt(x^2+a)))","f(x^2/sqrt(a-x^2),-x/2*sqrt(a-x^2)+a/2*arcsin(x/sqrt(a)),or(not(number(a)),a>0))"],"0.652928":["f(x^3/sqrt(x^2+a),1/3*sqrt((x^2+a)^3)-a*sqrt(x^2+a))","f(1/x^3*1/sqrt(x^2+a),-1/2*sqrt(x^2+a)/a/x^2+1/2*log((sqrt(a)+sqrt(x^2+a))/x)/a^(3/2),or(not(number(a)),a>0))","f(1/x^3*1/sqrt(x^2-a),1/2*sqrt(x^2-a)/a/x^2+1/2*1/(a^(3/2))*arcsec(x/(a^(1/2))),or(not(number(a)),a>0))"],"0.764022":["f(1/x^2*1/sqrt(x^2+a),-sqrt(x^2+a)/a/x)","f(1/x^2*1/sqrt(a-x^2),-sqrt(a-x^2)/a/x,or(not(number(a)),a>0))"],"1.578940":["f(x^2*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/6*x*sqrt((x^2+a^(1/3))^5)-1/24*a^(1/3)*x*sqrt((x^2+a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2+a^(1/3))-1/16*a*log(x+sqrt(x^2+a^(1/3))),or(not(number(a)),a>0))","f(x^2*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/6*x*sqrt((x^2-a^(1/3))^5)+1/24*a^(1/3)*x*sqrt((x^2-a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2-a^(1/3))+1/16*a*log(x+sqrt(x^2-a^(1/3))),or(not(number(a)),a>0))"],"1.620055":["f(x^3*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/7*sqrt((x^2+a^(1/3))^7)-1/5*a^(1/3)*sqrt((x^2+a^(1/3))^5),or(not(number(a)),a>0))","f(x^3*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/7*sqrt((x^2-a^(1/3))^7)+1/5*a^(1/3)*sqrt((x^2-a^(1/3))^5),or(not(number(a)),a>0))"],"0.332117":["f(1/(x-a)/sqrt(x^2-a^2),-sqrt(x^2-a^2)/a/(x-a))","f(1/(x+a)/sqrt(x^2-a^2),sqrt(x^2-a^2)/a/(x+a))"],"1.571443":["f(sqrt(a-x^2)/x^2,-sqrt(a-x^2)/x-arcsin(x/sqrt(a)),or(not(number(a)),a>0))"],"1.690994":["f(sin(a*x),-cos(a*x)/a)"],"1.055979":["f(cos(a*x),sin(a*x)/a)"],"1.116714":["f(tan(a*x),-log(cos(a*x))/a)"],"0.895484":["f(1/tan(a*x),log(sin(a*x))/a)"],"0.946989":["f(1/cos(a*x),log(tan(pi/4+a*x/2))/a)"],"0.591368":["f(1/sin(a*x),log(tan(a*x/2))/a)"],"2.859462":["f(sin(a*x)^2,x/2-sin(2*a*x)/(4*a))"],"2.128050":["f(sin(a*x)^3,-cos(a*x)*(sin(a*x)^2+2)/(3*a))","f(sin(a*x)^4,3/8*x-sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))"],"1.115091":["f(cos(a*x)^2,x/2+sin(2*a*x)/(4*a))"],"1.081452":["f(cos(a*x)^3,sin(a*x)*(cos(a*x)^2+2)/(3*a))","f(cos(a*x)^4,3/8*x+sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))"],"0.349716":["f(1/sin(a*x)^2,-1/(a*tan(a*x)))"],"0.896788":["f(1/cos(a*x)^2,tan(a*x)/a)"],"1.785654":["f(sin(a*x)*cos(a*x),sin(a*x)^2/(2*a))"],"3.188560":["f(sin(a*x)^2*cos(a*x)^2,-sin(4*a*x)/(32*a)+x/8)"],"1.516463":["f(sin(a*x)/cos(a*x)^2,1/(a*cos(a*x)))"],"2.707879":["f(sin(a*x)^2/cos(a*x),(log(tan(pi/4+a*x/2))-sin(a*x))/a)"],"0.369293":["f(cos(a*x)/sin(a*x)^2,-1/(a*sin(a*x)))"],"0.560019":["f(1/(sin(a*x)*cos(a*x)),log(tan(a*x))/a)"],"0.530332":["f(1/(sin(a*x)*cos(a*x)^2),(1/cos(a*x)+log(tan(a*x/2)))/a)"],"0.331177":["f(1/(sin(a*x)^2*cos(a*x)),(log(tan(pi/4+a*x/2))-1/sin(a*x))/a)"],"0.313621":["f(1/(sin(a*x)^2*cos(a*x)^2),-2/(a*tan(2*a*x)))"],"3.172365":["f(sin(a+b*x),-cos(a+b*x)/b)"],"1.127162":["f(cos(a+b*x),sin(a+b*x)/b)"],"0.352714":["f(1/(b+b*sin(a*x)),-tan(pi/4-a*x/2)/a/b)","f(1/(b-b*sin(a*x)),tan(pi/4+a*x/2)/a/b)","f(1/(a+b*sin(x)),1/sqrt(b^2-a^2)*log((a*tan(x/2)+b-sqrt(b^2-a^2))/(a*tan(x/2)+b+sqrt(b^2-a^2))),b^2-a^2)"],"0.454515":["f(1/(b+b*cos(a*x)),tan(a*x/2)/a/b)","f(1/(b-b*cos(a*x)),-1/tan(a*x/2)/a/b)","f(1/(a+b*cos(x)),1/sqrt(b^2-a^2)*log((sqrt(b^2-a^2)*tan(x/2)+a+b)/(sqrt(b^2-a^2)*tan(x/2)-a-b)),b^2-a^2)"],"1.615441":["f(x*sin(a*x),sin(a*x)/a^2-x*cos(a*x)/a)"],"1.543263":["f(x^2*sin(a*x),2*x*sin(a*x)/a^2-(a^2*x^2-2)*cos(a*x)/a^3)"],"1.008798":["f(x*cos(a*x),cos(a*x)/a^2+x*sin(a*x)/a)"],"0.963724":["f(x^2*cos(a*x),2*x*cos(a*x)/a^2+(a^2*x^2-2)*sin(a*x)/a^3)"],"1.611938":["f(arcsin(a*x),x*arcsin(a*x)+sqrt(1-a^2*x^2)/a)"],"1.791033":["f(arccos(a*x),x*arccos(a*x)-sqrt(1-a^2*x^2)/a)"],"1.123599":["f(arctan(a*x),x*arctan(a*x)-1/2*log(1+a^2*x^2)/a)"],"1.387031":["f(x*log(a*x),x^2*log(a*x)/2-x^2/4)"],"1.325058":["f(x^2*log(a*x),x^3*log(a*x)/3-1/9*x^3)"],"2.108018":["f(log(x)^2,x*log(x)^2-2*x*log(x)+2*x)"],"0.403214":["f(1/x*1/(a+log(x)),log(a+log(x)))"],"2.269268":["f(log(a*x+b),(a*x+b)*log(a*x+b)/a-x)"],"2.486498":["f(log(a*x+b)/x^2,a/b*log(x)-(a*x+b)*log(a*x+b)/b/x)"],"1.769733":["f(sinh(x),cosh(x))"],"1.883858":["f(cosh(x),sinh(x))"],"1.606140":["f(tanh(x),log(cosh(x)))"],"1.690661":["f(x*sinh(x),x*cosh(x)-sinh(x))"],"1.799688":["f(x*cosh(x),x*sinh(x)-cosh(x))"],"3.131954":["f(sinh(x)^2,sinh(2*x)/4-x/2)"],"2.579685":["f(tanh(x)^2,x-tanh(x))"],"3.548923":["f(cosh(x)^2,sinh(2*x)/4+x/2)"],"1.058866":["f(x^3*exp(a*x^2),exp(a*x^2)*(x^2/a-1/(a^2))/2)"],"1.235270":["f(x^3*exp(a*x^2+b),exp(a*x^2)*exp(b)*(x^2/a-1/(a^2))/2)"],"1.130783":["f(exp(a*x^2),-i*sqrt(pi)*erf(i*sqrt(a)*x)/sqrt(a)/2)"],"1.078698":["f(erf(a*x),x*erf(a*x)+exp(-a^2*x^2)/a/sqrt(pi))"],"2.573650":["f(x^2*(1-x^2)^(3/2),(x*sqrt(1-x^2)*(-8*x^4+14*x^2-3)+3*arcsin(x))/48)","f(x^2*(1-x^2)^(5/2),(x*sqrt(1-x^2)*(48*x^6-136*x^4+118*x^2-15)+15*arcsin(x))/384)"],"2.640666":["f(x^4*(1-x^2)^(3/2),(-x*sqrt(1-x^2)*(16*x^6-24*x^4+2*x^2+3)+3*arcsin(x))/128)"],"1.086487":["f(x*exp(a*x),exp(a*x)*(a*x-1)/(a^2))"],"1.267493":["f(x*exp(a*x+b),exp(a*x+b)*(a*x-1)/(a^2))"],"1.037943":["f(x^2*exp(a*x),exp(a*x)*(a^2*x^2-2*a*x+2)/(a^3))"],"1.210862":["f(x^2*exp(a*x+b),exp(a*x+b)*(a^2*x^2-2*a*x+2)/(a^3))"],"1.064970":["f(x^3*exp(a*x),exp(a*x)*x^3/a-3/a*integral(x^2*exp(a*x),x))"],"1.242392":["f(x^3*exp(a*x+b),exp(a*x+b)*x^3/a-3/a*integral(x^2*exp(a*x+b),x))"]}});var g_=A(va=>{"use strict";Object.defineProperty(va,"__esModule",{value:!0});va.logarithm=va.Eval_log=void 0;var Dr=N(),Gv=U(),m_=ce(),_T=j(),bT=Tn(),gT=G(),__=Q(),yT=ee(),b_=X(),vT=si();function qT(e){return Lo(gT.Eval(Dr.cadr(e)))}va.Eval_log=qT;function Lo(e){return e===Gv.symbol(Dr.E)?Dr.Constants.one:__.equaln(e,1)?Dr.Constants.zero:__.isnegativenumber(e)?m_.add(Lo(b_.negate(e)),b_.multiply(Dr.Constants.imaginaryunit,Dr.Constants.Pi())):Dr.isdouble(e)?_T.double(Math.log(e.d)):__.isfraction(e)?m_.subtract(Lo(vT.numerator(e)),Lo(bT.denominator(e))):Dr.ispower(e)?b_.multiply(Dr.caddr(e),Lo(Dr.cadr(e))):Dr.ismultiply(e)?e.tail().map(Lo).reduce(m_.add,Dr.Constants.zero):yT.makeList(Gv.symbol(Dr.LOG),e)}va.logarithm=Lo});var v_=A(qa=>{"use strict";Object.defineProperty(qa,"__esModule",{value:!0});qa.sgn=qa.Eval_sgn=void 0;var pr=N(),Fv=U(),ET=an(),xT=G(),jv=Q(),zv=ee(),Yv=cn(),y_=X(),pT=xt();function hT(e){return Vv(xT.Eval(pr.cadr(e)))}qa.Eval_sgn=hT;function Vv(e){return pr.isdouble(e)?e.d>0||e.d===0?pr.Constants.one:pr.Constants.negOne:pr.isrational(e)?pr.MSIGN(Yv.mmul(e.q.a,e.q.b))===-1?pr.Constants.negOne:pr.MZERO(Yv.mmul(e.q.a,e.q.b))?pr.Constants.zero:pr.Constants.one:jv.iscomplexnumber(e)?y_.multiply(pT.power(pr.Constants.negOne,ET.absval(e)),e):jv.isnegativeterm(e)?y_.multiply(zv.makeList(Fv.symbol(pr.SGN),y_.negate(e)),pr.Constants.negOne):zv.makeList(Fv.symbol(pr.SGN),e)}qa.sgn=Vv});var q_=A(Ea=>{"use strict";Object.defineProperty(Ea,"__esModule",{value:!0});Ea.ysinh=Ea.Eval_sinh=void 0;var Co=N(),Zv=U(),AT=j(),OT=G(),MT=Q(),TT=ee();function NT(e){return Xv(OT.Eval(Co.cadr(e)))}Ea.Eval_sinh=NT;function Xv(e){if(Co.car(e)===Zv.symbol(Co.ARCSINH))return Co.cadr(e);if(Co.isdouble(e)){let t=Math.sinh(e.d);return Math.abs(t)<1e-10&&(t=0),AT.double(t)}return MT.isZeroAtomOrTensor(e)?Co.Constants.zero:TT.makeList(Zv.symbol(Co.SINH),e)}Ea.ysinh=Xv});var Ro=A(pa=>{"use strict";Object.defineProperty(pa,"__esModule",{value:!0});pa.derivative=pa.Eval_derivative=void 0;var E=N(),IT=or(),Hv=Ee(),De=U(),jl=Ie(),Nr=ce(),Pc=wm(),Qv=Rm(),kt=j(),Wv=Li(),Jv=Lm(),ST=km(),xa=G(),Kv=Xr(),wT=xm(),RT=Fl(),e1=Q(),zl=ee(),LT=g_(),ve=X(),gr=xt(),CT=v_(),PT=Zi(),DT=Jn(),kT=q_(),t1=Zr(),E_=Et();function $T(e){e=E.cdr(e);let t=xa.Eval(E.car(e));e=E.cdr(e);let r,n,i=xa.Eval(E.car(e));for(i===De.symbol(E.NIL)?(r=Kv.guess(t),n=De.symbol(E.NIL)):E.isNumericAtom(i)?(r=Kv.guess(t),n=i):(r=i,e=E.cdr(e),n=xa.Eval(E.car(e)));;){let o;E.isNumericAtom(n)?(o=kt.nativeInt(n),isNaN(o)&&Hv.stop("nth derivative: check n")):o=1;let s=t;if(o>=0)for(let u=0;u<o;u++)s=rt(s,r);else{o=-o;for(let u=0;u<o;u++)s=RT.integral(s,r)}if(t=s,n===De.symbol(E.NIL))break;if(E.isNumericAtom(n)){if(e=E.cdr(e),n=xa.Eval(E.car(e)),n===De.symbol(E.NIL))break;E.isNumericAtom(n)||(r=n,e=E.cdr(e),n=xa.Eval(E.car(e)))}else r=n,e=E.cdr(e),n=xa.Eval(E.car(e))}return t}pa.Eval_derivative=$T;function rt(e,t){return E.isNumericAtom(t)&&Hv.stop("undefined function"),E.istensor(e)?E.istensor(t)?E_.d_tensor_tensor(e,t):E_.d_tensor_scalar(e,t):E.istensor(t)?E_.d_scalar_tensor(e,t):UT(e,t)}pa.derivative=rt;function UT(e,t){if(E.issymbol(t))return BT(e,t);let r=t1.subst(e,t,De.symbol(E.SECRETX));return t1.subst(rt(r,De.symbol(E.SECRETX)),De.symbol(E.SECRETX),t)}function BT(e,t){if(jl.equal(e,t))return E.Constants.one;if(!E.iscons(e))return E.Constants.zero;if(E.isadd(e))return GT(e,t);switch(E.car(e)){case De.symbol(E.MULTIPLY):return FT(e,t);case De.symbol(E.POWER):return jT(e,t);case De.symbol(E.DERIVATIVE):return YT(e,t);case De.symbol(E.LOG):return zT(e,t);case De.symbol(E.SIN):return ZT(e,t);case De.symbol(E.COS):return XT(e,t);case De.symbol(E.TAN):return HT(e,t);case De.symbol(E.ARCSIN):return QT(e,t);case De.symbol(E.ARCCOS):return WT(e,t);case De.symbol(E.ARCTAN):return JT(e,t);case De.symbol(E.SINH):return KT(e,t);case De.symbol(E.COSH):return eN(e,t);case De.symbol(E.TANH):return tN(e,t);case De.symbol(E.ARCSINH):return rN(e,t);case De.symbol(E.ARCCOSH):return nN(e,t);case De.symbol(E.ARCTANH):return iN(e,t);case De.symbol(E.ABS):return oN(e,t);case De.symbol(E.SGN):return sN(e,t);case De.symbol(E.HERMITE):return aN(e,t);case De.symbol(E.ERF):return lN(e,t);case De.symbol(E.ERFC):return uN(e,t);case De.symbol(E.BESSELJ):return cN(e,t);case De.symbol(E.BESSELY):return mN(e,t);default:}return E.car(e)===De.symbol(E.INTEGRAL)&&E.caddr(e)===t?gN(e):VT(e,t)}function GT(e,t){let r=E.iscons(e)?e.tail().map(n=>rt(n,t)):[];return Nr.add_all(r)}function FT(e,t){let r=jl.length(e)-1,n=[];for(let i=0;i<r;i++){let o=[],s=E.cdr(e);for(let u=0;u<r;u++){let c=E.car(s);i===u&&(c=rt(c,t)),o.push(c),s=E.cdr(s)}n.push(ve.multiply_all(o))}return Nr.add_all(n)}function jT(e,t){let r=ve.divide(E.caddr(e),E.cadr(e)),n=rt(E.cadr(e),t),i=LT.logarithm(E.cadr(e)),o=rt(E.caddr(e),t);return ve.multiply(Nr.add(ve.multiply(r,n),ve.multiply(i,o)),e)}function zT(e,t){let r=rt(E.cadr(e),t);return ve.divide(r,E.cadr(e))}function YT(e,t){let r=rt(E.cadr(e),t);return E.car(r)===De.symbol(E.DERIVATIVE)?jl.lessp(E.caddr(r),E.caddr(e))?zl.makeList(De.symbol(E.DERIVATIVE),zl.makeList(De.symbol(E.DERIVATIVE),E.cadr(r),E.caddr(r)),E.caddr(e)):zl.makeList(De.symbol(E.DERIVATIVE),zl.makeList(De.symbol(E.DERIVATIVE),E.cadr(r),E.caddr(e)),E.caddr(r)):rt(r,E.caddr(e))}function VT(e,t){let r=E.cdr(e);return r===De.symbol(E.NIL)||IT.Find(r,t)?zl.makeList(De.symbol(E.DERIVATIVE),e,t):E.Constants.zero}function ZT(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,Wv.cosine(E.cadr(e)))}function XT(e,t){let r=rt(E.cadr(e),t);return ve.negate(ve.multiply(r,DT.sine(E.cadr(e))))}function HT(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,gr.power(Wv.cosine(E.cadr(e)),kt.integer(-2)))}function QT(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,gr.power(Nr.subtract(E.Constants.one,gr.power(E.cadr(e),kt.integer(2))),kt.rational(-1,2)))}function WT(e,t){let r=rt(E.cadr(e),t);return ve.negate(ve.multiply(r,gr.power(Nr.subtract(E.Constants.one,gr.power(E.cadr(e),kt.integer(2))),kt.rational(-1,2))))}function JT(e,t){let r=rt(E.cadr(e),t);return PT.simplify(ve.multiply(r,ve.inverse(Nr.add(E.Constants.one,gr.power(E.cadr(e),kt.integer(2))))))}function KT(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,Jv.ycosh(E.cadr(e)))}function eN(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,kT.ysinh(E.cadr(e)))}function tN(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,gr.power(Jv.ycosh(E.cadr(e)),kt.integer(-2)))}function rN(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,gr.power(Nr.add(gr.power(E.cadr(e),kt.integer(2)),E.Constants.one),kt.rational(-1,2)))}function nN(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,gr.power(Nr.add(gr.power(E.cadr(e),kt.integer(2)),E.Constants.negOne),kt.rational(-1,2)))}function iN(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,ve.inverse(Nr.subtract(E.Constants.one,gr.power(E.cadr(e),kt.integer(2)))))}function oN(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,CT.sgn(E.cadr(e)))}function sN(e,t){let r=rt(E.cadr(e),t);return ve.multiply(ve.multiply(r,ST.dirac(E.cadr(e))),kt.integer(2))}function aN(e,t){let r=rt(E.cadr(e),t);return ve.multiply(ve.multiply(r,ve.multiply(kt.integer(2),E.caddr(e))),wT.hermite(E.cadr(e),Nr.add(E.caddr(e),E.Constants.negOne)))}function lN(e,t){let r=rt(E.cadr(e),t);return ve.multiply(ve.multiply(ve.multiply(jl.exponential(ve.multiply(gr.power(E.cadr(e),kt.integer(2)),E.Constants.negOne)),gr.power(E.Constants.Pi(),kt.rational(-1,2))),kt.integer(2)),r)}function uN(e,t){let r=rt(E.cadr(e),t);return ve.multiply(ve.multiply(ve.multiply(jl.exponential(ve.multiply(gr.power(E.cadr(e),kt.integer(2)),E.Constants.negOne)),gr.power(E.Constants.Pi(),kt.rational(-1,2))),kt.integer(-2)),r)}function cN(e,t){return e1.isZeroAtomOrTensor(E.caddr(e))?fN(e,t):dN(e,t)}function fN(e,t){let r=rt(E.cadr(e),t);return ve.multiply(ve.multiply(r,Pc.besselj(E.cadr(e),E.Constants.one)),E.Constants.negOne)}function dN(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,Nr.add(Pc.besselj(E.cadr(e),Nr.add(E.caddr(e),E.Constants.negOne)),ve.multiply(ve.divide(ve.multiply(E.caddr(e),E.Constants.negOne),E.cadr(e)),Pc.besselj(E.cadr(e),E.caddr(e)))))}function mN(e,t){return e1.isZeroAtomOrTensor(E.caddr(e))?_N(e,t):bN(e,t)}function _N(e,t){let r=rt(E.cadr(e),t);return ve.multiply(ve.multiply(r,Pc.besselj(E.cadr(e),E.Constants.one)),E.Constants.negOne)}function bN(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,Nr.add(Qv.bessely(E.cadr(e),Nr.add(E.caddr(e),E.Constants.negOne)),ve.multiply(ve.divide(ve.multiply(E.caddr(e),E.Constants.negOne),E.cadr(e)),Qv.bessely(E.cadr(e),E.caddr(e)))))}function gN(e){return E.cadr(e)}});var n1=A(kc=>{"use strict";Object.defineProperty(kc,"__esModule",{value:!0});kc.Eval_user_function=void 0;var Ye=N(),x_=Ee(),Po=U(),yN=Ro(),p_=G(),h_=ee(),r1=Et();function vN(e){if(Ye.DEBUG&&console.log(`Eval_user_function evaluating: ${Ye.car(e)}`),Ye.car(e)===Po.symbol(Ye.SYMBOL_D)&&Po.get_binding(Po.symbol(Ye.SYMBOL_D))===Po.symbol(Ye.SYMBOL_D))return yN.Eval_derivative(e);let t=p_.Eval(Ye.car(e));Ye.isNumericAtom(t)?x_.stop("expected function invocation, found multiplication instead. Use '*' symbol explicitly for multiplication."):Ye.istensor(t)?x_.stop("expected function invocation, found tensor product instead. Use 'dot/inner' explicitly."):Ye.isstr(t)&&x_.stop("expected function, found string instead.");let r=Ye.car(Ye.cdr(t)),n=Ye.car(Ye.cdr(Ye.cdr(t))),i=Ye.cdr(e);if(Ye.car(t)!==Po.symbol(Ye.FUNCTION)||t===Ye.car(e))return h_.makeList(t,...p_.evalList(i));e=n;let o=i,s=[];for(;Ye.iscons(e)&&Ye.iscons(o);)s.push(Ye.car(e)),s.push(Ye.car(o)),e=Ye.cdr(e),o=Ye.cdr(o);return s.length&&(r=Dc(r,s)),p_.Eval(r)}kc.Eval_user_function=vN;function Dc(e,t){if(Ye.istensor(e))return qN(e,t);if(Ye.iscons(e)){let n=[];for(Ye.car(e)===t[0]?n.push(h_.makeList(Po.symbol(Ye.EVAL),t[1])):n.push(Ye.car(e)),e=Ye.cdr(e);Ye.iscons(e);)n.push(Dc(Ye.car(e),t)),e=Ye.cdr(e);return h_.makeList(...n)}if(!Ye.issymbol(e))return e;for(let n=0;n<t.length;n+=2)if(e===t[n])return t[n+1];let r=Po.get_binding(e);return e!==r&&Dc(r,t)===r?e:r}function qN(e,t){return e=r1.copy_tensor(e),e.tensor.elem=e.tensor.elem.map(r=>Dc(r,t)),r1.check_tensor_dimensions(e),e}});var G=A(K=>{"use strict";Object.defineProperty(K,"__esModule",{value:!0});K.evalList=K.Eval_predicate=K.Eval_unit=K.Eval_subst=K.Eval_stop=K.Eval_sqrt=K.Eval_setq=K.Eval_rank=K.Eval_quote=K.Eval_operator=K.Eval_number=K.Eval_isinteger=K.Eval_invg=K.Eval_inv=K.Eval_index=K.Eval_hilbert=K.Eval_hermite=K.Eval_factorpoly=K.Eval_factorial=K.Eval_exp=K.Eval_Eval=K.Eval_dsolve=K.Eval_do=K.Eval_divisors=K.Eval_dim=K.Eval_det=K.Eval_check=K.Eval_binding=K.Eval_cons=K.Eval_sym=K.Eval=K.evaluate_integer=void 0;var i1=Qb(),EN=St(),R=N(),_i=Ee(),hr=U(),Do=j(),xN=kd(),pN=mc(),hN=Qd(),AN=ho(),o1=xs(),ON=xm(),MN=Cy(),s1=Il(),$c=Q(),Uc=ee(),TN=Ie(),NN=xt(),a1=Zr(),l1=Et(),u1=n1();function A_(e){return Do.nativeInt(Re(e))}K.evaluate_integer=A_;function Re(e){let t;_i.check_esc_flag(),e==null&&R.breakpoint,!R.defs.evaluatingAsFloats&&$c.isfloating(e)&&(t=!0,R.defs.evaluatingAsFloats=!0);try{switch(e.k){case R.CONS:return f1(e);case R.NUM:return R.defs.evaluatingAsFloats?Do.double(Do.convert_rational_to_double(e)):e;case R.DOUBLE:case R.STR:return e;case R.TENSOR:return l1.Eval_tensor(e);case R.SYM:return c1(e);default:_i.stop("atom?")}}finally{t&&(R.defs.evaluatingAsFloats=!1)}}K.Eval=Re;function c1(e){if(hr.iskeyword(e))return Re(Uc.makeList(e,hr.symbol(R.LAST)));if(e===hr.symbol(R.PI)&&R.defs.evaluatingAsFloats)return R.Constants.piAsDouble;let t=hr.get_binding(e);if(R.DEBUG&&console.log(`looked up: ${e} which contains: ${t}`),e!==t){let r=R.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated.indexOf(e);if(r!==-1){let n="";for(let i=r;i<R.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated.length;i++)n+=R.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated[i].printname+" -> ";n+=e.printname,_i.stop("recursive evaluation of symbols: "+n);return}R.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated.push(e),t=Re(t),R.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated.pop()}return t}K.Eval_sym=c1;function f1(e){let t=R.car(e);return R.car(t)===hr.symbol(R.EVAL)?u1.Eval_user_function(e):(R.issymbol(t)||_i.stop("cons?"),t.keyword?t.keyword(e):u1.Eval_user_function(e))}K.Eval_cons=f1;function IN(e){return hr.get_binding(R.cadr(e))}K.Eval_binding=IN;function SN(e){let t=$c.isZeroLikeOrNonZeroLikeOrUndetermined(R.cadr(e));return t==null?e:Do.integer(Number(t))}K.Eval_check=SN;function wN(e){let t=Re(R.cadr(e));return pN.det(t)}K.Eval_det=wN;function RN(e){let t=Re(R.cadr(e)),r=R.iscons(R.cddr(e))?A_(R.caddr(e)):1;return R.istensor(t)?r<1||r>t.tensor.ndim?e:Do.integer(t.tensor.dim[r-1]):R.Constants.one}K.Eval_dim=RN;function LN(e){return hN.divisors(Re(R.cadr(e)))}K.Eval_divisors=LN;function CN(e){let t=R.car(e);for(e=R.cdr(e);R.iscons(e);)t=Re(R.car(e)),e=R.cdr(e);return t}K.Eval_do=CN;function PN(e){let t=Re(R.cadr(e)),r=Re(R.caddr(e)),n=Re(R.cadddr(e));_i.stop("dsolve")}K.Eval_dsolve=PN;function DN(e){let t=Re(R.cadr(e));for(e=R.cddr(e);R.iscons(e);)t=a1.subst(t,Re(R.car(e)),Re(R.cadr(e))),e=R.cddr(e);return Re(t)}K.Eval_Eval=DN;function kN(e){return TN.exponential(Re(R.cadr(e)))}K.Eval_exp=kN;function $N(e){return AN.factorial(Re(R.cadr(e)))}K.Eval_factorial=$N;function UN(e){e=R.cdr(e);let t=Re(R.car(e));e=R.cdr(e);let r=Re(R.car(e)),n=o1.factorpoly(t,r);return R.iscons(e)&&(n=e.tail().reduce((i,o)=>o1.factorpoly(i,Re(o)),n)),n}K.Eval_factorpoly=UN;function BN(e){let t=Re(R.caddr(e)),r=Re(R.cadr(e));return ON.hermite(r,t)}K.Eval_hermite=BN;function GN(e){return MN.hilbert(Re(R.cadr(e)))}K.Eval_hilbert=GN;function FN(e){let t=e;e=R.cdr(e);let r=Re(R.car(e));if(R.isNumericAtom(r)&&_i.stop("trying to access a scalar as a tensor"),!R.istensor(r))return t;let n=[];for(e=R.cdr(e);R.iscons(e);){if(n.push(Re(R.car(e))),!$c.isintegerorintegerfloat(n[n.length-1]))return t;e=R.cdr(e)}return i1.index_function(r,n)}K.Eval_index=FN;function jN(e){let t=Re(R.cadr(e));return s1.inv(t)}K.Eval_inv=jN;function zN(e){let t=Re(R.cadr(e));return s1.invg(t)}K.Eval_invg=zN;function YN(e){return e=Re(R.cadr(e)),R.isrational(e)?$c.isinteger(e)?R.Constants.one:R.Constants.zero:R.isdouble(e)?Math.floor(e.d)===e.d?R.Constants.one:R.Constants.zero:Uc.makeList(hr.symbol(R.ISINTEGER),e)}K.Eval_isinteger=YN;function VN(e){return e=Re(R.cadr(e)),e.k===R.NUM||e.k===R.DOUBLE?R.Constants.one:R.Constants.zero}K.Eval_number=VN;function ZN(e){return Uc.makeList(hr.symbol(R.OPERATOR),...d1(R.cdr(e)))}K.Eval_operator=ZN;function XN(e){return R.cadr(e)}K.Eval_quote=XN;function HN(e){return e=Re(R.cadr(e)),R.istensor(e)?Do.integer(e.tensor.ndim):R.Constants.zero}K.Eval_rank=HN;function QN(e){if(R.caadr(e)===hr.symbol(R.INDEX))return WN(e);if(R.iscons(R.cadr(e)))return xN.define_user_function(e);R.issymbol(R.cadr(e))||_i.stop("symbol assignment: error in symbol");let t=Re(R.caddr(e));return hr.set_binding(R.cadr(e),t),hr.symbol(R.NIL)}K.Eval_setq=QN;function WN(e){let t=R.cadadr(e);console.log(`p4: ${t}`),R.issymbol(t)||_i.stop("indexed assignment: expected a symbol name");let r=Re(R.caddr(e)),n=[],i=R.cdadr(e);R.iscons(i)&&(n=[...i].map(Re));let o=i1.set_component(r,...n);return hr.set_binding(t,o),hr.symbol(R.NIL)}function JN(e){let t=Re(R.cadr(e));return NN.power(t,Do.rational(1,2))}K.Eval_sqrt=JN;function KN(){_i.stop("user stop")}K.Eval_stop=KN;function eI(e){let t=Re(R.cadr(e)),r=Re(R.caddr(e)),n=Re(R.cadddr(e));return Re(a1.subst(n,r,t))}K.Eval_subst=eI;function tI(e){let t=A_(R.cadr(e));if(isNaN(t)||t<1)return e;e=EN.alloc_tensor(t*t),e.tensor.ndim=2,e.tensor.dim[0]=t,e.tensor.dim[1]=t;for(let r=0;r<t;r++)e.tensor.elem[t*r+r]=R.Constants.one;return l1.check_tensor_dimensions(e),e}K.Eval_unit=tI;function rI(e){return R.car(e)===hr.symbol(R.SETQ)&&(e=Uc.makeList(hr.symbol(R.TESTEQ),R.cadr(e),R.caddr(e))),Re(e)}K.Eval_predicate=rI;function*d1(e){if(R.iscons(e))for(let t of e)yield Re(t)}K.evalList=d1});var ce=A(Dn=>{"use strict";Object.defineProperty(Dn,"__esModule",{value:!0});Dn.subtract=Dn.add_all=Dn.add=Dn.Eval_add=void 0;var le=N(),nI=Ee(),ko=U(),m1=j(),iI=G(),O_=Q(),oI=ee(),_1=Ie(),b1=X(),sI=ri(),aI=Et(),Yl=0;function lI(e){let t=[];e=le.cdr(e);for(let r of e){let n=iI.Eval(r);Bc(t,n)}return M_(t)}Dn.Eval_add=lI;function M_(e){if(le.DEBUG)for(let t of e)console.log(sI.print_list(t));for(let t=0;t<10&&!(e.length<2||(Yl=0,e.sort(cI),Yl===0));t++)fI(e);switch(e.length){case 0:return le.Constants.Zero();case 1:return e[0];default:return e.unshift(ko.symbol(le.ADD)),oI.makeList(...e)}}var uI=0;function cI(e,t){if(uI++,le.isNumericAtom(e)&&le.isNumericAtom(t))return Yl=1,0;if(le.istensor(e)&&le.istensor(t)){if(e.tensor.ndim<t.tensor.ndim)return-1;if(e.tensor.ndim>t.tensor.ndim)return 1;for(let n=0;n<e.tensor.ndim;n++){if(e.tensor.dim[n]<t.tensor.dim[n])return-1;if(e.tensor.dim[n]>t.tensor.dim[n])return 1}return Yl=1,0}le.ismultiply(e)&&(e=le.cdr(e),le.isNumericAtom(le.car(e))&&(e=le.cdr(e),le.cdr(e)===ko.symbol(le.NIL)&&(e=le.car(e)))),le.ismultiply(t)&&(t=le.cdr(t),le.isNumericAtom(le.car(t))&&(t=le.cdr(t),le.cdr(t)===ko.symbol(le.NIL)&&(t=le.car(t))));let r=_1.cmp_expr(e,t);return r===0&&(Yl=1),r}function fI(e){let t=0;for(;t<e.length-1;){nI.check_esc_flag();let r,n,i=e[t],o=e[t+1];if(le.istensor(i)&&le.istensor(o)){r=aI.tensor_plus_tensor(i,o),r!==ko.symbol(le.NIL)&&(e.splice(t,2,r),t--),t++;continue}if(le.istensor(i)||le.istensor(o)){t++;continue}if(le.isNumericAtom(i)&&le.isNumericAtom(o)){r=m1.add_numbers(i,o),O_.isZeroAtomOrTensor(r)?e.splice(t,2):e.splice(t,2,r),t--,t++;continue}if(le.isNumericAtom(i)||le.isNumericAtom(o)){t++;continue}r=le.Constants.One(),n=le.Constants.One();let s=0;if(le.ismultiply(i)&&(i=le.cdr(i),s=1,le.isNumericAtom(le.car(i))&&(r=le.car(i),i=le.cdr(i),le.cdr(i)===ko.symbol(le.NIL)&&(i=le.car(i),s=0))),le.ismultiply(o)&&(o=le.cdr(o),le.isNumericAtom(le.car(o))&&(n=le.car(o),o=le.cdr(o),le.cdr(o)===ko.symbol(le.NIL)&&(o=le.car(o)))),!_1.equal(i,o)){t++;continue}if(r=m1.add_numbers(r,n),O_.isZeroAtomOrTensor(r)){e.splice(t,2),t--,t++;continue}let u=s?new le.Cons(ko.symbol(le.MULTIPLY),i):i;e.splice(t,2,b1.multiply(r,u)),t--,t++}}function Bc(e,t){le.isadd(t)?e.push(...t.tail()):O_.isZeroAtom(t)||e.push(t)}function g1(e,t){let r=[];return Bc(r,e),Bc(r,t),M_(r)}Dn.add=g1;function dI(e){let t=[];for(let r of e)Bc(t,r);return M_(t)}Dn.add_all=dI;function mI(e,t){return g1(e,b1.negate(t))}Dn.subtract=mI});var an=A(kn=>{"use strict";Object.defineProperty(kn,"__esModule",{value:!0});kn.absval=kn.abs=kn.absValFloat=kn.Eval_abs=void 0;var ft=N(),T_=or(),_I=Ee(),Vl=U(),bI=Ie(),gI=ce(),Gc=j(),yI=vo(),vI=Tn(),Fc=G(),qI=Rn(),EI=ql(),xI=Gi(),$o=Q(),y1=ee(),jc=X(),pI=si(),Zl=xt(),v1=Bs(),hI=ti(),q1=Zi(),Ir=!1;function AI(e){return N_(Fc.Eval(ft.cadr(e)))}kn.Eval_abs=AI;function OI(e){return qI.zzfloat(Fc.Eval(Xl(Fc.Eval(e))))}kn.absValFloat=OI;function N_(e){let t=pI.numerator(e),r=Xl(t),n=vI.denominator(e),i=Xl(n),o=jc.divide(r,i);return Ir&&(console.trace(">>>>  ABS of "+e),console.log(`ABS numerator ${t}`),console.log(`ABSVAL numerator: ${r}`),console.log(`ABS denominator: ${n}`),console.log(`ABSVAL denominator: ${i}`),console.log(`ABSVAL divided: ${o}`),console.log("<<<<<<<  ABS")),o}kn.abs=N_;function Xl(e){let t=e;if(Ir&&console.log(`ABS of ${e}`),$o.isZeroAtomOrTensor(e))return Ir&&(console.log(` abs: ${e} just zero`),console.log(" --> ABS of "+t+" : "+ft.Constants.zero)),ft.Constants.zero;if($o.isnegativenumber(e))return Ir&&console.log(` abs: ${e} just a negative`),jc.negate(e);if($o.ispositivenumber(e))return Ir&&(console.log(` abs: ${e} just a positive`),console.log(` --> ABS of ${t} : ${e}`)),e;if(e===Vl.symbol(ft.PI))return Ir&&(console.log(` abs: ${e} of PI`),console.log(` --> ABS of ${t} : ${e}`)),e;if(ft.isadd(e)&&(T_.findPossibleClockForm(e,e)||T_.findPossibleExponentialForm(e)||T_.Find(e,ft.Constants.imaginaryunit))){Ir&&(console.log(` abs: ${e} is a sum`),console.log("abs of a sum")),e=hI.rect(e);let n=q1.simplify_trig(Zl.power(gI.add(Zl.power(v1.real(e),Gc.integer(2)),Zl.power(EI.imag(e),Gc.integer(2))),Gc.rational(1,2)));return Ir&&console.log(` --> ABS of ${t} : ${n}`),n}if(ft.ispower(e)&&$o.equaln(ft.cadr(e),-1)){let n=ft.Constants.One();if(Ir){console.log(` abs: ${e} is -1 to any power`);let i=ft.defs.evaluatingAsFloats?" abs: numeric, so result is 1.0":" abs: symbolic, so result is 1";console.log(i),console.log(` --> ABS of ${t} : ${n}`)}return n}if(ft.ispower(e)&&$o.ispositivenumber(ft.caddr(e))){let n=Zl.power(N_(ft.cadr(e)),ft.caddr(e));return Ir&&(console.log(` abs: ${e} is something to the power of a positive number`),console.log(` --> ABS of ${t} : ${n}`)),n}if(ft.ispower(e)&&ft.cadr(e)===Vl.symbol(ft.E)){let n=bI.exponential(v1.real(ft.caddr(e)));return Ir&&(console.log(` abs: ${e} is an exponential`),console.log(` --> ABS of ${t} : ${n}`)),n}if(ft.ismultiply(e)){let n=e.tail().map(Xl).reduce(jc.multiply);return Ir&&(console.log(` abs: ${e} is a product`),console.log(` --> ABS of ${t} : ${n}`)),n}if(ft.car(e)===Vl.symbol(ft.ABS)){let n=y1.makeList(Vl.symbol(ft.ABS),ft.cadr(e));return Ir&&(console.log(` abs: ${e} is abs of a abs`),console.log(` --> ABS of ${t} : ${n}`)),n}if(ft.istensor(e))return MI(e);($o.isnegativeterm(e)||ft.isadd(e)&&$o.isnegativeterm(ft.cadr(e)))&&(e=jc.negate(e));let r=y1.makeList(Vl.symbol(ft.ABS),e);return Ir&&(console.log(` abs: ${e} is nothing decomposable`),console.log(` --> ABS of ${t} : ${r}`)),r}kn.absval=Xl;function MI(e){return e.tensor.ndim!==1&&_I.stop("abs(tensor) with tensor rank > 1"),Fc.Eval(q1.simplify(Zl.power(xI.inner(e,yI.conjugate(e)),Gc.rational(1,2))))}});var Q=A(V=>{"use strict";Object.defineProperty(V,"__esModule",{value:!0});V.isnpi=V.isquarterturn=V.isimaginaryunit=V.isfloating=V.isMinusSqrtThreeOverTwo=V.isSqrtThreeOverTwo=V.isminusoneoversqrttwo=V.isoneoversqrttwo=V.isminusoneovertwo=V.isoneovertwo=V.equalq=V.equaln=V.isfraction=V.isoneover=V.isNumberOneOverSomething=V.isintegerfactor=V.issymbolic=V.isnegative=V.iseveninteger=V.iscomplexnumber=V.iscomplexnumberdouble=V.isimaginarynumber=V.isnegativeterm=V.ispolyexpandedform=V.isunivarpolyfactoredorexpandedform=V.isposint=V.isnonnegativeinteger=V.isintegerorintegerfloat=V.isinteger=V.isone=V.isminusone=V.isplusone=V.isplustwo=V.ispositivenumber=V.isnegativenumber=V.isZeroLikeOrNonZeroLikeOrUndetermined=V.isZeroAtomOrTensor=V.isZeroAtom=void 0;var h=N(),ha=or(),Wi=U(),Kt=Ie(),TI=an(),zc=j(),E1=G(),NI=Rn(),II=Xr(),x1=X(),Hl=!1;function p1(e){switch(e.k){case h.NUM:if(h.MZERO(e.q.a))return!0;break;case h.DOUBLE:if(e.d===0)return!0;break}return!1}V.isZeroAtom=p1;function SI(e){return h.istensor(e)?e.tensor.elem.every(t=>Ql(t)):!1}function Ql(e){return p1(e)||SI(e)}V.isZeroAtomOrTensor=Ql;function wI(e){let t=E1.Eval_predicate(e);if(Ql(t))return!1;if(h.isNumericAtomOrTensor(t))return!0;if(t=NI.zzfloat(t),Ql(t))return!1;if(h.isNumericAtomOrTensor(t))return!0;if(ha.Find(t,h.Constants.imaginaryunit)){if(t=E1.Eval_predicate(TI.absValFloat(t)),Ql(t))return!1;if(h.isNumericAtomOrTensor(t))return!0}return null}V.isZeroLikeOrNonZeroLikeOrUndetermined=wI;function Yc(e){switch(e.k){case h.NUM:if(h.MSIGN(e.q.a)===-1)return!0;break;case h.DOUBLE:if(e.d<0)return!0;break}return!1}V.isnegativenumber=Yc;function RI(e){switch(e.k){case h.NUM:if(h.MSIGN(e.q.a)===1)return!0;break;case h.DOUBLE:if(e.d>0)return!0;break}return!1}V.ispositivenumber=RI;function LI(e){switch(e.k){case h.NUM:if(h.MEQUAL(e.q.a,2)&&h.MEQUAL(e.q.b,1))return!0;break;case h.DOUBLE:if(e.d===2)return!0;break}return!1}V.isplustwo=LI;function h1(e){switch(e.k){case h.NUM:if(h.MEQUAL(e.q.a,1)&&h.MEQUAL(e.q.b,1))return!0;break;case h.DOUBLE:if(e.d===1)return!0;break}return!1}V.isplusone=h1;function I_(e){switch(e.k){case h.NUM:if(h.MEQUAL(e.q.a,-1)&&h.MEQUAL(e.q.b,1))return!0;break;case h.DOUBLE:if(e.d===-1)return!0;break}return!1}V.isminusone=I_;function CI(e){return h1(e)||I_(e)}V.isone=CI;function Uo(e){return e.k===h.NUM&&h.MEQUAL(e.q.b,1)}V.isinteger=Uo;function PI(e){return e.k===h.DOUBLE?e.d===Math.round(e.d):Uo(e)}V.isintegerorintegerfloat=PI;function DI(e){return h.isrational(e)&&h.MEQUAL(e.q.b,1)&&h.MSIGN(e.q.a)===1}V.isnonnegativeinteger=DI;function Vc(e){return Uo(e)&&h.MSIGN(e.q.a)===1}V.isposint=Vc;function kI(e,t){return t==null&&(t=II.guess(e)),UI(e,t)&&$I(ha.Find(e,Wi.symbol(h.SYMBOL_X)),ha.Find(e,Wi.symbol(h.SYMBOL_Y)),ha.Find(e,Wi.symbol(h.SYMBOL_Z)))===1?t:!1}V.isunivarpolyfactoredorexpandedform=kI;function $I(...e){return e.reduce((t,r)=>t+Number(r),0)}function UI(e,t){return BI(e,t)}function BI(e,t){return h.ismultiply(e)?e.tail().every(r=>{let n=A1(r,t);return h.DEBUG&&(console.log(`ispolyfactoredorexpandedform_factor testing ${r}`),n&&console.log(`... tested negative:${r}`)),n}):A1(e,t)}function A1(e,t){return h.ispower(e)?(h.DEBUG&&console.log("ispolyfactoredorexpandedform_power (isposint(caddr(p)) "+(Vc(h.caddr(e)),h.DEBUG?console.log("ispolyfactoredorexpandedform_power ispolyexpandedform_expr(cadr(p), x)) "+Zc(h.cadr(e),t)):void 0)),Vc(h.caddr(e))&&Zc(h.cadr(e),t)):(h.DEBUG&&console.log(`ispolyfactoredorexpandedform_power not a power, testing if this is exp form: ${e}`),Zc(e,t))}function GI(e,t){return ha.Find(e,t)?Zc(e,t):!1}V.ispolyexpandedform=GI;function Zc(e,t){return h.isadd(e)?e.tail().every(r=>O1(r,t)):O1(e,t)}function O1(e,t){return h.ismultiply(e)?e.tail().every(r=>M1(r,t)):M1(e,t)}function M1(e,t){return Kt.equal(e,t)?!0:h.ispower(e)&&Kt.equal(h.cadr(e),t)?Vc(h.caddr(e)):!ha.Find(e,t)}function S_(e){return Yc(e)||h.ismultiply(e)&&Yc(h.cadr(e))}V.isnegativeterm=S_;function T1(e){return h.ispower(e)&&h.isrational(h.car(h.cdr(h.cdr(e))))&&Yc(h.car(h.cdr(e)))?(Hl&&console.log(`hasNegativeRationalExponent: ${e} has imaginary component`),!0):(Hl&&console.log(`hasNegativeRationalExponent: ${e} has NO imaginary component`),!1)}function N1(e){return h.ismultiply(e)&&Kt.length(e)===3&&h.isdouble(h.cadr(e))&&T1(h.caddr(e))||Kt.equal(e,h.Constants.imaginaryunit)}function w_(e){return h.ismultiply(e)&&Kt.length(e)===3&&h.isNumericAtom(h.cadr(e))&&Kt.equal(h.caddr(e),h.Constants.imaginaryunit)||Kt.equal(e,h.Constants.imaginaryunit)||T1(h.caddr(e))?(Hl&&console.log(`isimaginarynumber: ${e} is imaginary number`),!0):(Hl&&console.log(`isimaginarynumber: ${e} isn't an imaginary number`),!1)}V.isimaginarynumber=w_;function FI(e){return h.isadd(e)&&Kt.length(e)===3&&h.isdouble(h.cadr(e))&&N1(h.caddr(e))||N1(e)}V.iscomplexnumberdouble=FI;function jI(e){return Hl&&h.breakpoint,h.isadd(e)&&Kt.length(e)===3&&h.isNumericAtom(h.cadr(e))&&w_(h.caddr(e))||w_(e)?(h.DEBUG&&console.log(`iscomplexnumber: ${e} is imaginary number`),!0):(h.DEBUG&&console.log(`iscomplexnumber: ${e} is imaginary number`),!1)}V.iscomplexnumber=jI;function zI(e){return Uo(e)&&e.q.a.isEven()}V.iseveninteger=zI;function YI(e){return h.isadd(e)&&S_(h.cadr(e))||S_(e)}V.isnegative=YI;function I1(e){return h.issymbol(e)?!0:h.iscons(e)?[...e].some(I1):!1}V.issymbolic=I1;function VI(e){return Uo(e)||h.ispower(e)&&Uo(h.cadr(e))&&Uo(h.caddr(e))}V.isintegerfactor=VI;function ZI(e){return S1(e)&&h.MEQUAL(e.q.a.abs(),1)}V.isNumberOneOverSomething=ZI;function XI(e){return h.ispower(e)&&I_(h.caddr(e))}V.isoneover=XI;function S1(e){return e.k===h.NUM&&!h.MEQUAL(e.q.b,1)}V.isfraction=S1;function Xc(e,t){switch(e.k){case h.NUM:return h.MEQUAL(e.q.a,t)&&h.MEQUAL(e.q.b,1);case h.DOUBLE:return e.d===t;default:return!1}}V.equaln=Xc;function Hc(e,t,r){switch(e.k){case h.NUM:return h.MEQUAL(e.q.a,t)&&h.MEQUAL(e.q.b,r);case h.DOUBLE:return e.d===t/r;default:return!1}}V.equalq=Hc;function R_(e){return Hc(e,1,2)}V.isoneovertwo=R_;function w1(e){return Hc(e,-1,2)}V.isminusoneovertwo=w1;function R1(e){return h.ispower(e)&&Xc(h.cadr(e),2)&&Hc(h.caddr(e),-1,2)}V.isoneoversqrttwo=R1;function HI(e){return h.ismultiply(e)&&Xc(h.cadr(e),-1)&&R1(h.caddr(e))&&Kt.length(e)===3}V.isminusoneoversqrttwo=HI;function QI(e){return h.ismultiply(e)&&R_(h.cadr(e))&&L1(h.caddr(e))&&Kt.length(e)===3}V.isSqrtThreeOverTwo=QI;function WI(e){return h.ismultiply(e)&&w1(h.cadr(e))&&L1(h.caddr(e))&&Kt.length(e)===3}V.isMinusSqrtThreeOverTwo=WI;function L1(e){return h.ispower(e)&&Xc(h.cadr(e),3)&&R_(h.caddr(e))}function C1(e){return e.k===h.DOUBLE||e===Wi.symbol(h.FLOATF)?!0:h.iscons(e)?[...e].some(C1):!1}V.isfloating=C1;function JI(e){return Kt.equal(e,h.Constants.imaginaryunit)}V.isimaginaryunit=JI;function KI(e){let t=0;if(!h.ismultiply(e))return 0;if(Kt.equal(h.cadr(e),h.Constants.imaginaryunit))return h.caddr(e)!==Wi.symbol(h.PI)||Kt.length(e)!==3?0:2;if(!h.isNumericAtom(h.cadr(e))||!Kt.equal(h.caddr(e),h.Constants.imaginaryunit)||h.cadddr(e)!==Wi.symbol(h.PI)||Kt.length(e)!==4)return 0;let r=zc.nativeInt(x1.multiply(h.cadr(e),zc.integer(2)));if(isNaN(r))return 0;switch(r<1&&(t=1,r=-r),r%4){case 0:r=1;break;case 1:r=t?4:3;break;case 2:r=2;break;case 3:r=t?3:4}return r}V.isquarterturn=KI;function eS(e){let t=0;return e===Wi.symbol(h.PI)?2:!h.ismultiply(e)||!h.isNumericAtom(h.cadr(e))||h.caddr(e)!==Wi.symbol(h.PI)||Kt.length(e)!==3||(t=zc.nativeInt(x1.multiply(h.cadr(e),zc.integer(2))),isNaN(t))?0:(t<0?t=4- -t%4:t=1+(t-1)%4,t)}V.isnpi=eS});var ci=A(Rt=>{"use strict";Object.defineProperty(Rt,"__esModule",{value:!0});Rt.yn=Rt.jn=Rt.append=Rt.isalnumorunderscore=Rt.isalpha=Rt.isdigit=Rt.isspace=Rt.clear_term=Rt.doubleToReasonableString=Rt.strcmp=void 0;var tS=j(),rS=Q(),nS=ee(),Ji=N(),P1=Ee(),Qc=U();function iS(e,t){return e===t?0:e>t?1:-1}Rt.strcmp=iS;function oS(e){let t;if(Ji.defs.codeGen||Ji.defs.fullDoubleOutput)return""+e;if(rS.isZeroAtomOrTensor(Qc.get_binding(Qc.symbol(Ji.FORCE_FIXED_PRINTOUT))))t=""+e,Ji.defs.printMode===Ji.PRINTMODE_LATEX?/\d*\.\d*e.*/gm.test(t)?t=t.replace(/e(.*)/gm,"\\mathrm{e}{$1}"):t=t.replace(/(\d+)e(.*)/gm,"$1.0\\mathrm{e}{$2}"):/\d*\.\d*e.*/gm.test(t)?t=t.replace(/e(.*)/gm,"*10^($1)"):t=t.replace(/(\d+)e(.*)/gm,"$1.0*10^($2)");else{let r=tS.nativeInt(Qc.get_binding(Qc.symbol(Ji.MAX_FIXED_PRINTOUT_DIGITS)));t=""+e.toFixed(r),t=t.replace(/(\.\d*?[1-9])0+$/gm,"$1"),t=t.replace(/\.0+$/gm,""),t.indexOf(".")===-1&&(t+=".0"),parseFloat(t)!==e&&(t=e.toFixed(r)+"...")}return t}Rt.doubleToReasonableString=oS;function sS(){}Rt.clear_term=sS;function aS(e){return e==null?!1:e===" "||e==="	"||e===`
`||e==="\v"||e==="\f"||e==="\r"}Rt.isspace=aS;function D1(e){return e==null?!1:/^\d+$/.test(e)}Rt.isdigit=D1;function lS(e){return e==null?!1:e.search(/[^A-Za-z]/)===-1}Rt.isalpha=lS;function uS(e){return e==null?!1:e.search(/[^A-Za-z_]/)===-1}function cS(e){return e==null?!1:uS(e)||D1(e)}Rt.isalnumorunderscore=cS;function fS(e,t){let r=[];return Ji.iscons(e)&&r.push(...e),Ji.iscons(t)&&r.push(...t),nS.makeList(...r)}Rt.append=fS;function dS(e,t){P1.stop("Not implemented")}Rt.jn=dS;function mS(e,t){P1.stop("Not implemented")}Rt.yn=mS});var k1=A(Wc=>{"use strict";Object.defineProperty(Wc,"__esModule",{value:!0});Wc.qadd=void 0;var L_=N(),_S=j(),bS=zd(),gS=vs(),Wl=cn();function yS(e,t){let r=Wl.mmul(e.q.a,t.q.b),n=Wl.mmul(e.q.b,t.q.a),i=bS.madd(r,n);if(L_.MZERO(i))return L_.Constants.zero;let o=Wl.mmul(e.q.b,t.q.b),s=gS.mgcd(i,o);s=_S.makeSignSameAs(s,o);let u=Wl.mdiv(i,s),c=Wl.mdiv(o,s);return new L_.Num(u,c)}Wc.qadd=yS});var $1=A(ef=>{"use strict";Object.defineProperty(ef,"__esModule",{value:!0});ef.qdiv=void 0;var Jc=N(),vS=Ee(),qS=j(),ES=vs(),Kc=cn();function xS(e,t){if(Jc.MZERO(t.q.a)&&vS.stop("divide by zero"),Jc.MZERO(e.q.a))return Jc.Constants.zero;let r=Kc.mmul(e.q.a,t.q.b),n=Kc.mmul(e.q.b,t.q.a),i=ES.mgcd(r,n);return i=qS.makeSignSameAs(i,n),new Jc.Num(Kc.mdiv(r,i),Kc.mdiv(n,i))}ef.qdiv=xS});var U1=A(nf=>{"use strict";Object.defineProperty(nf,"__esModule",{value:!0});nf.qmul=void 0;var tf=N(),pS=j(),hS=vs(),rf=cn();function AS(e,t){if(tf.MZERO(e.q.a)||tf.MZERO(t.q.a))return tf.Constants.zero;let r=rf.mmul(e.q.a,t.q.a),n=rf.mmul(e.q.b,t.q.b),i=hS.mgcd(r,n);return i=pS.makeSignSameAs(i,n),new tf.Num(rf.mdiv(r,i),rf.mdiv(n,i))}nf.qmul=AS});var j=A(oe=>{"use strict";var OS=oe&&oe.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(oe,"__esModule",{value:!0});oe.bignum_factorial=oe.bignum_float=oe.nativeDouble=oe.gcd_numbers=oe.print_number=oe.bignum_scan_float=oe.bignum_scan_integer=oe.nativeInt=oe.rational=oe.double=oe.integer=oe.convert_rational_to_double=oe.bignum_power_number=oe.mp_denominator=oe.mp_numerator=oe.bignum_truncate=oe.negate_number=oe.compare_numbers=oe.invert_number=oe.divide_numbers=oe.multiply_numbers=oe.add_numbers=oe.makePositive=oe.makeSignSameAs=oe.setSignTo=oe.isSmall=oe.mint=void 0;var $t=OS(Ti()),de=N(),MS=Tu(),TS=ci(),C_=Ee(),Aa=Q(),B1=vs(),of=cn(),G1=nc(),NS=X(),IS=k1(),SS=$1(),wS=U1();function RS(e){return $t.default(e)}oe.mint=RS;function F1(e){return e.geq(Number.MIN_SAFE_INTEGER)&&e.leq(Number.MAX_SAFE_INTEGER)}oe.isSmall=F1;function sf(e,t){if(e.isPositive()){if(t<0)return e.multiply($t.default(-1))}else if(t>0)return e.multiply($t.default(-1));return e}oe.setSignTo=sf;function P_(e,t){if(e.isPositive()){if(t.isNegative())return e.multiply($t.default(-1))}else if(t.isPositive())return e.multiply($t.default(-1));return e}oe.makeSignSameAs=P_;function LS(e){return e.isNegative()?e.multiply($t.default(-1)):e}oe.makePositive=LS;function CS(e,t){if(de.isrational(e)&&de.isrational(t))return IS.qadd(e,t);let r=de.isdouble(e)?e.d:bn(e),n=de.isdouble(t)?t.d:bn(t);return D_(r+n)}oe.add_numbers=CS;function PS(e,t){if(de.isrational(e)&&de.isrational(t))return wS.qmul(e,t);let r=de.isdouble(e)?e.d:bn(e),n=de.isdouble(t)?t.d:bn(t);return new de.Double(r*n)}oe.multiply_numbers=PS;function DS(e,t){if(de.isrational(e)&&de.isrational(t))return SS.qdiv(e,t);Aa.isZeroAtomOrTensor(t)&&C_.stop("divide by zero");let r=de.isdouble(e)?e.d:bn(e),n=de.isdouble(t)?t.d:bn(t);return new de.Double(r/n)}oe.divide_numbers=DS;function kS(e){if(Aa.isZeroAtomOrTensor(e)&&C_.stop("divide by zero"),de.isdouble(e))return new de.Double(1/e.d);let t=$t.default(e.q.a),r=$t.default(e.q.b);return r=P_(r,t),t=sf(t,1),new de.Num(r,t)}oe.invert_number=kS;function $S(e,t){let r=of.mmul(e.q.a,t.q.b),n=of.mmul(e.q.b,t.q.a);return MS.mcmp(r,n)}function US(e,t){if(de.isrational(e)&&de.isrational(t))return $S(e,t);let r=de.isdouble(e)?e.d:bn(e),n=de.isdouble(t)?t.d:bn(t);return r<n?-1:r>n?1:0}oe.compare_numbers=US;function BS(e){if(Aa.isZeroAtomOrTensor(e))return e;switch(e.k){case de.NUM:return new de.Num($t.default(e.q.a.multiply($t.default.minusOne)),$t.default(e.q.b));case de.DOUBLE:return new de.Double(-e.d);default:C_.stop("bug caught in mp_negate_number")}}oe.negate_number=BS;function GS(e){let t=of.mdiv(e.q.a,e.q.b);return new de.Num(t)}oe.bignum_truncate=GS;function FS(e){return de.isrational(e)?new de.Num($t.default(e.q.a)):de.Constants.one}oe.mp_numerator=FS;function jS(e){return de.isrational(e)?new de.Num($t.default(e.q.b)):de.Constants.one}oe.mp_denominator=jS;function zS(e,t){let r=G1.mpow(e.q.a,Math.abs(t)),n=G1.mpow(e.q.b,Math.abs(t));if(t<0){let i=r;r=n,n=i,r=P_(r,n),n=sf(n,1)}return new de.Num(r,n)}oe.bignum_power_number=zS;function bn(e){e.q==null&&de.breakpoint;let t=e.q.a.divmod(e.q.b);return t.quotient.toJSNumber()+t.remainder.toJSNumber()/e.q.b.toJSNumber()}oe.convert_rational_to_double=bn;function YS(e){return new de.Num($t.default(e))}oe.integer=YS;function D_(e){return new de.Double(e)}oe.double=D_;function VS(e,t){return new de.Num($t.default(e),$t.default(t))}oe.rational=VS;function ZS(e){let t=NaN;switch(e.k){case de.NUM:Aa.isinteger(e)&&F1(e.q.a)&&(t=e.q.a.toJSNumber());break;case de.DOUBLE:de.DEBUG&&console.log("popping integer but double is found"),Math.floor(e.d)===e.d&&(de.DEBUG&&console.log("...although it's an integer"),t=e.d);break}return t}oe.nativeInt=ZS;function XS(e){let t=0,r=e[t];(r==="+"||r==="-")&&t++;let n=$t.default(e.substring(t)),i=new de.Num(n);return r==="-"&&(i=NS.negate(i)),i}oe.bignum_scan_integer=XS;function HS(e){return D_(parseFloat(e))}oe.bignum_scan_float=HS;function QS(e,t){let r="",n="",i="";switch(e.k){case de.NUM:var o=e.q.a.toString();t||o[0]==="-"&&(o=o.substring(1)),de.defs.printMode===de.PRINTMODE_LATEX&&Aa.isfraction(e)&&(o="\\frac{"+o+"}{"),r+=o,Aa.isfraction(e)&&(de.defs.printMode!==de.PRINTMODE_LATEX&&(r+="/"),n=e.q.b.toString(),de.defs.printMode===de.PRINTMODE_LATEX&&(n+="}"),r+=n);break;case de.DOUBLE:o=TS.doubleToReasonableString(e.d),t||o[0]==="-"&&(o=o.substring(1)),r+=o;break}return r}oe.print_number=QS;function WS(e,t){let r=B1.mgcd(e.q.a,t.q.a),n=B1.mgcd(e.q.b,t.q.b);return new de.Num(sf(r,1),n)}oe.gcd_numbers=WS;function JS(e){let t=0;switch(e.k){case de.NUM:t=bn(e);break;case de.DOUBLE:({d:t}=e);break;default:t=0}return t}oe.nativeDouble=JS;function KS(e){let t=bn(e);return new de.Double(t)}oe.bignum_float=KS;function ew(e){return new de.Num(tw(e))}oe.bignum_factorial=ew;function tw(e){let t;if(e===0||e===1)return t=$t.default(1),t;t=$t.default(2);let r=$t.default(0);if(3<=e)for(let n=3;n<=e;n++)r=$t.default(n),t=of.mmul(t,r);return t}});var i_=A(Ma=>{"use strict";Object.defineProperty(Ma,"__esModule",{value:!0});Ma.polyform=Ma.bake=void 0;var Tt=N(),rw=j(),nw=yo(),Ki=Q(),Jl=ee(),Sr=U();function j1(e){return Tt.doexpand(iw,e)}Ma.bake=j1;function iw(e){let t=Ki.ispolyexpandedform(e,Sr.symbol(Tt.SYMBOL_S)),r=Ki.ispolyexpandedform(e,Sr.symbol(Tt.SYMBOL_T)),n=Ki.ispolyexpandedform(e,Sr.symbol(Tt.SYMBOL_X)),i=Ki.ispolyexpandedform(e,Sr.symbol(Tt.SYMBOL_Y)),o=Ki.ispolyexpandedform(e,Sr.symbol(Tt.SYMBOL_Z)),s;return t&&!r&&!n&&!i&&!o?s=Oa(e,Sr.symbol(Tt.SYMBOL_S)):!t&&r&&!n&&!i&&!o?s=Oa(e,Sr.symbol(Tt.SYMBOL_T)):!t&&!r&&n&&!i&&!o?s=Oa(e,Sr.symbol(Tt.SYMBOL_X)):!t&&!r&&!n&&i&&!o?s=Oa(e,Sr.symbol(Tt.SYMBOL_Y)):!t&&!r&&!n&&!i&&o?s=Oa(e,Sr.symbol(Tt.SYMBOL_Z)):Tt.iscons(e)&&Tt.car(e)!==Sr.symbol(Tt.FOR)?s=Jl.makeList(Tt.car(e),...e.tail().map(j1)):s=e,s}function z1(e,t){return Ki.ispolyexpandedform(e,t)?Oa(e,t):Tt.iscons(e)?Jl.makeList(Tt.car(e),...e.tail().map(r=>z1(r,t))):e}Ma.polyform=z1;function Oa(e,t){let r=nw.coeff(e,t),n=[];for(let i=r.length-1;i>=0;i--){let o=r[i];n.push(...ow(i,o,t))}return n.length>1?new Tt.Cons(Sr.symbol(Tt.ADD),Jl.makeList(...n)):n[0]}function ow(e,t,r){if(Ki.isZeroAtomOrTensor(t))return[];if(e===0)return Tt.isadd(t)?t.tail():[t];let n=[];return Tt.ismultiply(t)?n.push(...t.tail()):Ki.equaln(t,1)||n.push(t),e===1?n.push(r):n.push(Jl.makeList(Sr.symbol(Tt.POWER),r,rw.integer(e))),n.length>1?[Jl.makeList(Sr.symbol(Tt.MULTIPLY),...n)]:n}});var U_=A(Kr=>{"use strict";Object.defineProperty(Kr,"__esModule",{value:!0});Kr.testApprox=Kr.approxAll=Kr.approxRationalsOfLogs=Kr.approxRadicals=Kr.Eval_approxratio=void 0;var sw=St(),bi=N(),aw=U(),Y1=j(),lw=Rn(),uw=ee(),cw=Et();function fw(e){return af(bi.cadr(e))}Kr.Eval_approxratio=fw;function af(e){if(bi.istensor(e)){let t=sw.alloc_tensor(e.tensor.nelem);return t.tensor.ndim=e.tensor.ndim,t.tensor.dim=Array.from(e.tensor.dim),t.tensor.elem=t.tensor.elem.map(r=>{let n=af(r);return cw.check_tensor_dimensions(t),n}),t}return e.k===bi.DOUBLE?dw(e):bi.iscons(e)?new bi.Cons(af(bi.car(e)),af(bi.cdr(e))):e}function dw(e){let t=lw.zzfloat(e);if(t.k===bi.DOUBLE){let r=t.d,n=r.toString().split(".");if(n.length===2){let i=n[1].length,o=1/Math.pow(10,i),s=mw(r,o);return Y1.rational(s[0],s[1])}return Y1.integer(r)}return uw.makeList(aw.symbol(bi.APPROXRATIO),t)}function mw(e,t){if(isNaN(e))return[0,0];if(e===1/0)return[1,0];if(e===-1/0)return[-1,0];let r=e<0?-1:1;if(e=Math.abs(e),Math.abs(e-Math.floor(e))<t)return[e*r,1];if(e<1e-19)return[r,1e19];if(e>1e19)return[1e19*r,1];let n=e,i=0,o=1,s;for(;;){n=1/(n-Math.floor(n));let u=o;if(o=o*Math.floor(n)+i,i=u,s=Math.floor(e*o+.5),!(Math.abs(e-s/o)>t)||n===Math.floor(n))break}return s=r*s,[s,o]}var Jr=0,_w=1,V1=2,Z1=3,k_=4,bw=6,X1=7,gw=8,yw=9;function vw(e){let t,r=e.toString().split(".");if(r.length===2){let o=r[1].length;t=1/Math.pow(10,o)}else return[""+Math.floor(e),Jr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,i=Number.MAX_VALUE;for(let o of[2,3,5,6,7,8,10])for(let s=1;s<=10;s++){let u,c,d,_=Math.sqrt(o)/s;if(Math.abs(_)>1e-10?(d=e/_,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-_)),u<2*t){let w=kr(c,o,s);w<i&&(i=w,n=[`${c} * sqrt( ${o} ) / ${s}`,bw,c,o,s])}}return n}function qw(e){let t,r=e.toString().split(".");if(r.length===2){let o=r[1].length;t=1/Math.pow(10,o)}else return[""+Math.floor(e),Jr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,i=Number.MAX_VALUE;for(let o of[1,2,3,5,6,7,8,10])for(let s of[1,2,3,5,6,7,8,10]){let u,c,d,_=Math.sqrt(o/s);if(Math.abs(_)>1e-10?(d=e/_,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-_)),u<2*t){let w=kr(c,o,s);w<i&&(i=w,n=[`${c} * (sqrt( ${o} / ${s} )`,k_,c,o,s])}}return n}function Bo(e){let t,r=e.toString().split(".");if(r.length===2){let o=r[1].length;t=1/Math.pow(10,o)}else return[""+Math.floor(e),Jr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=vw(e);if(n!=null)return n;let i=qw(e);return i!=null?i:null}Kr.approxRadicals=Bo;function Kl(e){let t,r=e.toString().split(".");if(r.length===2){let o=r[1].length;t=1/Math.pow(10,o)}else return[""+Math.floor(e),Jr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=H1(e);if(n!=null)return n;let i=Ew(e);return i!=null?i:null}function H1(e){let t,r=e.toString().split(".");if(r.length===2){let o=r[1].length;t=1/Math.pow(10,o)}else return[""+Math.floor(e),Jr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,i=Number.MAX_VALUE;for(let o=2;o<=5;o++)for(let s=1;s<=5;s++){let u,c,d,_=Math.log(o)/s;if(Math.abs(_)>1e-10?(d=e/_,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-_)),!(c!==1&&Math.abs(Math.floor(c/s))===Math.abs(c/s))&&u<2.2*t){let w=kr(c,o,s);w<i&&(i=w,n=[`${c} * log( ${o} ) / ${s}`,yw,c,o,s])}}return n}Kr.approxRationalsOfLogs=H1;function Ew(e){let t,r=e.toString().split(".");if(r.length===2){let o=r[1].length;t=1/Math.pow(10,o)}else return[""+Math.floor(e),Jr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,i=Number.MAX_VALUE;for(let o=1;o<=5;o++)for(let s=1;s<=5;s++){let u,c,d,_=Math.log(o/s);if(Math.abs(_)>1e-10?(d=e/_,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-_)),u<1.96*t){let w=kr(c,o,s);w<i&&(i=w,n=[`${c} * log( ${o} / ${s} )`,gw,c,o,s])}}return n}function Q1(e){let t,r=e.toString().split(".");if(r.length===2){let o=r[1].length;t=1/Math.pow(10,o)}else return[""+Math.floor(e),Jr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,i=Number.MAX_VALUE;for(let o=1;o<=2;o++)for(let s=1;s<=12;s++){let u,c,d,_=Math.pow(Math.E,o)/s;if(Math.abs(_)>1e-10?(d=e/_,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-_)),u<2*t){let w=kr(c,o,s);w<i&&(i=w,n=[`${c} * (e ^ ${o} ) / ${s}`,X1,c,o,s])}}return n}function $_(e){let t,r=e.toString().split(".");if(r.length===2){let o=r[1].length;t=1/Math.pow(10,o)}else return[""+Math.floor(e),Jr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,i=Number.MAX_VALUE;for(let o=1;o<=5;o++)for(let s=1;s<=12;s++){let u,c,d,_=Math.pow(Math.PI,o)/s;if(Math.abs(_)>1e-10?(d=e/_,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-_)),u<2*t){let w=kr(c,o,s);w<i&&(i=w,n=[`${c} * (pi ^ ${o} ) / ${s} )`,Z1,c,o,s])}}return n}function eu(e){let t,r=e.toString().split(".");if(r.length===2){let o=r[1].length;t=1/Math.pow(10,o)}else return[""+Math.floor(e),Jr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=xw(e);if(n!=null)return n;let i=pw(e);return i!=null?i:null}function xw(e){let t,r=e.toString().split(".");if(r.length===2){let o=r[1].length;t=1/Math.pow(10,o)}else return[""+Math.floor(e),Jr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,i=Number.MAX_VALUE;for(let o=1;o<=4;o++)for(let s=1;s<=4;s++){let u,c,d,_=o/s,w=Math.sin(_);if(Math.abs(w)>1e-10?(d=e/w,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-w)),u<2*t){let T=kr(c,o,s);T<i&&(i=T,n=[`${c} * sin( ${o}/${s} )`,_w,c,o,s])}}return n}function pw(e){let t,r=e.toString().split(".");if(r.length===2){let o=r[1].length;t=1/Math.pow(10,o)}else return[""+Math.floor(e),Jr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,i=Number.MAX_VALUE;for(let o=1;o<=13;o++)for(let s=1;s<=13;s++){let u,c,d,_=o/s,w=Math.sin(Math.PI*_);if(Math.abs(w)>1e-10?(d=e/w,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-w)),u<23*t){let T=kr(c,o,s);T<i&&(i=T,n=[`${c} * sin( ${o}/${s} * pi )`,V1,c,o,s])}}return n}function Se(e){let t,r=e.toString().split(".");if(r.length===2){let T=r[1].length;t=1/Math.pow(10,T)}else return[""+Math.floor(e),Jr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=Number.MAX_VALUE,i=0,o=null,s=!0,u=Bo(e);u!=null&&(i=kr(u),i<n?(s&&console.log(`better explanation by approxRadicals: ${u} complexity: ${i}`),n=i,o=u):s&&console.log(`subpar explanation by approxRadicals: ${u} complexity: ${i}`));let c=Kl(e);c!=null&&(i=kr(c),i<n?(s&&console.log(`better explanation by approxLogs: ${c} complexity: ${i}`),n=i,o=c):s&&console.log(`subpar explanation by approxLogs: ${c} complexity: ${i}`));let d=Q1(e);d!=null&&(i=kr(d),i<n?(s&&console.log(`better explanation by approxRationalsOfPowersOfE: ${d} complexity: ${i}`),n=i,o=d):s&&console.log(`subpar explanation by approxRationalsOfPowersOfE: ${d} complexity: ${i}`));let _=$_(e);_!=null&&(i=kr(_),i<n?(s&&console.log(`better explanation by approxRationalsOfPowersOfPI: ${_} complexity: ${i}`),n=i,o=_):s&&console.log(`subpar explanation by approxRationalsOfPowersOfPI: ${_} complexity: ${i}`));let w=eu(e);return w!=null&&(i=kr(w),i<n?(s&&console.log(`better explanation by approxTrigonometric: ${w} complexity: ${i}`),n=i,o=w):s&&console.log(`subpar explanation by approxTrigonometric: ${w} complexity: ${i}`)),o}Kr.approxAll=Se;function kr(e,t,r){let n=0;if(e instanceof Array){switch(e[1]){case V1:n=4;break;case Z1:n=Math.pow(4,Math.abs(e[3]))*Math.abs(e[2]);break;case X1:n=Math.pow(3,Math.abs(e[3]))*Math.abs(e[2]);break;default:n=0}n+=Math.abs(e[2])*(Math.abs(e[3])+Math.abs(e[4]))}else n+=Math.abs(e)*(Math.abs(t)+Math.abs(r));return e[2]===1?n-=1:n+=1,e[3]===1?n-=1:n+=1,e[4]===1?n-=1:n+=1,n<0&&(n=0),n}function hw(){for(let t of[2,3,5,6,7,8,10])for(let r of[2,3,5,6,7,8,10]){if(t===r)continue;console.log(`testapproxRadicals testing: 1 * sqrt( ${t} ) / ${r}`);let n=t/r,i=Math.sqrt(t)/r,o=Bo(i),s=o[2]*Math.sqrt(o[3])/o[4];Math.abs(i-s)>1e-15&&console.log(`fail testapproxRadicals: 1 * sqrt( ${t} ) / ${r} . obtained: ${o}`)}for(let t of[2,3,5,6,7,8,10])for(let r of[2,3,5,6,7,8,10]){if(t===r)continue;console.log(`testapproxRadicals testing with 4 digits: 1 * sqrt( ${t} ) / ${r}`);let n=t/r,i=Math.sqrt(t)/r,o=i.toFixed(4),s=Bo(Number(o)),u=s[2]*Math.sqrt(s[3])/s[4];Math.abs(i-u)>1e-15&&console.log(`fail testapproxRadicals with 4 digits: 1 * sqrt( ${t} ) / ${r} . obtained: ${s}`)}for(let t of[2,3,5,6,7,8,10])for(let r of[2,3,5,6,7,8,10]){if(t===r)continue;console.log(`testapproxRadicals testing: 1 * sqrt( ${t} / ${r} )`);let n=t/r,i=Math.sqrt(t/r),o=Bo(i);if(o!=null){let s=o[2]*Math.sqrt(o[3]/o[4]);o[1]===k_&&Math.abs(i-s)>1e-15&&console.log(`fail testapproxRadicals: 1 * sqrt( ${t} / ${r} ) . obtained: ${o}`)}}for(let t of[1,2,3,5,6,7,8,10])for(let r of[1,2,3,5,6,7,8,10]){if(t===1&&r===1)continue;console.log(`testapproxRadicals testing with 4 digits:: 1 * sqrt( ${t} / ${r} )`);let n=t/r,i=Math.sqrt(t/r),o=i.toFixed(4),s=Bo(Number(o)),u=s[2]*Math.sqrt(s[3]/s[4]);s[1]===k_&&Math.abs(i-u)>1e-15&&console.log(`fail testapproxRadicals with 4 digits:: 1 * sqrt( ${t} / ${r} ) . obtained: ${s}`)}for(let t=1;t<=5;t++)for(let r=1;r<=5;r++){console.log(`testApproxAll testing: 1 * log(${t} ) / ${r}`);let n=t/r,i=Math.log(t)/r,o=Se(i),s=o[2]*Math.log(o[3])/o[4];Math.abs(i-s)>1e-15&&console.log(`fail testApproxAll: 1 * log(${t} ) / ${r} . obtained: ${o}`)}for(let t=1;t<=5;t++)for(let r=1;r<=5;r++){console.log(`testApproxAll testing with 4 digits: 1 * log(${t} ) / ${r}`);let n=t/r,i=Math.log(t)/r,o=i.toFixed(4),s=Se(Number(o)),u=s[2]*Math.log(s[3])/s[4];Math.abs(i-u)>1e-15&&console.log(`fail testApproxAll with 4 digits: 1 * log(${t} ) / ${r} . obtained: ${s}`)}for(let t=1;t<=5;t++)for(let r=1;r<=5;r++){console.log(`testApproxAll testing: 1 * log(${t} / ${r} )}`);let n=t/r,i=Math.log(t/r),o=Se(i),s=o[2]*Math.log(o[3]/o[4]);Math.abs(i-s)>1e-15&&console.log(`fail testApproxAll: 1 * log(${t} / ${r} ) . obtained: ${o}`)}for(let t=1;t<=5;t++)for(let r=1;r<=5;r++){console.log(`testApproxAll testing with 4 digits: 1 * log(${t} / ${r} )`);let n=t/r,i=Math.log(t/r),o=i.toFixed(4),s=Se(Number(o)),u=s[2]*Math.log(s[3]/s[4]);Math.abs(i-u)>1e-15&&console.log(`fail testApproxAll with 4 digits: 1 * log(${t} / ${r} ) . obtained: ${s}`)}for(let t=1;t<=2;t++)for(let r=1;r<=12;r++){console.log(`testApproxAll testing: 1 * (e ^ ${t} ) / ${r}`);let n=t/r,i=Math.pow(Math.E,t)/r,o=Se(i),s=o[2]*Math.pow(Math.E,o[3])/o[4];Math.abs(i-s)>1e-15&&console.log(`fail testApproxAll: 1 * (e ^ ${t} ) / ${r} . obtained: ${o}`)}for(let t=1;t<=2;t++)for(let r=1;r<=12;r++){console.log(`approxRationalsOfPowersOfE testing with 4 digits: 1 * (e ^ ${t} ) / ${r}`);let n=t/r,i=Math.pow(Math.E,t)/r,o=i.toFixed(4),s=Q1(Number(o)),u=s[2]*Math.pow(Math.E,s[3])/s[4];Math.abs(i-u)>1e-15&&console.log(`fail approxRationalsOfPowersOfE with 4 digits: 1 * (e ^ ${t} ) / ${r} . obtained: ${s}`)}for(let t=1;t<=2;t++)for(let r=1;r<=12;r++){console.log(`testApproxAll testing: 1 * pi ^ ${t} / ${r}`);let n=t/r,i=Math.pow(Math.PI,t)/r,o=Se(i),s=o[2]*Math.pow(Math.PI,o[3])/o[4];Math.abs(i-s)>1e-15&&console.log(`fail testApproxAll: 1 * pi ^ ${t} / ${r} ) . obtained: ${o}`)}for(let t=1;t<=2;t++)for(let r=1;r<=12;r++){console.log(`approxRationalsOfPowersOfPI testing with 4 digits: 1 * pi ^ ${t} / ${r}`);let n=t/r,i=Math.pow(Math.PI,t)/r,o=i.toFixed(4),s=$_(Number(o)),u=s[2]*Math.pow(Math.PI,s[3])/s[4];Math.abs(i-u)>1e-15&&console.log(`fail approxRationalsOfPowersOfPI with 4 digits: 1 * pi ^ ${t} / ${r} ) . obtained: ${s}`)}for(let t=1;t<=4;t++)for(let r=1;r<=4;r++){console.log(`testApproxAll testing: 1 * sin( ${t}/${r} )}`);let n=t/r,i=Math.sin(n),o=Se(i),s=o[3]/o[4],u=o[2]*Math.sin(s);Math.abs(i-u)>1e-15&&console.log(`fail testApproxAll: 1 * sin( ${t}/${r} ) . obtained: ${o}`)}for(let t=1;t<=4;t++)for(let r=1;r<=4;r++){console.log(`testApproxAll testing with 5 digits: 1 * sin( ${t}/${r} )`);let n=t/r,i=Math.sin(n),o=i.toFixed(5),s=Se(Number(o));s==null&&console.log(`fail testApproxAll with 5 digits: 1 * sin( ${t}/${r} ) . obtained:  undefined `);let u=s[3]/s[4],c=s[2]*Math.sin(u),d=Math.abs(i-c);d>1e-14&&console.log(`fail testApproxAll with 5 digits: 1 * sin( ${t}/${r} ) . obtained: ${s} error: ${d}`)}for(let t=1;t<=4;t++)for(let r=1;r<=4;r++){console.log(`testApproxAll testing with 4 digits: 1 * sin( ${t}/${r} )`);let n=t/r,i=Math.sin(n),o=i.toFixed(4),s=Se(Number(o));s==null&&console.log(`fail testApproxAll with 4 digits: 1 * sin( ${t}/${r} ) . obtained:  undefined `);let u=s[3]/s[4],c=s[2]*Math.sin(u),d=Math.abs(i-c);d>1e-14&&console.log(`fail testApproxAll with 4 digits: 1 * sin( ${t}/${r} ) . obtained: ${s} error: ${d}`)}let e=0;Se(e)[0]!=="0"&&console.log("fail testApproxAll: 0"),e=0,Se(e)[0]!=="0"&&console.log("fail testApproxAll: 0.0"),e=0,Se(e)[0]!=="0"&&console.log("fail testApproxAll: 0.00"),e=0,Se(e)[0]!=="0"&&console.log("fail testApproxAll: 0.000"),e=0,Se(e)[0]!=="0"&&console.log("fail testApproxAll: 0.0000"),e=1,Se(e)[0]!=="1"&&console.log("fail testApproxAll: 1"),e=1,Se(e)[0]!=="1"&&console.log("fail testApproxAll: 1.0"),e=1,Se(e)[0]!=="1"&&console.log("fail testApproxAll: 1.00"),e=1,Se(e)[0]!=="1"&&console.log("fail testApproxAll: 1.000"),e=1,Se(e)[0]!=="1"&&console.log("fail testApproxAll: 1.0000"),e=1,Se(e)[0]!=="1"&&console.log("fail testApproxAll: 1.00000"),e=Math.sqrt(2),Se(e)[0]!=="1 * sqrt( 2 ) / 1"&&console.log("fail testApproxAll: Math.sqrt(2)"),e=1.41,Se(e)[0]!=="1 * sqrt( 2 ) / 1"&&console.log("fail testApproxAll: 1.41"),e=1.4,Bo(e)[0]!=="1 * sqrt( 2 ) / 1"&&console.log("fail approxRadicals: 1.4"),e=.6,Kl(e)[0]!=="1 * log( 2 ) / 1"&&console.log("fail approxLogs: 0.6"),e=.69,Kl(e)[0]!=="1 * log( 2 ) / 1"&&console.log("fail approxLogs: 0.69"),e=.7,Kl(e)[0]!=="1 * log( 2 ) / 1"&&console.log("fail approxLogs: 0.7"),e=1.09,Kl(e)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxLogs: 1.09"),e=1.09,Se(e)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.09"),e=1.098,Se(e)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.098"),e=1.1,Se(e)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.1"),e=1.11,Se(e)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.11"),e=Math.sqrt(3),Se(e)[0]!=="1 * sqrt( 3 ) / 1"&&console.log("fail testApproxAll: Math.sqrt(3)"),e=1,Se(e)[0]!=="1"&&console.log("fail testApproxAll: 1.0000"),e=3.141592,Se(e)[0]!=="1 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 3.141592"),e=31.41592,Se(e)[0]!=="10 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 31.41592"),e=314.1592,Se(e)[0]!=="100 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 314.1592"),e=3141592653589793e-8,Se(e)[0]!=="10000000 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 31415926.53589793"),e=Math.sqrt(2),eu(e)[0]!=="2 * sin( 1/4 * pi )"&&console.log("fail approxTrigonometric: Math.sqrt(2)"),e=Math.sqrt(3),eu(e)[0]!=="2 * sin( 1/3 * pi )"&&console.log("fail approxTrigonometric: Math.sqrt(3)"),e=(Math.sqrt(6)-Math.sqrt(2))/4,Se(e)[0]!=="1 * sin( 1/12 * pi )"&&console.log("fail testApproxAll: (Math.sqrt(6) - Math.sqrt(2))/4"),e=Math.sqrt(2-Math.sqrt(2))/2,Se(e)[0]!=="1 * sin( 1/8 * pi )"&&console.log("fail testApproxAll: Math.sqrt(2 - Math.sqrt(2))/2"),e=(Math.sqrt(6)+Math.sqrt(2))/4,Se(e)[0]!=="1 * sin( 5/12 * pi )"&&console.log("fail testApproxAll: (Math.sqrt(6) + Math.sqrt(2))/4"),e=Math.sqrt(2+Math.sqrt(3))/2,Se(e)[0]!=="1 * sin( 5/12 * pi )"&&console.log("fail testApproxAll: Math.sqrt(2 + Math.sqrt(3))/2"),e=(Math.sqrt(5)-1)/4,Se(e)[0]!=="1 * sin( 1/10 * pi )"&&console.log("fail testApproxAll: (Math.sqrt(5) - 1)/4"),e=Math.sqrt(10-2*Math.sqrt(5))/4,Se(e)[0]!=="1 * sin( 1/5 * pi )"&&console.log("fail testApproxAll: Math.sqrt(10 - 2*Math.sqrt(5))/4"),e=Math.sin(Math.PI/7),Se(e)[0]!=="1 * sin( 1/7 * pi )"&&console.log("fail testApproxAll: Math.sin(Math.PI/7)"),e=Math.sin(Math.PI/9),Se(e)[0]!=="1 * sin( 1/9 * pi )"&&console.log("fail testApproxAll: Math.sin(Math.PI/9)"),e=1836.15267,$_(e)[0]!=="6 * (pi ^ 5 ) / 1 )"&&console.log("fail approxRationalsOfPowersOfPI: 1836.15267");for(let t=1;t<=13;t++)for(let r=1;r<=13;r++){console.log(`approxTrigonometric testing: 1 * sin( ${t}/${r} * pi )`);let n=t/r;e=Math.sin(Math.PI*n);let i=eu(e),o=i[3]/i[4],s=i[2]*Math.sin(Math.PI*o);Math.abs(e-s)>1e-15&&console.log(`fail approxTrigonometric: 1 * sin( ${t}/${r} * pi ) . obtained: ${i}`)}for(let t=1;t<=13;t++)for(let r=1;r<=13;r++){if(t===5&&r===11||t===6&&r===11)continue;console.log(`approxTrigonometric testing with 4 digits: 1 * sin( ${t}/${r} * pi )`);let n=t/r,i=Math.sin(Math.PI*n),o=i.toFixed(4),s=eu(Number(o)),u=s[3]/s[4],c=s[2]*Math.sin(Math.PI*u),d=Math.abs(i-c);d>1e-14&&console.log(`fail approxTrigonometric with 4 digits: 1 * sin( ${t}/${r} * pi ) . obtained: ${s} error: ${d}`)}return console.log("testApprox done")}Kr.testApprox=hw});var J1=A(lf=>{"use strict";Object.defineProperty(lf,"__esModule",{value:!0});lf.Eval_arccos=void 0;var re=N(),en=U(),fr=j(),Aw=G(),$n=Q(),W1=ee(),eo=X();function Ow(e){return Mw(Aw.Eval(re.cadr(e)))}lf.Eval_arccos=Ow;function Mw(e){if(re.car(e)===en.symbol(re.COS))return re.cadr(e);if(re.isdouble(e))return fr.double(Math.acos(e.d));if($n.isoneoversqrttwo(e)||re.ismultiply(e)&&$n.equalq(re.car(re.cdr(e)),1,2)&&re.car(re.car(re.cdr(re.cdr(e))))===en.symbol(re.POWER)&&$n.equaln(re.car(re.cdr(re.car(re.cdr(re.cdr(e))))),2)&&$n.equalq(re.car(re.cdr(re.cdr(re.car(re.cdr(re.cdr(e)))))),1,2))return re.defs.evaluatingAsFloats?fr.double(Math.PI/4):eo.multiply(fr.rational(1,4),en.symbol(re.PI));if($n.isminusoneoversqrttwo(e)||re.ismultiply(e)&&$n.equalq(re.car(re.cdr(e)),-1,2)&&re.car(re.car(re.cdr(re.cdr(e))))===en.symbol(re.POWER)&&$n.equaln(re.car(re.cdr(re.car(re.cdr(re.cdr(e))))),2)&&$n.equalq(re.car(re.cdr(re.cdr(re.car(re.cdr(re.cdr(e)))))),1,2))return re.defs.evaluatingAsFloats?fr.double(Math.PI*3/4):eo.multiply(fr.rational(3,4),en.symbol(re.PI));if($n.isSqrtThreeOverTwo(e))return re.defs.evaluatingAsFloats?fr.double(Math.PI/6):eo.multiply(fr.rational(1,6),en.symbol(re.PI));if($n.isMinusSqrtThreeOverTwo(e))return re.defs.evaluatingAsFloats?fr.double(5*Math.PI/6):eo.multiply(fr.rational(5,6),en.symbol(re.PI));if(!re.isrational(e))return W1.makeList(en.symbol(re.ARCCOS),e);switch(fr.nativeInt(eo.multiply(e,fr.integer(2)))){case-2:return re.Constants.Pi();case-1:return re.defs.evaluatingAsFloats?fr.double(Math.PI*2/3):eo.multiply(fr.rational(2,3),en.symbol(re.PI));case 0:return re.defs.evaluatingAsFloats?fr.double(Math.PI/2):eo.multiply(fr.rational(1,2),en.symbol(re.PI));case 1:return re.defs.evaluatingAsFloats?fr.double(Math.PI/3):eo.multiply(fr.rational(1,3),en.symbol(re.PI));case 2:return re.Constants.Zero();default:return W1.makeList(en.symbol(re.ARCCOS),e)}}});var eq=A(uf=>{"use strict";Object.defineProperty(uf,"__esModule",{value:!0});uf.Eval_arccosh=void 0;var Go=N(),Tw=Ee(),K1=U(),Nw=j(),Iw=G(),Sw=Q(),ww=ee();function Rw(e){return Lw(Iw.Eval(Go.cadr(e)))}uf.Eval_arccosh=Rw;function Lw(e){if(Go.car(e)===K1.symbol(Go.COSH))return Go.cadr(e);if(Go.isdouble(e)){let{d:t}=e;return t<1&&Tw.stop("arccosh function argument is less than 1.0"),t=Math.log(t+Math.sqrt(t*t-1)),Nw.double(t)}return Sw.isplusone(e)?Go.Constants.zero:ww.makeList(K1.symbol(Go.ARCCOSH),e)}});var rq=A(cf=>{"use strict";Object.defineProperty(cf,"__esModule",{value:!0});cf.Eval_arcsin=void 0;var ne=N(),$r=U(),er=j(),Cw=G(),Un=Q(),tq=ee(),gi=X();function Pw(e){return Dw(Cw.Eval(ne.cadr(e)))}cf.Eval_arcsin=Pw;function Dw(e){if(ne.car(e)===$r.symbol(ne.SIN))return ne.cadr(e);if(ne.isdouble(e))return er.double(Math.asin(e.d));if(Un.isoneoversqrttwo(e)||ne.ismultiply(e)&&Un.equalq(ne.car(ne.cdr(e)),1,2)&&ne.car(ne.car(ne.cdr(ne.cdr(e))))===$r.symbol(ne.POWER)&&Un.equaln(ne.car(ne.cdr(ne.car(ne.cdr(ne.cdr(e))))),2)&&Un.equalq(ne.car(ne.cdr(ne.cdr(ne.car(ne.cdr(ne.cdr(e)))))),1,2))return gi.multiply(er.rational(1,4),$r.symbol(ne.PI));if(Un.isminusoneoversqrttwo(e)||ne.ismultiply(e)&&Un.equalq(ne.car(ne.cdr(e)),-1,2)&&ne.car(ne.car(ne.cdr(ne.cdr(e))))===$r.symbol(ne.POWER)&&Un.equaln(ne.car(ne.cdr(ne.car(ne.cdr(ne.cdr(e))))),2)&&Un.equalq(ne.car(ne.cdr(ne.cdr(ne.car(ne.cdr(ne.cdr(e)))))),1,2))return ne.defs.evaluatingAsFloats?er.double(-Math.PI/4):gi.multiply(er.rational(-1,4),$r.symbol(ne.PI));if(Un.isSqrtThreeOverTwo(e))return ne.defs.evaluatingAsFloats?er.double(Math.PI/3):gi.multiply(er.rational(1,3),$r.symbol(ne.PI));if(Un.isMinusSqrtThreeOverTwo(e))return ne.defs.evaluatingAsFloats?er.double(-Math.PI/3):gi.multiply(er.rational(-1,3),$r.symbol(ne.PI));if(!ne.isrational(e))return tq.makeList($r.symbol(ne.ARCSIN),e);switch(er.nativeInt(gi.multiply(e,er.integer(2)))){case-2:return ne.defs.evaluatingAsFloats?er.double(-Math.PI/2):gi.multiply(er.rational(-1,2),$r.symbol(ne.PI));case-1:return ne.defs.evaluatingAsFloats?er.double(-Math.PI/6):gi.multiply(er.rational(-1,6),$r.symbol(ne.PI));case 0:return ne.Constants.Zero();case 1:return ne.defs.evaluatingAsFloats?er.double(Math.PI/6):gi.multiply(er.rational(1,6),$r.symbol(ne.PI));case 2:return ne.defs.evaluatingAsFloats?er.double(Math.PI/2):gi.multiply(er.rational(1,2),$r.symbol(ne.PI));default:return tq.makeList($r.symbol(ne.ARCSIN),e)}}});var iq=A(ff=>{"use strict";Object.defineProperty(ff,"__esModule",{value:!0});ff.Eval_arcsinh=void 0;var Fo=N(),nq=U(),kw=j(),$w=G(),Uw=Q(),Bw=ee();function Gw(e){return Fw($w.Eval(Fo.cadr(e)))}ff.Eval_arcsinh=Gw;function Fw(e){if(Fo.car(e)===nq.symbol(Fo.SINH))return Fo.cadr(e);if(Fo.isdouble(e)){let{d:t}=e;return t=Math.log(t+Math.sqrt(t*t+1)),kw.double(t)}return Uw.isZeroAtomOrTensor(e)?Fo.Constants.zero:Bw.makeList(nq.symbol(Fo.ARCSINH),e)}});var sq=A(df=>{"use strict";Object.defineProperty(df,"__esModule",{value:!0});df.Eval_arctanh=void 0;var jo=N(),jw=Ee(),oq=U(),zw=j(),Yw=G(),Vw=Q(),Zw=ee();function Xw(e){return Hw(Yw.Eval(jo.cadr(e)))}df.Eval_arctanh=Xw;function Hw(e){if(jo.car(e)===oq.symbol(jo.TANH))return jo.cadr(e);if(jo.isdouble(e)){let{d:t}=e;return(t<-1||t>1)&&jw.stop("arctanh function argument is not in the interval [-1,1]"),t=Math.log((1+t)/(1-t))/2,zw.double(t)}return Vw.isZeroAtomOrTensor(e)?jo.Constants.zero:Zw.makeList(oq.symbol(jo.ARCTANH),e)}});var uq=A(mf=>{"use strict";Object.defineProperty(mf,"__esModule",{value:!0});mf.Eval_binomial=void 0;var yi=N(),B_=Ie(),Qw=ce(),aq=G(),G_=ho(),lq=X();function Ww(e){let t=aq.Eval(yi.cadr(e)),r=aq.Eval(yi.caddr(e));return Jw(t,r)}mf.Eval_binomial=Ww;function Jw(e,t){return Kw(e,t)}function Kw(e,t){return eR(e,t)?lq.divide(lq.divide(G_.factorial(e),G_.factorial(t)),G_.factorial(Qw.subtract(e,t))):yi.Constants.zero}function eR(e,t){return yi.isNumericAtom(e)&&B_.lessp(e,yi.Constants.zero)||yi.isNumericAtom(t)&&B_.lessp(t,yi.Constants.zero)?!1:!(yi.isNumericAtom(e)&&yi.isNumericAtom(t)&&B_.lessp(e,t))}});var fq=A(_f=>{"use strict";Object.defineProperty(_f,"__esModule",{value:!0});_f.Eval_ceiling=void 0;var Ta=N(),tR=U(),rR=ce(),nR=j(),iR=G(),cq=Q(),oR=ee(),sR=cn();function aR(e){return lR(iR.Eval(Ta.cadr(e)))}_f.Eval_ceiling=aR;function lR(e){return uR(e)}function uR(e){if(!Ta.isNumericAtom(e))return oR.makeList(tR.symbol(Ta.CEILING),e);if(Ta.isdouble(e))return nR.double(Math.ceil(e.d));if(cq.isinteger(e))return e;let t=new Ta.Num(sR.mdiv(e.q.a,e.q.b));return cq.isnegativenumber(e)||(t=rR.add(t,Ta.Constants.one)),t}});var _q=A(bf=>{"use strict";Object.defineProperty(bf,"__esModule",{value:!0});bf.Eval_choose=void 0;var vi=N(),F_=Ie(),cR=ce(),dq=G(),j_=ho(),mq=X();function fR(e){let t=dq.Eval(vi.cadr(e)),r=dq.Eval(vi.caddr(e));return dR(t,r)}bf.Eval_choose=fR;function dR(e,t){return mR(e,t)?mq.divide(mq.divide(j_.factorial(e),j_.factorial(t)),j_.factorial(cR.subtract(e,t))):vi.Constants.zero}function mR(e,t){return vi.isNumericAtom(e)&&F_.lessp(e,vi.Constants.zero)||vi.isNumericAtom(t)&&F_.lessp(t,vi.Constants.zero)?!1:!(vi.isNumericAtom(e)&&vi.isNumericAtom(t)&&F_.lessp(e,t))}});var Y_=A(Na=>{"use strict";Object.defineProperty(Na,"__esModule",{value:!0});Na.expcos=Na.Eval_expcos=void 0;var z_=N(),bq=Ie(),_R=ce(),gq=j(),bR=G(),tu=X();function gR(e){return yq(bR.Eval(z_.cadr(e)))}Na.Eval_expcos=gR;function yq(e){return _R.add(tu.multiply(bq.exponential(tu.multiply(z_.Constants.imaginaryunit,e)),gq.rational(1,2)),tu.multiply(bq.exponential(tu.multiply(tu.negate(z_.Constants.imaginaryunit),e)),gq.rational(1,2)))}Na.expcos=yq});var V_=A(Ia=>{"use strict";Object.defineProperty(Ia,"__esModule",{value:!0});Ia.expsin=Ia.Eval_expsin=void 0;var ru=N(),vq=Ie(),yR=ce(),qq=j(),vR=G(),zo=X();function qR(e){return Eq(vR.Eval(ru.cadr(e)))}Ia.Eval_expsin=qR;function Eq(e){return yR.subtract(zo.multiply(zo.divide(vq.exponential(zo.multiply(ru.Constants.imaginaryunit,e)),ru.Constants.imaginaryunit),qq.rational(1,2)),zo.multiply(zo.divide(vq.exponential(zo.multiply(zo.negate(ru.Constants.imaginaryunit),e)),ru.Constants.imaginaryunit),qq.rational(1,2)))}Ia.expsin=Eq});var pq=A(gf=>{"use strict";Object.defineProperty(gf,"__esModule",{value:!0});gf.Eval_circexp=void 0;var bt=N(),Sa=U(),Yo=Ie(),wa=ce(),Z_=j(),xq=G(),ER=Y_(),xR=V_(),gn=X(),pR=Et();function hR(e){let t=X_(xq.Eval(bt.cadr(e)));return xq.Eval(t)}gf.Eval_circexp=hR;function X_(e){if(bt.car(e)===Sa.symbol(bt.COS))return ER.expcos(bt.cadr(e));if(bt.car(e)===Sa.symbol(bt.SIN))return xR.expsin(bt.cadr(e));if(bt.car(e)===Sa.symbol(bt.TAN)){e=bt.cadr(e);let t=Yo.exponential(gn.multiply(bt.Constants.imaginaryunit,e)),r=Yo.exponential(gn.negate(gn.multiply(bt.Constants.imaginaryunit,e)));return gn.divide(gn.multiply(wa.subtract(r,t),bt.Constants.imaginaryunit),wa.add(t,r))}return bt.car(e)===Sa.symbol(bt.COSH)?(e=bt.cadr(e),gn.multiply(wa.add(Yo.exponential(e),Yo.exponential(gn.negate(e))),Z_.rational(1,2))):bt.car(e)===Sa.symbol(bt.SINH)?(e=bt.cadr(e),gn.multiply(wa.subtract(Yo.exponential(e),Yo.exponential(gn.negate(e))),Z_.rational(1,2))):bt.car(e)===Sa.symbol(bt.TANH)?(e=Yo.exponential(gn.multiply(bt.cadr(e),Z_.integer(2))),gn.divide(wa.subtract(e,bt.Constants.one),wa.add(e,bt.Constants.one))):bt.iscons(e)?e.map(X_):(e.k===bt.TENSOR&&(e=pR.copy_tensor(e),e.tensor.elem=e.tensor.elem.map(X_)),e)}});var Aq=A(yf=>{"use strict";Object.defineProperty(yf,"__esModule",{value:!0});yf.Eval_contract=void 0;var AR=St(),qi=N(),hq=Ee(),OR=U(),MR=ce(),H_=j(),Q_=G(),TR=Q();function NR(e){let t=Q_.Eval(qi.cadr(e)),r,n;return qi.cddr(e)===OR.symbol(qi.NIL)?(r=qi.Constants.one,n=H_.integer(2)):(r=Q_.Eval(qi.caddr(e)),n=Q_.Eval(qi.cadddr(e))),IR(t,r,n)}yf.Eval_contract=NR;function IR(e,t,r){let n=[],i=[];if(!qi.istensor(e))return TR.isZeroAtomOrTensor(e)||hq.stop("contract: tensor expected, 1st arg is not a tensor"),qi.Constants.zero;let o=H_.nativeInt(t),s=H_.nativeInt(r),{ndim:u}=e.tensor;(o<1||o>u||s<1||s>u||o===s||e.tensor.dim[o-1]!==e.tensor.dim[s-1])&&hq.stop("contract: index out of range"),o--,s--;let c=e.tensor.dim[o],d=1;for(let k=0;k<u;k++)k!==o&&k!==s&&(d*=e.tensor.dim[k]);t=AR.alloc_tensor(d),t.tensor.ndim=u-2;let _=0;for(let k=0;k<u;k++)k!==o&&k!==s&&(t.tensor.dim[_++]=e.tensor.dim[k]);let w=e.tensor.elem,T=t.tensor.elem;for(let k=0;k<u;k++)n[k]=0,i[k]=e.tensor.dim[k];for(let k=0;k<d;k++){let Z=qi.Constants.zero;for(let Y=0;Y<c;Y++){n[o]=Y,n[s]=Y;let Ae=0;for(let tt=0;tt<u;tt++)Ae=Ae*i[tt]+n[tt];Z=MR.add(Z,w[Ae])}T[k]=Z;for(let Y=u-1;Y>=0;Y--)if(!(Y===o||Y===s)){if(++n[Y]<i[Y])break;n[Y]=0}}return d===1?T[0]:t}});var Mq=A(vf=>{"use strict";Object.defineProperty(vf,"__esModule",{value:!0});vf.Eval_defint=void 0;var Ei=N(),SR=ce(),Ra=G(),wR=Fl(),Oq=Zr();function RR(e){let t=Ra.Eval(Ei.cadr(e));for(e=Ei.cddr(e);Ei.iscons(e);){let r=Ra.Eval(Ei.car(e));e=Ei.cdr(e);let n=Ra.Eval(Ei.car(e));e=Ei.cdr(e);let i=Ra.Eval(Ei.car(e));e=Ei.cdr(e),t=wR.integral(t,r);let o=Ra.Eval(Oq.subst(t,r,i)),s=Ra.Eval(Oq.subst(t,r,n));t=SR.subtract(o,s)}return t}vf.Eval_defint=RR});var qf=A(La=>{"use strict";Object.defineProperty(La,"__esModule",{value:!0});La.degree=La.Eval_degree=void 0;var tn=N(),LR=U(),W_=Ie(),Tq=G(),CR=Xr(),PR=Q();function DR(e){let t=Tq.Eval(tn.cadr(e));e=Tq.Eval(tn.caddr(e));let r=e===LR.symbol(tn.NIL)?CR.guess(t):e;return Nq(t,r)}La.Eval_degree=DR;function Nq(e,t){return Iq(e,t,tn.Constants.zero)}La.degree=Nq;function Iq(e,t,r){return W_.equal(e,t)?PR.isZeroAtomOrTensor(r)&&(r=tn.Constants.one):tn.ispower(e)?W_.equal(tn.cadr(e),t)&&tn.isNumericAtom(tn.caddr(e))&&W_.lessp(r,tn.caddr(e))&&(r=tn.caddr(e)):tn.iscons(e)&&(r=e.tail().reduce((n,i)=>Iq(i,t,n),r)),r}});var Cq=A(to=>{"use strict";Object.defineProperty(to,"__esModule",{value:!0});to.Eval_eigenvec=to.Eval_eigenval=to.Eval_eigen=void 0;var Ur=N(),Ef=Ee(),Vo=U(),Sq=j(),wq=G(),kR=Rn(),Rq=ee(),$R=ri(),Lq=Et(),ue=0,Xt=[],xi=[];function UR(e){let{arg:t}=J_(e);t||Ef.stop("eigen: argument is not a square matrix");let[r,n]=K_(Ur.EIGEN,t);return e=Vo.usr_symbol("D"),Vo.set_binding(e,r),e=Vo.usr_symbol("Q"),Vo.set_binding(e,n),Vo.symbol(Ur.NIL)}to.Eval_eigen=UR;function BR(e){let{arg:t,invalid:r}=J_(e);if(r)return Rq.makeList(Vo.symbol(Ur.EIGENVAL),r);let[n,i]=K_(Ur.EIGENVAL,t);return n}to.Eval_eigenval=BR;function GR(e){let{arg:t,invalid:r}=J_(e);if(r)return Rq.makeList(Vo.symbol(Ur.EIGENVEC),r);let[n,i]=K_(Ur.EIGENVEC,t);return i}to.Eval_eigenvec=GR;function J_(e){if(e=wq.Eval(kR.yyfloat(wq.Eval(Ur.cadr(e)))),!Ur.istensor(e))return{invalid:e};(e.tensor.ndim!==2||e.tensor.dim[0]!==e.tensor.dim[1])&&Ef.stop("eigen: argument is not a square matrix"),ue=e.tensor.dim[0],FR(e)||Ef.stop("eigen: matrix is not numerical");for(let t=0;t<ue-1;t++)for(let r=t+1;r<ue;r++){let n=e.tensor.elem[ue*t+r],i=e.tensor.elem[ue*r+t];Math.abs(n.d-i.d)>1e-10&&Ef.stop("eigen: matrix is not symmetrical")}return{arg:e}}function FR(e){for(let t=0;t<ue;t++)for(let r=0;r<ue;r++)if(!Ur.isdouble(e.tensor.elem[ue*t+r]))return!1;return!0}function K_(e,t){for(let o=0;o<ue*ue;o++)Xt[o]=0;for(let o=0;o<ue*ue;o++)xi[o]=0;for(let o=0;o<ue;o++){Xt[ue*o+o]=t.tensor.elem[ue*o+o].d;for(let s=o+1;s<ue;s++)Xt[ue*o+s]=t.tensor.elem[ue*o+s].d,Xt[ue*s+o]=t.tensor.elem[ue*o+s].d}for(let o=0;o<ue;o++){xi[ue*o+o]=1;for(let s=o+1;s<ue;s++)xi[ue*o+s]=0,xi[ue*s+o]=0}let r=0;for(r=0;r<100&&jR()!==0;r++);r===100&&$R.print_str(`
note: eigen did not converge
`);let n;if(e===Ur.EIGEN||e===Ur.EIGENVAL){n=Lq.copy_tensor(t);for(let o=0;o<ue;o++)for(let s=0;s<ue;s++)n.tensor.elem[ue*o+s]=Sq.double(Xt[ue*o+s])}let i;if(e===Ur.EIGEN||e===Ur.EIGENVEC){i=Lq.copy_tensor(t);for(let o=0;o<ue;o++)for(let s=0;s<ue;s++)i.tensor.elem[ue*o+s]=Sq.double(xi[ue*o+s])}return[n,i]}function jR(){let e=0;for(let t=0;t<ue-1;t++)for(let r=t+1;r<ue;r++)Xt[ue*t+r]!==0&&(zR(t,r),e++);return e}function zR(e,t){let r=.5*(Xt[ue*e+e]-Xt[ue*t+t])/Xt[ue*e+t],n=1/(Math.abs(r)+Math.sqrt(r*r+1));r<0&&(n=-n);let i=1/Math.sqrt(n*n+1),o=n*i;for(let s=0;s<ue;s++){let u=Xt[ue*e+s],c=Xt[ue*t+s];Xt[ue*e+s]=i*u+o*c,Xt[ue*t+s]=i*c-o*u}for(let s=0;s<ue;s++){let u=Xt[ue*s+e],c=Xt[ue*s+t];Xt[ue*s+e]=i*u+o*c,Xt[ue*s+t]=i*c-o*u}for(let s=0;s<ue;s++){let u=xi[ue*e+s],c=xi[ue*t+s];xi[ue*e+s]=i*u+o*c,xi[ue*t+s]=i*c-o*u}Xt[ue*e+t]=0,Xt[ue*t+e]=0}});var eb=A(Ca=>{"use strict";Object.defineProperty(Ca,"__esModule",{value:!0});Ca.erfc=Ca.Eval_erfc=void 0;var xf=N(),YR=U(),VR=j(),ZR=G(),XR=Q(),HR=ee();function QR(e){return WR(ZR.Eval(xf.cadr(e)))}Ca.Eval_erfc=QR;function WR(e){if(xf.isdouble(e)){let t=Pq(e.d);return VR.double(t)}return XR.isZeroAtomOrTensor(e)?xf.Constants.one:HR.makeList(YR.symbol(xf.ERFC),e)}function Pq(e){if(e===0)return 1;let t=Math.abs(e),r=1/(1+.5*t),n=r*Math.exp(-t*t-1.26551223+r*(1.00002368+r*(.37409196+r*(.09678418+r*(-.18628806+r*(.27886807+r*(-1.13520398+r*(1.48851587+r*(-.82215223+r*.17087277)))))))));return e>=0?n:2-n}Ca.erfc=Pq});var Bq=A(pf=>{"use strict";Object.defineProperty(pf,"__esModule",{value:!0});pf.Eval_erf=void 0;var nu=N(),Dq=U(),JR=j(),KR=eb(),eL=G(),kq=Q(),$q=ee(),Uq=X();function tL(e){return rL(eL.Eval(nu.cadr(e)))}pf.Eval_erf=tL;function rL(e){return nu.isdouble(e)?JR.double(1-KR.erfc(e.d)):kq.isZeroAtomOrTensor(e)?nu.Constants.zero:kq.isnegativeterm(e)?Uq.negate($q.makeList(Dq.symbol(nu.ERF),Uq.negate(e))):$q.makeList(Dq.symbol(nu.ERF),e)}});var jq=A(hf=>{"use strict";Object.defineProperty(hf,"__esModule",{value:!0});hf.factors=void 0;var Gq=N();function nL(e){let t=[];return Gq.isadd(e)?e.tail().forEach(r=>t.push(...Fq(r))):t.push(...Fq(e)),t}hf.factors=nL;function Fq(e){return Gq.ismultiply(e)?e.tail():[e]}});var Wq=A(Af=>{"use strict";Object.defineProperty(Af,"__esModule",{value:!0});Af.Eval_expand=void 0;var tb=St(),lt=N(),zq=or(),iL=U(),oL=Ie(),rb=ce(),Br=j(),Yq=qf(),sL=Tn(),nb=G(),aL=xs(),Vq=jq(),Zq=ll(),lL=Xr(),Xq=Gi(),uL=Il(),iu=Q(),Gr=X(),cL=si(),ro=xt(),fL=Fu(),dL=Et();function mL(e){let t=nb.Eval(lt.cadr(e)),r=nb.Eval(lt.caddr(e)),n=r===iL.symbol(lt.NIL)?lL.guess(t):r;return ib(t,n)}Af.Eval_expand=mL;function ib(e,t){if(lt.istensor(e))return _L(e,t);if(lt.isadd(e))return e.tail().reduce((u,c)=>rb.add(u,ib(c,t)),lt.Constants.zero);let r=cL.numerator(e),n=sL.denominator(e);if([n,r]=bL(n,r,t),(iu.isone(r)||iu.isone(n))&&(!iu.ispolyexpandedform(n,t)||iu.isone(n)))return e;let i=fL.divpoly(r,n,t);if(r=rb.subtract(r,Gr.multiply(n,i)),iu.isZeroAtomOrTensor(r))return i;n=aL.factorpoly(n,t);let o=gL(n,t);r=vL(r,o,t),n=qL(n,o,t);let s;if(lt.istensor(o)){let u=lt.doexpand(uL.inv,o);s=Xq.inner(Xq.inner(u,r),n)}else{let u=lt.doexpand(Gr.divide,r,o);s=Gr.multiply(u,n)}return rb.add(s,i)}function _L(e,t){return e=dL.copy_tensor(e),e.tensor.elem=e.tensor.elem.map(r=>ib(r,t)),e}function bL(e,t,r){let n=[...Vq.factors(e),...Vq.factors(t)],i=0;for(let o=0;o<n.length;o++){let s=n[o];if(!lt.ispower(s)||lt.cadr(s)!==r)continue;let u=Br.nativeInt(lt.caddr(s));isNaN(u)||u<i&&(i=u)}return i===0?[e,t]:(e=Gr.multiply(e,ro.power(r,Br.integer(-i))),t=Gr.multiply(t,ro.power(r,Br.integer(-i))),[e,t])}function gL(e,t){let r=[];lt.ismultiply(e)?e.tail().forEach(o=>r.push(...Hq(e,o,t))):r.push(...Hq(e,e,t));let n=r.length;if(n===1)return r[0];let i=tb.alloc_tensor(n*n);i.tensor.ndim=2,i.tensor.dim[0]=n,i.tensor.dim[1]=n;for(let o=0;o<n;o++)for(let s=0;s<n;s++){let u=ro.power(t,Br.integer(o)),c=lt.doexpand(Gr.divide,r[s],u);i.tensor.elem[n*o+s]=Zq.filter(c,t)}return i}function Hq(e,t,r){let n,i=0;if(!zq.Find(t,r))return[];let o=lt.doexpand(yL,e,t);lt.ispower(t)?(i=Br.nativeInt(lt.caddr(t)),n=lt.cadr(t)):(i=1,n=t);let s=[],u=Br.nativeInt(Yq.degree(n,r));for(let c=0;c<i;c++)for(let d=0;d<u;d++){let _=ro.power(n,Br.integer(c)),w=lt.doexpand(Gr.multiply,o,_);_=ro.power(r,Br.integer(d));let T=lt.doexpand(Gr.multiply,w,_);s.push(T)}return s}function yL(e,t){let r=lt.Constants.one;if(lt.ismultiply(e)){let n=[];e.tail().forEach(i=>{oL.equal(i,t)||n.push(nb.Eval(i))}),r=Gr.multiply_all(n)}return r}function vL(e,t,r){if(!lt.istensor(t))return e;let n=t.tensor.dim[0],i=tb.alloc_tensor(n);i.tensor.ndim=1,i.tensor.dim[0]=n;for(let o=0;o<n;o++){let s=ro.power(r,Br.integer(o)),u=lt.doexpand(Gr.divide,e,s);i.tensor.elem[o]=Zq.filter(u,r)}return i}function qL(e,t,r){if(!lt.istensor(t))return Gr.reciprocate(e);let n=[];lt.ismultiply(e)?e.tail().forEach(s=>{n.push(...Qq(s,r))}):n=Qq(e,r);let i=n.length,o=tb.alloc_tensor(i);return o.tensor.ndim=1,o.tensor.dim[0]=i,o.tensor.elem=n,o}function Qq(e,t){let r=1;if(!zq.Find(e,t))return[];lt.ispower(e)&&(r=Br.nativeInt(lt.caddr(e)),e=lt.cadr(e));let n=[],i=Br.nativeInt(Yq.degree(e,t));for(let o=r;o>0;o--)for(let s=0;s<i;s++)n.push(Gr.multiply(Gr.reciprocate(ro.power(e,Br.integer(o))),ro.power(t,Br.integer(s))));return n}});var Kq=A(Of=>{"use strict";Object.defineProperty(Of,"__esModule",{value:!0});Of.Eval_floor=void 0;var Pa=N(),EL=U(),xL=ce(),pL=j(),hL=G(),Jq=Q(),AL=ee(),OL=cn();function ML(e){return TL(hL.Eval(Pa.cadr(e)))}Of.Eval_floor=ML;function TL(e){return NL(e)}function NL(e){if(!Pa.isNumericAtom(e))return AL.makeList(EL.symbol(Pa.FLOOR),e);if(Pa.isdouble(e))return pL.double(Math.floor(e.d));if(Jq.isinteger(e))return e;let t=new Pa.Num(OL.mdiv(e.q.a,e.q.b));return Jq.isnegativenumber(e)&&(t=xL.add(t,Pa.Constants.negOne)),t}});var eE=A(Tf=>{"use strict";Object.defineProperty(Tf,"__esModule",{value:!0});Tf.Eval_for=void 0;var Da=N(),IL=Ee(),Mf=U(),SL=j(),ob=G();function wL(e){let t=Da.caddr(e);Da.issymbol(t)||IL.stop("for: 2nd arg should be the variable to loop over");let r=ob.evaluate_integer(Da.cadddr(e));if(isNaN(r))return e;let n=ob.evaluate_integer(Da.caddddr(e));if(isNaN(n))return e;let i=Mf.get_binding(t);for(let o=r;o<=n;o++)Mf.set_binding(t,SL.integer(o)),ob.Eval(Da.cadr(e));return Mf.set_binding(t,i),Mf.symbol(Da.NIL)}Tf.Eval_for=wL});var iE=A(If=>{"use strict";Object.defineProperty(If,"__esModule",{value:!0});If.Eval_gamma=void 0;var We=N(),tE=U(),RL=ce(),sb=j(),LL=G(),CL=Q(),rE=ee(),pi=X(),nE=xt(),PL=Jn();function DL(e){return Nf(LL.Eval(We.cadr(e)))}If.Eval_gamma=DL;function Nf(e){return kL(e)}function kL(e){return We.isrational(e)&&We.MEQUAL(e.q.a,1)&&We.MEQUAL(e.q.b,2)?nE.power(We.Constants.Pi(),sb.rational(1,2)):We.isrational(e)&&We.MEQUAL(e.q.a,3)&&We.MEQUAL(e.q.b,2)?pi.multiply(nE.power(We.Constants.Pi(),sb.rational(1,2)),sb.rational(1,2)):CL.isnegativeterm(e)?pi.divide(pi.multiply(We.Constants.Pi(),We.Constants.negOne),pi.multiply(pi.multiply(PL.sine(pi.multiply(We.Constants.Pi(),e)),e),Nf(pi.negate(e)))):We.isadd(e)?$L(e):rE.makeList(tE.symbol(We.GAMMA),e)}function $L(e){let t=We.cdr(e);return We.isrational(We.car(t))&&We.MEQUAL(We.car(t).q.a,1)&&We.MEQUAL(We.car(t).q.b,1)?pi.multiply(We.cadr(t),Nf(We.cadr(t))):We.isrational(We.car(t))&&We.MEQUAL(We.car(t).q.a,-1)&&We.MEQUAL(We.car(t).q.b,1)?pi.divide(Nf(We.cadr(t)),RL.add(We.cadr(t),We.Constants.negOne)):rE.makeList(tE.symbol(We.GAMMA),e)}});var oE=A(Sf=>{"use strict";Object.defineProperty(Sf,"__esModule",{value:!0});Sf.Eval_isprime=void 0;var ab=N(),UL=G(),BL=Q(),GL=Yd();function FL(e){return jL(UL.Eval(ab.cadr(e)))}Sf.Eval_isprime=FL;function jL(e){return BL.isnonnegativeinteger(e)&&GL.mprime(e.q.a)?ab.Constants.one:ab.Constants.zero}});var aE=A(Pf=>{"use strict";Object.defineProperty(Pf,"__esModule",{value:!0});Pf.Eval_laguerre=void 0;var yn=N(),wf=U(),Rf=ce(),Lf=j(),Cf=G(),zL=ee(),lb=X(),YL=Zr();function VL(e){let t=Cf.Eval(yn.cadr(e)),r=Cf.Eval(yn.caddr(e)),n=Cf.Eval(yn.cadddr(e)),i=n===wf.symbol(yn.NIL)?yn.Constants.zero:n;return ZL(t,r,i)}Pf.Eval_laguerre=VL;function ZL(e,t,r){let n=Lf.nativeInt(t);return n<0||isNaN(n)?zL.makeList(wf.symbol(yn.LAGUERRE),e,t,r):yn.issymbol(e)?sE(n,e,r):Cf.Eval(YL.subst(sE(n,wf.symbol(yn.SECRETX),r),wf.symbol(yn.SECRETX),e))}function sE(e,t,r){let n=yn.Constants.zero,i=yn.Constants.one;for(let o=0;o<e;o++){let s=lb.divide(Rf.subtract(lb.multiply(Rf.add(Rf.subtract(Lf.integer(2*o+1),t),r),i),lb.multiply(Rf.add(Lf.integer(o),r),n)),Lf.integer(o+1));n=i,i=s}return i}});var uE=A(Df=>{"use strict";Object.defineProperty(Df,"__esModule",{value:!0});Df.Eval_leading=void 0;var ub=N(),XL=U(),HL=qf(),lE=G(),QL=ll(),WL=Xr(),JL=X(),KL=xt();function eC(e){let t=lE.Eval(ub.cadr(e));e=lE.Eval(ub.caddr(e));let r=e===XL.symbol(ub.NIL)?WL.guess(t):e;return tC(t,r)}Df.Eval_leading=eC;function tC(e,t){let r=HL.degree(e,t);return QL.filter(JL.divide(e,KL.power(t,r)),t)}});var dE=A($f=>{"use strict";Object.defineProperty($f,"__esModule",{value:!0});$f.Eval_legendre=void 0;var tr=N(),ka=U(),cb=Ie(),cE=ce(),Zo=j(),rC=Li(),nC=Ro(),kf=G(),iC=ee(),Xo=X(),oC=xt(),sC=Jn(),aC=Zr();function lC(e){let t=kf.Eval(tr.cadr(e)),r=kf.Eval(tr.caddr(e)),n=kf.Eval(tr.cadddr(e)),i=n===ka.symbol(tr.NIL)?tr.Constants.zero:n;return uC(t,r,i)}$f.Eval_legendre=lC;function uC(e,t,r){return cC(e,t,r)}function cC(e,t,r){let n=Zo.nativeInt(t),i=Zo.nativeInt(r);if(n<0||isNaN(n)||i<0||isNaN(i))return iC.makeList(ka.symbol(tr.LEGENDRE),e,t,r);let o;if(tr.issymbol(e))o=fE(n,i,e);else{let s=fE(n,i,ka.symbol(tr.SECRETX));o=kf.Eval(aC.subst(s,ka.symbol(tr.SECRETX),e))}return o=fC(o,i,e)||o,o}function fE(e,t,r){let n=tr.Constants.zero,i=tr.Constants.one;for(let o=0;o<e;o++){let s=Xo.divide(cE.subtract(Xo.multiply(Xo.multiply(Zo.integer(2*o+1),r),i),Xo.multiply(Zo.integer(o),n)),Zo.integer(o+1));n=i,i=s}for(let o=0;o<t;o++)i=nC.derivative(i,r);return i}function fC(e,t,r){if(t===0)return;let n=cE.subtract(tr.Constants.one,cb.square(r));tr.car(r)===ka.symbol(tr.COS)?n=cb.square(sC.sine(tr.cadr(r))):tr.car(r)===ka.symbol(tr.SIN)&&(n=cb.square(rC.cosine(tr.cadr(r))));let i=Xo.multiply(e,oC.power(n,Xo.multiply(Zo.integer(t),Zo.rational(1,2))));return t%2&&(i=Xo.negate(i)),i}});var mE=A(Bf=>{"use strict";Object.defineProperty(Bf,"__esModule",{value:!0});Bf.Eval_lookup=void 0;var Uf=N(),dC=U();function mC(e){return e=Uf.cadr(e),!Uf.iscons(e)&&Uf.cadr(e).k===Uf.SYM&&(e=dC.get_binding(e)),e}Bf.Eval_lookup=mC});var bE=A(jf=>{"use strict";Object.defineProperty(jf,"__esModule",{value:!0});jf.Eval_mod=void 0;var no=N(),Gf=Ee(),_C=U(),Ff=j(),_E=G(),fb=Q(),bC=ee(),gC=cn();function yC(e){let t=_E.Eval(no.cadr(e)),r=_E.Eval(no.caddr(e));return vC(t,r)}jf.Eval_mod=yC;function vC(e,t){if(fb.isZeroAtomOrTensor(t)&&Gf.stop("mod function: divide by zero"),!no.isNumericAtom(e)||!no.isNumericAtom(t))return bC.makeList(_C.symbol(no.MOD),e,t);if(no.isdouble(e)){let r=Ff.nativeInt(e);isNaN(r)&&Gf.stop("mod function: cannot convert float value to integer"),e=Ff.integer(r)}if(no.isdouble(t)){let r=Ff.nativeInt(t);isNaN(r)&&Gf.stop("mod function: cannot convert float value to integer"),t=Ff.integer(r)}return(!fb.isinteger(e)||!fb.isinteger(t))&&Gf.stop("mod function: integer arguments expected"),new no.Num(gC.mmod(e.q.a,t.q.a))}});var EE=A(Zf=>{"use strict";Object.defineProperty(Zf,"__esModule",{value:!0});Zf.Eval_nroots=void 0;var qC=St(),Ho=N(),ou=Ee(),EC=U(),xC=Ie(),pC=ce(),gE=j(),hC=yo(),zf=G(),yE=Rn(),AC=Xr(),OC=ql(),MC=Q(),TC=X(),NC=Bs(),vE=101,Yf=1e-6,IC=1e-9;function su(e){return Math.sqrt(e.r*e.r+e.i*e.i)}function Vf(){return 4*Math.random()-2}var Bn=class{constructor(){this.r=0,this.i=0}},et=new Bn,Gn=new Bn,ht=new Bn,yr=new Bn,wr=new Bn,Fr=new Bn,$a=new Bn,Fn=new Bn,Ve=[];for(let e=0;e<vE;e++)Ve[e]=new Bn;function SC(e){let t=zf.Eval(Ho.caddr(e));e=zf.Eval(Ho.cadr(e)),t=t===EC.symbol(Ho.NIL)?AC.guess(e):t,MC.ispolyexpandedform(e,t)||ou.stop("nroots: polynomial?");let r=hC.coeff(e,t),n=r.length;n>vE&&ou.stop("nroots: degree?");for(let o=0;o<n;o++)e=zf.Eval(yE.yyfloat(NC.real(r[o]))),t=zf.Eval(yE.yyfloat(OC.imag(r[o]))),(!Ho.isdouble(e)||!Ho.isdouble(t))&&ou.stop("nroots: coefficients?"),Ve[o].r=e.d,Ve[o].i=t.d;wC(n);let i=[];for(let o=n;o>1;o--)RC(o),Math.abs(et.r)<Yf&&(et.r=0),Math.abs(et.i)<Yf&&(et.i=0),i.push(pC.add(gE.double(et.r),TC.multiply(gE.double(et.i),Ho.Constants.imaginaryunit))),LC(o);if(n=i.length,n==1)return i[0];if(n>1)return i.sort(xC.cmp_expr),e=qC.alloc_tensor(n),e.tensor.ndim=1,e.tensor.dim[0]=n,e.tensor.elem=i,e}Zf.Eval_nroots=SC;function wC(e){yr.r=Ve[e-1].r,yr.i=Ve[e-1].i;let t=yr.r*yr.r+yr.i*yr.i;for(let r=0;r<e-1;r++)Ve[r].r=(Ve[r].r*yr.r+Ve[r].i*yr.i)/t,Ve[r].i=(Ve[r].i*yr.r-Ve[r].r*yr.i)/t;Ve[e-1].r=1,Ve[e-1].i=0}function RC(e){if(su(Ve[0])<Yf){et.r=0,et.i=0;return}for(let t=0;t<100;t++){et.r=Vf(),et.i=Vf(),qE(e),Gn.r=et.r,Gn.i=et.i,Fr.r=wr.r,Fr.i=wr.i,et.r=Vf(),et.i=Vf();for(let r=0;r<1e3;r++){qE(e);let n=su(wr);if(Ho.DEBUG&&console.log(`nrabs: ${n}`),n<IC)return;su(wr)<su(Fr)&&(ht.r=et.r,ht.i=et.i,et.r=Gn.r,et.i=Gn.i,Gn.r=ht.r,Gn.i=ht.i,ht.r=wr.r,ht.i=wr.i,wr.r=Fr.r,wr.i=Fr.i,Fr.r=ht.r,Fr.i=ht.i),$a.r=Gn.r-et.r,$a.i=Gn.i-et.i,Fn.r=Fr.r-wr.r,Fn.i=Fr.i-wr.i;let i=Fn.r*Fn.r+Fn.i*Fn.i;if(i===0)break;yr.r=($a.r*Fn.r+$a.i*Fn.i)/i,yr.i=($a.i*Fn.r-$a.r*Fn.i)/i,et.r=Gn.r-(yr.r*Fr.r-yr.i*Fr.i),et.i=Gn.i-(yr.r*Fr.i+yr.i*Fr.r)}}ou.stop("nroots: convergence error")}function qE(e){ht.r=et.r,ht.i=et.i,wr.r=Ve[0].r+Ve[1].r*ht.r-Ve[1].i*ht.i,wr.i=Ve[0].i+Ve[1].r*ht.i+Ve[1].i*ht.r;for(let t=2;t<e;t++){let r=et.r*ht.r-et.i*ht.i;ht.i=et.r*ht.i+et.i*ht.r,ht.r=r,wr.r+=Ve[t].r*ht.r-Ve[t].i*ht.i,wr.i+=Ve[t].r*ht.i+Ve[t].i*ht.r}}function LC(e){for(let t=e-1;t>0;t--)Ve[t-1].r+=Ve[t].r*et.r-Ve[t].i*et.i,Ve[t-1].i+=Ve[t].i*et.r+Ve[t].r*et.i;su(Ve[0])>Yf&&ou.stop("nroots: residual error");for(let t=0;t<e-1;t++)Ve[t].r=Ve[t+1].r,Ve[t].i=Ve[t+1].i}});var AE=A(Xf=>{"use strict";Object.defineProperty(Xf,"__esModule",{value:!0});Xf.Eval_outer=void 0;var CC=St(),io=N(),PC=Ee(),xE=G(),pE=X(),hE=Et();function DC(e){e=io.cdr(e);let t=xE.Eval(io.car(e));return io.iscons(e)?e.tail().reduce((n,i)=>kC(n,xE.Eval(i)),t):t}Xf.Eval_outer=DC;function kC(e,t){return io.istensor(e)&&io.istensor(t)?$C(e,t):io.istensor(e)?hE.tensor_times_scalar(e,t):io.istensor(t)?hE.scalar_times_tensor(e,t):pE.multiply(e,t)}function $C(e,t){let r=e.tensor.ndim+t.tensor.ndim;r>io.MAXDIM&&PC.stop("outer: rank of result exceeds maximum");let n=e.tensor.nelem*t.tensor.nelem,i=CC.alloc_tensor(n);i.tensor.ndim=r,i.tensor.dim=[...e.tensor.dim,...t.tensor.dim];let o=0;for(let s=0;s<e.tensor.nelem;s++)for(let u=0;u<t.tensor.nelem;u++)i.tensor.elem[o++]=pE.multiply(e.tensor.elem[s],t.tensor.elem[u]);return i}});var mb=A(rn=>{"use strict";Object.defineProperty(rn,"__esModule",{value:!0});rn.Eval_patternsinfo=rn.Eval_clearpatterns=rn.do_clearPatterns=rn.Eval_pattern=rn.Eval_silentpattern=void 0;var Ge=N(),db=Ee(),Ua=U(),UC=Ie(),BC=ee(),OE=ri();function GC(e){return ME(e),Ua.symbol(Ge.NIL)}rn.Eval_silentpattern=GC;function ME(e){let t;Ge.iscons(Ge.cdr(e))||db.stop("pattern needs at least a template and a transformed version");let r=Ge.car(Ge.cdr(e)),n=Ge.car(Ge.cdr(Ge.cdr(e)));n===Ua.symbol(Ge.NIL)&&db.stop("pattern needs at least a template and a transformed version"),Ge.iscons(Ge.cdr(Ge.cdr(e)))?t=Ge.car(Ge.cdr(Ge.cdr(Ge.cdr(e)))):t=Ua.symbol(Ge.NIL),UC.equal(r,n)&&db.stop("recursive pattern");let i="template: "+OE.print_list(r);i+=" tests: "+OE.print_list(t),Ge.DEBUG&&console.log(`pattern stringkey: ${i}`);let o=Ge.defs.userSimplificationsInStringForm.indexOf(i);return o===-1?(Ge.defs.userSimplificationsInStringForm.push(i),Ge.defs.userSimplificationsInListForm.push(Ge.cdr(e))):(Ge.DEBUG&&console.log(`pattern already exists, replacing. ${Ge.cdr(e)}`),Ge.defs.userSimplificationsInStringForm[o]=i,Ge.defs.userSimplificationsInListForm[o]=Ge.cdr(e)),BC.makeList(Ua.symbol(Ge.PATTERN),Ge.cdr(e))}rn.Eval_pattern=ME;function TE(){Ge.defs.userSimplificationsInListForm=[],Ge.defs.userSimplificationsInStringForm=[]}rn.do_clearPatterns=TE;function FC(){return TE(),Ua.symbol(Ge.NIL)}rn.Eval_clearpatterns=FC;function jC(){let e=zC();return e!==""?new Ge.Str(e):Ua.symbol(Ge.NIL)}rn.Eval_patternsinfo=jC;function zC(){let e="";for(let t of Array.from(Ge.defs.userSimplificationsInListForm))e+=Ge.defs.userSimplificationsInListForm+`
`;return e}});var IE=A(Hf=>{"use strict";Object.defineProperty(Hf,"__esModule",{value:!0});Hf.Eval_prime=void 0;var _b=N(),YC=Ee(),NE=j(),VC=G();function ZC(e){return XC(VC.Eval(_b.cadr(e)))}Hf.Eval_prime=ZC;function XC(e){let t=NE.nativeInt(e);return(t<1||t>_b.MAXPRIMETAB)&&YC.stop("prime: Argument out of range."),t=_b.primetab[t-1],NE.integer(t)}});var SE=A(Qf=>{"use strict";Object.defineProperty(Qf,"__esModule",{value:!0});Qf.Eval_product=void 0;var Qo=N(),HC=Ee(),bb=U(),QC=j(),gb=G(),WC=X();function JC(e){let t=Qo.cadr(e),r=Qo.caddr(e);Qo.issymbol(r)||HC.stop("sum: 2nd arg?");let n=gb.evaluate_integer(Qo.cadddr(e));if(isNaN(n))return e;let i=gb.evaluate_integer(Qo.caddddr(e));if(isNaN(i))return e;let o=bb.get_binding(r),s=Qo.Constants.one;for(let u=n;u<=i;u++){bb.set_binding(r,QC.integer(u));let c=gb.Eval(t),d=WC.multiply(s,c);Qo.DEBUG&&(console.log(`product - factor 1: ${c}`),console.log(`product - factor 2: ${s}`),console.log(`product - result: ${d}`)),s=d}return bb.set_binding(r,o),s}Qf.Eval_product=JC});var RE=A(Jf=>{"use strict";Object.defineProperty(Jf,"__esModule",{value:!0});Jf.Eval_round=void 0;var Wf=N(),KC=U(),wE=j(),e3=G(),t3=Rn(),r3=Q(),n3=ee();function i3(e){return o3(e3.Eval(Wf.cadr(e)))}Jf.Eval_round=i3;function o3(e){return Wf.isNumericAtom(e)?Wf.isdouble(e)?wE.double(Math.round(e.d)):r3.isinteger(e)?e:(e=t3.yyfloat(e),wE.integer(Math.round(e.d))):n3.makeList(KC.symbol(Wf.ROUND),e)}});var LE=A(Kf=>{"use strict";Object.defineProperty(Kf,"__esModule",{value:!0});Kf.Eval_shape=void 0;var s3=St(),yb=N(),a3=Ee(),l3=j(),u3=G(),c3=Q();function f3(e){return d3(u3.Eval(yb.cadr(e)))}Kf.Eval_shape=f3;function d3(e){if(!yb.istensor(e))return c3.isZeroAtomOrTensor(e)||a3.stop("transpose: tensor expected, 1st arg is not a tensor"),yb.Constants.zero;let{ndim:t}=e.tensor,r=s3.alloc_tensor(t);r.tensor.ndim=1,r.tensor.dim[0]=t;for(let n=0;n<t;n++)r.tensor.elem[n]=l3.integer(e.tensor.dim[n]);return r}});var CE=A(ed=>{"use strict";Object.defineProperty(ed,"__esModule",{value:!0});ed.Eval_sum=void 0;var Ba=N(),m3=Ee(),vb=U(),_3=ce(),b3=j(),qb=G();function g3(e){let t=Ba.cadr(e),r=Ba.caddr(e);Ba.issymbol(r)||m3.stop("sum: 2nd arg?");let n=qb.evaluate_integer(Ba.cadddr(e));if(isNaN(n))return e;let i=qb.evaluate_integer(Ba.caddddr(e));if(isNaN(i))return e;let o=vb.get_binding(r),s=Ba.Constants.zero;for(let u=n;u<=i;u++)vb.set_binding(r,b3.integer(u)),s=_3.add(s,qb.Eval(t));return vb.set_binding(r,o),s}ed.Eval_sum=g3});var kE=A(rd=>{"use strict";Object.defineProperty(rd,"__esModule",{value:!0});rd.Eval_tan=void 0;var vn=N(),Eb=U(),jr=j(),y3=G(),v3=Q(),PE=ee(),Wo=X(),td=xt();function q3(e){return DE(y3.Eval(vn.cadr(e)))}rd.Eval_tan=q3;function DE(e){if(vn.car(e)===Eb.symbol(vn.ARCTAN))return vn.cadr(e);if(vn.isdouble(e)){let r=Math.tan(e.d);return Math.abs(r)<1e-10&&(r=0),jr.double(r)}if(v3.isnegative(e))return Wo.negate(DE(Wo.negate(e)));let t=jr.nativeInt(Wo.divide(Wo.multiply(e,jr.integer(180)),vn.Constants.Pi()));if(t<0||isNaN(t))return PE.makeList(Eb.symbol(vn.TAN),e);switch(t%360){case 0:case 180:return vn.Constants.zero;case 30:case 210:return Wo.multiply(jr.rational(1,3),td.power(jr.integer(3),jr.rational(1,2)));case 150:case 330:return Wo.multiply(jr.rational(-1,3),td.power(jr.integer(3),jr.rational(1,2)));case 45:case 225:return vn.Constants.one;case 135:case 315:return vn.Constants.negOne;case 60:case 240:return td.power(jr.integer(3),jr.rational(1,2));case 120:case 300:return Wo.negate(td.power(jr.integer(3),jr.rational(1,2)));default:return PE.makeList(Eb.symbol(vn.TAN),e)}}});var UE=A(nd=>{"use strict";Object.defineProperty(nd,"__esModule",{value:!0});nd.Eval_tanh=void 0;var Jo=N(),$E=U(),E3=j(),x3=G(),p3=Q(),h3=ee();function A3(e){return O3(x3.Eval(Jo.cadr(e)))}nd.Eval_tanh=A3;function O3(e){if(Jo.car(e)===$E.symbol(Jo.ARCTANH))return Jo.cadr(e);if(Jo.isdouble(e)){let t=Math.tanh(e.d);return Math.abs(t)<1e-10&&(t=0),E3.double(t)}return p3.isZeroAtomOrTensor(e)?Jo.Constants.zero:h3.makeList($E.symbol(Jo.TANH),e)}});var FE=A(od=>{"use strict";Object.defineProperty(od,"__esModule",{value:!0});od.Eval_taylor=void 0;var Rr=N(),id=U(),BE=ce(),xb=j(),M3=Ro(),Ga=G(),T3=ho(),N3=Xr(),I3=Q(),S3=ee(),pb=X(),GE=Zr();function w3(e){e=Rr.cdr(e);let t=Ga.Eval(Rr.car(e));e=Rr.cdr(e);let r=Ga.Eval(Rr.car(e)),n=r===id.symbol(Rr.NIL)?N3.guess(t):r;e=Rr.cdr(e),r=Ga.Eval(Rr.car(e));let i=r===id.symbol(Rr.NIL)?xb.integer(24):r;e=Rr.cdr(e),r=Ga.Eval(Rr.car(e));let o=r===id.symbol(Rr.NIL)?Rr.Constants.zero:r;return R3(t,n,i,o)}od.Eval_taylor=w3;function R3(e,t,r,n){let i=xb.nativeInt(r);if(isNaN(i))return S3.makeList(id.symbol(Rr.TAYLOR),e,t,r,n);let o=Rr.Constants.one,s=Ga.Eval(GE.subst(e,t,n));for(let u=1;u<=i&&(e=M3.derivative(e,t),!I3.isZeroAtomOrTensor(e));u++){o=pb.multiply(o,BE.subtract(t,n));let c=Ga.Eval(GE.subst(e,t,n));s=BE.add(s,pb.divide(pb.multiply(c,o),T3.factorial(xb.integer(u))))}return s}});var jE=A(Bt=>{"use strict";Object.defineProperty(Bt,"__esModule",{value:!0});Bt.Eval_or=Bt.Eval_and=Bt.Eval_not=Bt.Eval_testlt=Bt.Eval_testle=Bt.Eval_testgt=Bt.Eval_testge=Bt.Eval_testeq=Bt.Eval_test=void 0;var ge=N(),L3=U(),hb=ce(),hi=G(),C3=Rn(),Ko=Q(),sd=Zi();function P3(e){let t=e;for(e=ge.cdr(e);ge.iscons(e);){if(ge.cdr(e)===L3.symbol(ge.NIL))return hi.Eval(ge.car(e));let r=Ko.isZeroLikeOrNonZeroLikeOrUndetermined(ge.car(e));if(r==null)return t;if(r)return hi.Eval(ge.cadr(e));e=ge.cddr(e)}return ge.Constants.zero}Bt.Eval_test=P3;function D3(e){let t=e,r=hb.subtract(hi.Eval(ge.cadr(e)),hi.Eval(ge.caddr(e))),n=Ko.isZeroLikeOrNonZeroLikeOrUndetermined(r);if(n)return ge.Constants.zero;if(n!=null&&!n)return ge.Constants.one;let i=sd.simplify(hi.Eval(ge.cadr(e))),o=sd.simplify(hi.Eval(ge.caddr(e)));return r=hb.subtract(i,o),n=Ko.isZeroLikeOrNonZeroLikeOrUndetermined(r),n?ge.Constants.zero:n!=null&&!n?ge.Constants.one:t}Bt.Eval_testeq=D3;function k3(e){let t=e,r=ad(e);return r==null?t:r>=0?ge.Constants.one:ge.Constants.zero}Bt.Eval_testge=k3;function $3(e){let t=e,r=ad(e);return r==null?t:r>0?ge.Constants.one:ge.Constants.zero}Bt.Eval_testgt=$3;function U3(e){let t=e,r=ad(e);return r==null?t:r<=0?ge.Constants.one:ge.Constants.zero}Bt.Eval_testle=U3;function B3(e){let t=e,r=ad(e);return r==null?t:r<0?ge.Constants.one:ge.Constants.zero}Bt.Eval_testlt=B3;function G3(e){let t=e,r=Ko.isZeroLikeOrNonZeroLikeOrUndetermined(ge.cadr(e));return r==null?t:r?ge.Constants.zero:ge.Constants.one}Bt.Eval_not=G3;function F3(e){let t=e,r=ge.cdr(t),n=!1;for(;ge.iscons(r);){let i=Ko.isZeroLikeOrNonZeroLikeOrUndetermined(ge.car(r));if(i==null)n=!0,r=ge.cdr(r);else if(i)r=ge.cdr(r);else if(!i)return ge.Constants.zero}return n?t:ge.Constants.one}Bt.Eval_and=F3;function j3(e){let t=e,r=ge.cdr(t),n=!1;for(;ge.iscons(r);){let i=Ko.isZeroLikeOrNonZeroLikeOrUndetermined(ge.car(r));if(i==null)n=!0,r=ge.cdr(r);else{if(i)return ge.Constants.one;i||(r=ge.cdr(r))}}return n?t:ge.Constants.zero}Bt.Eval_or=j3;function ad(e){let t=0,r=sd.simplify(hi.Eval(ge.cadr(e))),n=sd.simplify(hi.Eval(ge.caddr(e)));if(e=hb.subtract(r,n),e.k!==ge.NUM&&e.k!==ge.DOUBLE&&(e=hi.Eval(C3.yyfloat(e))),Ko.isZeroAtomOrTensor(e))return 0;switch(e.k){case ge.NUM:ge.MSIGN(e.q.a)===-1?t=-1:t=1;break;case ge.DOUBLE:e.d<0?t=-1:t=1;break;default:t=null}return t}});var zE=A(ud=>{"use strict";Object.defineProperty(ud,"__esModule",{value:!0});ud.Eval_zero=void 0;var z3=St(),ld=N(),Y3=G();function V3(e){let t=Array(ld.MAXDIM).fill(0),r=1,n=0;if(ld.iscons(e))for(let i of e.tail()){let o=Y3.evaluate_integer(i);if(o<1||isNaN(o))return ld.Constants.zero;r*=o,t[n++]=o}if(n===0)return ld.Constants.zero;e=z3.alloc_tensor(r),e.tensor.ndim=n;for(let i=0;i<n;i++)e.tensor.dim[i]=t[i];return e}ud.Eval_zero=V3});var au=A(Fa=>{"use strict";Object.defineProperty(Fa,"__esModule",{value:!0});Fa.defn=Fa.init=void 0;var Z3=an(),X3=ce(),H3=Mm(),Q3=U_(),W3=J1(),J3=eq(),K3=rq(),eP=iq(),tP=dm(),rP=sq(),nP=ms(),iP=wm(),oP=Rm(),YE=j(),sP=uq(),aP=fq(),lP=_q(),uP=pq(),VE=Mb(),cP=Du(),fP=yo(),dP=Om(),mP=gl(),_P=vo(),bP=Aq(),gP=Li(),yP=Lm(),vP=t_(),qP=kd(),EP=Mq(),xP=qf(),pP=Tn(),hP=Ro(),AP=km(),Ab=Cq(),OP=Bq(),MP=eb(),gt=G(),TP=Wq(),NP=Y_(),IP=V_(),SP=dl(),wP=ll(),RP=Rn(),LP=Kq(),CP=eE(),PP=iE(),DP=bo(),kP=ql(),ZE=Gi(),$P=Fl(),UP=oE(),BP=aE(),GP=Ud(),FP=uE(),jP=dE(),zP=ee(),YP=g_(),VP=mE(),ZP=bE(),XP=X(),HP=EE(),QP=si(),WP=AE(),cd=mb(),JP=ku(),KP=xt(),eD=IE(),oo=ri(),tD=SE(),rD=Fu(),nD=yl(),iD=Bs(),oD=ti(),sD=Km(),aD=RE(),lD=Yi(),uD=v_(),cD=LE(),fD=Zi(),dD=Jn(),mD=q_(),_D=CE(),bD=kE(),gD=UE(),yD=FE(),Ai=jE(),vD=a_(),qD=zE(),g=N(),y=U(),Ob=0;function ED(){Ob=0,g.reset_after_error(),g.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated=[],!Ob&&(Ob=1,y.reset_symbols(),HE())}Fa.init=ED;var XE=['version="'+g.version+'"',"e=exp(1)","i=sqrt(-1)","autoexpand=1","assumeRealVariables=1","trange=[-pi,pi]","xrange=[-10,10]","yrange=[-10,10]","last=0","trace=0","forceFixedPrintout=1","maxFixedPrintoutDigits=6","printLeaveEAlone=1","printLeaveXAlone=0","cross(u,v)=[u[2]*v[3]-u[3]*v[2],u[3]*v[1]-u[1]*v[3],u[1]*v[2]-u[2]*v[1]]","curl(v)=[d(v[3],y)-d(v[2],z),d(v[1],z)-d(v[3],x),d(v[2],x)-d(v[1],y)]","div(v)=d(v[1],x)+d(v[2],y)+d(v[3],z)","ln(x)=log(x)"];function HE(){y.std_symbol(g.ABS,Z3.Eval_abs),y.std_symbol(g.ADD,X3.Eval_add),y.std_symbol(g.ADJ,H3.Eval_adj),y.std_symbol(g.AND,Ai.Eval_and),y.std_symbol(g.APPROXRATIO,Q3.Eval_approxratio),y.std_symbol(g.ARCCOS,W3.Eval_arccos),y.std_symbol(g.ARCCOSH,J3.Eval_arccosh),y.std_symbol(g.ARCSIN,K3.Eval_arcsin),y.std_symbol(g.ARCSINH,eP.Eval_arcsinh),y.std_symbol(g.ARCTAN,tP.Eval_arctan),y.std_symbol(g.ARCTANH,rP.Eval_arctanh),y.std_symbol(g.ARG,nP.Eval_arg),y.std_symbol(g.ATOMIZE),y.std_symbol(g.BESSELJ,iP.Eval_besselj),y.std_symbol(g.BESSELY,oP.Eval_bessely),y.std_symbol(g.BINDING,gt.Eval_binding),y.std_symbol(g.BINOMIAL,sP.Eval_binomial),y.std_symbol(g.CEILING,aP.Eval_ceiling),y.std_symbol(g.CHECK,gt.Eval_check),y.std_symbol(g.CHOOSE,lP.Eval_choose),y.std_symbol(g.CIRCEXP,uP.Eval_circexp),y.std_symbol(g.CLEAR,VE.Eval_clear),y.std_symbol(g.CLEARALL,VE.Eval_clearall),y.std_symbol(g.CLEARPATTERNS,cd.Eval_clearpatterns),y.std_symbol(g.CLOCK,cP.Eval_clock),y.std_symbol(g.COEFF,fP.Eval_coeff),y.std_symbol(g.COFACTOR,dP.Eval_cofactor),y.std_symbol(g.CONDENSE,mP.Eval_condense),y.std_symbol(g.CONJ,_P.Eval_conj),y.std_symbol(g.CONTRACT,bP.Eval_contract),y.std_symbol(g.COS,gP.Eval_cos),y.std_symbol(g.COSH,yP.Eval_cosh),y.std_symbol(g.DECOMP,vP.Eval_decomp),y.std_symbol(g.DEFINT,EP.Eval_defint),y.std_symbol(g.DEGREE,xP.Eval_degree),y.std_symbol(g.DENOMINATOR,pP.Eval_denominator),y.std_symbol(g.DET,gt.Eval_det),y.std_symbol(g.DERIVATIVE,hP.Eval_derivative),y.std_symbol(g.DIM,gt.Eval_dim),y.std_symbol(g.DIRAC,AP.Eval_dirac),y.std_symbol(g.DIVISORS,gt.Eval_divisors),y.std_symbol(g.DO,gt.Eval_do),y.std_symbol(g.DOT,ZE.Eval_inner),y.std_symbol(g.DRAW),y.std_symbol(g.DSOLVE),y.std_symbol(g.ERF,OP.Eval_erf),y.std_symbol(g.ERFC,MP.Eval_erfc),y.std_symbol(g.EIGEN,Ab.Eval_eigen),y.std_symbol(g.EIGENVAL,Ab.Eval_eigenval),y.std_symbol(g.EIGENVEC,Ab.Eval_eigenvec),y.std_symbol(g.EVAL,gt.Eval_Eval),y.std_symbol(g.EXP,gt.Eval_exp),y.std_symbol(g.EXPAND,TP.Eval_expand),y.std_symbol(g.EXPCOS,NP.Eval_expcos),y.std_symbol(g.EXPSIN,IP.Eval_expsin),y.std_symbol(g.FACTOR,SP.Eval_factor),y.std_symbol(g.FACTORIAL,gt.Eval_factorial),y.std_symbol(g.FACTORPOLY,gt.Eval_factorpoly),y.std_symbol(g.FILTER,wP.Eval_filter),y.std_symbol(g.FLOATF,RP.Eval_float),y.std_symbol(g.FLOOR,LP.Eval_floor),y.std_symbol(g.FOR,CP.Eval_for),y.std_symbol(g.FUNCTION,qP.Eval_function_reference),y.std_symbol(g.GAMMA,PP.Eval_gamma),y.std_symbol(g.GCD,DP.Eval_gcd),y.std_symbol(g.HERMITE,gt.Eval_hermite),y.std_symbol(g.HILBERT,gt.Eval_hilbert),y.std_symbol(g.IMAG,kP.Eval_imag),y.std_symbol(g.INDEX,gt.Eval_index),y.std_symbol(g.INNER,ZE.Eval_inner),y.std_symbol(g.INTEGRAL,$P.Eval_integral),y.std_symbol(g.INV,gt.Eval_inv),y.std_symbol(g.INVG,gt.Eval_invg),y.std_symbol(g.ISINTEGER,gt.Eval_isinteger),y.std_symbol(g.ISPRIME,UP.Eval_isprime),y.std_symbol(g.LAGUERRE,BP.Eval_laguerre),y.std_symbol(g.LCM,GP.Eval_lcm),y.std_symbol(g.LEADING,FP.Eval_leading),y.std_symbol(g.LEGENDRE,jP.Eval_legendre),y.std_symbol(g.LOG,YP.Eval_log),y.std_symbol(g.LOOKUP,VP.Eval_lookup),y.std_symbol(g.MOD,ZP.Eval_mod),y.std_symbol(g.MULTIPLY,XP.Eval_multiply),y.std_symbol(g.NOT,Ai.Eval_not),y.std_symbol(g.NROOTS,HP.Eval_nroots),y.std_symbol(g.NUMBER,gt.Eval_number),y.std_symbol(g.NUMERATOR,QP.Eval_numerator),y.std_symbol(g.OPERATOR,gt.Eval_operator),y.std_symbol(g.OR,Ai.Eval_or),y.std_symbol(g.OUTER,WP.Eval_outer),y.std_symbol(g.PATTERN,cd.Eval_pattern),y.std_symbol(g.PATTERNSINFO,cd.Eval_patternsinfo),y.std_symbol(g.POLAR,JP.Eval_polar),y.std_symbol(g.POWER,KP.Eval_power),y.std_symbol(g.PRIME,eD.Eval_prime),y.std_symbol(g.PRINT,oo.Eval_print),y.std_symbol(g.PRINT2DASCII,oo.Eval_print2dascii),y.std_symbol(g.PRINTFULL,oo.Eval_printcomputer),y.std_symbol(g.PRINTLATEX,oo.Eval_printlatex),y.std_symbol(g.PRINTLIST,oo.Eval_printlist),y.std_symbol(g.PRINTPLAIN,oo.Eval_printhuman),y.std_symbol(g.PRINT_LEAVE_E_ALONE),y.std_symbol(g.PRINT_LEAVE_X_ALONE),y.std_symbol(g.PRODUCT,tD.Eval_product),y.std_symbol(g.QUOTE,gt.Eval_quote),y.std_symbol(g.QUOTIENT,rD.Eval_quotient),y.std_symbol(g.RANK,gt.Eval_rank),y.std_symbol(g.RATIONALIZE,nD.Eval_rationalize),y.std_symbol(g.REAL,iD.Eval_real),y.std_symbol(g.YYRECT,oD.Eval_rect),y.std_symbol(g.ROOTS,sD.Eval_roots),y.std_symbol(g.ROUND,aD.Eval_round),y.std_symbol(g.SETQ,gt.Eval_setq),y.std_symbol(g.SGN,uD.Eval_sgn),y.std_symbol(g.SILENTPATTERN,cd.Eval_silentpattern),y.std_symbol(g.SIMPLIFY,fD.Eval_simplify),y.std_symbol(g.SIN,dD.Eval_sin),y.std_symbol(g.SINH,mD.Eval_sinh),y.std_symbol(g.SHAPE,cD.Eval_shape),y.std_symbol(g.SQRT,gt.Eval_sqrt),y.std_symbol(g.STOP,gt.Eval_stop),y.std_symbol(g.SUBST,gt.Eval_subst),y.std_symbol(g.SUM,_D.Eval_sum),y.std_symbol(g.SYMBOLSINFO,y.Eval_symbolsinfo),y.std_symbol(g.TAN,bD.Eval_tan),y.std_symbol(g.TANH,gD.Eval_tanh),y.std_symbol(g.TAYLOR,yD.Eval_taylor),y.std_symbol(g.TEST,Ai.Eval_test),y.std_symbol(g.TESTEQ,Ai.Eval_testeq),y.std_symbol(g.TESTGE,Ai.Eval_testge),y.std_symbol(g.TESTGT,Ai.Eval_testgt),y.std_symbol(g.TESTLE,Ai.Eval_testle),y.std_symbol(g.TESTLT,Ai.Eval_testlt),y.std_symbol(g.TRANSPOSE,vD.Eval_transpose),y.std_symbol(g.UNIT,gt.Eval_unit),y.std_symbol(g.ZERO,qD.Eval_zero),y.std_symbol(g.NIL),y.std_symbol(g.AUTOEXPAND),y.std_symbol(g.BAKE),y.std_symbol(g.ASSUME_REAL_VARIABLES),y.std_symbol(g.LAST),y.std_symbol(g.LAST_PRINT),y.std_symbol(g.LAST_2DASCII_PRINT),y.std_symbol(g.LAST_FULL_PRINT),y.std_symbol(g.LAST_LATEX_PRINT),y.std_symbol(g.LAST_LIST_PRINT),y.std_symbol(g.LAST_PLAIN_PRINT),y.std_symbol(g.TRACE),y.std_symbol(g.FORCE_FIXED_PRINTOUT),y.std_symbol(g.MAX_FIXED_PRINTOUT_DIGITS),y.std_symbol(g.YYE),y.std_symbol(g.DRAWX),y.std_symbol(g.METAA),y.std_symbol(g.METAB),y.std_symbol(g.METAX),y.std_symbol(g.SECRETX),y.std_symbol(g.VERSION),y.std_symbol(g.PI),y.std_symbol(g.SYMBOL_A),y.std_symbol(g.SYMBOL_B),y.std_symbol(g.SYMBOL_C),y.std_symbol(g.SYMBOL_D),y.std_symbol(g.SYMBOL_I),y.std_symbol(g.SYMBOL_J),y.std_symbol(g.SYMBOL_N),y.std_symbol(g.SYMBOL_R),y.std_symbol(g.SYMBOL_S),y.std_symbol(g.SYMBOL_T),y.std_symbol(g.SYMBOL_X),y.std_symbol(g.SYMBOL_Y),y.std_symbol(g.SYMBOL_Z),y.std_symbol(g.SYMBOL_IDENTITY_MATRIX),y.std_symbol(g.SYMBOL_A_UNDERSCORE),y.std_symbol(g.SYMBOL_B_UNDERSCORE),y.std_symbol(g.SYMBOL_X_UNDERSCORE),y.std_symbol(g.C1),y.std_symbol(g.C2),y.std_symbol(g.C3),y.std_symbol(g.C4),y.std_symbol(g.C5),y.std_symbol(g.C6),xD();let e=g.defs.codeGen;g.defs.codeGen=!1;for(let t=0;t<XE.length;t++){let r=XE[t],[,n]=lD.scan(r);g.DEBUG&&(console.log(`... evaling ${r}`),console.log("top of stack:"),console.log(oo.print_list(n))),gt.Eval(n)}g.defs.codeGen=e}Fa.defn=HE;function xD(){let e=zP.makeList(y.symbol(g.POWER),YE.integer(-1),YE.rational(1,2));g.DEBUG&&console.log(oo.print_list(e)),g.Constants.imaginaryunit=e}});var Mb=A(so=>{"use strict";Object.defineProperty(so,"__esModule",{value:!0});so.Eval_clear=so.do_clearall=so.Eval_clearall=void 0;var Oi=N(),pD=au(),hD=ci(),AD=Ee(),fd=U(),OD=mb();function MD(){return QE(),fd.symbol(Oi.NIL)}so.Eval_clearall=MD;function QE(){return Oi.defs.test_flag||hD.clear_term(),OD.do_clearPatterns(),fd.clear_symbols(),pD.defn(),Oi.defs.codeGen=!1}so.do_clearall=QE;function TD(e){let t;for(t=Oi.cdr(e);Oi.iscons(t);){let r=Oi.car(t);r.k!==Oi.SYM&&AD.stop("symbol error"),fd.clear_symbol(r),t=Oi.cdr(t)}return fd.symbol(Oi.NIL)}so.Eval_clear=TD});var wb=A(md=>{"use strict";Object.defineProperty(md,"__esModule",{value:!0});md.print2dascii=void 0;var v=N(),ND=ci(),qn=U(),lu=an(),ja=j(),rr=Q(),ID=ri(),WE=1e4,JE=class{constructor(){this.c=0,this.x=0,this.y=0}},yt=[];for(let e=0;e<WE;e++)yt[e]=new JE;var ct=0,jn=0,zn=0,KE=0;function Tb(e){let t="";return t+=e,t}function SD(e){return Tb(e)}function wD(e){ct=0,jn=0,zn=0,RD(e);let[t,r,n]=Array.from(Va(0,ct));if(r>100){ID.printline(e);return}return YD()}md.print2dascii=wD;function RD(e){if(v.car(e)===qn.symbol(v.SETQ)){vr(v.cadr(e)),Sb(" = "),vr(v.caddr(e));return}v.istensor(e)?ZD(e):vr(e)}function ex(e){if(jn>0)return!1;if(rr.isfraction(e))return!0;if(!v.ismultiply(e))return!1;if(rr.isfraction(v.cadr(e)))return!0;for(;v.iscons(e);){if(es(v.car(e)))return!0;e=v.cdr(e)}return!1}function vr(e){if(KE++,v.isadd(e))for(e=v.cdr(e),za(v.car(e))&&(_e("-"),ex(v.car(e))&&_e(" ")),Ya(v.car(e)),e=v.cdr(e);v.iscons(e);)za(v.car(e))?(_e(" "),_e("-"),_e(" ")):(_e(" "),_e("+"),_e(" ")),Ya(v.car(e)),e=v.cdr(e);else za(e)&&(_e("-"),ex(e)&&_e(" ")),Ya(e);KE--}function LD(e){if(v.isadd(e))for(e=v.cdr(e),Ya(v.car(e)),e=v.cdr(e);v.iscons(e);)za(v.car(e))?(_e(" "),_e("-"),_e(" ")):(_e(" "),_e("+"),_e(" ")),Ya(v.car(e)),e=v.cdr(e);else Ya(e)}function za(e){return!!(rr.isnegativenumber(e)||v.ismultiply(e)&&rr.isnegativenumber(v.cadr(e)))}function Ya(e){if(v.ismultiply(e)){let t=CD(e);t&&jn===0?DD(e,t):PD(e,t)}else En(e)}function es(e){return v.ispower(e)&&v.cadr(e)!==qn.symbol(v.E)&&za(v.caddr(e))}function CD(e){let t=0;for(e=v.cdr(e);v.iscons(e);){let r=v.car(e);es(r)&&t++,e=v.cdr(e)}return t}function PD(e,t){if(t===0)for(e=v.cdr(e),(rr.isplusone(v.car(e))||rr.isminusone(v.car(e)))&&(e=v.cdr(e)),En(v.car(e)),e=v.cdr(e);v.iscons(e);)_e(" "),En(v.car(e)),e=v.cdr(e);else kD(e),_e("/"),t>1||rr.isfraction(v.cadr(e))?(_e("("),tx(e),_e(")")):tx(e)}function DD(e,t){let r,n,i=0,o=0,s=0,u=0,c=0,d=v.Constants.one,_=v.Constants.one;for(v.isrational(v.cadr(e))&&(d=lu.absval(ja.mp_numerator(v.cadr(e))),_=ja.mp_denominator(v.cadr(e))),v.isdouble(v.cadr(e))&&(d=lu.absval(v.cadr(e))),u=rr.isplusone(d)?0:1,r=v.cdr(e),v.isNumericAtom(v.car(r))&&(r=v.cdr(r));v.iscons(r);)n=v.car(r),es(n)||u++,r=v.cdr(r);for(c=zn,o=ct,i=0,rr.isplusone(d)||(Mi(d,0),i++),r=v.cdr(e),v.isNumericAtom(v.car(r))&&(r=v.cdr(r));v.iscons(r);)n=v.car(r),es(n)||(i>0&&_e(" "),u===1?vr(n):En(n),i++),r=v.cdr(r);for(i===0&&_e("1"),s=ct,i=0,rr.isplusone(_)||(Mi(_,0),i++,t++),r=v.cdr(e),v.isrational(v.car(r))&&(r=v.cdr(r));v.iscons(r);)n=v.car(r),es(n)&&(i>0&&_e(" "),Nb(n,t),i++),r=v.cdr(r);Ib(c,o,s)}function kD(e){let t=v.Constants.one;e=v.cdr(e),v.isrational(v.car(e))?(t=lu.absval(ja.mp_numerator(v.car(e))),e=v.cdr(e)):v.isdouble(v.car(e))&&(t=lu.absval(v.car(e)),e=v.cdr(e));let r=0;for(rr.isplusone(t)||(Mi(t,0),r++);v.iscons(e);)es(v.car(e))||(r>0&&_e(" "),En(v.car(e)),r++),e=v.cdr(e);r===0&&_e("1")}function tx(e){let t=0;if(e=v.cdr(e),rr.isfraction(v.car(e))){let r=ja.mp_denominator(v.car(e));Mi(r,0),t++,e=v.cdr(e)}for(;v.iscons(e);)es(v.car(e))&&(t>0&&_e(" "),Nb(v.car(e),0),t++),e=v.cdr(e)}function En(e){if(v.istensor(e)){dd(e);return}if(v.isdouble(e)){Mi(e,0);return}if(v.isadd(e)||v.ismultiply(e)){ao(e);return}if(v.ispower(e)){UD(e);return}if(v.iscons(e)){BD(e);return}if(v.isNumericAtom(e)){jn===0?$D(e):Mi(e,0);return}if(v.issymbol(e)){rx(e);return}v.isstr(e)&&jD(e)}function $D(e){let t=lu.absval(ja.mp_numerator(e)),r=ja.mp_denominator(e);if(rr.isplusone(r)){Mi(t,0);return}let n=zn,i=ct;Mi(t,0);let o=ct;Mi(r,0),Ib(n,i,o)}function uu(e){return v.iscons(e)&&!v.isadd(e)&&!v.ismultiply(e)&&!v.ispower(e)||v.issymbol(e)?!0:rr.isfraction(e)||rr.isnegativenumber(e)?!1:!!v.isNumericAtom(e)}function UD(e){let t=0,r=0,n=0;if(v.cadr(e)===qn.symbol(v.E)){Sb("exp("),vr(v.caddr(e)),_e(")");return}if(jn>0){rr.isminusone(v.caddr(e))?(_e("1"),_e("/"),uu(v.cadr(e))?En(v.cadr(e)):ao(v.cadr(e))):(uu(v.cadr(e))?En(v.cadr(e)):ao(v.cadr(e)),_e("^"),uu(v.caddr(e))?En(v.caddr(e)):ao(v.caddr(e)));return}if(za(v.caddr(e))){n=zn,t=ct,_e("1"),r=ct,Nb(e,1),Ib(n,t,r);return}t=ct,uu(v.cadr(e))?En(v.cadr(e)):ao(v.cadr(e)),r=ct,jn++,vr(v.caddr(e)),jn--,nx(t,r)}function Nb(e,t){let r=0,n=0;if(rr.isminusone(v.caddr(e))){t===1?vr(v.cadr(e)):En(v.cadr(e));return}r=ct,uu(v.cadr(e))?En(v.cadr(e)):ao(v.cadr(e)),n=ct,jn++,LD(v.caddr(e)),jn--,nx(r,n)}function BD(e){if(v.car(e)===qn.symbol(v.INDEX)&&v.issymbol(v.cadr(e))){GD(e);return}if(v.isfactorial(e)){FD(e);return}if(v.car(e)===qn.symbol(v.DERIVATIVE)?_e("d"):rx(v.car(e)),_e("("),e=v.cdr(e),v.iscons(e))for(vr(v.car(e)),e=v.cdr(e);v.iscons(e);)_e(","),vr(v.car(e)),e=v.cdr(e);_e(")")}function GD(e){if(e=v.cdr(e),v.caar(e)===qn.symbol(v.ADD)||v.caar(e)===qn.symbol(v.MULTIPLY)||v.caar(e)===qn.symbol(v.POWER)||v.caar(e)===qn.symbol(v.FACTORIAL)?ao(v.car(e)):vr(v.car(e)),_e("["),e=v.cdr(e),v.iscons(e))for(vr(v.car(e)),e=v.cdr(e);v.iscons(e);)_e(","),vr(v.car(e)),e=v.cdr(e);_e("]")}function FD(e){e=v.cadr(e),rr.isfraction(e)||v.isadd(e)||v.ismultiply(e)||v.ispower(e)||v.isfactorial(e)?ao(e):vr(e),_e("!")}function ao(e){_e("("),vr(e),_e(")")}function rx(e){if(e===qn.symbol(v.E)){Sb("exp(1)");return}let t=qn.get_printname(e);for(let r=0;r<t.length;r++)_e(t[r])}function jD(e){let t=e.str;_e('"');for(let r=0;r<t.length;r++)_e(t[r]);_e('"')}function Ib(e,t,r){let n=0,i=0,[o,s,u]=Array.from(Va(t,r)),[c,d,_]=Array.from(Va(r,ct));d>s?n=(d-s)/2:n=0,n++,i=-(u+o-1)-1,cu(t,r,n,i),d>s?n=-s:n=-s+(s-d)/2,n++,i=-_+1,cu(r,ct,n,i);let T=0;d>s?T=d:T=s,T+=2,zn=e;for(let k=0;k<T;k++)_e("-")}function nx(e,t){let r=0,n=0,i=0,o=0,s=0,u=0,c=0;[n,i,o]=Array.from(Va(e,t)),[s,u,c]=Array.from(Va(t,ct)),r=-c-s+1,r+=o-1,cu(t,ct,0,r)}function cu(e,t,r,n){for(let i=e;i<t;i++)yt[i].x+=r,yt[i].y+=n}function Va(e,t){let r=yt[e].x,n=yt[e].x,i=yt[e].y,o=yt[e].y;for(let d=e+1;d<t;d++)yt[d].x<r&&(r=yt[d].x),yt[d].x>n&&(n=yt[d].x),yt[d].y<i&&(i=yt[d].y),yt[d].y>o&&(o=yt[d].y);let s=o-i+1,u=n-r+1;return[s,u,i]}function _e(e){if(ct!==WE)return yt[ct]==null&&v.breakpoint,yt[ct].c=e,yt[ct].x=zn,yt[ct].y=0,ct++,zn++}function Sb(e){for(let t=0;t<e.length;t++)_e(e[t])}function Mi(e,t){let r="";switch(e.k){case v.NUM:r=e.q.a.toString(),r[0]==="-"&&t===0&&(r=r.substring(1));for(let n=0;n<r.length;n++)_e(r[n]);if(r=e.q.b.toString(),r==="1")break;_e("/");for(let n=0;n<r.length;n++)_e(r[n]);break;case v.DOUBLE:r=ND.doubleToReasonableString(e.d),r[0]==="-"&&t===0&&(r=r.substring(1));for(let n=0;n<r.length;n++)_e(r[n]);break}}function zD(e,t){return e.y<t.y?-1:e.y>t.y?1:e.x<t.x?-1:e.x>t.x?1:0}function YD(){let e="",t=yt.slice(0,ct);t.sort(zD),yt=[].concat(t).concat(yt.slice(ct));let r=0,{y:n}=yt[0];for(let i=0;i<ct;i++){for(;yt[i].y>n;)e+=SD(`
`),r=0,n++;for(;yt[i].x>r;)e+=Tb(" "),r++;e+=Tb(yt[i].c),r++}return e}var VD=100,ix=class{constructor(){this.x=0,this.y=0,this.h=0,this.w=0,this.index=0,this.count=0}},Nt=[];for(let e=0;e<1e4;e++)Nt[e]=new ix;var ox=3,sx=1;function ZD(e){let t=0,r=0,n=0;if(e.tensor.ndim>2){dd(e);return}let i=e.tensor.dim[0];e.tensor.ndim===2?t=e.tensor.dim[1]:t=1;let o=i*t;if(o>VD){dd(e);return}let s=zn;for(let T=0;T<o;T++)Nt[T].index=ct,Nt[T].x=zn,vr(e.tensor.elem[T]),Nt[T].count=ct-Nt[T].index,[Nt[T].h,Nt[T].w,Nt[T].y]=Array.from(Va(Nt[T].index,ct));let u=0,c=0;for(let T=0;T<o;T++)Nt[T].h>u&&(u=Nt[T].h),Nt[T].w>c&&(c=Nt[T].w);let d=i*u+(i-1)*sx,_=t*c+(t-1)*ox,w=-(d/2);for(let T=0;T<i;T++)for(let k=0;k<t;k++){let Z=T*t+k;r=s-Nt[Z].x,n=w-Nt[Z].y,cu(Nt[Z].index,Nt[Z].index+Nt[Z].count,r,n),r=0,k>0&&(r=k*(c+ox)),n=0,T>0&&(n=T*(u+sx)),r+=(c-Nt[Z].w)/2,n+=(u-Nt[Z].h)/2,cu(Nt[Z].index,Nt[Z].index+Nt[Z].count,r,n)}zn=s+_}function dd(e){ax(e,0,0)}function ax(e,t,r){_e("(");for(let n=0;n<e.tensor.dim[t];n++)t+1===e.tensor.ndim?(vr(e.tensor.elem[r]),r=r+1):r=ax(e,t+1,r),n+1<e.tensor.dim[t]&&_e(",");return _e(")"),r}});var Ee=A(nr=>{"use strict";Object.defineProperty(nr,"__esModule",{value:!0});nr.computeResultsAndJavaScriptFromAlgebra=nr.computeDependenciesFromAlgebra=nr.check_esc_flag=nr.top_level_eval=nr.check_stack=nr.run=nr.findDependenciesInScript=nr.stop=void 0;var XD=i_(),lx=Mb(),HD=G(),fu=Q(),ux=ri(),QD=wb(),cx=Yi(),WD=Zi(),_d=Zr(),p=N(),bd=au(),vt=U();function du(e){p.defs.errorMessage+="Stop: ",p.defs.errorMessage+=e;let t=p.defs.errorMessage;throw p.defs.errorMessage="",new Error(t)}nr.stop=du;function Rb(e,t=!1){p.DEBUG&&console.log(`stringToBeParsed: ${e}`);let r=new Date().getTime(),n=!0;p.defs.codeGen=!0,p.defs.symbolsDependencies={},p.defs.symbolsHavingReassignments=[],p.defs.symbolsInExpressionsWithoutAssignments=[],p.defs.patternHasBeenFound=!1;let i=0,o="",s="",u=0,c={affectsVariables:[],affectedBy:[]},d=e;for(;;){try{p.defs.errorMessage="",Za(),p.DEBUG&&console.log("findDependenciesInScript: scanning"),[u]=cx.scan(e.substring(i)),p.DEBUG&&console.log("scanned"),Za()}catch(Y){p.PRINTOUTRESULT&&console.log(Y),p.defs.errorMessage=Y+"",p.reset_after_error();break}if(u===0)break;i+=u}let _="";p.DEBUG&&console.log("all local dependencies ----------------"),_+="All local dependencies: ";for(let Y in p.defs.symbolsDependencies){let Ae=p.defs.symbolsDependencies[Y];p.DEBUG&&console.log(`variable ${Y} depends on: `),c.affectsVariables.push(Y),_+=" variable "+Y+" depends on: ";for(let tt of Array.from(Ae))p.DEBUG&&console.log(`    ${tt}`),tt[0]!=="'"&&c.affectedBy.push(tt),_+=tt+", ";_+="; "}_+=". ",p.DEBUG&&console.log("Symbols with reassignments ----------------"),_+="Symbols with reassignments: ";for(let Y of Array.from(p.defs.symbolsHavingReassignments))c.affectedBy.indexOf(Y)===-1&&(c.affectedBy.push(Y),_+=Y+", ");_+=". ",p.DEBUG&&console.log("Symbols in expressions without assignments ----------------"),_+="Symbols in expressions without assignments: ";for(let Y of Array.from(p.defs.symbolsInExpressionsWithoutAssignments))c.affectedBy.indexOf(Y)===-1&&(c.affectedBy.push(Y),_+=Y+", ");_+=". ",c.affectedBy.push("PATTERN_DEPENDENCY"),p.defs.patternHasBeenFound&&(c.affectsVariables.push("PATTERN_DEPENDENCY"),_+=" - PATTERN_DEPENDENCY inserted - "),p.DEBUG&&console.log("All dependencies recursively ----------------"),_+="All dependencies recursively: ";let w=["",""],T="",k="";if(p.defs.errorMessage===""&&!t){try{o="",s="",w=dx(e,!0),o="",s=""}catch(Y){let Ae=Y;p.PRINTOUTRESULT&&console.log(Ae),p.defs.errorMessage=Ae.toString(),bd.init()}if(p.defs.errorMessage==="")for(let Y in p.defs.symbolsDependencies){p.defs.codeGen=!0,p.DEBUG&&console.log("  variable "+Y+" is: "+vt.get_binding(vt.usr_symbol(Y)).toString()),p.defs.codeGen=!1,p.DEBUG&&console.log(`  variable ${Y} depends on: `),_+=" variable "+Y+" depends on: ";var Z=[];let Ae=[],tt=[];fx(Y,Z,[],Ae,[],tt);for(let Oe of Array.from(Ae))p.DEBUG&&console.log(`    --> cycle through ${Oe}`);for(let Oe of Array.from(Z))p.DEBUG&&console.log(`    ${Oe}`),_+=Oe+", ";_+="; ";for(let Oe of Array.from(tt))_+=" "+Oe+", ";p.DEBUG&&console.log(`  code generation:${Y} is: ${vt.get_binding(vt.usr_symbol(Y))}`);let Ze=vt.get_binding(vt.usr_symbol(Y)),ke=[],st=[];for(let Oe of Array.from(Z))if(Oe[0]==="'"){let at=Oe.substring(1),ir=vt.usr_symbol(at),Gt=vt.usr_symbol("AVOID_BINDING_TO_EXTERNAL_SCOPE_VALUE"+at);ke.push(ir),st.push(Gt),Ze=_d.subst(Ze,ir,Gt),p.DEBUG&&console.log(`after substitution: ${Ze}`)}try{Ze=WD.simplifyForCodeGeneration(Ze)}catch(Oe){p.PRINTOUTRESULT&&console.log(Oe),p.defs.errorMessage=Oe+"",bd.init()}for(let Oe=0;Oe<ke.length;Oe++)Ze=_d.subst(Ze,st[Oe],ke[Oe]);if(vt.clearRenamedVariablesToAvoidBindingToExternalScope(),p.defs.errorMessage===""){let Oe=Ze,at=[];vt.collectUserSymbols(Oe,at),o="",s="",p.defs.codeGen=!0;let ir=Oe.toString();p.defs.codeGen=!1;let Gt=p.defs.printMode;p.defs.printMode=p.PRINTMODE_LATEX;let qr=Oe.toString();if(p.defs.printMode=Gt,Ae.indexOf(Y)!==-1)T+="// "+Y+" is part of a cyclic dependency, no code generated.",k+="#"+Y+" is part of a cyclic dependency, no code generated.";else if(at=at.filter(It=>p.predefinedSymbolsInGlobalScope_doNotTrackInDependencies.indexOf(It+"")===-1),at=at.filter(It=>Z.indexOf(It+"")!==-1||Z.indexOf("'"+It+"")!==-1),at.length!==0){let It="(";for(let co of Array.from(at))co.printname!==Y&&(It+=co.printname+", ");It=It.replace(/, $/gm,""),It+=")",T+=Y+" = function "+It+" { return ( "+ir+" ); }",k+=Y+It+" = "+qr}else T+=Y+" = "+ir+";",k+=Y+" = "+qr;T+=`
`,k+=`
`,p.DEBUG&&console.log(`    ${T}`)}}}return T=T.replace(/\n$/gm,""),k=k.replace(/\n$/gm,""),p.defs.symbolsDependencies={},p.defs.symbolsHavingReassignments=[],p.defs.patternHasBeenFound=!1,p.defs.symbolsInExpressionsWithoutAssignments=[],p.DEBUG&&console.log(`testable string: ${_}`),gd&&console.log(`findDependenciesInScript time for: ${d} : ${new Date().getTime()-r}ms`),[_,w[0],T,k,w[1],p.defs.errorMessage,c]}nr.findDependenciesInScript=Rb;function fx(e,t,r,n,i,o){if(r.push(e),p.defs.symbolsDependencies[i[i.length-1]]!=null&&p.defs.symbolsDependencies[i[i.length-1]].indexOf("'"+e)!==-1){p.DEBUG&&console.log("can't keep following the chain of "+e+" because it's actually a variable bound to a parameter"),t.indexOf("'"+e)===-1&&t.indexOf(e)===-1&&t.push(e);return}if(i.push(e),p.defs.symbolsDependencies[e]==null)t.indexOf(e)===-1&&t.push(e);else for(let s of Array.from(p.defs.symbolsDependencies[e]))if(i.indexOf(s)!==-1){p.DEBUG&&console.log("  found cycle:");let u="";for(let c of Array.from(i))n.indexOf(c)===-1&&n.push(c),p.DEBUG&&console.log(c+" --> "),u+=c+" --> ";p.DEBUG&&console.log(` ... then ${s} again`),u+=" ... then "+s+" again",o.push(u),n.indexOf(s)===-1&&n.push(s)}else fx(s,t,r,n,i,o),i.pop()}var JD="\\rlap{\\large\\color{red}\\bigtriangleup}{\\ \\ \\tiny\\color{red}!}";function Lb(e){return e=e.replace(/\n/g,""),e=e.replace(/_/g,"} \\_ \\text{"),e=e.replace(new RegExp(String.fromCharCode(p.transpose_unicode),"g"),"}{}^{T}\\text{"),e=e.replace(new RegExp(String.fromCharCode(p.dotprod_unicode),"g"),"}\\cdot \\text{"),e=e.replace("Stop:","}  \\quad \\text{Stop:"),e=e.replace("->","}  \\rightarrow \\text{"),e=e.replace("?","}\\enspace "+JD+" \\enspace  \\text{"),e="$$\\text{"+e.replace(/\n/g,"")+"}$$",e}function Cb(e){return e=e.replace(new RegExp(String.fromCharCode(8901),"g"),String.fromCharCode(p.dotprod_unicode)),e=e.replace(new RegExp(String.fromCharCode(8226),"g"),String.fromCharCode(p.dotprod_unicode)),e=e.replace(new RegExp(String.fromCharCode(12539),"g"),String.fromCharCode(p.dotprod_unicode)),e=e.replace(new RegExp(String.fromCharCode(55296),"g"),String.fromCharCode(p.dotprod_unicode)),e=e.replace(new RegExp(String.fromCharCode(65381),"g"),String.fromCharCode(p.dotprod_unicode)),e}var gd=!1;function dx(e,t=!1){let r,n,i,o=new Date().getTime();e=Cb(e),p.defs.inited||(p.defs.inited=!0,bd.init());let s=0,u=0,c="",d="",_,w;for(;;){try{p.defs.errorMessage="",Za(),[s,r]=cx.scan(e.substring(u)),Za()}catch(k){p.PRINTOUTRESULT&&console.log(k),c+=k.message,t&&(d+=Lb(k.message)),p.reset_after_error();break}if(s===0)break;u+=s;let T=!1;try{p.defs.stringsEmittedByUserPrintouts="",n=mx(r),Za(),p.isstr(n)&&(p.DEBUG&&console.log(n.str),p.DEBUG&&console.log(`
`)),n===vt.symbol(p.NIL)?(w=p.defs.stringsEmittedByUserPrintouts,t&&(_="$$"+p.defs.stringsEmittedByUserPrintouts+"$$")):(w=ux.print_expr(n),w+=`
`,t&&(_="$$"+ux.collectLatexStringFromReturnValue(n)+"$$",p.DEBUG&&console.log(`collectedLatexResult: ${_}`))),c+=w,t&&(d+=_),p.PRINTOUTRESULT&&(p.DEBUG&&console.log("printline"),p.DEBUG&&console.log(w)),p.PRINTOUTRESULT&&(p.DEBUG&&console.log("display:"),QD.print2dascii(n)),t&&(d+=`
`)}catch(k){T=!0,w=k.message,t&&(_=Lb(k.message)),p.PRINTOUTRESULT&&console.log(w),c+=w,w!==""&&(c+=`
`),t&&(d+=_,d+=`
`),bd.init()}}if(c[c.length-1]===`
`&&(c=c.substring(0,c.length-1)),t&&d[d.length-1]===`
`&&(d=d.substring(0,d.length-1)),t?(p.DEBUG&&console.log(`allReturnedLatexStrings: ${d}`),i=[c,d]):i=c,gd){let T="run time on: "+e+" : "+(new Date().getTime()-o)+"ms";console.log(T)}return c="",d="",i}nr.run=dx;function Za(){p.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated.length!==0&&(p.breakpoint,du("symbols evaluation still ongoing?")),p.defs.evaluatingAsFloats&&(p.breakpoint,du("numeric evaluation still ongoing?")),p.defs.evaluatingPolar&&(p.breakpoint,du("evaluation of polar still ongoing?"))}nr.check_stack=Za;function mx(e){p.DEBUG&&console.log("#### top level eval"),p.defs.trigmode=0;let t=vt.symbol(p.AUTOEXPAND);p.defs.expanding=!fu.isZeroAtomOrTensor(vt.get_binding(t));let r=e,n=HD.Eval(e);return n===vt.symbol(p.NIL)||(vt.set_binding(vt.symbol(p.LAST),n),fu.isZeroAtomOrTensor(vt.get_binding(vt.symbol(p.BAKE)))||(n=XD.bake(n)),(r===vt.symbol(p.SYMBOL_I)||r===vt.symbol(p.SYMBOL_J))&&fu.isimaginaryunit(n))?n:fu.isimaginaryunit(vt.get_binding(vt.symbol(p.SYMBOL_J)))?_d.subst(n,p.Constants.imaginaryunit,vt.symbol(p.SYMBOL_J)):fu.isimaginaryunit(vt.get_binding(vt.symbol(p.SYMBOL_I)))?_d.subst(n,p.Constants.imaginaryunit,vt.symbol(p.SYMBOL_I)):n}nr.top_level_eval=mx;function KD(){p.defs.esc_flag&&du("esc key")}nr.check_esc_flag=KD;function ek(e){let t,r;p.DEBUG&&console.log("computeDependenciesFromAlgebra!!!");let n=e,i=!0;if(p.defs.called_from_Algebra_block=!0,e=Cb(e),!i){p.defs.userSimplificationsInListForm=[];let o="";for(let s of Array.from(p.defs.userSimplificationsInListForm))o+="silentpattern("+p.car(s)+","+p.car(p.cdr(s))+","+p.car(p.cdr(p.cdr(s)))+`)
`;lx.do_clearall(),e=o+e,p.DEBUG&&console.log("codeFromAlgebraBlock including patterns: "+e)}if(p.DEBUG){console.log("computeDependenciesFromAlgebra: patterns in the list --------------- ");for(let o of Array.from(p.defs.userSimplificationsInListForm))console.log(p.car(o)+","+p.cdr(o)+")");console.log("...end of list --------------- ")}return p.defs.called_from_Algebra_block=!1,Rb(e,!0)[6]}nr.computeDependenciesFromAlgebra=ek;function tk(e){let t,r,n,i,o,s,u,c,d,_=e,w=!0;p.defs.called_from_Algebra_block=!0;let T=new Date().getTime();gd&&console.log(" --------- computeResultsAndJavaScriptFromAlgebra input: "+e+" at: "+new Date),e=Cb(e);let k=e;if(p.DEBUG){console.log("computeResultsAndJavaScriptFromAlgebra: patterns in the list --------------- ");for(o of Array.from(p.defs.userSimplificationsInListForm))console.log(p.car(o)+","+p.cdr(o)+")");console.log("...end of list --------------- ")}if(!w){p.defs.userSimplificationsInListForm=[];let Z="";for(o of Array.from(p.defs.userSimplificationsInListForm))Z+="silentpattern("+p.car(o)+","+p.car(p.cdr(o))+","+p.car(p.cdr(p.cdr(o)))+`)
`;lx.do_clearall(),e=Z+e,p.DEBUG&&console.log("codeFromAlgebraBlock including patterns: "+e)}return[d,c,n,u,s,p.defs.errorMessage,i]=Rb(e),p.defs.called_from_Algebra_block=!1,(u!==""||p.defs.errorMessage!=="")&&(c+=`
`+u,p.defs.errorMessage!==""&&(c+=`
`+p.defs.errorMessage),c=c.replace(/\n/g,`

`),s+=`
$$`+u+"$$",p.defs.errorMessage!==""&&(s+=Lb(p.defs.errorMessage)),s=s.replace(/\n/g,`

`)),s=s.replace(/\n*/,""),s=s.replace(/\$\$\$\$\n*/g,""),n=n.replace(/Math\./g,""),n=n.replace(/\n/g,`

`),gd&&console.log("computeResultsAndJavaScriptFromAlgebra time (total time from notebook and back) for: "+k+" : "+(new Date().getTime()-T)+"ms"),{code:n,result:s,latexResult:s,dependencyInfo:i}}nr.computeResultsAndJavaScriptFromAlgebra=tk});var Et=A(qt=>{"use strict";Object.defineProperty(qt,"__esModule",{value:!0});qt.copy_tensor=qt.power_tensor=qt.compare_tensors=qt.d_tensor_scalar=qt.d_scalar_tensor=qt.d_tensor_tensor=qt.is_square_matrix=qt.check_tensor_dimensions=qt.scalar_times_tensor=qt.tensor_times_scalar=qt.tensor_plus_tensor=qt.Eval_tensor=void 0;var Yn=St(),dr=N(),Pb=Ee(),mu=U(),_x=Ie(),rk=ce(),nk=j(),Db=Ro(),ik=G(),ok=Gi(),sk=Il(),ak=Q(),kb=ee(),bx=X();function lk(e){Vn(e);let{nelem:t,ndim:r}=e.tensor,n=Yn.alloc_tensor(t);return n.tensor.ndim=r,n.tensor.dim=Array.from(e.tensor.dim),Vn(n),n.tensor.elem=e.tensor.elem.map(ik.Eval),Vn(e),Vn(n),qk(n)}qt.Eval_tensor=lk;function uk(e,t){if(e.tensor.ndim!==t.tensor.ndim||e.tensor.dim.some((c,d)=>c!==t.tensor.dim[d]))return mu.symbol(dr.NIL);let{nelem:r,ndim:n}=e.tensor,i=Yn.alloc_tensor(r);i.tensor.ndim=n,i.tensor.dim=Array.from(e.tensor.dim);let o=e.tensor.elem,s=t.tensor.elem,u=i.tensor.elem;for(let c=0;c<r;c++)u[c]=rk.add(o[c],s[c]);return i}qt.tensor_plus_tensor=uk;function ck(e,t){let{ndim:r,nelem:n}=e.tensor,i=Yn.alloc_tensor(n);return i.tensor.ndim=r,i.tensor.dim=Array.from(e.tensor.dim),i.tensor.elem=e.tensor.elem.map(o=>bx.multiply(o,t)),i}qt.tensor_times_scalar=ck;function fk(e,t){let{ndim:r,nelem:n}=t.tensor,i=Yn.alloc_tensor(n);return i.tensor.ndim=r,i.tensor.dim=Array.from(t.tensor.dim),i.tensor.elem=t.tensor.elem.map(o=>bx.multiply(e,o)),i}qt.scalar_times_tensor=fk;function Vn(e){if(e.tensor.nelem!==e.tensor.elem.length)return console.log("something wrong in tensor dimensions"),dr.breakpoint}qt.check_tensor_dimensions=Vn;function dk(e){return dr.istensor(e)&&e.tensor.ndim===2&&e.tensor.dim[0]===e.tensor.dim[1]}qt.is_square_matrix=dk;function mk(e,t){let{ndim:r,nelem:n}=e.tensor;if(r+1>=dr.MAXDIM)return kb.makeList(mu.symbol(dr.DERIVATIVE),e,t);let i=Yn.alloc_tensor(n*t.tensor.nelem);i.tensor.ndim=r+1,i.tensor.dim=[...e.tensor.dim,t.tensor.dim[0]];let o=e.tensor.elem,s=t.tensor.elem,u=i.tensor.elem;for(let c=0;c<n;c++)for(let d=0;d<t.tensor.nelem;d++)u[c*t.tensor.nelem+d]=Db.derivative(o[c],s[d]);return i}qt.d_tensor_tensor=mk;function _k(e,t){let r=Yn.alloc_tensor(t.tensor.nelem);return r.tensor.ndim=1,r.tensor.dim[0]=t.tensor.dim[0],r.tensor.elem=t.tensor.elem.map(n=>Db.derivative(e,n)),r}qt.d_scalar_tensor=_k;function bk(e,t){let r=Yn.alloc_tensor(e.tensor.nelem);return r.tensor.ndim=e.tensor.ndim,r.tensor.dim=[...e.tensor.dim],r.tensor.elem=e.tensor.elem.map(n=>Db.derivative(n,t)),r}qt.d_tensor_scalar=bk;function gk(e,t){if(e.tensor.ndim<t.tensor.ndim)return-1;if(e.tensor.ndim>t.tensor.ndim)return 1;for(let r=0;r<e.tensor.ndim;r++){if(e.tensor.dim[r]<t.tensor.dim[r])return-1;if(e.tensor.dim[r]>t.tensor.dim[r])return 1}for(let r=0;r<e.tensor.nelem;r++)if(!_x.equal(e.tensor.elem[r],t.tensor.elem[r]))return _x.lessp(e.tensor.elem[r],t.tensor.elem[r])?-1:1;return 0}qt.compare_tensors=gk;function yk(e,t){let r=e.tensor.ndim-1;if(e.tensor.dim[0]!==e.tensor.dim[r])return kb.makeList(mu.symbol(dr.POWER),e,t);let n=nk.nativeInt(t);if(isNaN(n))return kb.makeList(mu.symbol(dr.POWER),e,t);if(n===0){e.tensor.ndim!==2&&Pb.stop("power(tensor,0) with tensor rank not equal to 2"),n=e.tensor.dim[0],e=Yn.alloc_tensor(n*n),e.tensor.ndim=2,e.tensor.dim[0]=n,e.tensor.dim[1]=n;for(let s=0;s<n;s++)e.tensor.elem[n*s+s]=dr.Constants.one;return Vn(e),e}let i=e;n<0&&(n=-n,i=sk.inv(i));let o=i;for(let s=1;s<n&&(o=ok.inner(o,i),!ak.isZeroAtomOrTensor(o));s++);return o}qt.power_tensor=yk;function vk(e){let t=Yn.alloc_tensor(e.tensor.nelem);return t.tensor.ndim=e.tensor.ndim,t.tensor.dim=[...e.tensor.dim],t.tensor.elem=[...e.tensor.elem],Vn(e),Vn(t),t}qt.copy_tensor=vk;function qk(e){if(!dr.istensor(e))return e;let t=e.tensor.elem[0];if(e.tensor.elem.some(o=>!Ek(t,o))&&Pb.stop("Cannot promote tensor due to inconsistent tensor components."),!dr.istensor(t))return e;let r=e.tensor.ndim+t.tensor.ndim;r>dr.MAXDIM&&Pb.stop("tensor rank > "+dr.MAXDIM);let n=e.tensor.nelem*t.tensor.nelem,i=Yn.alloc_tensor(n);return i.tensor.ndim=r,i.tensor.dim=[...e.tensor.dim,...t.tensor.dim],i.tensor.elem=[].concat(...e.tensor.elem.map(o=>o.tensor.elem)),Vn(t),Vn(i),i}function Ek(e,t){if(!dr.istensor(e)&&!dr.istensor(t))return!0;if(!dr.istensor(e)||!dr.istensor(t)||e.tensor.ndim!==t.tensor.ndim)return!1;for(let r=0;r<e.tensor.ndim;r++)if(e.tensor.dim[r]!==t.tensor.dim[r])return!1;return!0}});var St=A(yd=>{"use strict";Object.defineProperty(yd,"__esModule",{value:!0});yd.alloc_tensor=void 0;var xk=Et(),gx=N();function pk(e){let t=new gx.Tensor;for(let r=0;r<e;r++)t.tensor.elem[r]=gx.Constants.zero;return xk.check_tensor_dimensions(t),t}yd.alloc_tensor=pk});var Ie=A(Lt=>{"use strict";Object.defineProperty(Lt,"__esModule",{value:!0});Lt.sort=Lt.square=Lt.exponential=Lt.yyexpand=Lt.length=Lt.cmp_expr=Lt.sign=Lt.lessp=Lt.equal=Lt.zero_matrix=void 0;var hk=St(),ut=N(),yx=ci(),_u=U(),vx=j(),Ak=G(),qx=xt(),Ok=Et();function Mk(e,t){let r=hk.alloc_tensor(e*t);return r.ndim=2,r.dim[0]=e,r.dim[1]=t,r}Lt.zero_matrix=Mk;function Tk(e,t){return bu(e,t)===0}Lt.equal=Tk;function Nk(e,t){return bu(e,t)<0}Lt.lessp=Nk;function vd(e){return e<0?-1:e>0?1:0}Lt.sign=vd;function bu(e,t){let r=0;if(e===t)return 0;if(e===_u.symbol(ut.NIL))return-1;if(t===_u.symbol(ut.NIL))return 1;if(ut.isNumericAtom(e)&&ut.isNumericAtom(t))return vd(vx.compare_numbers(e,t));if(ut.isNumericAtom(e))return-1;if(ut.isNumericAtom(t))return 1;if(ut.isstr(e)&&ut.isstr(t))return vd(yx.strcmp(e.str,t.str));if(ut.isstr(e))return-1;if(ut.isstr(t))return 1;if(ut.issymbol(e)&&ut.issymbol(t))return vd(yx.strcmp(_u.get_printname(e),_u.get_printname(t)));if(ut.issymbol(e))return-1;if(ut.issymbol(t))return 1;if(ut.istensor(e)&&ut.istensor(t))return Ok.compare_tensors(e,t);if(ut.istensor(e))return-1;if(ut.istensor(t))return 1;for(;ut.iscons(e)&&ut.iscons(t);){if(r=bu(ut.car(e),ut.car(t)),r!==0)return r;e=ut.cdr(e),t=ut.cdr(t)}return ut.iscons(t)?-1:ut.iscons(e)?1:0}Lt.cmp_expr=bu;function Ik(e){return ut.iscons(e)?[...e].length:0}Lt.length=Ik;function Sk(e){return ut.doexpand(Ak.Eval,e)}Lt.yyexpand=Sk;function wk(e){return qx.power(_u.symbol(ut.E),e)}Lt.exponential=wk;function Rk(e){return qx.power(e,vx.integer(2))}Lt.square=Rk;function Lk(e){e.sort(bu)}Lt.sort=Lk});var Oc=A(lo=>{"use strict";Object.defineProperty(lo,"__esModule",{value:!0});lo.countsize=lo.countOccurrencesOfSymbol=lo.count=void 0;var Ck=Ie(),qd=N(),$b=e=>e.reduce((t,r)=>t+r,0);function Ed(e){let t;if(qd.iscons(e)){let r=[...e];t=$b(r.map(Ed))+r.length}else t=1;return t}lo.count=Ed;function Ex(e,t){let r=0;return qd.iscons(t)?r=$b([...t].map(n=>Ex(e,n))):Ck.equal(e,t)&&(r=1),r}lo.countOccurrencesOfSymbol=Ex;function Pk(e){let t=0;if(qd.istensor(e))for(let r=0;r<e.tensor.nelem;r++)t+=Ed(e.tensor.elem[r]);else if(qd.iscons(e)){let r=[...e];t=$b(r.map(Ed))+r.length}else t=1;return t}lo.countsize=Pk});var U=A(ot=>{"use strict";Object.defineProperty(ot,"__esModule",{value:!0});ot.clear_symbol=ot.clearRenamedVariablesToAvoidBindingToExternalScope=ot.iskeyword=ot.symbol=ot.collectUserSymbols=ot.clear_symbols=ot.reset_symbols=ot.get_binding=ot.set_binding=ot.get_printname=ot.usr_symbol=ot.std_symbol=ot.inChildScope=ot.Eval_symbolsinfo=void 0;var Dk=Oc(),nn=N(),xd=Ee();function kk(){let e=$k();return e!==""?new nn.Str(e):xx(nn.NIL)}ot.Eval_symbolsinfo=kk;function $k(){return[...zr.symbolinfo()].join(`
`)}var ts=class{constructor(t){this.parent=t,this.symbols=new Map,this.bindings=new Map}getOrCreate(t){let r=this.getExisting(t);if(r)return r;let n=new nn.Sym(t);return this.symbols.set(t,n),n}getExisting(t){var r;return((r=this.parent)===null||r===void 0?void 0:r.getExisting(t))||this.symbols.get(t)}mustGet(t){var r;return this.symbols.get(t)||((r=this.parent)===null||r===void 0?void 0:r.mustGet(t))||xd.stop(`${t} not defined`)}has(t){return this.symbols.has(t.printname)}binding(t){var r;return this.bindings.get(t.printname)||((r=this.parent)===null||r===void 0?void 0:r.binding(t))||t}set(t,r){this.bindings.set(t.printname,r)}clear(){this.bindings.clear()}delete(t){var r;this.symbols.delete(t.printname),this.bindings.delete(t.printname),(r=this.parent)===null||r===void 0||r.delete(t)}*symbolinfo(){this.parent&&(yield*this.parent.symbolinfo());for(let[t,r]of this.symbols.entries()){let n=this.bindings.get(t)||r,i=(n+"").substring(0,4);yield`symbol: ${r} size: ${Dk.countsize(n)} value: ${i}...`}}clearRenamedVariablesToAvoidBindingToExternalScope(){var t;for(let r of this.symbols.keys())r.indexOf("AVOID_BINDING_TO_EXTERNAL_SCOPE_VALUE")!==-1&&this.symbols.delete(r);for(let r of this.bindings.keys())r.indexOf("AVOID_BINDING_TO_EXTERNAL_SCOPE_VALUE")!==-1&&this.bindings.delete(r);(t=this.parent)===null||t===void 0||t.clearRenamedVariablesToAvoidBindingToExternalScope()}},rs=new ts,zr=new ts(rs);function Uk(e){let t=zr;try{return zr=new ts(zr),e()}finally{zr=t}}ot.inChildScope=Uk;function Bk(e,t){let r=rs.getOrCreate(e);r.latexPrint=e,r.keyword=t}ot.std_symbol=Bk;function Gk(e){return zr.getOrCreate(e)}ot.usr_symbol=Gk;function Fk(e){return e.k!==nn.SYM&&xd.stop("symbol error"),e.printname}ot.get_printname=Fk;function jk(e,t){e.k!==nn.SYM&&xd.stop("symbol error"),zr.set(e,t)}ot.set_binding=jk;function zk(e){return e.k!==nn.SYM&&xd.stop("symbol error"),zr.binding(e)}ot.get_binding=zk;function Yk(e){return e.k!==nn.SYM?!1:/^[abcdjnrstxyz]_?$/.test(e.printname)||!rs.has(e)}function Vk(){rs=new ts,zr=new ts(rs)}ot.reset_symbols=Vk;function Zk(){zr=new ts(rs),rs.clear()}ot.clear_symbols=Zk;function Ub(e,t){if(t==null&&(t=[]),Yk(e)&&t.indexOf(e)===-1){t.push(e);return}if(nn.istensor(e)){for(let r=0;r<e.tensor.nelem;r++)Ub(e.tensor.elem[r],t);return}for(;nn.iscons(e);)Ub(nn.car(e),t),e=nn.cdr(e)}ot.collectUserSymbols=Ub;function xx(e){return zr.mustGet(e)}ot.symbol=xx;function Xk(e){return nn.issymbol(e)&&e.keyword!=null}ot.iskeyword=Xk;function Hk(){zr.clearRenamedVariablesToAvoidBindingToExternalScope()}ot.clearRenamedVariablesToAvoidBindingToExternalScope=Hk;function Qk(e){zr.delete(e)}ot.clear_symbol=Qk});var ri=A(Ot=>{"use strict";Object.defineProperty(Ot,"__esModule",{value:!0});Ot.print_list=Ot.print_expr=Ot.printline=Ot.collectLatexStringFromReturnValue=Ot.print_str=Ot.Eval_printlist=Ot.Eval_printhuman=Ot.Eval_printlatex=Ot.Eval_printcomputer=Ot.Eval_print2dascii=Ot.Eval_print=void 0;var l=N(),se=U(),ns=Ie(),Wk=an(),pd=j(),Jk=Tn(),Kk=G(),At=Q(),px=X(),e$=si(),t$=wb(),r$=Yi(),n$="^";function i$(e){return l.defs.stringsEmittedByUserPrintouts+=Xa(l.cdr(e),l.defs.printMode),se.symbol(l.NIL)}Ot.Eval_print=i$;function o$(e){return l.defs.stringsEmittedByUserPrintouts+=Xa(l.cdr(e),l.PRINTMODE_2DASCII),se.symbol(l.NIL)}Ot.Eval_print2dascii=o$;function s$(e){return l.defs.stringsEmittedByUserPrintouts+=Xa(l.cdr(e),l.PRINTMODE_COMPUTER),se.symbol(l.NIL)}Ot.Eval_printcomputer=s$;function a$(e){return l.defs.stringsEmittedByUserPrintouts+=Xa(l.cdr(e),l.PRINTMODE_LATEX),se.symbol(l.NIL)}Ot.Eval_printlatex=a$;function l$(e){let t=l.defs.test_flag;return l.defs.test_flag=!1,l.defs.stringsEmittedByUserPrintouts+=Xa(l.cdr(e),l.PRINTMODE_HUMAN),l.defs.test_flag=t,se.symbol(l.NIL)}Ot.Eval_printhuman=l$;function u$(e){let t=Xa(l.cdr(e),l.PRINTMODE_LIST);return l.defs.stringsEmittedByUserPrintouts+=t,se.symbol(l.NIL)}Ot.Eval_printlist=u$;function Xa(e,t){let r="";for(;l.iscons(e);){let n=Kk.Eval(l.car(e)),i=l.defs.printMode;t===l.PRINTMODE_COMPUTER?(l.defs.printMode=l.PRINTMODE_COMPUTER,r=hd(n),gu(r,l.LAST_FULL_PRINT)):t===l.PRINTMODE_HUMAN?(l.defs.printMode=l.PRINTMODE_HUMAN,r=hd(n),gu(r,l.LAST_PLAIN_PRINT)):t===l.PRINTMODE_2DASCII?(l.defs.printMode=l.PRINTMODE_2DASCII,r=t$.print2dascii(n),gu(r,l.LAST_2DASCII_PRINT)):t===l.PRINTMODE_LATEX?(l.defs.printMode=l.PRINTMODE_LATEX,r=hd(n),gu(r,l.LAST_LATEX_PRINT)):t===l.PRINTMODE_LIST&&(l.defs.printMode=l.PRINTMODE_LIST,r=Ha(n),gu(r,l.LAST_LIST_PRINT)),l.defs.printMode=i,e=l.cdr(e)}return l.DEBUG&&console.log(`emttedString from display: ${l.defs.stringsEmittedByUserPrintouts}`),r}function gu(e,t){let[,r]=r$.scan('"'+e+'"');se.set_binding(se.symbol(t),r)}function S(e){return l.DEBUG&&console.log(`emttedString from print_str: ${l.defs.stringsEmittedByUserPrintouts}`),e}Ot.print_str=S;function Yr(e){return e}function c$(e){let t=l.defs.printMode;l.defs.printMode=l.PRINTMODE_LATEX;let r=l.defs.codeGen;l.defs.codeGen=!1;let n=C(e);return n=n.replace(/_/g,"\\_"),l.defs.printMode=t,l.defs.codeGen=r,l.DEBUG&&console.log(`emttedString from collectLatexStringFromReturnValue: ${l.defs.stringsEmittedByUserPrintouts}`),n}Ot.collectLatexStringFromReturnValue=c$;function hd(e){let t="";return t+=C(e),t}Ot.printline=hd;function hx(e){let t="";return At.isfraction(e)||l.isadd(e)||l.ismultiply(e)||l.ispower(e)||ns.lessp(e,l.Constants.zero)?(t+=Yr("("),t+=C(e),t+=Yr(")")):t+=C(e),t}function Ax(e){let t="";return At.isfraction(e)||l.isadd(e)||l.ismultiply(e)||l.ispower(e)?(t+=Yr("("),t+=C(e),t+=Yr(")")):t+=C(e),t}function f$(e,t){let r="",n=l.cadr(e),i=l.caddr(e);return At.isminusone(i)?(r+=hx(n),r):(t===1&&(r+=Yr("(")),i=px.negate(i),r+=vu(n,i),t===1&&(r+=Yr(")")),r)}function d$(e){let t,r,n="",i=0,o=0,s=0,u=l.cdr(e),c=l.car(u);for(l.isrational(c)?(t=Wk.absval(pd.mp_numerator(c)),r=pd.mp_denominator(c),At.isplusone(t)||o++,At.isplusone(r)||s++,u=l.cdr(u)):(t=l.Constants.one,r=l.Constants.one);l.iscons(u);)c=l.car(u),Ad(c)?s++:o++,u=l.cdr(u);if(l.defs.printMode===l.PRINTMODE_LATEX&&(n+=S("\\frac{")),o===0)n+=Yr("1");else for(i=0,u=l.cdr(e),l.isrational(l.car(u))&&(u=l.cdr(u)),At.isplusone(t)||(n+=xn(t),i=1);l.iscons(u);)c=l.car(u),Ad(c)||(i&&(n+=Gb()),n+=xn(c),i=1),u=l.cdr(u);for(l.defs.printMode===l.PRINTMODE_LATEX?n+=S("}{"):l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag?n+=S(" / "):n+=S("/"),s>1&&l.defs.printMode!==l.PRINTMODE_LATEX&&(n+=Yr("(")),i=0,u=l.cdr(e),l.isrational(l.car(u))&&(u=l.cdr(u)),At.isplusone(r)||(n+=xn(r),i=1);l.iscons(u);)c=l.car(u),Ad(c)&&(i&&(n+=Gb()),n+=f$(c,s),i=1),u=l.cdr(u);return s>1&&l.defs.printMode!==l.PRINTMODE_LATEX&&(n+=Yr(")")),l.defs.printMode===l.PRINTMODE_LATEX&&(n+=S("}")),n}function C(e){let t="";if(l.isadd(e))for(e=l.cdr(e),yu(l.car(e))==="-"&&(t+=S("-")),t+=Bb(l.car(e)),e=l.cdr(e);l.iscons(e);)yu(l.car(e))==="+"?l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag?t+=S(" + "):t+=S("+"):l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag?t+=S(" - "):t+=S("-"),t+=Bb(l.car(e)),e=l.cdr(e);else yu(e)==="-"&&(t+=S("-")),t+=Bb(e);return t}Ot.print_expr=C;function yu(e){let t="";return l.ismultiply(e)&&l.isNumericAtom(l.cadr(e))&&ns.lessp(l.cadr(e),l.Constants.zero)||l.isNumericAtom(e)&&ns.lessp(e,l.Constants.zero)?t+="-":t+="+",t}function Bb(e){let t="";if(l.ismultiply(e)&&X$(e))return t+=d$(e),t;if(l.ismultiply(e)){let r,n;e=l.cdr(e),At.isminusone(l.car(e))&&(e=l.cdr(e));let i=!1;l.isNumericAtom(l.car(e))&&(i=!0);let o=!1;for(l.defs.printMode===l.PRINTMODE_LATEX&&l.iscons(l.cdr(e))&&At.isNumberOneOverSomething(l.car(e))&&(o=!0,r=l.car(e).q.b.toString()),o?(n=t,t=""):t+=xn(l.car(e)),e=l.cdr(e);l.iscons(e);)l.defs.printMode===l.PRINTMODE_LATEX&&i&&l.caar(e)===se.symbol(l.POWER)&&l.isNumericAtom(l.car(l.cdr(l.car(e))))&&(At.isfraction(l.car(l.cdr(l.cdr(l.car(e)))))||(t+=" \\cdot ")),t+=Gb(),t+=xn(l.car(e),!1,!0),i=!1,l.isNumericAtom(l.car(e))&&(i=!0),e=l.cdr(e);o&&(t=n+"\\frac{"+t+"}{"+r+"}")}else t+=xn(e);return t}function Ox(e){let t="";return t+=Yr("("),t+=C(e),t+=Yr(")"),t}function m$(e){let t="";return e=l.cadr(e),At.isfraction(e)||l.isadd(e)||l.ismultiply(e)||l.ispower(e)||l.isfactorial(e)?t+=Ox(e):t+=C(e),t+=Yr("!"),t}function _$(e){let t="";return t+=S("\\left |"),t+=C(l.cadr(e)),t+=S(" \\right |"),t}function b$(e){let t="";return t+=S("\\binom{"),t+=C(l.cadr(e)),t+=S("}{"),t+=C(l.caddr(e)),t+=S("} "),t}function g$(e){let t="";return t+=C(l.cadr(e)),t+=S(" \\cdot "),t+=C(l.caddr(e)),t}function y$(e){let t="dot(";return t+=C(l.cadr(e)),t+=", ",t+=C(l.caddr(e)),t+=")",t}function v$(e){let t="Math.sin(";return t+=C(l.cadr(e)),t+=")",t}function q$(e){let t="Math.cos(";return t+=C(l.cadr(e)),t+=")",t}function E$(e){let t="Math.tan(";return t+=C(l.cadr(e)),t+=")",t}function x$(e){let t="Math.asin(";return t+=C(l.cadr(e)),t+=")",t}function p$(e){let t="Math.acos(";return t+=C(l.cadr(e)),t+=")",t}function h$(e){let t="Math.atan(";return t+=C(l.cadr(e)),t+=")",t}function A$(e){let t="";return t+=S("\\sqrt{"),t+=C(l.cadr(e)),t+=S("} "),t}function O$(e){let t="";return t+=S("{"),l.iscons(l.cadr(e))&&(t+=S("(")),t+=C(l.cadr(e)),l.iscons(l.cadr(e))&&(t+=S(")")),t+=S("}"),t+=S("^T"),t}function M$(e){let t="";return t+=S("transpose("),t+=C(l.cadr(e)),t+=S(")"),t}function T$(e){let t="";return t+=S("identity("),t+=C(l.cadr(e)),t+=S(")"),t}function N$(e){let t="";return t+=S("{"),l.iscons(l.cadr(e))&&(t+=S("(")),t+=C(l.cadr(e)),l.iscons(l.cadr(e))&&(t+=S(")")),t+=S("}"),t+=S("^{-1}"),t}function I$(e){let t="";return t+=S("inv("),t+=C(l.cadr(e)),t+=S(")"),t}function S$(e){let t="",r=l.car(l.cdr(e));e=l.cdr(e);let n=e,i=0;for(;l.iscons(l.cdr(l.cdr(e)));){i++;let o=l.cdr(l.cdr(e));t+=S("\\int^{"),t+=C(l.car(l.cdr(o))),t+=S("}_{"),t+=C(l.car(o)),t+=S("} \\! "),e=l.cdr(o)}t+=C(r),t+=S(" \\,"),e=n;for(let o=1;o<=i;o++){let s=l.cdr(e);t+=S(" \\mathrm{d} "),t+=C(l.car(s)),o<i&&(t+=S(" \\, ")),e=l.cdr(l.cdr(s))}return t}function w$(e){let t="";return t+=Mx(e,0,0)[1],t}function Mx(e,t,r){let n="";if(n+=S("["),t<e.tensor.ndim-1)for(let i=0;i<e.tensor.dim[t];i++){let o;[r,o]=Array.from(Mx(e,t+1,r)),n+=o,i!==e.tensor.dim[t]-1&&(n+=S(","))}else for(let i=0;i<e.tensor.dim[t];i++)n+=C(e.tensor.elem[r]),i!==e.tensor.dim[t]-1&&(n+=S(",")),r++;return n+=S("]"),[r,n]}function R$(e){let t="";return e.tensor.ndim<=2&&(t+=Tx(!0,e,0,0)[1]),t}function Tx(e,t,r,n){let i="";if(e&&(i+="\\begin{bmatrix} "),r<t.tensor.ndim-1)for(let o=0;o<t.tensor.dim[r];o++){let s;[n,s]=Array.from(Tx(!1,t,r+1,n)),i+=s,o!==t.tensor.dim[r]-1&&(i+=S(" \\\\ "))}else for(let o=0;o<t.tensor.dim[r];o++)i+=C(t.tensor.elem[n]),o!==t.tensor.dim[r]-1&&(i+=S(" & ")),n++;return e&&(i+=" \\end{bmatrix}"),[n,i]}function L$(e){let t="\\sum_{";return t+=C(l.caddr(e)),t+="=",t+=C(l.cadddr(e)),t+="}^{",t+=C(l.caddddr(e)),t+="}{",t+=C(l.cadr(e)),t+="}",t}function C$(e){let t=l.cadr(e),r=l.caddr(e),n=l.cadddr(e),i=l.caddddr(e);return"(function(){ var "+r+";  var holderSum = 0;  var lowerlimit = "+C(n)+";  var upperlimit = "+C(i)+";  for ("+r+" = lowerlimit; "+r+" < upperlimit; "+r+"++) {    holderSum += "+C(t)+"; }  return holderSum;})()"}function P$(e){let t="\\left\\{ \\begin{array}{ll}";for(e=l.cdr(e);l.iscons(e);){if(l.cdr(e)===se.symbol(l.NIL)){t+="{",t+=C(l.car(e)),t+="} & otherwise ",t+=" \\\\\\\\";break}t+="{",t+=C(l.cadr(e)),t+="} & if & ",t+=C(l.car(e)),t+=" \\\\\\\\",e=l.cddr(e)}return t=t.substring(0,t.length-4),t+="\\end{array} \\right."}function D$(e){let t="(function(){";e=l.cdr(e);let r=0;for(;l.iscons(e);){if(l.cdr(e)===se.symbol(l.NIL)){t+="else {",t+="return ("+C(l.car(e))+");",t+="}";break}r&&(t+=" else "),t+="if ("+C(l.car(e))+"){",t+="return ("+C(l.cadr(e))+");",t+="}",r++,e=l.cddr(e)}return t+="})()",t}function k$(e){let t="{";return t+=C(l.cadr(e)),t+="}",t+=" < ",t+="{",t+=C(l.caddr(e)),t+="}"}function $$(e){let t="{";return t+=C(l.cadr(e)),t+="}",t+=" \\leq ",t+="{",t+=C(l.caddr(e)),t+="}"}function U$(e){let t="{";return t+=C(l.cadr(e)),t+="}",t+=" > ",t+="{",t+=C(l.caddr(e)),t+="}"}function B$(e){let t="{";return t+=C(l.cadr(e)),t+="}",t+=" \\geq ",t+="{",t+=C(l.caddr(e)),t+="}"}function G$(e){let t="{";return t+=C(l.cadr(e)),t+="}",t+=" = ",t+="{",t+=C(l.caddr(e)),t+="}"}function F$(e){let t=l.cadr(e),r=l.caddr(e),n=l.cadddr(e),i=l.caddddr(e);return"(function(){ var "+r+";  var lowerlimit = "+C(n)+";  var upperlimit = "+C(i)+";  for ("+r+" = lowerlimit; "+r+" < upperlimit; "+r+"++) {    "+C(t)+" } })()"}function j$(e){let t="";for(e=l.cdr(e);l.iscons(e);)t+=C(l.car(e)),e=l.cdr(e);return t}function z$(e){let t="";return t+=C(l.cadr(e)),t+=" = ",t+=C(l.caddr(e)),t+="; ",t}function Y$(e){let t="\\prod_{";return t+=C(l.caddr(e)),t+="=",t+=C(l.cadddr(e)),t+="}^{",t+=C(l.caddddr(e)),t+="}{",t+=C(l.cadr(e)),t+="}",t}function V$(e){let t=l.cadr(e),r=l.caddr(e),n=l.cadddr(e),i=l.caddddr(e);return"(function(){ var "+r+";  var holderProduct = 1;  var lowerlimit = "+C(n)+";  var upperlimit = "+C(i)+";  for ("+r+" = lowerlimit; "+r+" < upperlimit; "+r+"++) {    holderProduct *= "+C(t)+"; }  return holderProduct;})()"}function vu(e,t){let r="";if(l.DEBUG&&console.log("power base: "+e+"  exponent: "+t),At.isoneovertwo(t))if(At.equaln(e,2)){if(l.defs.codeGen)return r+=S("Math.SQRT2"),r}else{if(l.defs.printMode===l.PRINTMODE_LATEX)return r+=S("\\sqrt{"),r+=C(e),r+=S("}"),r;if(l.defs.codeGen)return r+=S("Math.sqrt("),r+=C(e),r+=S(")"),r}if(At.equaln(se.get_binding(se.symbol(l.PRINT_LEAVE_E_ALONE)),1)&&e===se.symbol(l.E))return l.defs.codeGen?(r+=S("Math.exp("),r+=Ax(t),r+=S(")"),r):(l.defs.printMode===l.PRINTMODE_LATEX?(r+=S("e^{"),r+=C(t),r+=S("}")):(r+=S("exp("),r+=C(t),r+=S(")")),r);if(l.defs.codeGen)return r+=S("Math.pow("),r+=hx(e),r+=S(", "),r+=Ax(t),r+=S(")"),r;if(At.equaln(se.get_binding(se.symbol(l.PRINT_LEAVE_X_ALONE)),0)||e.printname!=="x"){if(e!==se.symbol(l.E)){if(At.isminusone(t))return l.defs.printMode===l.PRINTMODE_LATEX?r+=S("\\frac{1}{"):l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag?r+=S("1 / "):r+=S("1/"),l.iscons(e)&&l.defs.printMode!==l.PRINTMODE_LATEX?(r+=S("("),r+=C(e),r+=S(")")):r+=C(e),l.defs.printMode===l.PRINTMODE_LATEX&&(r+=S("}")),r;if(At.isnegativeterm(t)){l.defs.printMode===l.PRINTMODE_LATEX?r+=S("\\frac{1}{"):l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag?r+=S("1 / "):r+=S("1/");let n=px.multiply(t,l.Constants.negOne);return l.iscons(e)&&l.defs.printMode!==l.PRINTMODE_LATEX?(r+=S("("),r+=vu(e,n),r+=S(")")):r+=vu(e,n),l.defs.printMode===l.PRINTMODE_LATEX&&(r+=S("}")),r}}if(At.isfraction(t)&&l.defs.printMode===l.PRINTMODE_LATEX){r+=S("\\sqrt");let n=Jk.denominator(t);return At.isplustwo(n)||(r+=S("["),r+=C(n),r+=S("]")),r+=S("{"),t=e$.numerator(t),r+=vu(e,t),r+=S("}"),r}}return l.defs.printMode===l.PRINTMODE_LATEX&&At.isplusone(t)?r+=C(e):(l.isadd(e)||At.isnegativenumber(e)?(r+=S("("),r+=C(e),r+=S(")")):l.ismultiply(e)||l.ispower(e)?(l.defs.printMode!==l.PRINTMODE_LATEX&&(r+=S("(")),r+=xn(e,!0),l.defs.printMode!==l.PRINTMODE_LATEX&&(r+=S(")"))):l.isNumericAtom(e)&&(ns.lessp(e,l.Constants.zero)||At.isfraction(e))?(r+=S("("),r+=xn(e),r+=S(")")):r+=xn(e),l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag?r+=S(n$):r+=S("^"),l.defs.printMode===l.PRINTMODE_LATEX?C(t).length>1?(r+=S("{"),r+=C(t),r+=S("}")):r+=C(t):l.iscons(t)||At.isfraction(t)||l.isNumericAtom(t)&&ns.lessp(t,l.Constants.zero)?(r+=S("("),r+=C(t),r+=S(")")):r+=xn(t)),r}function Z$(e){let t="";if(e=l.cdr(e),l.caar(e)===se.symbol(l.ADD)||l.caar(e)===se.symbol(l.MULTIPLY)||l.caar(e)===se.symbol(l.POWER)||l.caar(e)===se.symbol(l.FACTORIAL)?t+=Ox(l.car(e)):t+=C(l.car(e)),t+=S("["),e=l.cdr(e),l.iscons(e))for(t+=C(l.car(e)),e=l.cdr(e);l.iscons(e);)t+=S(","),t+=C(l.car(e)),e=l.cdr(e);return t+=S("]"),t}function xn(e,t=!1,r=!1){let n="";if(l.isNumericAtom(e))return r&&ns.lessp(e,l.Constants.zero)&&(n+="("),n+=pd.print_number(e,r),r&&ns.lessp(e,l.Constants.zero)&&(n+=")"),n;if(l.isstr(e))return n+=S('"'),n+=S(e.str),n+=S('"'),n;if(l.istensor(e))return l.defs.printMode===l.PRINTMODE_LATEX?n+=R$(e):n+=w$(e),n;if(l.ismultiply(e))return t||(yu(e)==="-"||l.defs.printMode!==l.PRINTMODE_LATEX)&&(l.defs.printMode===l.PRINTMODE_LATEX?n+=S(" \\left ("):n+=S("(")),n+=C(e),t||(yu(e)==="-"||l.defs.printMode!==l.PRINTMODE_LATEX)&&(l.defs.printMode===l.PRINTMODE_LATEX?n+=S(" \\right ) "):n+=S(")")),n;if(l.isadd(e))return t||(n+=S("(")),n+=C(e),t||(n+=S(")")),n;if(l.ispower(e)){let i=l.cadr(e),o=l.caddr(e);return n+=vu(i,o),n}if(l.car(e)===se.symbol(l.FUNCTION)){let i=l.cadr(e);if(!l.defs.codeGen){let o=l.caddr(e);n+=S("function "),l.DEBUG&&console.log(`emittedString from print_factor ${l.defs.stringsEmittedByUserPrintouts}`),n+=Ha(o),n+=S(" -> ")}return n+=C(i),n}if(l.car(e)===se.symbol(l.PATTERN))return n+=C(l.caadr(e)),l.defs.printMode===l.PRINTMODE_LATEX?n+=S(" \\rightarrow "):l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag?n+=S(" -> "):n+=S("->"),n+=C(l.car(l.cdr(l.cadr(e)))),n;if(l.car(e)===se.symbol(l.INDEX)&&l.issymbol(l.cadr(e)))return n+=Z$(e),n;if(l.isfactorial(e))return n+=m$(e),n;if(l.car(e)===se.symbol(l.ABS)&&l.defs.printMode===l.PRINTMODE_LATEX)return n+=_$(e),n;if(l.car(e)===se.symbol(l.SQRT)&&l.defs.printMode===l.PRINTMODE_LATEX)return n+=A$(e),n;if(l.isfactorial(e)){if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=O$(e),n;if(l.defs.codeGen)return n+=M$(e),n}else if(l.car(e)===se.symbol(l.UNIT)){if(l.defs.codeGen)return n+=T$(e),n}else if(l.isinv(e)){if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=N$(e),n;if(l.defs.codeGen)return n+=I$(e),n}else{if(l.car(e)===se.symbol(l.BINOMIAL)&&l.defs.printMode===l.PRINTMODE_LATEX)return n+=b$(e),n;if(l.car(e)===se.symbol(l.DEFINT)&&l.defs.printMode===l.PRINTMODE_LATEX)return n+=S$(e),n;if(l.isinnerordot(e)){if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=g$(e),n;if(l.defs.codeGen)return n+=y$(e),n}else if(l.car(e)===se.symbol(l.SIN)){if(l.defs.codeGen)return n+=v$(e),n}else if(l.car(e)===se.symbol(l.COS)){if(l.defs.codeGen)return n+=q$(e),n}else if(l.car(e)===se.symbol(l.TAN)){if(l.defs.codeGen)return n+=E$(e),n}else if(l.car(e)===se.symbol(l.ARCSIN)){if(l.defs.codeGen)return n+=x$(e),n}else if(l.car(e)===se.symbol(l.ARCCOS)){if(l.defs.codeGen)return n+=p$(e),n}else if(l.car(e)===se.symbol(l.ARCTAN)){if(l.defs.codeGen)return n+=h$(e),n}else if(l.car(e)===se.symbol(l.SUM)){if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=L$(e),n;if(l.defs.codeGen)return n+=C$(e),n}else if(l.car(e)===se.symbol(l.PRODUCT)){if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=Y$(e),n;if(l.defs.codeGen)return n+=V$(e),n}else if(l.car(e)===se.symbol(l.FOR)){if(l.defs.codeGen)return n+=F$(e),n}else if(l.car(e)===se.symbol(l.DO)){if(l.defs.codeGen)return n+=j$(e),n}else if(l.car(e)===se.symbol(l.TEST)){if(l.defs.codeGen)return n+=D$(e),n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=P$(e),n}else if(l.car(e)===se.symbol(l.TESTLT)){if(l.defs.codeGen)return n+="(("+C(l.cadr(e))+") < ("+C(l.caddr(e))+"))",n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=k$(e),n}else if(l.car(e)===se.symbol(l.TESTLE)){if(l.defs.codeGen)return n+="(("+C(l.cadr(e))+") <= ("+C(l.caddr(e))+"))",n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=$$(e),n}else if(l.car(e)===se.symbol(l.TESTGT)){if(l.defs.codeGen)return n+="(("+C(l.cadr(e))+") > ("+C(l.caddr(e))+"))",n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=U$(e),n}else if(l.car(e)===se.symbol(l.TESTGE)){if(l.defs.codeGen)return n+="(("+C(l.cadr(e))+") >= ("+C(l.caddr(e))+"))",n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=B$(e),n}else if(l.car(e)===se.symbol(l.TESTEQ)){if(l.defs.codeGen)return n+="(("+C(l.cadr(e))+") === ("+C(l.caddr(e))+"))",n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=G$(e),n}else if(l.car(e)===se.symbol(l.FLOOR)){if(l.defs.codeGen)return n+="Math.floor("+C(l.cadr(e))+")",n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=" \\lfloor {"+C(l.cadr(e))+"} \\rfloor ",n}else if(l.car(e)===se.symbol(l.CEILING)){if(l.defs.codeGen)return n+="Math.ceiling("+C(l.cadr(e))+")",n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=" \\lceil {"+C(l.cadr(e))+"} \\rceil ",n}else if(l.car(e)===se.symbol(l.ROUND)){if(l.defs.codeGen)return n+="Math.round("+C(l.cadr(e))+")",n}else if(l.car(e)===se.symbol(l.SETQ))return l.defs.codeGen?(n+=z$(e),n):(n+=C(l.cadr(e)),n+=S("="),n+=C(l.caddr(e)),n)}if(l.iscons(e)){if(n+=xn(l.car(e)),e=l.cdr(e),t||(n+=S("(")),l.iscons(e))for(n+=C(l.car(e)),e=l.cdr(e);l.iscons(e);)n+=S(","),n+=C(l.car(e)),e=l.cdr(e);return t||(n+=S(")")),n}return e===se.symbol(l.DERIVATIVE)?n+=Yr("d"):e===se.symbol(l.E)?l.defs.codeGen?n+=S("Math.E"):n+=S("e"):e===se.symbol(l.PI)?l.defs.printMode===l.PRINTMODE_LATEX?n+=S("\\pi"):n+=S("pi"):n+=S(se.get_printname(e)),n}function Ha(e){let t="";switch(e.k){case l.CONS:for(t+="(",t+=Ha(l.car(e)),e===l.cdr(e)&&(console.log("oh no recursive!"),l.breakpoint),e=l.cdr(e);l.iscons(e);)t+=" ",t+=Ha(l.car(e)),e=l.cdr(e),e===l.cdr(e)&&e!==se.symbol(l.NIL)&&(console.log("oh no recursive!"),l.breakpoint);e!==se.symbol(l.NIL)&&(t+=" . ",t+=Ha(e)),t+=")";break;case l.STR:t+=e.str;break;case l.NUM:case l.DOUBLE:t+=pd.print_number(e,!0);break;case l.SYM:t+=se.get_printname(e);break;default:t+="<tensor>"}return t}Ot.print_list=Ha;function Gb(){let e="";return l.defs.printMode===l.PRINTMODE_LATEX||(l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag&&!l.defs.codeGen?e+=S(" "):e+=S("*")),e}function Ad(e){return l.ispower(e)&&l.cadr(e)!==se.symbol(l.E)&&At.isnegativeterm(l.caddr(e))}function X$(e){for(e=l.cdr(e);l.iscons(e);){let t=l.car(e);if(Ad(t))return!0;e=l.cdr(e)}return!1}});var N=A(a=>{"use strict";var H$=a&&a.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(a,"__esModule",{value:!0});a.evalFloats=a.evalPolar=a.doexpand=a.noexpand=a.Constants=a.$=a.reset_after_error=a.MEQUAL=a.MZERO=a.MSIGN=a.isidentitymatrix=a.isinv=a.istranspose=a.isinnerordot=a.isfactorial=a.ispower=a.ismultiply=a.isadd=a.caddaddr=a.cdddaddr=a.caddadr=a.cddaddr=a.cadaddr=a.caddddr=a.cddddr=a.cadddr=a.cdaddr=a.caddar=a.cadadr=a.caaddr=a.cdddr=a.cddar=a.cdadr=a.cadar=a.caddr=a.caadr=a.cddr=a.cdar=a.cadr=a.caar=a.cdr=a.car=a.issymbol=a.isNumericAtomOrTensor=a.istensor=a.isstr=a.isNumericAtom=a.isdouble=a.isrational=a.iscons=a.dotprod_unicode=a.transpose_unicode=a.logbuf=a.mtotal=a.primetab=a.parse_time_simplifications=a.predefinedSymbolsInGlobalScope_doNotTrackInDependencies=a.MAXDIM=a.MAX_CONSECUTIVE_APPLICATIONS_OF_SINGLE_RULE=a.MAX_CONSECUTIVE_APPLICATIONS_OF_ALL_RULES=a.MAXPRIMETAB=a.E=a.C6=a.C5=a.C4=a.C3=a.C2=a.C1=a.SYMBOL_X_UNDERSCORE=a.SYMBOL_B_UNDERSCORE=a.SYMBOL_A_UNDERSCORE=a.SYMBOL_IDENTITY_MATRIX=a.SYMBOL_Z=a.SYMBOL_Y=a.SYMBOL_X=a.SYMBOL_T=a.SYMBOL_S=a.SYMBOL_R=a.SYMBOL_N=a.SYMBOL_J=a.SYMBOL_I=a.SYMBOL_D=a.SYMBOL_C=a.SYMBOL_B=a.SYMBOL_A=a.PI=a.VERSION=a.SECRETX=a.METAX=a.METAB=a.METAA=a.DRAWX=a.YYE=a.MAX_FIXED_PRINTOUT_DIGITS=a.FORCE_FIXED_PRINTOUT=a.TRACE=a.ASSUME_REAL_VARIABLES=a.BAKE=a.AUTOEXPAND=a.LAST_PLAIN_PRINT=a.LAST_LIST_PRINT=a.LAST_LATEX_PRINT=a.LAST_FULL_PRINT=a.LAST_2DASCII_PRINT=a.LAST_PRINT=a.LAST=a.NIL=a.ZERO=a.UNIT=a.TRANSPOSE=a.TESTLT=a.TESTLE=a.TESTGT=a.TESTGE=a.TESTEQ=a.TEST=a.TAYLOR=a.TANH=a.TAN=a.SYMBOLSINFO=a.SUM=a.SUBST=a.STOP=a.SQRT=a.SHAPE=a.SINH=a.SIN=a.SIMPLIFY=a.SILENTPATTERN=a.SGN=a.SETQ=a.ROOTS=a.YYRECT=a.ROUND=a.REAL=a.RATIONALIZE=a.RANK=a.QUOTIENT=a.QUOTE=a.PRODUCT=a.PRINTPLAIN=a.PRINTLIST=a.PRINTLATEX=a.PRINTFULL=a.PRINT2DASCII=a.PRINT=a.PRINT_LEAVE_X_ALONE=a.PRINT_LEAVE_E_ALONE=a.PRIME=a.POWER=a.POLAR=a.PATTERNSINFO=a.PATTERN=a.OUTER=a.OR=a.OPERATOR=a.NUMERATOR=a.NUMBER=a.NROOTS=a.NOT=a.MULTIPLY=a.MOD=a.LOOKUP=a.LOG=a.LEGENDRE=a.LEADING=a.LCM=a.LAGUERRE=a.ISPRIME=a.ISINTEGER=a.INVG=a.INV=a.INTEGRAL=a.INNER=a.INDEX=a.IMAG=a.HILBERT=a.HERMITE=a.GCD=a.GAMMA=a.FUNCTION=a.FOR=a.FLOOR=a.FLOATF=a.FILTER=a.FACTORPOLY=a.FACTORIAL=a.FACTOR=a.EXPSIN=a.EXPCOS=a.EXPAND=a.EXP=a.EVAL=a.ERFC=a.ERF=a.EIGENVEC=a.EIGENVAL=a.EIGEN=a.DSOLVE=a.DRAW=a.DOT=a.DO=a.DIVISORS=a.DIRAC=a.DIM=a.DET=a.DERIVATIVE=a.DENOMINATOR=a.DEGREE=a.DEFINT=a.DECOMP=a.COSH=a.COS=a.CONTRACT=a.CONJ=a.CONDENSE=a.COFACTOR=a.COEFF=a.CLOCK=a.CLEARPATTERNS=a.CLEARALL=a.CLEAR=a.CIRCEXP=a.CHOOSE=a.CHECK=a.CEILING=a.BINOMIAL=a.BINDING=a.BESSELY=a.BESSELJ=a.ATOMIZE=a.ARG=a.ARCTANH=a.ARCTAN=a.ARCSINH=a.ARCSIN=a.ARCCOSH=a.ARCCOS=a.APPROXRATIO=a.AND=a.ADJ=a.ADD=a.ABS=a.SYM=a.TENSOR=a.STR=a.DOUBLE=a.NUM=a.CONS=a.Sym=a.Tensor=a.Str=a.Double=a.Num=a.Cons=a.BaseAtom=a.avoidCalculatingPowersIntoArctans=a.do_simplify_nested_radicals=a.dontCreateNewRadicalsInDenominatorWhenEvalingMultiplication=a.defs=a.PRINTMODE_LIST=a.PRINTMODE_HUMAN=a.PRINTMODE_COMPUTER=a.PRINTMODE_2DASCII=a.PRINTMODE_LATEX=a.PRINTOUTRESULT=a.DEBUG=a.NSYM=a.version=a.breakpoint=void 0;var Od=H$(Ti()),Nx=ri(),Vr=U();function Ix(){}a.breakpoint=Ix;a.version="2.0.0";a.NSYM=1e3;a.DEBUG=!1;a.PRINTOUTRESULT=!1;a.PRINTMODE_LATEX="PRINTMODE_LATEX";a.PRINTMODE_2DASCII="PRINTMODE_2DASCII";a.PRINTMODE_COMPUTER="PRINTMODE_COMPUTER";a.PRINTMODE_HUMAN="PRINTMODE_HUMAN";a.PRINTMODE_LIST="PRINTMODE_LIST";var Sx=class{constructor(){this.printMode=a.PRINTMODE_COMPUTER,this.recursionLevelNestedRadicalsRemoval=0,this.errorMessage="",this.symbolsDependencies={},this.symbolsHavingReassignments=[],this.symbolsInExpressionsWithoutAssignments=[],this.patternHasBeenFound=!1,this.inited=!1,this.chainOfUserSymbolsNotFunctionsBeingEvaluated=[],this.stringsEmittedByUserPrintouts="",this.called_from_Algebra_block=!1,this.expanding=!1,this.evaluatingAsFloats=!1,this.evaluatingPolar=!1,this.esc_flag=!1,this.trigmode=0,this.out_count=0,this.test_flag=!1,this.codeGen=!1,this.userSimplificationsInListForm=[],this.userSimplificationsInStringForm=[],this.fullDoubleOutput=!1}};a.defs=new Sx;a.dontCreateNewRadicalsInDenominatorWhenEvalingMultiplication=!0;a.do_simplify_nested_radicals=!0;a.avoidCalculatingPowersIntoArctans=!0;var uo=class{toString(){return Nx.print_expr(this)}toLatexString(){return Nx.collectLatexStringFromReturnValue(this)}};a.BaseAtom=uo;var Md=class extends uo{constructor(t,r){super();this.k=a.CONS,this.cons={car:t,cdr:r}}*[Symbol.iterator](){let t=this;for(;Wa(t);)yield Ce(t),t=ae(t)}tail(){return Wa(this.cons.cdr)?[...this.cons.cdr]:[]}map(t){let r=Ce(this),n=ae(this);return Wa(n)&&(n=n.map(t)),new Md(t(r),n)}};a.Cons=Md;var qu=class extends uo{constructor(t,r=Od.default.one){super();this.a=t,this.b=r,this.q=this,this.k=a.NUM}};a.Num=qu;var Qa=class extends uo{constructor(t){super();this.d=t,this.k=a.DOUBLE}};a.Double=Qa;var wx=class extends uo{constructor(t){super();this.str=t,this.k=a.STR}};a.Str=wx;var Rx=class extends uo{constructor(){super(...arguments);this.tensor=this,this.k=a.TENSOR,this.ndim=0,this.dim=[],this.elem=[]}get nelem(){return this.elem.length}};a.Tensor=Rx;var Lx=class extends uo{constructor(t){super();this.printname=t,this.k=a.SYM}};a.Sym=Lx;a.CONS=0;a.NUM=1;a.DOUBLE=2;a.STR=3;a.TENSOR=4;a.SYM=5;a.ABS="abs";a.ADD="add";a.ADJ="adj";a.AND="and";a.APPROXRATIO="approxratio";a.ARCCOS="arccos";a.ARCCOSH="arccosh";a.ARCSIN="arcsin";a.ARCSINH="arcsinh";a.ARCTAN="arctan";a.ARCTANH="arctanh";a.ARG="arg";a.ATOMIZE="atomize";a.BESSELJ="besselj";a.BESSELY="bessely";a.BINDING="binding";a.BINOMIAL="binomial";a.CEILING="ceiling";a.CHECK="check";a.CHOOSE="choose";a.CIRCEXP="circexp";a.CLEAR="clear";a.CLEARALL="clearall";a.CLEARPATTERNS="clearpatterns";a.CLOCK="clock";a.COEFF="coeff";a.COFACTOR="cofactor";a.CONDENSE="condense";a.CONJ="conj";a.CONTRACT="contract";a.COS="cos";a.COSH="cosh";a.DECOMP="decomp";a.DEFINT="defint";a.DEGREE="deg";a.DENOMINATOR="denominator";a.DERIVATIVE="derivative";a.DET="det";a.DIM="dim";a.DIRAC="dirac";a.DIVISORS="divisors";a.DO="do";a.DOT="dot";a.DRAW="draw";a.DSOLVE="dsolve";a.EIGEN="eigen";a.EIGENVAL="eigenval";a.EIGENVEC="eigenvec";a.ERF="erf";a.ERFC="erfc";a.EVAL="eval";a.EXP="exp";a.EXPAND="expand";a.EXPCOS="expcos";a.EXPSIN="expsin";a.FACTOR="factor";a.FACTORIAL="factorial";a.FACTORPOLY="factorpoly";a.FILTER="filter";a.FLOATF="float";a.FLOOR="floor";a.FOR="for";a.FUNCTION="function";a.GAMMA="Gamma";a.GCD="gcd";a.HERMITE="hermite";a.HILBERT="hilbert";a.IMAG="imag";a.INDEX="component";a.INNER="inner";a.INTEGRAL="integral";a.INV="inv";a.INVG="invg";a.ISINTEGER="isinteger";a.ISPRIME="isprime";a.LAGUERRE="laguerre";a.LCM="lcm";a.LEADING="leading";a.LEGENDRE="legendre";a.LOG="log";a.LOOKUP="lookup";a.MOD="mod";a.MULTIPLY="multiply";a.NOT="not";a.NROOTS="nroots";a.NUMBER="number";a.NUMERATOR="numerator";a.OPERATOR="operator";a.OR="or";a.OUTER="outer";a.PATTERN="pattern";a.PATTERNSINFO="patternsinfo";a.POLAR="polar";a.POWER="power";a.PRIME="prime";a.PRINT_LEAVE_E_ALONE="printLeaveEAlone";a.PRINT_LEAVE_X_ALONE="printLeaveXAlone";a.PRINT="print";a.PRINT2DASCII="print2dascii";a.PRINTFULL="printcomputer";a.PRINTLATEX="printlatex";a.PRINTLIST="printlist";a.PRINTPLAIN="printhuman";a.PRODUCT="product";a.QUOTE="quote";a.QUOTIENT="quotient";a.RANK="rank";a.RATIONALIZE="rationalize";a.REAL="real";a.ROUND="round";a.YYRECT="rect";a.ROOTS="roots";a.SETQ="equals";a.SGN="sgn";a.SILENTPATTERN="silentpattern";a.SIMPLIFY="simplify";a.SIN="sin";a.SINH="sinh";a.SHAPE="shape";a.SQRT="sqrt";a.STOP="stop";a.SUBST="subst";a.SUM="sum";a.SYMBOLSINFO="symbolsinfo";a.TAN="tan";a.TANH="tanh";a.TAYLOR="taylor";a.TEST="test";a.TESTEQ="testeq";a.TESTGE="testge";a.TESTGT="testgt";a.TESTLE="testle";a.TESTLT="testlt";a.TRANSPOSE="transpose";a.UNIT="unit";a.ZERO="zero";a.NIL="nil";a.LAST="last";a.LAST_PRINT="lastprint";a.LAST_2DASCII_PRINT="last2dasciiprint";a.LAST_FULL_PRINT="lastfullprint";a.LAST_LATEX_PRINT="lastlatexprint";a.LAST_LIST_PRINT="lastlistprint";a.LAST_PLAIN_PRINT="lastplainprint";a.AUTOEXPAND="autoexpand";a.BAKE="bake";a.ASSUME_REAL_VARIABLES="assumeRealVariables";a.TRACE="trace";a.FORCE_FIXED_PRINTOUT="forceFixedPrintout";a.MAX_FIXED_PRINTOUT_DIGITS="maxFixedPrintoutDigits";a.YYE="~";a.DRAWX="$DRAWX";a.METAA="$METAA";a.METAB="$METAB";a.METAX="$METAX";a.SECRETX="$SECRETX";a.VERSION="version";a.PI="pi";a.SYMBOL_A="a";a.SYMBOL_B="b";a.SYMBOL_C="c";a.SYMBOL_D="d";a.SYMBOL_I="i";a.SYMBOL_J="j";a.SYMBOL_N="n";a.SYMBOL_R="r";a.SYMBOL_S="s";a.SYMBOL_T="t";a.SYMBOL_X="x";a.SYMBOL_Y="y";a.SYMBOL_Z="z";a.SYMBOL_IDENTITY_MATRIX="I";a.SYMBOL_A_UNDERSCORE="a_";a.SYMBOL_B_UNDERSCORE="b_";a.SYMBOL_X_UNDERSCORE="x_";a.C1="$C1";a.C2="$C2";a.C3="$C3";a.C4="$C4";a.C5="$C5";a.C6="$C6";a.E=a.YYE;a.MAXPRIMETAB=1e4;a.MAX_CONSECUTIVE_APPLICATIONS_OF_ALL_RULES=5;a.MAX_CONSECUTIVE_APPLICATIONS_OF_SINGLE_RULE=10;a.MAXDIM=24;a.predefinedSymbolsInGlobalScope_doNotTrackInDependencies=["rationalize","abs","e","i","pi","sin","ceiling","cos","roots","integral","derivative","defint","sqrt","eig","cov","deig","dcov","float","floor","product","root","round","sum","test","unit"];a.parse_time_simplifications=!0;a.primetab=function(){let e=[2],t=3;for(;e.length<a.MAXPRIMETAB;){let r=0,n=Math.sqrt(t);for(;r<e.length&&e[r]<=n;){if(t%e[r]==0){r=-1;break}r++}r!==-1&&e.push(t),t+=2}return e[a.MAXPRIMETAB]=0,e}();var Q$=!1;a.mtotal=0;a.logbuf="";a.transpose_unicode=7488;a.dotprod_unicode=183;function Wa(e){return e.k===a.CONS}a.iscons=Wa;function Cx(e){return e.k===a.NUM}a.isrational=Cx;function Px(e){return e.k===a.DOUBLE}a.isdouble=Px;function Dx(e){return Cx(e)||Px(e)}a.isNumericAtom=Dx;function W$(e){return e.k===a.STR}a.isstr=W$;function kx(e){return e.k===a.TENSOR}a.istensor=kx;function $x(e){if(Dx(e)||e===Vr.symbol(a.SYMBOL_IDENTITY_MATRIX))return!0;if(!kx(e))return!1;let t=e.tensor.nelem,r=e.tensor.elem;for(let n=0;n<t;n++)if(!$x(r[n]))return!1;return!0}a.isNumericAtomOrTensor=$x;function J$(e){return e.k===a.SYM}a.issymbol=J$;function Ce(e){return Wa(e)?e.cons.car:Vr.symbol(a.NIL)}a.car=Ce;function ae(e){return Wa(e)?e.cons.cdr:Vr.symbol(a.NIL)}a.cdr=ae;function K$(e){return Ce(Ce(e))}a.caar=K$;function eU(e){return Ce(ae(e))}a.cadr=eU;function tU(e){return ae(Ce(e))}a.cdar=tU;function rU(e){return ae(ae(e))}a.cddr=rU;function nU(e){return Ce(Ce(ae(e)))}a.caadr=nU;function iU(e){return Ce(ae(ae(e)))}a.caddr=iU;function oU(e){return Ce(ae(Ce(e)))}a.cadar=oU;function sU(e){return ae(Ce(ae(e)))}a.cdadr=sU;function aU(e){return ae(ae(Ce(e)))}a.cddar=aU;function lU(e){return ae(ae(ae(e)))}a.cdddr=lU;function uU(e){return Ce(Ce(ae(ae(e))))}a.caaddr=uU;function cU(e){return Ce(ae(Ce(ae(e))))}a.cadadr=cU;function fU(e){return Ce(ae(ae(Ce(e))))}a.caddar=fU;function dU(e){return ae(Ce(ae(ae(e))))}a.cdaddr=dU;function mU(e){return Ce(ae(ae(ae(e))))}a.cadddr=mU;function _U(e){return ae(ae(ae(ae(e))))}a.cddddr=_U;function bU(e){return Ce(ae(ae(ae(ae(e)))))}a.caddddr=bU;function gU(e){return Ce(ae(Ce(ae(ae(e)))))}a.cadaddr=gU;function yU(e){return ae(ae(Ce(ae(ae(e)))))}a.cddaddr=yU;function vU(e){return Ce(ae(ae(Ce(ae(e)))))}a.caddadr=vU;function qU(e){return ae(ae(ae(Ce(ae(ae(e))))))}a.cdddaddr=qU;function EU(e){return Ce(ae(ae(Ce(ae(ae(e))))))}a.caddaddr=EU;function xU(e){return Ce(e)===Vr.symbol(a.ADD)}a.isadd=xU;function pU(e){return Ce(e)===Vr.symbol(a.MULTIPLY)}a.ismultiply=pU;function hU(e){return Ce(e)===Vr.symbol(a.POWER)}a.ispower=hU;function AU(e){return Ce(e)===Vr.symbol(a.FACTORIAL)}a.isfactorial=AU;function OU(e){return Ce(e)===Vr.symbol(a.INNER)||Ce(e)===Vr.symbol(a.DOT)}a.isinnerordot=OU;function MU(e){return Ce(e)===Vr.symbol(a.TRANSPOSE)}a.istranspose=MU;function TU(e){return Ce(e)===Vr.symbol(a.INV)}a.isinv=TU;function NU(e){return e===Vr.symbol(a.SYMBOL_IDENTITY_MATRIX)}a.isidentitymatrix=NU;function IU(e){return e.isPositive()?1:e.isZero()?0:-1}a.MSIGN=IU;function SU(e){return e.isZero()}a.MZERO=SU;function wU(e,t){return e==null,e.equals(t)}a.MEQUAL=wU;function RU(){a.defs.esc_flag=!1,Q$=!1,a.defs.evaluatingAsFloats=!1,a.defs.evaluatingPolar=!1}a.reset_after_error=RU;a.$={};var mr=class{static One(){return a.defs.evaluatingAsFloats?mr.oneAsDouble:mr.one}static NegOne(){return a.defs.evaluatingAsFloats?mr.negOneAsDouble:mr.negOne}static Zero(){return a.defs.evaluatingAsFloats?mr.zeroAsDouble:mr.zero}static Pi(){return a.defs.evaluatingAsFloats?mr.piAsDouble:Vr.symbol(a.PI)}};a.Constants=mr;mr.one=new qu(Od.default(1));mr.oneAsDouble=new Qa(1);mr.negOne=new qu(Od.default(-1));mr.negOneAsDouble=new Qa(-1);mr.zero=new qu(Od.default(0));mr.zeroAsDouble=new Qa(0);mr.piAsDouble=new Qa(Math.PI);function LU(e,...t){let r=a.defs.expanding;a.defs.expanding=!1;try{return e(...t)}finally{a.defs.expanding=r}}a.noexpand=LU;function CU(e,...t){let r=a.defs.expanding;a.defs.expanding=!0;try{return e(...t)}finally{a.defs.expanding=r}}a.doexpand=CU;function PU(e,...t){let r=a.defs.evaluatingPolar;a.defs.evaluatingPolar=!0;try{return e(...t)}finally{a.defs.evaluatingPolar=r}}a.evalPolar=PU;function DU(e,...t){let r=a.defs.evaluatingAsFloats;a.defs.evaluatingAsFloats=!0;try{return e(...t)}finally{a.defs.evaluatingAsFloats=r}}a.evalFloats=DU});var Gx=A(Ja=>{"use strict";Object.defineProperty(Ja,"__esModule",{value:!0});Ja.exec=Ja.parse=void 0;var Td=Ee(),Ux=j(),kU=ee(),$U=Yi(),Eu=N(),UU=au(),Fb=U();Eu.defs.inited||(Eu.defs.inited=!0,UU.init());function Bx(e){if(typeof e=="string"){let[,t]=$U.scan(e);return t}else return typeof e=="number"?e%1==0?Ux.integer(e):Ux.double(e):typeof e.k=="number"?e:(console.warn("unknown argument type",e),Fb.symbol(Eu.NIL))}function BU(e){let t;try{t=Bx(e),Td.check_stack()}catch(r){throw Eu.reset_after_error(),r}return t}Ja.parse=BU;function GU(e,...t){let r,n=Fb.get_binding(Fb.usr_symbol(e));Td.check_stack();let i=kU.makeList(n,...t.map(Bx));try{r=Td.top_level_eval(i),Td.check_stack()}catch(o){throw Eu.reset_after_error(),o}return r}Ja.exec=GU});var jx=A(Id=>{"use strict";Object.defineProperty(Id,"__esModule",{value:!0});var Ne=N(),FU=or(),jU=au(),Ka=U(),jb=Gx(),Ct=Q(),Fx=Ie(),zU=Yi(),Nd=U_(),YU=Fl(),VU=Ee(),F={};F.version=Ne.version;F.isadd=Ne.isadd;F.ismultiply=Ne.ismultiply;F.ispower=Ne.ispower;F.isfactorial=Ne.isfactorial;F.car=Ne.car;F.cdr=Ne.cdr;F.caar=Ne.caar;F.cadr=Ne.cadr;F.cdar=Ne.cdar;F.cddr=Ne.cddr;F.caadr=Ne.caadr;F.caddr=Ne.caddr;F.cadar=Ne.cadar;F.cdadr=Ne.cdadr;F.cddar=Ne.cddar;F.cdddr=Ne.cdddr;F.caaddr=Ne.caaddr;F.cadadr=Ne.cadadr;F.caddar=Ne.caddar;F.cdaddr=Ne.cdaddr;F.cadddr=Ne.cadddr;F.cddddr=Ne.cddddr;F.caddddr=Ne.caddddr;F.cadaddr=Ne.cadaddr;F.cddaddr=Ne.cddaddr;F.caddadr=Ne.caddadr;F.cdddaddr=Ne.cdddaddr;F.caddaddr=Ne.caddaddr;F.symbol=Ka.symbol;F.iscons=Ne.iscons;F.isrational=Ne.isrational;F.isdouble=Ne.isdouble;F.isNumericAtom=Ne.isNumericAtom;F.isstr=Ne.isstr;F.istensor=Ne.istensor;F.issymbol=Ne.issymbol;F.iskeyword=Ka.iskeyword;F.CONS=Ne.CONS;F.NUM=Ne.NUM;F.DOUBLE=Ne.DOUBLE;F.STR=Ne.STR;F.TENSOR=Ne.TENSOR;F.SYM=Ne.SYM;F.approxRadicals=Nd.approxRadicals;F.approxRationalsOfLogs=Nd.approxRationalsOfLogs;F.approxAll=Nd.approxAll;F.testApprox=Nd.testApprox;F.make_hashed_itab=YU.make_hashed_itab;F.isZeroAtomOrTensor=Ct.isZeroAtomOrTensor;F.isnegativenumber=Ct.isnegativenumber;F.isplusone=Ct.isplusone;F.isminusone=Ct.isminusone;F.isinteger=Ct.isinteger;F.isnonnegativeinteger=Ct.isnonnegativeinteger;F.isposint=Ct.isposint;F.isnegativeterm=Ct.isnegativeterm;F.isimaginarynumber=Ct.isimaginarynumber;F.iscomplexnumber=Ct.iscomplexnumber;F.iseveninteger=Ct.iseveninteger;F.isnegative=Ct.isnegative;F.issymbolic=Ct.issymbolic;F.isintegerfactor=Ct.isintegerfactor;F.isoneover=Ct.isoneover;F.isfraction=Ct.isfraction;F.isoneoversqrttwo=Ct.isoneoversqrttwo;F.isminusoneoversqrttwo=Ct.isminusoneoversqrttwo;F.isfloating=Ct.isfloating;F.isimaginaryunit=Ct.isimaginaryunit;F.isquarterturn=Ct.isquarterturn;F.isnpi=Ct.isnpi;F.equal=Fx.equal;F.length=Fx.length;F.scan=zU.scan;F.Find=FU.Find;F.get_binding=Ka.get_binding;F.set_binding=Ka.set_binding;F.usr_symbol=Ka.usr_symbol;F.collectUserSymbols=Ka.collectUserSymbols;F.init=jU.init;F.exec=jb.exec;F.parse=jb.parse;F.run=VU.run;var ZU=["abs","add","adj","and","approxratio","arccos","arccosh","arcsin","arcsinh","arctan","arctanh","arg","atomize","besselj","bessely","binding","binomial","ceiling","check","choose","circexp","clear","clearall","clearpatterns","clock","coeff","cofactor","condense","conj","contract","cos","cosh","decomp","defint","deg","denominator","det","derivative","dim","dirac","divisors","do","dot","draw","dsolve","eigen","eigenval","eigenvec","erf","erfc","eval","exp","expand","expcos","expsin","factor","factorial","factorpoly","filter","float","floor","for","Gamma","gcd","hermite","hilbert","imag","component","inner","integral","inv","invg","isinteger","isprime","laguerre","lcm","leading","legendre","log","mod","multiply","not","nroots","number","numerator","operator","or","outer","pattern","patternsinfo","polar","power","prime","print","print2dascii","printcomputer","printlatex","printlist","printhuman","product","quote","quotient","rank","rationalize","real","rect","roots","round","equals","shape","sgn","silentpattern","simplify","sin","sinh","sqrt","stop","subst","sum","symbolsinfo","tan","tanh","taylor","test","testeq","testge","testgt","testle","testlt","transpose","unit","zero"];Array.from(ZU).map(e=>F[e]=jb.exec.bind(Id,e));Id.default=F});var zx=n0(jx());globalThis.Algebrite=zx.default;})();
//# sourceMappingURL=algebrite.bundle-for-browser-min.js.map
