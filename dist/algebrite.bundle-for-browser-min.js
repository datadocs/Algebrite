"use strict";(()=>{var A=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var To=A(($U,Ou)=>{var Gt=function(e){"use strict";var t=1e7,r=7,n=9007199254740992,o=T(n),i="0123456789abcdefghijklmnopqrstuvwxyz",s=typeof BigInt=="function";function u(f,m,b,q){return typeof f>"u"?u[0]:typeof m<"u"?+m==10&&!b?qe(f):jx(f,m,b,q):qe(f)}function c(f,m){this.value=f,this.sign=m,this.isSmall=!1}c.prototype=Object.create(u.prototype);function d(f){this.value=f,this.sign=f<0,this.isSmall=!0}d.prototype=Object.create(u.prototype);function _(f){this.value=f}_.prototype=Object.create(u.prototype);function R(f){return-n<f&&f<n}function T(f){return f<1e7?[f]:f<1e14?[f%1e7,Math.floor(f/1e7)]:[f%1e7,Math.floor(f/1e7)%1e7,Math.floor(f/1e14)]}function k(f){V(f);var m=f.length;if(m<4&&Vn(f,o)<0)switch(m){case 0:return 0;case 1:return f[0];case 2:return f[0]+f[1]*t;default:return f[0]+(f[1]+f[2]*t)*t}return f}function V(f){for(var m=f.length;f[--m]===0;);f.length=m+1}function z(f){for(var m=new Array(f),b=-1;++b<f;)m[b]=0;return m}function Ae(f){return f>0?Math.floor(f):Math.ceil(f)}function et(f,m){var b=f.length,q=m.length,O=new Array(b),x=0,P=t,L,$;for($=0;$<q;$++)L=f[$]+m[$]+x,x=L>=P?1:0,O[$]=L-x*P;for(;$<b;)L=f[$]+x,x=L===P?1:0,O[$++]=L-x*P;return x>0&&O.push(x),O}function Ve(f,m){return f.length>=m.length?et(f,m):et(m,f)}function De(f,m){var b=f.length,q=new Array(b),O=t,x,P;for(P=0;P<b;P++)x=f[P]-O+m,m=Math.floor(x/O),q[P]=x-m*O,m+=1;for(;m>0;)q[P++]=m%O,m=Math.floor(m/O);return q}c.prototype.add=function(f){var m=qe(f);if(this.sign!==m.sign)return this.subtract(m.negate());var b=this.value,q=m.value;return m.isSmall?new c(De(b,Math.abs(q)),this.sign):new c(Ve(b,q),this.sign)},c.prototype.plus=c.prototype.add,d.prototype.add=function(f){var m=qe(f),b=this.value;if(b<0!==m.sign)return this.subtract(m.negate());var q=m.value;if(m.isSmall){if(R(b+q))return new d(b+q);q=T(Math.abs(q))}return new c(De(q,Math.abs(b)),b<0)},d.prototype.plus=d.prototype.add,_.prototype.add=function(f){return new _(this.value+qe(f).value)},_.prototype.plus=_.prototype.add;function it(f,m){var b=f.length,q=m.length,O=new Array(b),x=0,P=t,L,$;for(L=0;L<q;L++)$=f[L]-x-m[L],$<0?($+=P,x=1):x=0,O[L]=$;for(L=q;L<b;L++){if($=f[L]-x,$<0)$+=P;else{O[L++]=$;break}O[L]=$}for(;L<b;L++)O[L]=f[L];return V(O),O}function Oe(f,m,b){var q;return Vn(f,m)>=0?q=it(f,m):(q=it(m,f),b=!b),q=k(q),typeof q=="number"?(b&&(q=-q),new d(q)):new c(q,b)}function st(f,m,b){var q=f.length,O=new Array(q),x=-m,P=t,L,$;for(L=0;L<q;L++)$=f[L]+x,x=Math.floor($/P),$%=P,O[L]=$<0?$+P:$;return O=k(O),typeof O=="number"?(b&&(O=-O),new d(O)):new c(O,b)}c.prototype.subtract=function(f){var m=qe(f);if(this.sign!==m.sign)return this.add(m.negate());var b=this.value,q=m.value;return m.isSmall?st(b,Math.abs(q),this.sign):Oe(b,q,this.sign)},c.prototype.minus=c.prototype.subtract,d.prototype.subtract=function(f){var m=qe(f),b=this.value;if(b<0!==m.sign)return this.add(m.negate());var q=m.value;return m.isSmall?new d(b-q):st(q,Math.abs(b),b>=0)},d.prototype.minus=d.prototype.subtract,_.prototype.subtract=function(f){return new _(this.value-qe(f).value)},_.prototype.minus=_.prototype.subtract,c.prototype.negate=function(){return new c(this.value,!this.sign)},d.prototype.negate=function(){var f=this.sign,m=new d(-this.value);return m.sign=!f,m},_.prototype.negate=function(){return new _(-this.value)},c.prototype.abs=function(){return new c(this.value,!1)},d.prototype.abs=function(){return new d(Math.abs(this.value))},_.prototype.abs=function(){return new _(this.value>=0?this.value:-this.value)};function or(f,m){var b=f.length,q=m.length,O=b+q,x=z(O),P=t,L,$,xe,Ge,Me;for(xe=0;xe<b;++xe){Ge=f[xe];for(var rt=0;rt<q;++rt)Me=m[rt],L=Ge*Me+x[xe+rt],$=Math.floor(L/P),x[xe+rt]=L-$*P,x[xe+rt+1]+=$}return V(x),x}function Bt(f,m){var b=f.length,q=new Array(b),O=t,x=0,P,L;for(L=0;L<b;L++)P=f[L]*m+x,x=Math.floor(P/O),q[L]=P-x*O;for(;x>0;)q[L++]=x%O,x=Math.floor(x/O);return q}function vr(f,m){for(var b=[];m-- >0;)b.push(0);return b.concat(f)}function Nt(f,m){var b=Math.max(f.length,m.length);if(b<=30)return or(f,m);b=Math.ceil(b/2);var q=f.slice(b),O=f.slice(0,b),x=m.slice(b),P=m.slice(0,b),L=Nt(O,P),$=Nt(q,x),xe=Nt(Ve(O,q),Ve(P,x)),Ge=Ve(Ve(L,vr(it(it(xe,L),$),b)),vr($,2*b));return V(Ge),Ge}function ci(f,m){return-.012*f-.012*m+15e-6*f*m>0}c.prototype.multiply=function(f){var m=qe(f),b=this.value,q=m.value,O=this.sign!==m.sign,x;if(m.isSmall){if(q===0)return u[0];if(q===1)return this;if(q===-1)return this.negate();if(x=Math.abs(q),x<t)return new c(Bt(b,x),O);q=T(x)}return ci(b.length,q.length)?new c(Nt(b,q),O):new c(or(b,q),O)},c.prototype.times=c.prototype.multiply;function Yn(f,m,b){return f<t?new c(Bt(m,f),b):new c(or(m,T(f)),b)}d.prototype._multiplyBySmall=function(f){return R(f.value*this.value)?new d(f.value*this.value):Yn(Math.abs(f.value),T(Math.abs(this.value)),this.sign!==f.sign)},c.prototype._multiplyBySmall=function(f){return f.value===0?u[0]:f.value===1?this:f.value===-1?this.negate():Yn(Math.abs(f.value),this.value,this.sign!==f.sign)},d.prototype.multiply=function(f){return qe(f)._multiplyBySmall(this)},d.prototype.times=d.prototype.multiply,_.prototype.multiply=function(f){return new _(this.value*qe(f).value)},_.prototype.times=_.prototype.multiply;function Ka(f){var m=f.length,b=z(m+m),q=t,O,x,P,L,$;for(P=0;P<m;P++){L=f[P],x=0-L*L;for(var xe=P;xe<m;xe++)$=f[xe],O=2*(L*$)+b[P+xe]+x,x=Math.floor(O/q),b[P+xe]=O-x*q;b[P+m]=x}return V(b),b}c.prototype.square=function(){return new c(Ka(this.value),!1)},d.prototype.square=function(){var f=this.value*this.value;return R(f)?new d(f):new c(Ka(T(Math.abs(this.value))),!1)},_.prototype.square=function(f){return new _(this.value*this.value)};function Eu(f,m){var b=f.length,q=m.length,O=t,x=z(m.length),P=m[q-1],L=Math.ceil(O/(2*P)),$=Bt(f,L),xe=Bt(m,L),Ge,Me,rt,wr,hr,Id,Sd;for($.length<=b&&$.push(0),xe.push(0),P=xe[q-1],Me=b-q;Me>=0;Me--){for(Ge=O-1,$[Me+q]!==P&&(Ge=Math.floor(($[Me+q]*O+$[Me+q-1])/P)),rt=0,wr=0,Id=xe.length,hr=0;hr<Id;hr++)rt+=Ge*xe[hr],Sd=Math.floor(rt/O),wr+=$[Me+hr]-(rt-Sd*O),rt=Sd,wr<0?($[Me+hr]=wr+O,wr=-1):($[Me+hr]=wr,wr=0);for(;wr!==0;){for(Ge-=1,rt=0,hr=0;hr<Id;hr++)rt+=$[Me+hr]-O+xe[hr],rt<0?($[Me+hr]=rt+O,rt=0):($[Me+hr]=rt,rt=1);wr+=rt}x[Me]=Ge}return $=el($,L)[0],[k(x),k($)]}function xu(f,m){for(var b=f.length,q=m.length,O=[],x=[],P=t,L,$,xe,Ge,Me;b;){if(x.unshift(f[--b]),V(x),Vn(x,m)<0){O.push(0);continue}$=x.length,xe=x[$-1]*P+x[$-2],Ge=m[q-1]*P+m[q-2],$>q&&(xe=(xe+1)*P),L=Math.ceil(xe/Ge);do{if(Me=Bt(m,L),Vn(Me,x)<=0)break;L--}while(L);O.push(L),x=it(x,Me)}return O.reverse(),[k(O),k(x)]}function el(f,m){var b=f.length,q=z(b),O=t,x,P,L,$;for(L=0,x=b-1;x>=0;--x)$=L*O+f[x],P=Ae($/m),L=$-P*m,q[x]=P|0;return[q,L|0]}function rn(f,m){var b,q=qe(m);if(s)return[new _(f.value/q.value),new _(f.value%q.value)];var O=f.value,x=q.value,P;if(x===0)throw new Error("Cannot divide by zero");if(f.isSmall)return q.isSmall?[new d(Ae(O/x)),new d(O%x)]:[u[0],f];if(q.isSmall){if(x===1)return[f,u[0]];if(x==-1)return[f.negate(),u[0]];var L=Math.abs(x);if(L<t){b=el(O,L),P=k(b[0]);var $=b[1];return f.sign&&($=-$),typeof P=="number"?(f.sign!==q.sign&&(P=-P),[new d(P),new d($)]):[new c(P,f.sign!==q.sign),new d($)]}x=T(L)}var xe=Vn(O,x);if(xe===-1)return[u[0],f];if(xe===0)return[u[f.sign===q.sign?1:-1],u[0]];O.length+x.length<=200?b=Eu(O,x):b=xu(O,x),P=b[0];var Ge=f.sign!==q.sign,Me=b[1],rt=f.sign;return typeof P=="number"?(Ge&&(P=-P),P=new d(P)):P=new c(P,Ge),typeof Me=="number"?(rt&&(Me=-Me),Me=new d(Me)):Me=new c(Me,rt),[P,Me]}c.prototype.divmod=function(f){var m=rn(this,f);return{quotient:m[0],remainder:m[1]}},_.prototype.divmod=d.prototype.divmod=c.prototype.divmod,c.prototype.divide=function(f){return rn(this,f)[0]},_.prototype.over=_.prototype.divide=function(f){return new _(this.value/qe(f).value)},d.prototype.over=d.prototype.divide=c.prototype.over=c.prototype.divide,c.prototype.mod=function(f){return rn(this,f)[1]},_.prototype.mod=_.prototype.remainder=function(f){return new _(this.value%qe(f).value)},d.prototype.remainder=d.prototype.mod=c.prototype.remainder=c.prototype.mod,c.prototype.pow=function(f){var m=qe(f),b=this.value,q=m.value,O,x,P;if(q===0)return u[1];if(b===0)return u[0];if(b===1)return u[1];if(b===-1)return m.isEven()?u[1]:u[-1];if(m.sign)return u[0];if(!m.isSmall)throw new Error("The exponent "+m.toString()+" is too large.");if(this.isSmall&&R(O=Math.pow(b,q)))return new d(Ae(O));for(x=this,P=u[1];q&!0&&(P=P.times(x),--q),q!==0;)q/=2,x=x.square();return P},d.prototype.pow=c.prototype.pow,_.prototype.pow=function(f){var m=qe(f),b=this.value,q=m.value,O=BigInt(0),x=BigInt(1),P=BigInt(2);if(q===O)return u[1];if(b===O)return u[0];if(b===x)return u[1];if(b===BigInt(-1))return m.isEven()?u[1]:u[-1];if(m.isNegative())return new _(O);for(var L=this,$=u[1];(q&x)===x&&($=$.times(L),--q),q!==O;)q/=P,L=L.square();return $},c.prototype.modPow=function(f,m){if(f=qe(f),m=qe(m),m.isZero())throw new Error("Cannot take modPow with modulus 0");var b=u[1],q=this.mod(m);for(f.isNegative()&&(f=f.multiply(u[-1]),q=q.modInv(m));f.isPositive();){if(q.isZero())return u[0];f.isOdd()&&(b=b.multiply(q).mod(m)),f=f.divide(2),q=q.square().mod(m)}return b},_.prototype.modPow=d.prototype.modPow=c.prototype.modPow;function Vn(f,m){if(f.length!==m.length)return f.length>m.length?1:-1;for(var b=f.length-1;b>=0;b--)if(f[b]!==m[b])return f[b]>m[b]?1:-1;return 0}c.prototype.compareAbs=function(f){var m=qe(f),b=this.value,q=m.value;return m.isSmall?1:Vn(b,q)},d.prototype.compareAbs=function(f){var m=qe(f),b=Math.abs(this.value),q=m.value;return m.isSmall?(q=Math.abs(q),b===q?0:b>q?1:-1):-1},_.prototype.compareAbs=function(f){var m=this.value,b=qe(f).value;return m=m>=0?m:-m,b=b>=0?b:-b,m===b?0:m>b?1:-1},c.prototype.compare=function(f){if(f===1/0)return-1;if(f===-1/0)return 1;var m=qe(f),b=this.value,q=m.value;return this.sign!==m.sign?m.sign?1:-1:m.isSmall?this.sign?-1:1:Vn(b,q)*(this.sign?-1:1)},c.prototype.compareTo=c.prototype.compare,d.prototype.compare=function(f){if(f===1/0)return-1;if(f===-1/0)return 1;var m=qe(f),b=this.value,q=m.value;return m.isSmall?b==q?0:b>q?1:-1:b<0!==m.sign?b<0?-1:1:b<0?1:-1},d.prototype.compareTo=d.prototype.compare,_.prototype.compare=function(f){if(f===1/0)return-1;if(f===-1/0)return 1;var m=this.value,b=qe(f).value;return m===b?0:m>b?1:-1},_.prototype.compareTo=_.prototype.compare,c.prototype.equals=function(f){return this.compare(f)===0},_.prototype.eq=_.prototype.equals=d.prototype.eq=d.prototype.equals=c.prototype.eq=c.prototype.equals,c.prototype.notEquals=function(f){return this.compare(f)!==0},_.prototype.neq=_.prototype.notEquals=d.prototype.neq=d.prototype.notEquals=c.prototype.neq=c.prototype.notEquals,c.prototype.greater=function(f){return this.compare(f)>0},_.prototype.gt=_.prototype.greater=d.prototype.gt=d.prototype.greater=c.prototype.gt=c.prototype.greater,c.prototype.lesser=function(f){return this.compare(f)<0},_.prototype.lt=_.prototype.lesser=d.prototype.lt=d.prototype.lesser=c.prototype.lt=c.prototype.lesser,c.prototype.greaterOrEquals=function(f){return this.compare(f)>=0},_.prototype.geq=_.prototype.greaterOrEquals=d.prototype.geq=d.prototype.greaterOrEquals=c.prototype.geq=c.prototype.greaterOrEquals,c.prototype.lesserOrEquals=function(f){return this.compare(f)<=0},_.prototype.leq=_.prototype.lesserOrEquals=d.prototype.leq=d.prototype.lesserOrEquals=c.prototype.leq=c.prototype.lesserOrEquals,c.prototype.isEven=function(){return(this.value[0]&1)===0},d.prototype.isEven=function(){return(this.value&1)===0},_.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},c.prototype.isOdd=function(){return(this.value[0]&1)===1},d.prototype.isOdd=function(){return(this.value&1)===1},_.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},c.prototype.isPositive=function(){return!this.sign},d.prototype.isPositive=function(){return this.value>0},_.prototype.isPositive=d.prototype.isPositive,c.prototype.isNegative=function(){return this.sign},d.prototype.isNegative=function(){return this.value<0},_.prototype.isNegative=d.prototype.isNegative,c.prototype.isUnit=function(){return!1},d.prototype.isUnit=function(){return Math.abs(this.value)===1},_.prototype.isUnit=function(){return this.abs().value===BigInt(1)},c.prototype.isZero=function(){return!1},d.prototype.isZero=function(){return this.value===0},_.prototype.isZero=function(){return this.value===BigInt(0)},c.prototype.isDivisibleBy=function(f){var m=qe(f);return m.isZero()?!1:m.isUnit()?!0:m.compareAbs(2)===0?this.isEven():this.mod(m).isZero()},_.prototype.isDivisibleBy=d.prototype.isDivisibleBy=c.prototype.isDivisibleBy;function pu(f){var m=f.abs();if(m.isUnit())return!1;if(m.equals(2)||m.equals(3)||m.equals(5))return!0;if(m.isEven()||m.isDivisibleBy(3)||m.isDivisibleBy(5))return!1;if(m.lesser(49))return!0}function tl(f,m){for(var b=f.prev(),q=b,O=0,x,P,L,$;q.isEven();)q=q.divide(2),O++;e:for(L=0;L<m.length;L++)if(!f.lesser(m[L])&&($=Gt(m[L]).modPow(q,f),!($.isUnit()||$.equals(b)))){for(x=O-1;x!=0;x--){if($=$.square().mod(f),$.isUnit())return!1;if($.equals(b))continue e}return!1}return!0}c.prototype.isPrime=function(f){var m=pu(this);if(m!==e)return m;var b=this.abs(),q=b.bitLength();if(q<=64)return tl(b,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var O=Math.log(2)*q.toJSNumber(),x=Math.ceil(f===!0?2*Math.pow(O,2):O),P=[],L=0;L<x;L++)P.push(Gt(L+2));return tl(b,P)},_.prototype.isPrime=d.prototype.isPrime=c.prototype.isPrime,c.prototype.isProbablePrime=function(f,m){var b=pu(this);if(b!==e)return b;for(var q=this.abs(),O=f===e?5:f,x=[],P=0;P<O;P++)x.push(Gt.randBetween(2,q.minus(2),m));return tl(q,x)},_.prototype.isProbablePrime=d.prototype.isProbablePrime=c.prototype.isProbablePrime,c.prototype.modInv=function(f){for(var m=Gt.zero,b=Gt.one,q=qe(f),O=this.abs(),x,P,L;!O.isZero();)x=q.divide(O),P=m,L=q,m=b,q=O,b=P.subtract(x.multiply(b)),O=L.subtract(x.multiply(O));if(!q.isUnit())throw new Error(this.toString()+" and "+f.toString()+" are not co-prime");return m.compare(0)===-1&&(m=m.add(f)),this.isNegative()?m.negate():m},_.prototype.modInv=d.prototype.modInv=c.prototype.modInv,c.prototype.next=function(){var f=this.value;return this.sign?st(f,1,this.sign):new c(De(f,1),this.sign)},d.prototype.next=function(){var f=this.value;return f+1<n?new d(f+1):new c(o,!1)},_.prototype.next=function(){return new _(this.value+BigInt(1))},c.prototype.prev=function(){var f=this.value;return this.sign?new c(De(f,1),!0):st(f,1,this.sign)},d.prototype.prev=function(){var f=this.value;return f-1>-n?new d(f-1):new c(o,!0)},_.prototype.prev=function(){return new _(this.value-BigInt(1))};for(var nn=[1];2*nn[nn.length-1]<=t;)nn.push(2*nn[nn.length-1]);var fi=nn.length,Zn=nn[fi-1];function hu(f){return Math.abs(f)<=t}c.prototype.shiftLeft=function(f){var m=qe(f).toJSNumber();if(!hu(m))throw new Error(String(m)+" is too large for shifting.");if(m<0)return this.shiftRight(-m);var b=this;if(b.isZero())return b;for(;m>=fi;)b=b.multiply(Zn),m-=fi-1;return b.multiply(nn[m])},_.prototype.shiftLeft=d.prototype.shiftLeft=c.prototype.shiftLeft,c.prototype.shiftRight=function(f){var m,b=qe(f).toJSNumber();if(!hu(b))throw new Error(String(b)+" is too large for shifting.");if(b<0)return this.shiftLeft(-b);for(var q=this;b>=fi;){if(q.isZero()||q.isNegative()&&q.isUnit())return q;m=rn(q,Zn),q=m[1].isNegative()?m[0].prev():m[0],b-=fi-1}return m=rn(q,nn[b]),m[1].isNegative()?m[0].prev():m[0]},_.prototype.shiftRight=d.prototype.shiftRight=c.prototype.shiftRight;function rl(f,m,b){m=qe(m);for(var q=f.isNegative(),O=m.isNegative(),x=q?f.not():f,P=O?m.not():m,L=0,$=0,xe=null,Ge=null,Me=[];!x.isZero()||!P.isZero();)xe=rn(x,Zn),L=xe[1].toJSNumber(),q&&(L=Zn-1-L),Ge=rn(P,Zn),$=Ge[1].toJSNumber(),O&&($=Zn-1-$),x=xe[0],P=Ge[0],Me.push(b(L,$));for(var rt=b(q?1:0,O?1:0)!==0?Gt(-1):Gt(0),wr=Me.length-1;wr>=0;wr-=1)rt=rt.multiply(Zn).add(Gt(Me[wr]));return rt}c.prototype.not=function(){return this.negate().prev()},_.prototype.not=d.prototype.not=c.prototype.not,c.prototype.and=function(f){return rl(this,f,function(m,b){return m&b})},_.prototype.and=d.prototype.and=c.prototype.and,c.prototype.or=function(f){return rl(this,f,function(m,b){return m|b})},_.prototype.or=d.prototype.or=c.prototype.or,c.prototype.xor=function(f){return rl(this,f,function(m,b){return m^b})},_.prototype.xor=d.prototype.xor=c.prototype.xor;var nl=1<<30,Nd=(t&-t)*(t&-t)|nl;function ns(f){var m=f.value,b=typeof m=="number"?m|nl:typeof m=="bigint"?m|BigInt(nl):m[0]+m[1]*t|Nd;return b&-b}function Au(f,m){if(m.compareTo(f)<=0){var b=Au(f,m.square(m)),q=b.p,O=b.e,x=q.multiply(m);return x.compareTo(f)<=0?{p:x,e:O*2+1}:{p:q,e:O*2}}return{p:Gt(1),e:0}}c.prototype.bitLength=function(){var f=this;return f.compareTo(Gt(0))<0&&(f=f.negate().subtract(Gt(1))),f.compareTo(Gt(0))===0?Gt(0):Gt(Au(f,Gt(2)).e).add(Gt(1))},_.prototype.bitLength=d.prototype.bitLength=c.prototype.bitLength;function ol(f,m){return f=qe(f),m=qe(m),f.greater(m)?f:m}function os(f,m){return f=qe(f),m=qe(m),f.lesser(m)?f:m}function Zb(f,m){if(f=qe(f).abs(),m=qe(m).abs(),f.equals(m))return f;if(f.isZero())return m;if(m.isZero())return f;for(var b=u[1],q,O;f.isEven()&&m.isEven();)q=os(ns(f),ns(m)),f=f.divide(q),m=m.divide(q),b=b.multiply(q);for(;f.isEven();)f=f.divide(ns(f));do{for(;m.isEven();)m=m.divide(ns(m));f.greater(m)&&(O=m,m=f,f=O),m=m.subtract(f)}while(!m.isZero());return b.isUnit()?f:f.multiply(b)}function Gx(f,m){return f=qe(f).abs(),m=qe(m).abs(),f.divide(Zb(f,m)).multiply(m)}function Fx(f,m,b){f=qe(f),m=qe(m);var q=b||Math.random,O=os(f,m),x=ol(f,m),P=x.subtract(O).add(1);if(P.isSmall)return O.add(Math.floor(q()*P));for(var L=il(P,t).value,$=[],xe=!0,Ge=0;Ge<L.length;Ge++){var Me=xe?L[Ge]+(Ge+1<L.length?L[Ge+1]/t:0):t,rt=Ae(q()*Me);$.push(rt),rt<L[Ge]&&(xe=!1)}return O.add(u.fromArray($,t,!1))}var jx=function(f,m,b,q){b=b||i,f=String(f),q||(f=f.toLowerCase(),b=b.toLowerCase());var O=f.length,x,P=Math.abs(m),L={};for(x=0;x<b.length;x++)L[b[x]]=x;for(x=0;x<O;x++){var $=f[x];if($!=="-"&&$ in L&&L[$]>=P){if($==="1"&&P===1)continue;throw new Error($+" is not a valid digit in base "+m+".")}}m=qe(m);var xe=[],Ge=f[0]==="-";for(x=Ge?1:0;x<f.length;x++){var $=f[x];if($ in L)xe.push(qe(L[$]));else if($==="<"){var Me=x;do x++;while(f[x]!==">"&&x<f.length);xe.push(qe(f.slice(Me+1,x)))}else throw new Error($+" is not a valid character")}return Xb(xe,m,Ge)};function Xb(f,m,b){var q=u[0],O=u[1],x;for(x=f.length-1;x>=0;x--)q=q.add(f[x].times(O)),O=O.times(m);return b?q.negate():q}function zx(f,m){return m=m||i,f<m.length?m[f]:"<"+f+">"}function il(f,m){if(m=Gt(m),m.isZero()){if(f.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(m.equals(-1)){if(f.isZero())return{value:[0],isNegative:!1};if(f.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-f.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var b=Array.apply(null,Array(f.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return b.unshift([1]),{value:[].concat.apply([],b),isNegative:!1}}var q=!1;if(f.isNegative()&&m.isPositive()&&(q=!0,f=f.abs()),m.isUnit())return f.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(f.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:q};for(var O=[],x=f,P;x.isNegative()||x.compareAbs(m)>=0;){P=x.divmod(m),x=P.quotient;var L=P.remainder;L.isNegative()&&(L=m.minus(L).abs(),x=x.next()),O.push(L.toJSNumber())}return O.push(x.toJSNumber()),{value:O.reverse(),isNegative:q}}function Hb(f,m,b){var q=il(f,m);return(q.isNegative?"-":"")+q.value.map(function(O){return zx(O,b)}).join("")}c.prototype.toArray=function(f){return il(this,f)},d.prototype.toArray=function(f){return il(this,f)},_.prototype.toArray=function(f){return il(this,f)},c.prototype.toString=function(f,m){if(f===e&&(f=10),f!==10)return Hb(this,f,m);for(var b=this.value,q=b.length,O=String(b[--q]),x="0000000",P;--q>=0;)P=String(b[q]),O+=x.slice(P.length)+P;var L=this.sign?"-":"";return L+O},d.prototype.toString=function(f,m){return f===e&&(f=10),f!=10?Hb(this,f,m):String(this.value)},_.prototype.toString=d.prototype.toString,_.prototype.toJSON=c.prototype.toJSON=d.prototype.toJSON=function(){return this.toString()},c.prototype.valueOf=function(){return parseInt(this.toString(),10)},c.prototype.toJSNumber=c.prototype.valueOf,d.prototype.valueOf=function(){return this.value},d.prototype.toJSNumber=d.prototype.valueOf,_.prototype.valueOf=_.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};function Qb(f){if(R(+f)){var m=+f;if(m===Ae(m))return s?new _(BigInt(m)):new d(m);throw new Error("Invalid integer: "+f)}var b=f[0]==="-";b&&(f=f.slice(1));var q=f.split(/e/i);if(q.length>2)throw new Error("Invalid integer: "+q.join("e"));if(q.length===2){var O=q[1];if(O[0]==="+"&&(O=O.slice(1)),O=+O,O!==Ae(O)||!R(O))throw new Error("Invalid integer: "+O+" is not a valid exponent.");var x=q[0],P=x.indexOf(".");if(P>=0&&(O-=x.length-P-1,x=x.slice(0,P)+x.slice(P+1)),O<0)throw new Error("Cannot include negative exponent part for integers");x+=new Array(O+1).join("0"),f=x}var L=/^([0-9][0-9]*)$/.test(f);if(!L)throw new Error("Invalid integer: "+f);if(s)return new _(BigInt(b?"-"+f:f));for(var $=[],xe=f.length,Ge=r,Me=xe-Ge;xe>0;)$.push(+f.slice(Me,xe)),Me-=Ge,Me<0&&(Me=0),xe-=Ge;return V($),new c($,b)}function Yx(f){if(s)return new _(BigInt(f));if(R(f)){if(f!==Ae(f))throw new Error(f+" is not an integer.");return new d(f)}return Qb(f.toString())}function qe(f){return typeof f=="number"?Yx(f):typeof f=="string"?Qb(f):typeof f=="bigint"?new _(f):f}for(var di=0;di<1e3;di++)u[di]=qe(di),di>0&&(u[-di]=qe(-di));return u.one=u[1],u.zero=u[0],u.minusOne=u[-1],u.max=ol,u.min=os,u.gcd=Zb,u.lcm=Gx,u.isInstance=function(f){return f instanceof c||f instanceof d||f instanceof _},u.randBetween=Fx,u.fromArray=function(f,m,b){return Xb(f.map(qe),qe(m||10),b)},u}();typeof Ou<"u"&&Ou.hasOwnProperty("exports")&&(Ou.exports=Gt);typeof define=="function"&&define.amd&&define(function(){return Gt})});var Mu=A(is=>{"use strict";var Vx=is&&is.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(is,"__esModule",{value:!0});is.mcmp=void 0;var UU=Vx(To());function Zx(e,t){return e.compare(t)}is.mcmp=Zx});var ir=A(No=>{"use strict";Object.defineProperty(No,"__esModule",{value:!0});No.findPossibleExponentialForm=No.findPossibleClockForm=No.Find=void 0;var Tu=H(),Xx=Ne(),Xt=N(),Hx=U();function sl(e,t){if(Xx.equal(e,t))return!0;if(Xt.istensor(e)){for(let r=0;r<e.tensor.nelem;r++)if(sl(e.tensor.elem[r],t))return!0;return!1}return Xt.iscons(e)?[...e].some(r=>sl(r,t)):!1}No.Find=sl;function Rd(e,t){if(Tu.isimaginaryunit(e))return!1;if(Xt.ispower(e)&&!Tu.isinteger(Xt.caddr(t))&&sl(Xt.cadr(e),Xt.Constants.imaginaryunit)||Xt.ispower(e)&&Tu.equaln(Xt.cadr(e),-1)&&!Tu.isinteger(Xt.caddr(t)))return!0;if(Xt.istensor(e)){for(let r=0;r<e.tensor.nelem;r++)if(Rd(e.tensor.elem[r],t))return!0;return!1}return Xt.iscons(e)?[...e].some(r=>Rd(r,t)):!1}No.findPossibleClockForm=Rd;function wd(e){if(Xt.ispower(e)&&Xt.cadr(e)===Hx.symbol(Xt.E))return sl(Xt.caddr(e),Xt.Constants.imaginaryunit);if(Xt.istensor(e)){for(let t=0;t<e.tensor.nelem;t++)if(wd(e.tensor.elem[t]))return!0;return!1}return Xt.iscons(e)?[...e].some(wd):!1}No.findPossibleExponentialForm=wd});var Kb=A(ss=>{"use strict";Object.defineProperty(ss,"__esModule",{value:!0});ss.set_component=ss.index_function=void 0;var Wb=It(),Ld=N(),xn=Ee(),Jb=F(),mi=qt();function Qx(e,t){let{ndim:r}=e.tensor,n=t.length;n>r&&xn.stop("too many indices for tensor");let o=0;for(let u=0;u<n;u++){let c=Jb.nativeInt(t[u]);(c<1||c>e.tensor.dim[u])&&xn.stop("index out of range"),o=o*e.tensor.dim[u]+c-1}if(r===n)return e.tensor.elem[o];o=e.tensor.dim.slice(n).reduce((u,c)=>u*c,o);let i=e.tensor.dim.slice(n).reduce((u,c)=>u*c,1),s=Wb.alloc_tensor(i);s.tensor.ndim=r-n,s.tensor.dim=e.tensor.dim.slice(n);for(let u=0;u<i;u++)s.tensor.elem[u]=e.tensor.elem[o+u];return mi.check_tensor_dimensions(e),mi.check_tensor_dimensions(s),s}ss.index_function=Qx;function Wx(e,...t){t.length<2&&xn.stop("error in indexed assign");let[r,...n]=t;Ld.istensor(r)||xn.stop("error in indexed assign: assigning to something that is not a tensor");let{ndim:o}=r.tensor,i=n.length;i>o&&xn.stop("error in indexed assign");let s=0;for(let c=0;c<i;c++){let d=Jb.nativeInt(n[c]);(d<1||d>r.tensor.dim[c])&&xn.stop(`error in indexed assign
`),s=s*r.tensor.dim[c]+d-1}for(let c=i;c<o;c++)s=s*r.tensor.dim[c]+0;let u=Wb.alloc_tensor(r.tensor.nelem);if(u.tensor.ndim=r.tensor.ndim,u.tensor.dim=Array.from(r.tensor.dim),u.tensor.elem=Array.from(r.tensor.elem),mi.check_tensor_dimensions(r),mi.check_tensor_dimensions(u),r=u,o===i)return Ld.istensor(e)&&xn.stop("error in indexed assign"),r.tensor.elem[s]=e,mi.check_tensor_dimensions(r),r;Ld.istensor(e)||xn.stop("error in indexed assign"),o-i!==e.tensor.ndim&&xn.stop("error in indexed assign");for(let c=0;c<e.tensor.ndim;c++)r.tensor.dim[i+c]!==e.tensor.dim[c]&&xn.stop("error in indexed assign");for(let c=0;c<e.tensor.nelem;c++)r.tensor.elem[s+c]=e.tensor.elem[c];return mi.check_tensor_dimensions(r),mi.check_tensor_dimensions(e),r}ss.set_component=Wx});var K=A(Nu=>{"use strict";Object.defineProperty(Nu,"__esModule",{value:!0});Nu.makeList=void 0;var eg=N(),Jx=U();function Kx(...e){let t=Jx.symbol(eg.NIL);for(let r=e.length-1;r>=0;r--)t=new eg.Cons(e[r],t);return t}Nu.makeList=Kx});var Cd=A(as=>{"use strict";Object.defineProperty(as,"__esModule",{value:!0});as.Eval_function_reference=as.define_user_function=void 0;var Xn=N(),e0=Ee(),Iu=U(),t0=G(),r0=K();function n0(e){let t=Xn.caadr(e),r=Xn.cdadr(e),n=Xn.caddr(e);return Xn.issymbol(t)||e0.stop("function name?"),Xn.car(n)===Iu.symbol(Xn.EVAL)&&(n=t0.Eval(Xn.cadr(n))),n=r0.makeList(Iu.symbol(Xn.FUNCTION),n,r),Iu.set_binding(t,n),Iu.symbol(Xn.NIL)}as.define_user_function=n0;function o0(e){return e}as.Eval_function_reference=o0});var Dd=A(ls=>{"use strict";Object.defineProperty(ls,"__esModule",{value:!0});ls.lcm=ls.Eval_lcm=void 0;var Su=N(),tg=G(),i0=_i(),Pd=Z();function s0(e){e=Su.cdr(e);let t=tg.Eval(Su.car(e));return Su.iscons(e)&&(t=e.tail().reduce((r,n)=>rg(r,tg.Eval(n)),t)),t}ls.Eval_lcm=s0;function rg(e,t){return Su.doexpand(a0,e,t)}ls.lcm=rg;function a0(e,t){return Pd.inverse(Pd.divide(Pd.divide(i0.gcd(e,t),e),t))}});var al=A(us=>{"use strict";Object.defineProperty(us,"__esModule",{value:!0});us.filter=us.Eval_filter=void 0;var l0=It(),Hn=N(),u0=ir(),c0=ue(),ng=G();function f0(e){e=Hn.cdr(e);let t=ng.Eval(Hn.car(e));return Hn.iscons(e)&&(t=e.tail().reduce((r,n)=>Ru(r,ng.Eval(n)),t)),t}us.Eval_filter=f0;function Ru(e,t){return d0(e,t)}us.filter=Ru;function d0(e,t){return Hn.isadd(e)?m0(e,t):Hn.istensor(e)?_0(e,t):u0.Find(e,t)?Hn.Constants.zero:e}function m0(e,t){return Hn.iscons(e)?e.tail().reduce((r,n)=>c0.add(r,Ru(n,t)),Hn.Constants.zero):Hn.Constants.zero}function _0(e,t){let r=e.tensor.nelem,n=l0.alloc_tensor(r);return n.tensor.ndim=e.tensor.ndim,n.tensor.dim=Array.from(e.tensor.dim),n.tensor.elem=e.tensor.elem.map(o=>Ru(o,t)),n}});var Yr=A(Lu=>{"use strict";Object.defineProperty(Lu,"__esModule",{value:!0});Lu.subst=void 0;var b0=It(),bi=N(),g0=Ne(),y0=qt(),og=U();function wu(e,t,r){if(t===og.symbol(bi.NIL)||r===og.symbol(bi.NIL))return e;if(bi.istensor(e)){let n=b0.alloc_tensor(e.tensor.nelem);return n.tensor.ndim=e.tensor.ndim,n.tensor.dim=Array.from(e.tensor.dim),n.tensor.elem=e.tensor.elem.map(o=>{let i=wu(o,t,r);return y0.check_tensor_dimensions(n),i}),n}return g0.equal(e,t)?r:bi.iscons(e)?new bi.Cons(wu(bi.car(e),t,r),wu(bi.cdr(e),t,r)):e}Lu.subst=wu});var gi=A(cs=>{"use strict";Object.defineProperty(cs,"__esModule",{value:!0});cs.coeff=cs.Eval_coeff=void 0;var Io=N(),ig=U(),v0=Ne(),q0=ue(),Cu=G(),E0=al(),sg=Z(),x0=Et(),p0=Yr();function h0(e){let t=Cu.Eval(Io.cadddr(e)),r=Cu.Eval(Io.caddr(e)),n=Cu.Eval(Io.cadr(e));return t===ig.symbol(Io.NIL)&&(t=r,r=ig.symbol(Io.SYMBOL_X)),E0.filter(sg.divide(n,x0.power(r,t)),r)}cs.Eval_coeff=h0;function A0(e,t){let r=[];for(;;){let n=Cu.Eval(p0.subst(e,t,Io.Constants.zero));if(r.push(n),e=q0.subtract(e,n),v0.equal(e,Io.Constants.zero))return r;e=Io.doexpand(sg.divide,e,t)}}cs.coeff=A0});var Pu=A(fs=>{"use strict";Object.defineProperty(fs,"__esModule",{value:!0});fs.clockform=fs.Eval_clock=void 0;var ll=N(),O0=U(),ag=on(),kd=ds(),M0=G(),T0=K(),$d=Z(),N0=!1;function I0(e){return lg(M0.Eval(ll.cadr(e)))}fs.Eval_clock=I0;function lg(e){let t=T0.makeList(O0.symbol(ll.POWER),ll.Constants.negOne,$d.divide(kd.arg(e),ll.Constants.Pi())),r=$d.multiply(ag.abs(e),t);return N0&&(console.log(`clockform: abs of ${e} : ${ag.abs(e)}`),console.log(`clockform: arg of ${e} : ${kd.arg(e)}`),console.log(`clockform: divide : ${$d.divide(kd.arg(e),ll.Constants.Pi())}`),console.log(`clockform: power : ${t}`),console.log(`clockform: multiply : ${r}`)),r}fs.clockform=lg});var Du=A(ms=>{"use strict";Object.defineProperty(ms,"__esModule",{value:!0});ms.polar=ms.Eval_polar=void 0;var Ud=N(),S0=Ne(),R0=on(),w0=ds(),L0=G(),ug=Z();function C0(e){return cg(L0.Eval(Ud.cadr(e)))}ms.Eval_polar=C0;function cg(e){return Ud.evalPolar(()=>ug.multiply(R0.abs(e),S0.exponential(ug.multiply(Ud.Constants.imaginaryunit,w0.arg(e)))))}ms.polar=cg});var yi=A(_s=>{"use strict";Object.defineProperty(_s,"__esModule",{value:!0});_s.conjugate=_s.Eval_conj=void 0;var ku=N(),P0=ir(),D0=Pu(),fg=G(),k0=Z(),$0=Du(),U0=Yr();function B0(e){return e=fg.Eval(ku.cadr(e)),P0.Find(e,ku.Constants.imaginaryunit)?Bd(e):D0.clockform(Bd($0.polar(e)))}_s.Eval_conj=B0;function Bd(e){return fg.Eval(U0.subst(e,ku.Constants.imaginaryunit,k0.negate(ku.Constants.imaginaryunit)))}_s.conjugate=Bd});var Vr=A($u=>{"use strict";Object.defineProperty($u,"__esModule",{value:!0});$u.guess=void 0;var sn=N(),ul=ir(),an=U();function G0(e){return ul.Find(e,an.symbol(sn.SYMBOL_X))?an.symbol(sn.SYMBOL_X):ul.Find(e,an.symbol(sn.SYMBOL_Y))?an.symbol(sn.SYMBOL_Y):ul.Find(e,an.symbol(sn.SYMBOL_Z))?an.symbol(sn.SYMBOL_Z):ul.Find(e,an.symbol(sn.SYMBOL_T))?an.symbol(sn.SYMBOL_T):ul.Find(e,an.symbol(sn.SYMBOL_S))?an.symbol(sn.SYMBOL_S):an.symbol(sn.SYMBOL_X)}$u.guess=G0});var Gd=A(bs=>{"use strict";Object.defineProperty(bs,"__esModule",{value:!0});bs.msub=bs.madd=void 0;function F0(e,t){return e.add(t)}bs.madd=F0;function j0(e,t){return e.subtract(t)}bs.msub=j0});var ys=A(gs=>{"use strict";var z0=gs&&gs.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(gs,"__esModule",{value:!0});gs.mgcd=void 0;var Y0=z0(To());function V0(e,t){return Y0.default.gcd(e,t)}gs.mgcd=V0});var ln=A(pn=>{"use strict";Object.defineProperty(pn,"__esModule",{value:!0});pn.mdivrem=pn.mmod=pn.mdiv=pn.mmul=void 0;function Z0(e,t){return e.multiply(t)}pn.mmul=Z0;function X0(e,t){return e.divide(t)}pn.mdiv=X0;function H0(e,t){return e.mod(t)}pn.mmod=H0;function Q0(e,t){let r=e.divmod(t);return[r.quotient,r.remainder]}pn.mdivrem=Q0});var Fd=A(Uu=>{"use strict";Object.defineProperty(Uu,"__esModule",{value:!0});Uu.mprime=void 0;function W0(e){return e.isProbablePrime()}Uu.mprime=W0});var gg=A(qs=>{"use strict";var J0=qs&&qs.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(qs,"__esModule",{value:!0});qs.factor_number=void 0;var K0=J0(To()),Ro=N(),mg=Mu(),ep=Ee(),_g=U(),So=F(),jd=H(),bg=K(),dg=Gd(),tp=ys(),vs=ln(),rp=Fd(),Ft=K0.default(0);function np(e){if(jd.equaln(e,0)||jd.equaln(e,1)||jd.equaln(e,-1))return e;Ft=e.q.a;let t=op();return t.length==1?t[0]:bg.makeList(_g.symbol(Ro.MULTIPLY),...t)}qs.factor_number=np;function op(){let e=[];Ft.isNegative()&&(Ft=So.setSignTo(Ft,1),e.push(Ro.Constants.negOne));for(let t=0;t<1e4;t++)if(e.push(...ip(t)),Ft.compare(1)===0)return e;return e.push(...sp()),e}function ip(e){let t=[],r,n=So.mint(Ro.primetab[e]),o=0;for(;;){if(Ft.compare(1)===0)return o&&t.push(cl(n,o)),t;let i;if([r,i]=Array.from(vs.mdivrem(Ft,n)),i.isZero())o++,Ft=r;else break}return o&&t.push(cl(n,o)),mg.mcmp(r,n)===-1&&(t.push(cl(Ft,1)),Ft=So.mint(1)),t}function sp(){let e=[],t=So.mint(1),r=So.mint(5),n=So.mint(2),o=1,i=1;for(;;){if(rp.mprime(Ft))return e.push(cl(Ft,1)),e;for(;;){Ro.defs.esc_flag&&ep.stop("esc");let s=dg.msub(n,r);s=So.setSignTo(s,1);let u=tp.mgcd(s,Ft);if(Ro.MEQUAL(u,1)){--o===0&&(n=r,i*=2,o=i),s=vs.mmul(r,r),r=dg.madd(s,t),s=vs.mmod(r,Ft),r=s;continue}if(e.push(cl(u,1)),mg.mcmp(u,Ft)===0)return e;s=vs.mdiv(Ft,u),Ft=s,s=vs.mmod(r,Ft),r=s,s=vs.mmod(n,Ft),n=s;break}}}function cl(e,t){let r=new Ro.Num(e);return t>1&&(r=bg.makeList(_g.symbol(Ro.POWER),r,new Ro.Num(So.mint(t)))),r}});var fl=A(wo=>{"use strict";Object.defineProperty(wo,"__esModule",{value:!0});wo.factor_small_number=wo.factor=wo.Eval_factor=void 0;var hn=N(),ap=Ee(),lp=U(),zd=F(),Yd=G(),vg=Es(),up=Vr(),cp=H(),fp=Z(),dp=gg();function mp(e){let t=Yd.Eval(hn.cadr(e)),r=Yd.Eval(hn.caddr(e)),n=r===lp.symbol(hn.NIL)?up.guess(t):r,o=qg(t,n);return e=hn.cdddr(e),hn.iscons(e)&&(o=[...e].reduce((i,s)=>_p(i,Yd.Eval(s)),o)),o}wo.Eval_factor=mp;function _p(e,t){if(hn.ismultiply(e)){let n=[];return e.tail().forEach(o=>yg(n,o,t)),fp.multiply_all_noexpand(n)}let r=[];return yg(r,e,t),r[0]}function yg(e,t,r){let n=vg.factorpoly(t,r);if(hn.ismultiply(n)){e.push(...n.tail());return}e.push(n)}function qg(e,t){return cp.isinteger(e)?dp.factor_number(e):vg.factorpoly(e,t)}wo.factor=qg;function bp(e){isNaN(e)&&ap.stop("number too big to factor");let t=[];e<0&&(e=-e);for(let r=0;r<hn.MAXPRIMETAB;r++){let n=hn.primetab[r];if(n>e/n)break;let o=0;for(;e%n===0;)e/=n,o++;o&&(t.push(zd.integer(n)),t.push(zd.integer(o)))}return e>1&&(t.push(zd.integer(e)),t.push(hn.Constants.one)),t}wo.factor_small_number=bp});var Zd=A(ps=>{"use strict";Object.defineProperty(ps,"__esModule",{value:!0});ps.ydivisors=ps.divisors=void 0;var gp=_i(),yp=It(),ke=N(),Eg=Ne(),vp=ue(),xs=F(),Bu=fl(),qp=H(),Vd=Z(),Ep=Et();function xp(e){let t=xg(e),r=t.length;t.sort(Eg.cmp_expr);let n=yp.alloc_tensor(r);return n.tensor.ndim=1,n.tensor.dim[0]=r,n.tensor.elem=t,n}ps.divisors=xp;var pp=e=>[].concat(...e);function xg(e){let t=[];if(ke.isNumericAtom(e))t.push(...Bu.factor_small_number(xs.nativeInt(e)));else if(ke.isadd(e))t.push(...hp(e));else if(ke.ismultiply(e)){if(e=ke.cdr(e),ke.isNumericAtom(ke.car(e))&&(t.push(...Bu.factor_small_number(xs.nativeInt(ke.car(e)))),e=ke.cdr(e)),ke.iscons(e)){let n=[...e].map(o=>ke.ispower(o)?[ke.cadr(o),ke.caddr(o)]:[o,ke.Constants.one]);t.push(...pp(n))}}else ke.ispower(e)?t.push(ke.cadr(e),ke.caddr(e)):t.push(e,ke.Constants.one);let r=t.length;return t.push(ke.Constants.one),pg(t,0,r),t.slice(r)}ps.ydivisors=xg;function pg(e,t,r){let n=e.pop();if(t===r){e.push(n);return}let o=e[t+0],i=e[t+1],s=xs.nativeInt(i);if(!isNaN(s))for(let u=0;u<=Math.abs(s);u++)e.push(Vd.multiply(n,Ep.power(o,xs.integer(Eg.sign(s)*u)))),pg(e,t+2,r)}function hp(e){let t=ke.iscons(e)?e.tail().reduce(gp.gcd):ke.car(e),r=[],n=t;if(qp.isplusone(n))return r.push(e,ke.Constants.one),r;if(ke.isNumericAtom(n))r.push(...Bu.factor_small_number(xs.nativeInt(n)));else if(ke.ismultiply(n)){let i=ke.cdr(n);ke.isNumericAtom(ke.car(i))?r.push(...Bu.factor_small_number(xs.nativeInt(ke.car(i)))):r.push(ke.car(i),ke.Constants.one),ke.iscons(i)&&i.tail().forEach(s=>r.push(s,ke.Constants.one))}else r.push(n,ke.Constants.one);n=Vd.inverse(n);let o=ke.iscons(e)?e.tail().reduce((i,s)=>vp.add(i,Vd.multiply(n,s)),ke.Constants.zero):ke.cdr(e);return r.push(o,ke.Constants.one),r}});var Gu=A(As=>{"use strict";Object.defineProperty(As,"__esModule",{value:!0});As.divpoly=As.Eval_quotient=void 0;var hs=N(),hg=U(),Ag=ue(),Ap=F(),Og=gi(),Xd=G(),Hd=Z(),Op=Et();function Mp(e){let t=Xd.Eval(hs.cadr(e)),r=Xd.Eval(hs.caddr(e)),n=Xd.Eval(hs.cadddr(e));return n===hg.symbol(hs.NIL)&&(n=hg.symbol(hs.SYMBOL_X)),Mg(t,r,n)}As.Eval_quotient=Mp;function Mg(e,t,r){let n=Og.coeff(e,r),o=n.length-1,i=Og.coeff(t,r),s=i.length-1,u=o-s,c=hs.Constants.zero;for(;u>=0;){let d=Hd.divide(n[o],i[s]);for(let _=0;_<=s;_++)n[u+_]=Ag.subtract(n[u+_],Hd.multiply(i[_],d));c=Ag.add(c,Hd.multiply(d,Op.power(r,Ap.integer(u)))),o--,u--}return c}As.divpoly=Mg});var Qn=A(Ms=>{"use strict";Object.defineProperty(Ms,"__esModule",{value:!0});Ms.sine=Ms.Eval_sin=void 0;var Ct=N(),Fu=U(),Qd=ue(),jt=F(),Tg=Lo(),Tp=G(),Ig=H(),Ng=K(),un=Z(),Os=Et();function Np(e){return dl(Tp.Eval(Ct.cadr(e)))}Ms.Eval_sin=Np;function dl(e){return Ct.isadd(e)?Ip(e):Sg(e)}Ms.sine=dl;function Ip(e){let t=Ct.cdr(e);for(;Ct.iscons(t);){let r=Ct.car(t);if(Ig.isnpi(r)){let n=Qd.subtract(e,r);return Qd.add(un.multiply(dl(n),Tg.cosine(r)),un.multiply(Tg.cosine(n),dl(r)))}t=Ct.cdr(t)}return Sg(e)}function Sg(e){if(Ct.car(e)===Fu.symbol(Ct.ARCSIN))return Ct.cadr(e);if(Ct.isdouble(e)){let r=Math.sin(e.d);return Math.abs(r)<1e-10&&(r=0),jt.double(r)}if(Ig.isnegative(e))return un.negate(dl(un.negate(e)));if(Ct.car(e)===Fu.symbol(Ct.ARCTAN))return un.multiply(Ct.cadr(e),Os.power(Qd.add(Ct.Constants.one,Os.power(Ct.cadr(e),jt.integer(2))),jt.rational(-1,2)));let t=jt.nativeInt(un.divide(un.multiply(e,jt.integer(180)),Ct.Constants.Pi()));if(t<0||isNaN(t))return Ng.makeList(Fu.symbol(Ct.SIN),e);switch(t%360){case 0:case 180:return Ct.Constants.zero;case 30:case 150:return jt.rational(1,2);case 210:case 330:return jt.rational(-1,2);case 45:case 135:return un.multiply(jt.rational(1,2),Os.power(jt.integer(2),jt.rational(1,2)));case 225:case 315:return un.multiply(jt.rational(-1,2),Os.power(jt.integer(2),jt.rational(1,2)));case 60:case 120:return un.multiply(jt.rational(1,2),Os.power(jt.integer(3),jt.rational(1,2)));case 240:case 300:return un.multiply(jt.rational(-1,2),Os.power(jt.integer(3),jt.rational(1,2)));case 90:return Ct.Constants.one;case 270:return Ct.Constants.negOne;default:return Ng.makeList(Fu.symbol(Ct.SIN),e)}}});var Lo=A(Ns=>{"use strict";Object.defineProperty(Ns,"__esModule",{value:!0});Ns.cosine=Ns.Eval_cos=void 0;var sr=N(),ju=U(),Wd=ue(),zt=F(),Sp=G(),Lg=H(),Rg=K(),Wn=Z(),Ts=Et(),wg=Qn();function Rp(e){return zu(Sp.Eval(sr.cadr(e)))}Ns.Eval_cos=Rp;function zu(e){return sr.isadd(e)?wp(e):Cg(e)}Ns.cosine=zu;function wp(e){if(sr.iscons(e)){for(let t of e.tail())if(Lg.isnpi(t)){let r=Wd.subtract(e,t);return Wd.subtract(Wn.multiply(zu(r),zu(t)),Wn.multiply(wg.sine(r),wg.sine(t)))}}return Cg(e)}function Cg(e){if(sr.car(e)===ju.symbol(sr.ARCCOS))return sr.cadr(e);if(sr.isdouble(e)){let r=Math.cos(e.d);return Math.abs(r)<1e-10&&(r=0),zt.double(r)}if(Lg.isnegative(e)&&(e=Wn.negate(e)),sr.car(e)===ju.symbol(sr.ARCTAN)){let r=Wd.add(sr.Constants.one,Ts.power(sr.cadr(e),zt.integer(2)));return Ts.power(r,zt.rational(-1,2))}let t=zt.nativeInt(Wn.divide(Wn.multiply(e,zt.integer(180)),sr.Constants.Pi()));if(t<0||isNaN(t))return Rg.makeList(ju.symbol(sr.COS),e);switch(t%360){case 90:case 270:return sr.Constants.zero;case 60:case 300:return zt.rational(1,2);case 120:case 240:return zt.rational(-1,2);case 45:case 315:return Wn.multiply(zt.rational(1,2),Ts.power(zt.integer(2),zt.rational(1,2)));case 135:case 225:return Wn.multiply(zt.rational(-1,2),Ts.power(zt.integer(2),zt.rational(1,2)));case 30:case 330:return Wn.multiply(zt.rational(1,2),Ts.power(zt.integer(3),zt.rational(1,2)));case 150:case 210:return Wn.multiply(zt.rational(-1,2),Ts.power(zt.integer(3),zt.rational(1,2)));case 0:return sr.Constants.one;case 180:return sr.Constants.negOne;default:return Rg.makeList(ju.symbol(sr.COS),e)}}});var Kn=A(Ss=>{"use strict";Object.defineProperty(Ss,"__esModule",{value:!0});Ss.rect=Ss.Eval_rect=void 0;var mr=N(),Is=ir(),Jn=U(),Pg=on(),Jd=ue(),vi=ds(),Kd=Lo(),Lp=G(),Yu=H(),Cp=K(),Vu=Z(),Zu=Qn(),ml=!1;function Pp(e){return em(Lp.Eval(mr.cadr(e)))}Ss.Eval_rect=Pp;function em(e){let t=e;if(ml&&(console.log(`RECT of ${t}`),console.log(`any clock forms in : ${t} ? ${Is.findPossibleClockForm(t,e)}`)),mr.issymbol(e))return ml&&console.log(` rect: simple symbol: ${t}`),Yu.isZeroAtomOrTensor(Jn.get_binding(Jn.symbol(mr.ASSUME_REAL_VARIABLES)))?Cp.makeList(Jn.symbol(mr.YYRECT),e):e;if(!Yu.isZeroAtomOrTensor(Jn.get_binding(Jn.symbol(mr.ASSUME_REAL_VARIABLES)))&&!Is.findPossibleExponentialForm(e)&&!Is.findPossibleClockForm(e,e)&&!(Is.Find(e,Jn.symbol(mr.SIN))&&Is.Find(e,Jn.symbol(mr.COS))&&Is.Find(e,mr.Constants.imaginaryunit)))return ml&&console.log(` rect: simple symbol: ${t}`),e;if(mr.ismultiply(e)&&Yu.isimaginaryunit(mr.cadr(e))&&!Yu.isZeroAtomOrTensor(Jn.get_binding(Jn.symbol(mr.ASSUME_REAL_VARIABLES))))return e;if(mr.isadd(e))return ml&&console.log(` rect - ${t} is a sum `),e.tail().reduce((n,o)=>Jd.add(n,em(o)),mr.Constants.zero);let r=Vu.multiply(Pg.abs(e),Jd.add(Kd.cosine(vi.arg(e)),Vu.multiply(mr.Constants.imaginaryunit,Zu.sine(vi.arg(e)))));return ml&&(console.log(` rect - ${t} is NOT a sum `),console.log(` rect - ${t} abs: ${Pg.abs(e)}`),console.log(` rect - ${t} arg of ${e} : ${e}`),console.log(` rect - ${t} cosine: ${Kd.cosine(vi.arg(e))}`),console.log(` rect - ${t} sine: ${Zu.sine(vi.arg(e))}`),console.log(` rect - ${t} i * sine: ${Vu.multiply(mr.Constants.imaginaryunit,Zu.sine(vi.arg(e)))}`),console.log(` rect - ${t} cos + i * sine: ${Jd.add(Kd.cosine(vi.arg(e)),Vu.multiply(mr.Constants.imaginaryunit,Zu.sine(vi.arg(e))))}`),console.log(`rect of ${t} : ${r}`)),r}Ss.rect=em});var Es=A(Xu=>{"use strict";Object.defineProperty(Xu,"__esModule",{value:!0});Xu.factorpoly=void 0;var Dp=Dd(),Se=N(),kp=ir(),$p=Ee(),Up=Ne(),An=ue(),Co=F(),Dg=gi(),kg=bl(),Bp=yi(),Gp=Mn(),$g=Zd(),On=H(),Ot=Z(),Rs=Et(),Fp=eo(),jp=Gu(),tm=Kn();function zp(e,t){return!kp.Find(e,t)||!On.ispolyexpandedform(e,t)||!Se.issymbol(t)?e:Yp(e,t)}Xu.factorpoly=zp;function Yp(e,t){let r,n,o,i;On.isfloating(e)&&$p.stop("floating point numbers in polynomial");let s=Dg.coeff(e,t),u=s.length-1,c=Vp(s),d="real",_=null;for(;u>0;){var R,T;if(On.isZeroAtomOrTensor(s[0])?(r=Se.Constants.one,n=Se.Constants.zero):d==="real"?[T,r,n]=Zp(s,u,t,r,n):d==="complex"&&([R,r]=Xp(_,s,u)),d==="real")if(T===!1){d="complex";continue}else{for(o=An.add(Ot.multiply(r,t),n),Se.DEBUG&&console.log(`success
FACTOR=${o}`),c=Ot.multiply_noexpand(c,o),Hp(r,n,s,u);u&&On.isZeroAtomOrTensor(s[u]);)u--;let V=Se.Constants.zero;for(let z=0;z<=u;z++)V=An.add(V,Ot.multiply(s[z],Rs.power(t,Co.integer(z))));_=V}else if(d==="complex"){if(R===!1)break;{let V=An.subtract(r,t),z=An.subtract(Bp.conjugate(r),t);o=Ot.multiply(V,z),Se.DEBUG&&console.log(`success
FACTOR=${o}`);let Ae=c;if(c=Ot.multiply_noexpand(c,o),_==null){let Oe=Se.Constants.zero;for(let st=0;st<=u;st++)Oe=An.add(Oe,Ot.multiply(s[st],Rs.power(t,Co.integer(st))));_=Oe}let et=t,Ve=o,De=_;_=jp.divpoly(De,Ve,et);let it=Ot.multiply(_,o);if(!Up.equal(it,De))return Se.DEBUG&&(console.log("we found a polynomial based on complex root and its conj but it doesn't divide the poly, quitting"),console.log(`so just returning previousFactorisation times dividend: ${Ae} * ${De}`)),Ot.multiply_noexpand(Ae,Se.noexpand(kg.yycondense,De));for(let Oe=0;Oe<=u;Oe++)s.pop();s.push(...Dg.coeff(_,t)),u-=2}}}let k=Se.Constants.zero;for(let V=0;V<=u;V++)k=An.add(k,Ot.multiply(s[V],Rs.power(t,Co.integer(V))));return e=k,Se.DEBUG&&console.log(`POLY=${e}`),e=Se.noexpand(kg.yycondense,e),u>0&&On.isnegativeterm(s[u])&&(e=Ot.negate(e),c=Ot.negate_noexpand(c)),c=Ot.multiply_noexpand(c,e),Se.DEBUG&&console.log(`RESULT=${c}`),c}function Vp(e){let t=Se.Constants.one;for(let r of e)t=Dp.lcm(Gp.denominator(r),t);for(let r=0;r<e.length;r++)e[r]=Ot.multiply(t,e[r]);return t=Ot.reciprocate(t),Se.DEBUG&&console.log("rationalize_coefficients result"),t}function Zp(e,t,r,n,o){let i,s,u;if(Se.DEBUG){let _=Se.Constants.zero;for(let R=0;R<=t;R++)_=An.add(_,Ot.multiply(e[R],Rs.power(r,Co.integer(R))));i=_,console.log(`POLY=${i}`)}let c=$g.ydivisors(e[t]),d=$g.ydivisors(e[0]);if(Se.DEBUG){console.log("divisors of base term");for(let _=0;_<d.length;_++)console.log(`, ${d[_]}`);console.log("divisors of leading term");for(let _=0;_<c.length;_++)console.log(`, ${c[_]}`)}for(let _=0;_<c.length;_++)for(let R=0;R<d.length;R++){if(n=c[_],o=d[R],s=Ot.negate(Ot.divide(o,n)),u=_l(s,e,t),Se.DEBUG&&console.log(`try A=${n}
, B=${o}
, root ${r}
=-B/A=${s}
, POLY(${s}
)=${u}`),On.isZeroAtomOrTensor(u))return Se.DEBUG&&console.log("get_factor_from_real_root returning true"),[!0,n,o];if(o=Ot.negate(o),s=Ot.negate(s),u=_l(s,e,t),Se.DEBUG&&console.log(`try A=${n}
, B=${o}
, root ${r}
=-B/A=${s}
, POLY(${s}
)=${u}`),On.isZeroAtomOrTensor(u))return Se.DEBUG&&console.log("get_factor_from_real_root returning true"),[!0,n,o]}return Se.DEBUG&&console.log("get_factor_from_real_root returning false"),[!1,n,o]}function Xp(e,t,r){let n,o,i,s;if(r<=2)return Se.DEBUG&&console.log("no more factoring via complex roots to be found in polynomial of degree <= 2"),[!1,o];if(n=e,Se.DEBUG&&console.log(`complex root finding for POLY=${n}`),o=tm.rect(Rs.power(Se.Constants.negOne,Co.rational(2,3))),Se.DEBUG&&console.log(`complex root finding: trying with ${o}`),i=o,s=_l(i,t,r),Se.DEBUG&&console.log(`complex root finding result: ${s}`),On.isZeroAtomOrTensor(s))return Se.DEBUG&&console.log("get_factor_from_complex_root returning true"),[!0,o];if(o=tm.rect(Rs.power(Se.Constants.one,Co.rational(2,3))),Se.DEBUG&&console.log(`complex root finding: trying with ${o}`),i=o,s=_l(i,t,r),Se.DEBUG&&console.log(`complex root finding result: ${s}`),On.isZeroAtomOrTensor(s))return Se.DEBUG&&console.log("get_factor_from_complex_root returning true"),[!0,o];for(let u=-10;u<=10;u++)for(let c=1;c<=5;c++){o=tm.rect(An.add(Co.integer(u),Ot.multiply(Co.integer(c),Se.Constants.imaginaryunit)));let _=_l(o,t,r);if(On.isZeroAtomOrTensor(_))return Se.DEBUG&&console.log(`found complex root: ${_}`),[!0,o]}return Se.DEBUG&&console.log("get_factor_from_complex_root returning false"),[!1,o]}function Hp(e,t,r,n){let o=Se.Constants.zero;for(let i=n;i>0;i--){let s=Ot.divide(r[i],e);r[i]=o,o=s,r[i-1]=An.subtract(r[i-1],Ot.multiply(o,t))}r[0]=o,Se.DEBUG&&console.log("yydivpoly Q:")}function _l(e,t,r){let n=Se.Constants.zero;for(let o=r;o>=0;o--)Se.DEBUG&&(console.log("Evalpoly top of stack:"),console.log(Fp.print_list(n))),n=An.add(Ot.multiply(n,e),t[o]);return n}});var _i=A(Do=>{"use strict";Object.defineProperty(Do,"__esModule",{value:!0});Do.areunivarpolysfactoredorexpandedform=Do.gcd=Do.Eval_gcd=void 0;var X=N(),Ug=U(),qi=Ne(),Qp=ue(),Wp=F(),Bg=G(),Gg=Es(),nm=H(),Fg=K(),Po=Z(),rm=Et();function Jp(e){e=X.cdr(e);let t=Bg.Eval(X.car(e));return X.iscons(e)&&(t=e.tail().reduce((r,n)=>to(r,Bg.Eval(n)),t)),t}Do.Eval_gcd=Jp;function to(e,t){return X.doexpand(Kp,e,t)}Do.gcd=to;function Kp(e,t){let r;return qi.equal(e,t)?e:X.isrational(e)&&X.isrational(t)?Wp.gcd_numbers(e,t):(r=zg(e,t))?eh(e,t,r):X.isadd(e)&&X.isadd(t)?th(e,t):(X.isadd(e)&&(e=jg(e)),X.isadd(t)&&(t=jg(t)),X.ismultiply(e)?rh(e,t):X.ismultiply(t)?nh(e,t):X.ismultiply(e)&&X.ismultiply(t)?Yg(e,t):Vg(e,t))}function zg(e,t){let r;if((r=nm.isunivarpolyfactoredorexpandedform(e))&&nm.isunivarpolyfactoredorexpandedform(t,r))return r}Do.areunivarpolysfactoredorexpandedform=zg;function eh(e,t,r){return e=Gg.factorpoly(e,r),t=Gg.factorpoly(t,r),(X.ismultiply(e)||X.ismultiply(t))&&(X.ismultiply(e)||(e=Fg.makeList(Ug.symbol(X.MULTIPLY),e,X.Constants.one)),X.ismultiply(t)||(t=Fg.makeList(Ug.symbol(X.MULTIPLY),t,X.Constants.one))),X.ismultiply(e)&&X.ismultiply(t)?Yg(e,t):Vg(e,t)}function Yg(e,t){let r=X.cdr(e),n=X.cdr(t);if(X.iscons(r))return[...r].reduce((o,i)=>{if(X.iscons(n))return Po.multiply(o,[...n].reduce((s,u)=>Po.multiply(s,to(i,u)),X.Constants.one))},X.Constants.one)}function Vg(e,t){let r,n,o;if(X.ispower(e)?(r=X.caddr(e),e=X.cadr(e)):r=X.Constants.one,X.ispower(t)?(n=X.caddr(t),t=X.cadr(t)):n=X.Constants.one,!qi.equal(e,t))return X.Constants.one;if(X.isNumericAtom(r)&&X.isNumericAtom(n)){let u=qi.lessp(r,n)?r:n;return rm.power(e,u)}let i=Po.divide(r,n);if(X.isNumericAtom(i)){i=X.ismultiply(r)&&X.isNumericAtom(X.cadr(r))?X.cadr(r):X.Constants.one,o=X.ismultiply(n)&&X.isNumericAtom(X.cadr(n))?X.cadr(n):X.Constants.one;let u=qi.lessp(i,o)?r:n;return rm.power(e,u)}if(i=Qp.subtract(r,n),!X.isNumericAtom(i))return X.Constants.one;let s=nm.isnegativenumber(i)?r:n;return rm.power(e,s)}function th(e,t){let r,n,o,i;return qi.length(e)!==qi.length(t)?X.Constants.one:(r=X.iscons(e)?e.tail().reduce(to):X.car(X.cdr(e)),n=X.iscons(t)?t.tail().reduce(to):X.car(X.cdr(t)),o=Po.divide(e,r),i=Po.divide(t,n),qi.equal(o,i)?Po.multiply(o,to(r,n)):X.Constants.one)}function jg(e){return X.iscons(e)?e.tail().reduce(to):X.car(X.cdr(e))}function rh(e,t){return X.iscons(e)?e.tail().reduce((r,n)=>Po.multiply(r,to(n,t)),X.Constants.one):X.Constants.one}function nh(e,t){return X.iscons(t)?t.tail().reduce((r,n)=>Po.multiply(r,to(e,n)),X.Constants.one):X.Constants.one}});var bl=A(ko=>{"use strict";Object.defineProperty(ko,"__esModule",{value:!0});ko.yycondense=ko.Condense=ko.Eval_condense=void 0;var Hu=N(),oh=Ne(),ih=ue(),sh=G(),ah=_i(),om=Z();function lh(e){return Zg(sh.Eval(Hu.cadr(e)))}ko.Eval_condense=lh;function Zg(e){return Hu.noexpand(Xg,e)}ko.Condense=Zg;function Xg(e){if(!Hu.isadd(e))return e;let t=e.tail().reduce(ah.gcd),r=om.inverse(t),n=e.tail().reduce((i,s)=>ih.add(i,om.multiply_noexpand(r,s)),Hu.Constants.zero),o=oh.yyexpand(n);return om.divide(o,r)}ko.yycondense=Xg});var gl=A(Ls=>{"use strict";Object.defineProperty(Ls,"__esModule",{value:!0});Ls.rationalize=Ls.Eval_rationalize=void 0;var ar=N(),uh=ue(),ch=bl(),Kg=G(),fh=_i(),Hg=H(),ws=Z(),dh=qt();function mh(e){return im(Kg.Eval(ar.cadr(e)))}Ls.Eval_rationalize=mh;function im(e){let t=ar.defs.expanding,r=_h(e);return ar.defs.expanding=t,r}Ls.rationalize=im;function _h(e){if(ar.istensor(e))return gh(e);if(ar.defs.expanding=!1,!ar.isadd(e))return e;let t=bh(e),r=ar.Constants.zero;return ar.iscons(e)&&(r=e.tail().reduce((n,o)=>uh.add(n,ws.multiply(t,o)),r)),ws.divide(ch.Condense(r),t)}function bh(e){return ar.isadd(e)?e.tail().reduce((t,r)=>Qg(r,t),ar.Constants.one):Qg(e,ar.Constants.one)}function Qg(e,t){return ar.ismultiply(e)?e.tail().reduce((r,n)=>Wg(n,r),t):Wg(e,t)}function Wg(e,t){if(!ar.ispower(e))return t;let r=e;return e=ar.caddr(e),Hg.isnegativenumber(e)||ar.ismultiply(e)&&Hg.isnegativenumber(ar.cadr(e))?Jg(t,ws.inverse(r)):t}function gh(e){return e=Kg.Eval(e),ar.istensor(e)&&(e.tensor.elem=e.tensor.elem.map(im),dh.check_tensor_dimensions(e)),e}function Jg(e,t){return ws.divide(ws.multiply(e,t),fh.gcd(e,t))}});var Mn=A(Cs=>{"use strict";Object.defineProperty(Cs,"__esModule",{value:!0});Cs.denominator=Cs.Eval_denominator=void 0;var ro=N(),yh=F(),vh=G(),ey=H(),ty=Z(),qh=gl();function Eh(e){return sm(vh.Eval(ro.cadr(e)))}Cs.Eval_denominator=Eh;function sm(e){return ro.isadd(e)&&(e=qh.rationalize(e)),ro.ismultiply(e)&&!ey.isplusone(ro.car(ro.cdr(e)))?ty.multiply_all(e.tail().map(sm)):ro.isrational(e)?yh.mp_denominator(e):ro.ispower(e)&&ey.isnegativeterm(ro.caddr(e))?ty.reciprocate(e):ro.Constants.one}Cs.denominator=sm});var oo=A(Ps=>{"use strict";Object.defineProperty(Ps,"__esModule",{value:!0});Ps.numerator=Ps.Eval_numerator=void 0;var no=N(),xh=F(),ph=G(),ry=H(),hh=Z(),Ah=gl();function Oh(e){return am(ph.Eval(no.cadr(e)))}Ps.Eval_numerator=Oh;function am(e){return no.isadd(e)&&(e=Ah.rationalize(e)),no.ismultiply(e)&&!ry.isplusone(no.car(no.cdr(e)))?hh.multiply_all(e.tail().map(am)):no.isrational(e)?xh.mp_numerator(e):no.ispower(e)&&ry.isnegativeterm(no.caddr(e))?no.Constants.one:e}Ps.numerator=am});var um=A(Ds=>{"use strict";Object.defineProperty(Ds,"__esModule",{value:!0});Ds.arctan=Ds.Eval_arctan=void 0;var pe=N(),ny=ir(),Ei=U(),Mh=Ne(),Qu=F(),Th=Mn(),Nh=G(),Tn=H(),Ih=K(),yl=Z(),Sh=oo();function Rh(e){return lm(Nh.Eval(pe.cadr(e)))}Ds.Eval_arctan=Rh;function lm(e){if(pe.car(e)===Ei.symbol(pe.TAN))return pe.cadr(e);if(pe.isdouble(e))return Qu.double(Math.atan(e.d));if(Tn.isZeroAtomOrTensor(e))return pe.Constants.zero;if(Tn.isnegative(e))return yl.negate(lm(yl.negate(e)));if(ny.Find(e,Ei.symbol(pe.SIN))&&ny.Find(e,Ei.symbol(pe.COS))){let t=Sh.numerator(e),r=Th.denominator(e);if(pe.car(t)===Ei.symbol(pe.SIN)&&pe.car(r)===Ei.symbol(pe.COS)&&Mh.equal(pe.cadr(t),pe.cadr(r)))return pe.cadr(t)}return pe.ispower(e)&&Tn.equaln(pe.cadr(e),3)&&Tn.equalq(pe.caddr(e),-1,2)||pe.ismultiply(e)&&Tn.equalq(pe.car(pe.cdr(e)),1,3)&&pe.car(pe.car(pe.cdr(pe.cdr(e))))===Ei.symbol(pe.POWER)&&Tn.equaln(pe.car(pe.cdr(pe.car(pe.cdr(pe.cdr(e))))),3)&&Tn.equalq(pe.car(pe.cdr(pe.cdr(pe.car(pe.cdr(pe.cdr(e)))))),1,2)?yl.multiply(Qu.rational(1,6),pe.Constants.Pi()):Tn.equaln(e,1)?yl.multiply(Qu.rational(1,4),pe.Constants.Pi()):pe.ispower(e)&&Tn.equaln(pe.cadr(e),3)&&Tn.equalq(pe.caddr(e),1,2)?yl.multiply(Qu.rational(1,3),pe.Constants.Pi()):Ih.makeList(Ei.symbol(pe.ARCTAN),e)}Ds.arctan=lm});var vl=A(ks=>{"use strict";Object.defineProperty(ks,"__esModule",{value:!0});ks.imag=ks.Eval_imag=void 0;var iy=N(),wh=ue(),Lh=F(),Ch=yi(),Ph=G(),oy=Z(),Dh=Kn(),kh=!1;function $h(e){return sy(Ph.Eval(iy.cadr(e)))}ks.Eval_imag=$h;function sy(e){let t=Dh.rect(e),r=Ch.conjugate(t),n=oy.divide(wh.subtract(t,r),Lh.integer(2)),o=oy.divide(n,iy.Constants.imaginaryunit);return kh&&(console.log(`IMAGE of ${t}`),console.log(` image: conjugate result: ${r}`),console.log(` image: 1st divide result: ${n}`),console.log(` image: 2nd divide result: ${o}`)),o}ks.imag=sy});var Us=A($s=>{"use strict";Object.defineProperty($s,"__esModule",{value:!0});$s.real=$s.Eval_real=void 0;var Uh=N(),Bh=ue(),Gh=F(),Fh=yi(),jh=G(),zh=Z(),Yh=Kn();function Vh(e){return ay(jh.Eval(Uh.cadr(e)))}$s.Eval_real=Vh;function ay(e){let t=Yh.rect(e);return zh.divide(Bh.add(t,Fh.conjugate(t)),Gh.integer(2))}$s.real=ay});var ds=A(Bs=>{"use strict";Object.defineProperty(Bs,"__esModule",{value:!0});Bs.arg=Bs.Eval_arg=void 0;var Fe=N(),xi=U(),Wu=ue(),Zh=um(),Xh=Mn(),Hh=G(),ly=vl(),io=H(),uy=K(),ql=Z(),Qh=oo(),Wh=Us(),Jh=Kn(),Kh=!1;function e2(e){return Ju(Hh.Eval(Fe.cadr(e)))}Bs.Eval_arg=e2;function Ju(e){return Wu.subtract(cy(Qh.numerator(e)),cy(Xh.denominator(e)))}Bs.arg=Ju;function cy(e){if(io.ispositivenumber(e)||e===xi.symbol(Fe.PI))return Fe.isdouble(e)||Fe.defs.evaluatingAsFloats?Fe.Constants.zeroAsDouble:Fe.Constants.zero;if(io.isnegativenumber(e)){let t=Fe.isdouble(e)||Fe.defs.evaluatingAsFloats?Fe.Constants.piAsDouble:xi.symbol(Fe.PI);return ql.negate(t)}if(Fe.issymbol(e))return uy.makeList(xi.symbol(Fe.ARG),e);if(Fe.ispower(e)&&io.equaln(Fe.cadr(e),-1))return ql.multiply(Fe.Constants.Pi(),Fe.caddr(e));if(Fe.ispower(e)&&Fe.cadr(e)===xi.symbol(Fe.E))return ly.imag(Fe.caddr(e));if(Fe.ispower(e)&&io.isoneovertwo(Fe.caddr(e))){let t=Ju(Fe.cadr(e));return Kh&&(console.log(`arg of a sqrt: ${e}`),Fe.breakpoint,console.log(` = 1/2 * ${t}`)),ql.multiply(t,Fe.caddr(e))}if(Fe.ismultiply(e))return e.tail().map(Ju).reduce(Wu.add,Fe.Constants.zero);if(Fe.isadd(e)){e=Jh.rect(e);let t=Wh.real(e),r=ly.imag(e);if(io.isZeroAtomOrTensor(t))return io.isnegative(r)?ql.negate(Fe.Constants.Pi()):Fe.Constants.Pi();{let n=Zh.arctan(ql.divide(r,t));return io.isnegative(t)?io.isnegative(r)?Wu.subtract(n,Fe.Constants.Pi()):Wu.add(n,Fe.Constants.Pi()):n}}return io.isZeroAtomOrTensor(xi.get_binding(xi.symbol(Fe.ASSUME_REAL_VARIABLES)))?uy.makeList(xi.symbol(Fe.ARG),e):Fe.Constants.zero}});var fy=A(Ku=>{"use strict";Object.defineProperty(Ku,"__esModule",{value:!0});Ku.dpow=void 0;var t2=N(),r2=Ee(),n2=ue(),cm=F(),o2=Z();function i2(e,t){if(e===0&&t<0&&r2.stop("divide by zero"),e>=0||t%1===0)return cm.double(Math.pow(e,t));let r=Math.pow(Math.abs(e),t),n=Math.PI*t,o=0,i=0;return t%.5===0?(o=0,i=Math.sin(n)):(o=Math.cos(n),i=Math.sin(n)),n2.add(cm.double(o*r),o2.multiply(cm.double(i*r),t2.Constants.imaginaryunit))}Ku.dpow=i2});var pi=A(ec=>{"use strict";Object.defineProperty(ec,"__esModule",{value:!0});ec.factorial=void 0;var s2=N(),xB=Ne(),pB=ue(),dy=F(),a2=K(),hB=Z(),AB=Et(),l2=U();function u2(e){let t=dy.nativeInt(e);return t<0||isNaN(t)?a2.makeList(l2.symbol(s2.FACTORIAL),e):dy.bignum_factorial(t)}ec.factorial=u2});var rc=A(tc=>{"use strict";Object.defineProperty(tc,"__esModule",{value:!0});tc.mpow=void 0;function c2(e,t){return e.pow(t)}tc.mpow=c2});var my=A(Gs=>{"use strict";var f2=Gs&&Gs.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Gs,"__esModule",{value:!0});Gs.mroot=void 0;var nc=f2(To()),d2=Mu(),m2=Ee(),_2=F(),b2=rc();function g2(e,t){e=e.abs(),t===0&&m2.stop("root index is zero");let r=0;for(;e.shiftRight(r).toJSNumber()>0;)r++;if(r===0)return _2.mint(0);r=Math.floor((r-1)/t);let n=Math.floor(r/32+1),o=nc.default(n);for(let i=0;i<n;i++)o=o.and(nc.default(1).shiftLeft(i).not());for(;r>=0;){o=o.or(nc.default(1).shiftLeft(r));let i=b2.mpow(o,t);switch(d2.mcmp(i,e)){case 0:return o;case 1:o=o.and(nc.default(1).shiftLeft(r).not());break}r--}return 0}Gs.mroot=g2});var qy=A(Fs=>{"use strict";Object.defineProperty(Fs,"__esModule",{value:!0});Fs.quickpower=Fs.quickfactor=void 0;var _y=N(),y2=ue(),oc=F(),v2=fl(),q2=H(),by=K(),gy=Z(),yy=U();function E2(e,t){let r=v2.factor_small_number(oc.nativeInt(e)),n=r.length;for(let o=0;o<n;o+=2)r.push(...vy(r[o],gy.multiply(r[o+1],t)));return gy.multiply_all(r.slice(n))}Fs.quickfactor=E2;function vy(e,t){let r=oc.bignum_truncate(t),n=y2.subtract(t,r),o;q2.isZeroAtomOrTensor(n)||(o=by.makeList(yy.symbol(_y.POWER),e,n));let i=oc.nativeInt(r);if(isNaN(i)){let u=by.makeList(yy.symbol(_y.POWER),e,r);return o?[o,u]:[u]}if(i===0)return[o];let s=oc.bignum_power_number(e,i);return o?[o,s]:[s]}Fs.quickpower=vy});var xy=A(js=>{"use strict";var x2=js&&js.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(js,"__esModule",{value:!0});js.qpow=void 0;var p2=x2(To()),qr=N(),h2=Ee(),Ey=ue(),so=F(),Lr=H(),ic=K(),fm=rc(),A2=my(),El=Z(),O2=qy(),sc=U();function xl(e,t){return M2(e,t)}js.qpow=xl;function M2(e,t){if(Lr.isplusone(e)||Lr.isZeroAtomOrTensor(t))return qr.Constants.one;if(Lr.isminusone(e)&&Lr.isoneovertwo(t))return qr.Constants.imaginaryunit;if(Lr.isZeroAtomOrTensor(e))return Lr.isnegativenumber(t)&&h2.stop("divide by zero"),qr.Constants.zero;if(Lr.isplusone(t))return e;let r=0,n,o;if(Lr.isinteger(t)){if(r=so.nativeInt(t),isNaN(r))return ic.makeList(sc.symbol(qr.POWER),e,t);if(n=fm.mpow(e.q.a,Math.abs(r)),o=fm.mpow(e.q.b,Math.abs(r)),r<0){let u=n;n=o,o=u,n=so.makeSignSameAs(n,o),o=so.makePositive(o)}return new qr.Num(n,o)}if(Lr.isminusone(e))return T2(t);if(Lr.isnegativenumber(e))return El.multiply(xl(El.negate(e),t),xl(qr.Constants.negOne,t));if(!Lr.isinteger(e))return El.multiply(xl(so.mp_numerator(e),t),xl(so.mp_denominator(e),El.negate(t)));if(N2(e))return O2.quickfactor(e,t);if(!so.isSmall(t.q.a)||!so.isSmall(t.q.b))return ic.makeList(sc.symbol(qr.POWER),e,t);let{a:i,b:s}=t.q;return n=A2.mroot(e.q.a,s.toJSNumber()),n===0?ic.makeList(sc.symbol(qr.POWER),e,t):(o=fm.mpow(n,i),t.q.a.isNegative()?new qr.Num(p2.default.one,o):new qr.Num(o))}function T2(e){if(Lr.isinteger(e))return e.q.a.isOdd()?qr.Constants.negOne:qr.Constants.one;let t=so.bignum_truncate(e);Lr.isnegativenumber(e)&&(t=Ey.add(t,qr.Constants.negOne));let r=Ey.subtract(e,t),n=ic.makeList(sc.symbol(qr.POWER),qr.Constants.negOne,r);return t.q.a.isOdd()&&(n=El.negate(n)),n}function N2(e){return so.isSmall(e.q.a)}});var Et=A(Ys=>{"use strict";Object.defineProperty(Ys,"__esModule",{value:!0});Ys.power=Ys.Eval_power=void 0;var B=N(),ac=ir(),Yt=U(),pl=Ne(),py=on(),lc=ue(),I2=ds(),Ar=F(),S2=yi(),R2=Lo(),w2=fy(),hy=G(),Oy=pi(),xt=H(),zs=K(),Ht=Z(),L2=xy(),Ay=Kn(),C2=Qn(),P2=qt(),We=!1;function D2(e){We&&B.breakpoint;let t=hy.Eval(B.cadr(e)),r=hy.Eval(B.caddr(e));return Or(t,r)}Ys.Eval_power=D2;function Or(e,t){return k2(e,t)}Ys.power=Or;function k2(e,t){We&&B.breakpoint;let r=t,n=e;if(We&&console.log(`POWER: ${e} ^ ${t}`),pl.equal(e,B.Constants.one)||xt.isZeroAtomOrTensor(t)){let d=B.Constants.One();return We&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}if(pl.equal(t,B.Constants.one))return We&&console.log(`   power of ${n} ^ ${r}: ${e}`),e;if(xt.isminusone(e)&&xt.isminusone(t)){let d=Ht.negate(B.Constants.One());return We&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}if(xt.isminusone(e)&&xt.isoneovertwo(t)){let d=B.Constants.imaginaryunit;return We&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}if(xt.isminusone(e)&&xt.isminusoneovertwo(t)){let d=Ht.negate(B.Constants.imaginaryunit);return We&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}let o;if(xt.isminusone(e)&&!B.isdouble(e)&&B.isrational(t)&&!xt.isinteger(t)&&xt.ispositivenumber(t)&&!B.defs.evaluatingAsFloats){We&&(console.log("   power: -1 ^ rational"),console.log(` trick: exponent.q.a , exponent.q.b ${t.q.a} , ${t.q.b}`)),t.q.a<t.q.b?o=zs.makeList(Yt.symbol(B.POWER),e,t):(o=zs.makeList(Yt.symbol(B.MULTIPLY),e,zs.makeList(Yt.symbol(B.POWER),e,Ar.rational(t.q.a.mod(t.q.b),t.q.b))),We&&console.log(` trick applied : ${o}`));let d=Ay.rect(o);return We&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}if(B.isrational(e)&&B.isrational(t)){We&&console.log("   power: isrational(base) && isrational(exponent)");let d=L2.qpow(e,t);return We&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}if(B.isNumericAtom(e)&&B.isNumericAtom(t)){let d=w2.dpow(Ar.nativeDouble(e),Ar.nativeDouble(t));return We&&(console.log("   power: both base and exponent are either rational or double "),console.log("POWER - isNumericAtom(base) && isNumericAtom(exponent)"),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}if(B.istensor(e)){let d=P2.power_tensor(e,t);return We&&(console.log("   power: istensor(base) "),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}if(B.car(e)===Yt.symbol(B.ABS)&&xt.iseveninteger(t)&&!xt.isZeroAtomOrTensor(Yt.get_binding(Yt.symbol(B.ASSUME_REAL_VARIABLES)))){let d=Or(B.cadr(e),t);return We&&(console.log("   power: even power of absolute of real value "),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}if(e===Yt.symbol(B.E)&&B.car(t)===Yt.symbol(B.LOG)){let d=B.cadr(t);return We&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}if(e===Yt.symbol(B.E)&&B.isdouble(t)){let d=Ar.double(Math.exp(t.d));return We&&(console.log("   power: base == symbol(E) && isdouble(exponent) "),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}if(e===Yt.symbol(B.E)&&ac.Find(t,B.Constants.imaginaryunit)&&ac.Find(t,Yt.symbol(B.PI))&&!B.defs.evaluatingPolar){let d=zs.makeList(Yt.symbol(B.POWER),e,t);We&&console.log(`   power: turning complex exponential to rect: ${d}`);let _=Ay.rect(d);if(!ac.Find(_,Yt.symbol(B.PI)))return We&&console.log(`   power: turned complex exponential to rect: ${_}`),_}if(B.ismultiply(e)&&xt.isinteger(t)){e=B.cdr(e);let d=Or(B.car(e),t);return B.iscons(e)&&(d=e.tail().reduce((_,R)=>Ht.multiply(_,Or(R,t)),d)),We&&(console.log("   power: (a * b) ^ c  ->  (a ^ c) * (b ^ c) "),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}let i=!1;if(B.isNumericAtom(B.cadr(e))&&(i=pl.sign(Ar.compare_numbers(B.cadr(e),B.Constants.zero))>0),B.ispower(e)&&(xt.isinteger(t)||i)){let d=Or(B.cadr(e),Ht.multiply(B.caddr(e),t));return We&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}let s=!1;if(xt.iseveninteger(B.caddr(e))){let d=Ht.multiply(B.caddr(e),t);xt.isone(d)&&(s=!0)}if(B.ispower(e)&&s){let d=py.abs(B.cadr(e));return We&&(console.log("   power: car(base) == symbol(POWER) && b_isEven_and_c_isItsInverse "),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}if(B.defs.expanding&&B.isadd(e)&&B.isNumericAtom(t)){let d=Ar.nativeInt(t);if(d>1&&!isNaN(d)){We&&console.log("   power: expanding && isadd(base) && isNumericAtom(exponent) ");let _=$2(d,e);return We&&console.log(`   power of ${n} ^ ${r}: ${_}`),_}}if(B.defs.trigmode===1&&B.car(e)===Yt.symbol(B.SIN)&&xt.iseveninteger(t)){let d=Or(lc.subtract(B.Constants.one,Or(R2.cosine(B.cadr(e)),Ar.integer(2))),Ht.multiply(t,Ar.rational(1,2)));return We&&(console.log("   power: trigmode == 1 && car(base) == symbol(SIN) && iseveninteger(exponent) "),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}if(B.defs.trigmode===2&&B.car(e)===Yt.symbol(B.COS)&&xt.iseveninteger(t)){let d=Or(lc.subtract(B.Constants.one,Or(C2.sine(B.cadr(e)),Ar.integer(2))),Ht.multiply(t,Ar.rational(1,2)));return We&&(console.log("   power: trigmode == 2 && car(base) == symbol(COS) && iseveninteger(exponent) "),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}if(xt.iscomplexnumber(e)){if(We&&console.log(" power - handling the case (a + ib) ^ n"),xt.isinteger(t)){let d=S2.conjugate(e),_=Ht.divide(d,Ht.multiply(d,e));return xt.isone(t)||(_=Or(_,Ht.negate(t))),We&&console.log(`   power of ${n} ^ ${r}: ${_}`),_}if(B.isNumericAtom(t)){let d=B.defs.evaluatingAsFloats||xt.iscomplexnumberdouble(e)&&B.isdouble(t)?Ar.double(Math.PI):Yt.symbol(B.PI),_=Ht.multiply(Or(py.abs(e),t),Or(B.Constants.negOne,Ht.divide(Ht.multiply(I2.arg(e),t),d)));return B.avoidCalculatingPowersIntoArctans&&ac.Find(_,Yt.symbol(B.ARCTAN))&&(_=zs.makeList(Yt.symbol(B.POWER),e,t)),We&&console.log(`   power of ${n} ^ ${r}: ${_}`),_}}let u=U2(t);if(u!==void 0)return We&&console.log("   power: using simplify_polar"),u;let c=zs.makeList(Yt.symbol(B.POWER),e,t);return We&&(console.log("   power: nothing can be done "),console.log(`   power of ${n} ^ ${r}: ${c}`)),c}function $2(e,t){let r=[],n=pl.length(t)-1,o=[];t=B.cdr(t);for(let i=0;i<n;i++){for(let s=0;s<=e;s++)o[i*(e+1)+s]=Or(B.car(t),Ar.integer(s));t=B.cdr(t)}t=Oy.factorial(Ar.integer(e));for(let i=0;i<n;i++)r[i]=0;return My(n,e,r,0,e,o,t,B.Constants.zero)}function My(e,t,r,n,o,i,s,u){if(n<e-1){for(let d=0;d<=o;d++)r[n]=d,u=My(e,t,r,n+1,o-d,i,s,u);return u}r[n]=o;let c=s;for(let d=0;d<e;d++)c=Ht.divide(c,Oy.factorial(Ar.integer(r[d])));for(let d=0;d<e;d++)c=Ht.multiply(c,i[d*(t+1)+r[d]]);return lc.add(u,c)}function U2(e){let t=xt.isquarterturn(e);switch(t){case 0:break;case 1:return B.Constants.one;case 2:return B.Constants.negOne;case 3:return B.Constants.imaginaryunit;case 4:return Ht.negate(B.Constants.imaginaryunit)}if(B.isadd(e)){let r=B.cdr(e);for(;B.iscons(r)&&(t=xt.isquarterturn(B.car(r)),!t);)r=B.cdr(r);let n;switch(t){case 0:return;case 1:n=B.Constants.one;break;case 2:n=B.Constants.negOne;break;case 3:n=B.Constants.imaginaryunit;break;case 4:n=Ht.negate(B.Constants.imaginaryunit);break}return Ht.multiply(n,pl.exponential(lc.subtract(e,B.car(r))))}}});var Z=A(St=>{"use strict";Object.defineProperty(St,"__esModule",{value:!0});St.negate_noexpand=St.negate=St.reciprocate=St.inverse=St.divide=St.multiply_all_noexpand=St.multiply_all=St.multiply_noexpand=St.multiply=St.Eval_multiply=void 0;var D=N(),B2=lo(),Iy=Ee(),$o=U(),G2=Ne(),Al=ue(),ao=F(),Ty=G(),lr=H(),Vs=K(),Sy=Et(),Ny=qt();function F2(e){let t=Ty.Eval(D.cadr(e));return e=D.cddr(e),D.iscons(e)&&(t=[...e].reduce((r,n)=>Uo(r,Ty.Eval(n)),t)),t}St.Eval_multiply=F2;function Uo(e,t){return D.defs.esc_flag&&Iy.stop("escape key stop"),D.isNumericAtom(e)&&D.isNumericAtom(t)?ao.multiply_numbers(e,t):j2(e,t)}St.multiply=Uo;function j2(e,t){if(lr.isZeroAtom(e)||lr.isZeroAtom(t))return D.Constants.Zero();if(D.defs.expanding&&D.isadd(e))return e.tail().reduce((c,d)=>Al.add(c,Uo(d,t)),D.Constants.Zero());if(D.defs.expanding&&D.isadd(t))return t.tail().reduce((c,d)=>Al.add(c,Uo(e,d)),D.Constants.Zero());if(!D.istensor(e)&&D.istensor(t))return Ny.scalar_times_tensor(e,t);if(D.istensor(e)&&!D.istensor(t))return Ny.tensor_times_scalar(e,t);e=D.ismultiply(e)?D.cdr(e):Vs.makeList(e),t=D.ismultiply(t)?D.cdr(t):Vs.makeList(t);let r=[];if(D.isNumericAtom(D.car(e))&&D.isNumericAtom(D.car(t))){let c=D.car(e),d=D.car(t);r.push(ao.multiply_numbers(c,d)),e=D.cdr(e),t=D.cdr(t)}else D.isNumericAtom(D.car(e))?(r.push(D.car(e)),e=D.cdr(e)):D.isNumericAtom(D.car(t))?(r.push(D.car(t)),t=D.cdr(t)):r.push(D.Constants.One());let[n,o]=uc(e),[i,s]=cc(t);for(;D.iscons(e)&&D.iscons(t);){if(D.caar(e)===$o.symbol(D.OPERATOR)&&D.caar(t)===$o.symbol(D.OPERATOR)){r.push(new D.Cons($o.symbol(D.OPERATOR),B2.append(D.cdar(e),D.cdar(t)))),e=D.cdr(e),t=D.cdr(t),[n,o]=uc(e),[i,s]=cc(t);continue}switch(G2.cmp_expr(n,i)){case-1:r.push(D.car(e)),e=D.cdr(e),[n,o]=uc(e);break;case 1:r.push(D.car(t)),t=D.cdr(t),[i,s]=cc(t);break;case 0:z2(r,i,o,s),e=D.cdr(e),t=D.cdr(t),[n,o]=uc(e),[i,s]=cc(t);break;default:Iy.stop("internal error 2")}}if(D.iscons(e)&&r.push(...e),D.iscons(t)&&r.push(...t),H2(r),D.defs.expanding){for(let c=0;c<r.length;c++)if(D.isadd(r[c]))return mm(r)}let u=r.length;return u===1?r.pop():D.isrational(r[0])&&lr.equaln(r[0],1)?u===2?r.pop():(r[0]=$o.symbol(D.MULTIPLY),Vs.makeList(...r)):new D.Cons($o.symbol(D.MULTIPLY),Vs.makeList(...r))}function uc(e){let t=D.car(e),r=D.Constants.One();return D.ispower(t)&&(r=D.caddr(t),t=D.cadr(t)),[t,r]}function cc(e){let t=D.car(e),r=D.Constants.One();return D.ispower(t)&&(r=D.caddr(t),t=D.cadr(t)),[t,r]}function z2(e,t,r,n){let o=Sy.power(t,Al.add(r,n));if(D.isNumericAtom(o))e[0]=ao.multiply_numbers(e[0],o);else if(D.ismultiply(o))if(D.isNumericAtom(D.cadr(o))&&D.cdddr(o)===$o.symbol(D.NIL)){let i=e[0],s=D.cadr(o);e[0]=ao.multiply_numbers(i,s),e.push(D.caddr(o))}else e.push(o);else e.push(o)}function Y2(e,t){return D.noexpand(Uo,e,t)}St.multiply_noexpand=Y2;function mm(e){if(e.length===1)return e[0];if(e.length===0)return D.Constants.One();let t=e[0];for(let r=1;r<e.length;r++)t=Uo(t,e[r]);return t}St.multiply_all=mm;function V2(e){return D.noexpand(mm,e)}St.multiply_all_noexpand=V2;function hl(e,t){return D.isNumericAtom(e)&&D.isNumericAtom(t)?ao.divide_numbers(e,t):Uo(e,_m(t))}St.divide=hl;function _m(e){return D.isNumericAtom(e)?ao.invert_number(e):Sy.power(e,D.Constants.negOne)}St.inverse=_m;function Z2(e){return _m(e)}St.reciprocate=Z2;function Ry(e){return D.isNumericAtom(e)?ao.negate_number(e):Uo(e,D.Constants.NegOne())}St.negate=Ry;function X2(e){return D.noexpand(Ry,e)}St.negate_noexpand=X2;function H2(e){let t=0;if(lr.isplusone(e[0])||lr.isminusone(e[0])||D.isdouble(e[0]))return;for(t=1;t<e.length&&!dm(e[t]);t++);if(t===e.length)return;let r=ao.mp_numerator(e[0]);for(let o=1;o<e.length&&!(lr.isplusone(r)||lr.isminusone(r));o++){if(!dm(e[o]))continue;let i=D.cadr(e[o]),s=D.caddr(e[o]);if(!lr.isnegativenumber(s))continue;let u=hl(r,i);!lr.isinteger(u)||(r=u,e[o]=Vs.makeList($o.symbol(D.POWER),i,Al.add(D.Constants.One(),s)))}let n=ao.mp_denominator(e[0]);for(let o=1;o<e.length&&!lr.isplusone(n);o++){if(!dm(e[o]))continue;let i=D.cadr(e[o]),s=D.caddr(e[o]);if(lr.isnegativenumber(s))continue;let u=hl(n,i);if(!lr.isinteger(u))continue;n=u;let c=Al.subtract(s,D.Constants.one);if(D.dontCreateNewRadicalsInDenominatorWhenEvalingMultiplication&&lr.isinteger(i)&&!lr.isinteger(c)&&lr.isnegativenumber(c)){r=hl(r,i);break}e[o]=Vs.makeList($o.symbol(D.POWER),i,c)}e[0]=hl(r,n)}function dm(e){return D.ispower(e)&&D.isNumericAtom(D.cadr(e))&&lr.isfraction(D.caddr(e))&&!lr.isminusone(D.cadr(e))}});var dc=A(Zs=>{"use strict";Object.defineProperty(Zs,"__esModule",{value:!0});Zs.determinant=Zs.det=void 0;var Bo=N(),wy=Ne(),Ly=ue(),Q2=F(),W2=K(),hi=Z(),J2=qt(),K2=U();function eA(e){if(!J2.is_square_matrix(e))return W2.makeList(K2.symbol(Bo.DET),e);let t=e.tensor.elem;return t.every(n=>Bo.isNumericAtom(n))?tA(e):Cy(t,e.tensor.dim[0])}Zs.det=eA;function Cy(e,t){let r=0,n=[];for(let s=0;s<t;s++)n[s]=s,n[s+t]=0,n[s+t+t]=1;let o=1,i=Bo.Constants.zero;for(;;){let s=Q2.integer(o);for(let R=0;R<t;R++){let T=t*n[R]+R;s=hi.multiply(s,e[T])}i=Ly.add(i,s);let u=t-1,c=0,d=!1;for(;;){if(r=n[t+u]+n[t+t+u],r<0){n[t+t+u]=-n[t+t+u],u--;continue}if(r===u+1){if(u===0){d=!0;break}c++,n[t+t+u]=-n[t+t+u],u--;continue}break}if(d)break;let _=n[u-n[t+u]+c];n[u-n[t+u]+c]=n[u-r+c],n[u-r+c]=_,n[t+u]=r,o=o===1?-1:1}return i}Zs.determinant=Cy;function tA(e){let t=e.tensor.dim[0],r=[...e.tensor.elem];return rA(r,t)}function Nn(e,t,r,n){return e[t*r+n]}function fc(e,t,r,n,o){e[t*r+n]=o}function rA(e,t){let r=Bo.Constants.one;for(let n=0;n<t-1;n++){if(wy.equal(Nn(e,t,n,n),Bo.Constants.zero)){let o=0;for(o=n+1;o<t&&wy.equal(Nn(e,t,o,n),Bo.Constants.zero);o++);if(o===t){r=Bo.Constants.zero;break}for(let i=n;i<t;i++){let s=Nn(e,t,n,i);fc(e,t,n,i,Nn(e,t,o,i)),fc(e,t,o,i,s)}r=hi.negate(r)}r=hi.multiply(r,Nn(e,t,n,n));for(let o=n+1;o<t;o++){let i=hi.negate(hi.divide(Nn(e,t,o,n),Nn(e,t,n,n)));fc(e,t,o,n,Bo.Constants.zero);for(let s=n+1;s<t;s++){let u=Ly.add(hi.multiply(Nn(e,t,n,s),i),Nn(e,t,o,s));fc(e,t,o,s,u)}}}return hi.multiply(r,Nn(e,t,t-1,t-1))}});var vm=A(mc=>{"use strict";Object.defineProperty(mc,"__esModule",{value:!0});mc.hermite=void 0;var Xs=N(),bm=U(),nA=ue(),ym=F(),oA=G(),iA=K(),gm=Z(),sA=Yr();function aA(e,t){return lA(e,t)}mc.hermite=aA;function lA(e,t){let r=ym.nativeInt(t);return r<0||isNaN(r)?iA.makeList(bm.symbol(Xs.HERMITE),e,t):Xs.issymbol(e)?Py(r,e):oA.Eval(sA.subst(Py(r,bm.symbol(Xs.SECRETX)),bm.symbol(Xs.SECRETX),e))}function Py(e,t){let r=Xs.Constants.zero,n=Xs.Constants.one;for(let o=0;o<e;o++){let i=r;r=n,n=gm.multiply(nA.subtract(gm.multiply(t,r),gm.multiply(ym.integer(o),i)),ym.integer(2))}return n}});var ky=A(_c=>{"use strict";Object.defineProperty(_c,"__esModule",{value:!0});_c.hilbert=void 0;var uA=N(),cA=Ne(),Dy=F(),fA=K(),dA=Z(),mA=U();function _A(e){let t=Dy.nativeInt(e);if(t<2)return fA.makeList(mA.symbol(uA.HILBERT),e);let r=cA.zero_matrix(t,t);for(let n=0;n<t;n++)for(let o=0;o<t;o++)r.tensor.elem[n*t+o]=dA.inverse(Dy.integer(n+o+1));return r}_c.hilbert=_A});var pm=A(Hs=>{"use strict";Object.defineProperty(Hs,"__esModule",{value:!0});Hs.cofactor=Hs.Eval_cofactor=void 0;var qm=N(),Em=Ee(),bA=dc(),xm=G(),gA=Z(),yA=qt();function vA(e){let t=xm.Eval(qm.cadr(e));yA.is_square_matrix(t)||Em.stop("cofactor: 1st arg: square matrix expected");let r=t.tensor.dim[0],n=xm.evaluate_integer(qm.caddr(e));(n<1||n>r)&&Em.stop("cofactor: 2nd arg: row index expected");let o=xm.evaluate_integer(qm.cadddr(e));return(o<1||o>r)&&Em.stop("cofactor: 3rd arg: column index expected"),$y(t,r,n-1,o-1)}Hs.Eval_cofactor=vA;function $y(e,t,r,n){let o=[];for(let s=0;s<t;s++)for(let u=0;u<t;u++)s!==r&&u!==n&&o.push(e.tensor.elem[t*s+u]);let i=bA.determinant(o,t-1);return(r+n)%2&&(i=gA.negate(i)),i}Hs.cofactor=$y});var hm=A(Qs=>{"use strict";Object.defineProperty(Qs,"__esModule",{value:!0});Qs.adj=Qs.Eval_adj=void 0;var qA=It(),EA=N(),xA=Ee(),pA=pm(),hA=G(),AA=qt();function OA(e){return Uy(hA.Eval(EA.cadr(e)))}Qs.Eval_adj=OA;function Uy(e){AA.is_square_matrix(e)||xA.stop("adj: square matrix expected");let t=e.tensor.dim[0],r=qA.alloc_tensor(t*t);r.tensor.ndim=2,r.tensor.dim[0]=t,r.tensor.dim[1]=t;for(let n=0;n<t;n++)for(let o=0;o<t;o++)r.tensor.elem[t*o+n]=pA.cofactor(e,t,n,o);return r}Qs.adj=Uy});var Go=A(Ws=>{"use strict";Object.defineProperty(Ws,"__esModule",{value:!0});Ws.inner=Ws.Eval_inner=void 0;var MA=It(),ce=N(),Om=Ee(),Zr=U(),Ol=ue(),Am=G(),Fy=Nl(),Ml=H(),Mm=K(),bc=Z(),By=qt();function jy(e){let t=[];t.push(ce.car(ce.cdr(e))),ce.car(ce.cdr(ce.cdr(e)))===Zr.symbol(ce.NIL)&&Om.stop("pattern needs at least a template and a transformed version");let n=ce.cdr(ce.cdr(e));for(;n!==Zr.symbol(ce.NIL);)t.push(ce.car(n)),n=ce.cdr(n);if(t.length>2){let s=Mm.makeList(Zr.symbol(ce.INNER),t[t.length-2],t[t.length-1]);for(let u=2;u<t.length;u++)s=Mm.makeList(Zr.symbol(ce.INNER),t[t.length-u-1],s);return jy(s)}let o=[];gc(e,o);let i=[];for(let s=0;s<o.length;s++)o[s]!==Zr.symbol(ce.SYMBOL_IDENTITY_MATRIX)&&i.push(o[s]);if(o=i,i=[],o.length>1){let s=0;for(let u=0;u<o.length&&u+s+1<=o.length-1;u++){if(ce.isNumericAtomOrTensor(o[u+s])||ce.isNumericAtomOrTensor(o[u+s+1]))i.push(o[u+s]);else{let c=Fy.inv(Am.Eval(o[u+s])),d=Am.Eval(o[u+s+1]),_=Ol.subtract(c,d);Ml.isZeroAtomOrTensor(_)?s+=1:i.push(o[u+s])}if(u+s===o.length-2&&i.push(o[o.length-1]),u+s>=o.length-1)break}o=i}return o.length==0?Zr.symbol(ce.SYMBOL_IDENTITY_MATRIX):(o=o.map(Am.Eval),o.reduce(Tl))}Ws.Eval_inner=jy;function Tl(e,t){if(Ml.isnegativeterm(t)&&Ml.isnegativeterm(e)&&(t=bc.negate(t),e=bc.negate(e)),ce.isinnerordot(e)&&(t=Tl(ce.car(ce.cdr(ce.cdr(e))),t),e=ce.car(ce.cdr(e))),e===Zr.symbol(ce.SYMBOL_IDENTITY_MATRIX))return t;if(t===Zr.symbol(ce.SYMBOL_IDENTITY_MATRIX))return e;if(ce.istensor(e)&&ce.istensor(t))return TA(e,t);if(!(ce.isNumericAtomOrTensor(e)||ce.isNumericAtomOrTensor(t))){let r=Ol.subtract(e,Fy.inv(t));if(Ml.isZeroAtomOrTensor(r))return Zr.symbol(ce.SYMBOL_IDENTITY_MATRIX)}return ce.defs.expanding&&ce.isadd(e)?e.tail().reduce((r,n)=>Ol.add(r,Tl(n,t)),ce.Constants.zero):ce.defs.expanding&&ce.isadd(t)?t.tail().reduce((r,n)=>Ol.add(r,Tl(e,n)),ce.Constants.zero):ce.istensor(e)&&ce.isNumericAtom(t)?By.tensor_times_scalar(e,t):ce.isNumericAtom(e)&&ce.istensor(t)?By.scalar_times_tensor(e,t):ce.isNumericAtom(e)||ce.isNumericAtom(t)?bc.multiply(e,t):Mm.makeList(Zr.symbol(ce.INNER),e,t)}Ws.inner=Tl;function TA(e,t){let r=e.tensor.dim[e.tensor.ndim-1];r!==t.tensor.dim[0]&&(ce.breakpoint,Om.stop("inner: tensor dimension check"));let n=e.tensor.ndim+t.tensor.ndim-2;n>ce.MAXDIM&&Om.stop("inner: rank of result exceeds maximum");let o=e.tensor.elem,i=t.tensor.elem,s=e.tensor.dim.slice(0,e.tensor.dim.length-1).reduce((_,R)=>_*R,1),u=t.tensor.dim.slice(1).reduce((_,R)=>_*R,1),c=MA.alloc_tensor(s*u),d=c.tensor.elem;for(let _=0;_<s;_++)for(let R=0;R<r;R++)if(!Ml.isZeroAtomOrTensor(o[_*r+R]))for(let T=0;T<u;T++)d[_*u+T]=Ol.add(bc.multiply(o[_*r+R],i[R*u+T]),d[_*u+T]);return n===0?c.tensor.elem[0]:(c.tensor.ndim=n,c.tensor.dim=[...e.tensor.dim.slice(0,e.tensor.ndim-1),...t.tensor.dim.slice(1,t.tensor.ndim)],c)}function gc(e,t){if(!ce.iscons(e)){Gy(e,t);return}if(ce.cdr(e)===Zr.symbol(ce.NIL)){gc(ce.car(e),t);return}if(ce.isinnerordot(e)){gc(ce.car(ce.cdr(e)),t),gc(ce.cdr(ce.cdr(e)),t);return}Gy(e,t)}function Gy(e,t){e!==Zr.symbol(ce.NIL)&&t.push(e)}});var Nl=A(Js=>{"use strict";Object.defineProperty(Js,"__esModule",{value:!0});Js.invg=Js.inv=void 0;var NA=It(),Mr=N(),Vy=Ee(),zy=Ne(),Yy=ue(),IA=hm(),SA=dc(),RA=Go(),wA=H(),Zy=K(),Il=Z(),Xy=qt(),Hy=U();function Qy(e){if(Mr.isinv(e))return Mr.car(Mr.cdr(e));if(Mr.isidentitymatrix(e))return e;if(Mr.defs.expanding&&Mr.isinnerordot(e)){let n=(Mr.iscons(e)?e.tail():[]).map(Qy);for(let o=n.length-1;o>0;o--)n[o-1]=RA.inner(n[o],n[o-1]);return n[0]}if(!Xy.is_square_matrix(e))return Zy.makeList(Hy.symbol(Mr.INV),e);if(Mr.isNumericAtomOrTensor(e))return Wy(e);let t=SA.det(e);return wA.isZeroAtomOrTensor(t)&&Vy.stop("inverse of singular matrix"),Il.divide(IA.adj(e),t)}Js.inv=Qy;function LA(e){return Xy.is_square_matrix(e)?Wy(e):Zy.makeList(Hy.symbol(Mr.INVG),e)}Js.invg=LA;function Wy(e){let t=e.tensor.dim[0],r=new Array(t*t);r.fill(Mr.Constants.zero);for(let i=0;i<t;i++)r[i*t+i]=Mr.Constants.one;let n=CA(r,e.tensor.elem,t),o=NA.alloc_tensor(t*t);return o.tensor.ndim=2,o.tensor.dim[0]=t,o.tensor.dim[1]=t,o.tensor.elem=n,o}function CA(e,t,r){for(let n=0;n<r;n++){if(zy.equal(t[r*n+n],Mr.Constants.zero)){let i=0;for(i=n+1;i<r&&zy.equal(t[r*i+n],Mr.Constants.zero);i++);i===r&&Vy.stop("inverse of singular matrix");for(let s=0;s<r;s++){let u=t[r*n+s];t[r*n+s]=t[r*i+s],t[r*i+s]=u,u=e[r*n+s],e[r*n+s]=e[r*i+s],e[r*i+s]=u}}let o=t[r*n+n];for(let i=0;i<r;i++)i>n&&(t[r*n+i]=Il.divide(t[r*n+i],o)),e[r*n+i]=Il.divide(e[r*n+i],o);for(let i=0;i<r;i++){if(i===n)continue;let s=t[r*i+n];for(let u=0;u<r;u++)u>n&&(t[r*i+u]=Yy.subtract(t[r*i+u],Il.multiply(t[r*n+u],s))),e[r*i+u]=Yy.subtract(e[r*i+u],Il.multiply(e[r*n+u],s))}}return e}});var Nm=A(Ks=>{"use strict";Object.defineProperty(Ks,"__esModule",{value:!0});Ks.besselj=Ks.Eval_besselj=void 0;var Qt=N(),PA=lo(),Sl=U(),yc=ue(),cn=F(),DA=Lo(),Jy=G(),Rl=H(),Tm=K(),ur=Z(),wl=Et(),kA=Qn();function $A(e){return vc(Jy.Eval(Qt.cadr(e)),Jy.Eval(Qt.caddr(e)))}Ks.Eval_besselj=$A;function vc(e,t){return UA(e,t)}Ks.besselj=vc;function UA(e,t){let r=cn.nativeInt(t);if(Qt.isdouble(e)&&!isNaN(r)){let n=PA.jn(r,e.d);return cn.double(n)}if(Rl.isZeroAtomOrTensor(e)&&Rl.isZeroAtomOrTensor(t))return Qt.Constants.one;if(Rl.isZeroAtomOrTensor(e)&&!isNaN(r))return Qt.Constants.zero;if(t.k===Qt.NUM&&Qt.MEQUAL(t.q.b,2)){if(Qt.MEQUAL(t.q.a,1)){let o=Qt.defs.evaluatingAsFloats?cn.double(2/Math.PI):ur.divide(cn.integer(2),Sl.symbol(Qt.PI));return ur.multiply(wl.power(ur.divide(o,e),cn.rational(1,2)),kA.sine(e))}if(Qt.MEQUAL(t.q.a,-1)){let o=Qt.defs.evaluatingAsFloats?cn.double(2/Math.PI):ur.divide(cn.integer(2),Sl.symbol(Qt.PI));return ur.multiply(wl.power(ur.divide(o,e),cn.rational(1,2)),DA.cosine(e))}let n=cn.integer(Qt.MSIGN(t.q.a));return yc.subtract(ur.multiply(ur.multiply(ur.divide(cn.integer(2),e),yc.subtract(t,n)),vc(e,yc.subtract(t,n))),vc(e,yc.subtract(t,ur.multiply(cn.integer(2),n))))}return Rl.isnegativeterm(e)?ur.multiply(ur.multiply(wl.power(ur.negate(e),t),wl.power(e,ur.negate(t))),Tm.makeList(Sl.symbol(Qt.BESSELJ),ur.negate(e),t)):Rl.isnegativeterm(t)?ur.multiply(wl.power(Qt.Constants.negOne,t),Tm.makeList(Sl.symbol(Qt.BESSELJ),e,ur.negate(t))):Tm.makeList(Sl.symbol(Qt.BESSELJ),e,t)}});var Im=A(ta=>{"use strict";Object.defineProperty(ta,"__esModule",{value:!0});ta.bessely=ta.Eval_bessely=void 0;var ea=N(),BA=lo(),Ky=U(),ev=F(),tv=G(),GA=H(),rv=K(),nv=Z(),FA=Et();function jA(e){return ov(tv.Eval(ea.cadr(e)),tv.Eval(ea.caddr(e)))}ta.Eval_bessely=jA;function ov(e,t){return zA(e,t)}ta.bessely=ov;function zA(e,t){let r=ev.nativeInt(t);if(ea.isdouble(e)&&!isNaN(r)){let n=BA.yn(r,e.d);return ev.double(n)}return GA.isnegativeterm(t)?nv.multiply(FA.power(ea.Constants.negOne,t),rv.makeList(Ky.symbol(ea.BESSELY),e,nv.negate(t))):rv.makeList(Ky.symbol(ea.BESSELY),e,t)}});var Sm=A(ra=>{"use strict";Object.defineProperty(ra,"__esModule",{value:!0});ra.ycosh=ra.Eval_cosh=void 0;var Ai=N(),iv=U(),YA=F(),VA=G(),ZA=H(),XA=K();function HA(e){return sv(VA.Eval(Ai.cadr(e)))}ra.Eval_cosh=HA;function sv(e){if(Ai.car(e)===iv.symbol(Ai.ARCCOSH))return Ai.cadr(e);if(Ai.isdouble(e)){let t=Math.cosh(e.d);return Math.abs(t)<1e-10&&(t=0),YA.double(t)}return ZA.isZeroAtomOrTensor(e)?Ai.Constants.one:XA.makeList(iv.symbol(Ai.COSH),e)}ra.ycosh=sv});var Cm=A(na=>{"use strict";Object.defineProperty(na,"__esModule",{value:!0});na.dirac=na.Eval_dirac=void 0;var Er=N(),Rm=U(),QA=G(),wm=H(),Lm=K(),WA=ln(),av=Z();function JA(e){return lv(QA.Eval(Er.cadr(e)))}na.Eval_dirac=JA;function lv(e){return KA(e)}na.dirac=lv;function KA(e){return Er.isdouble(e)?e.d===0?Er.Constants.one:Er.Constants.zero:Er.isrational(e)?Er.MZERO(WA.mmul(e.q.a,e.q.b))?Er.Constants.one:Er.Constants.zero:Er.ispower(e)?Lm.makeList(Rm.symbol(Er.DIRAC),Er.cadr(e)):wm.isnegativeterm(e)?Lm.makeList(Rm.symbol(Er.DIRAC),av.negate(e)):((wm.isnegativeterm(e)||Er.isadd(e)&&wm.isnegativeterm(Er.cadr(e)))&&(e=av.negate(e)),Lm.makeList(Rm.symbol(Er.DIRAC),e))}});var cv=A(qc=>{"use strict";Object.defineProperty(qc,"__esModule",{value:!0});qc.partition=void 0;var Pm=N(),eO=ir(),uv=Z();function tO(e,t){let r=Pm.Constants.one,n=r;if(e=Pm.cdr(e),!Pm.iscons(e))return[r,n];for(let o of e)eO.Find(o,t)?n=uv.multiply(n,o):r=uv.multiply(r,o);return[r,n]}qc.partition=tO});var Yo=A(aa=>{"use strict";Object.defineProperty(aa,"__esModule",{value:!0});aa.scan_meta=aa.scan=void 0;var rO=It(),Q=N(),Fo=lo(),nO=Ee(),dt=U(),fv=F(),oO=H(),Vt=K(),Ec=Z(),iO=qt(),Fm=1001,jm=1002,xc=1003,zm=1004,$m=1006,Ym=1007,mv=1008,_v=1009,bv=1010,gv=1011,Um=1012,ee="",Pl=0,Vm=0,Xr=0,W=0,ia=0,ft="",pc=null,Ze=null,Cl=null,zo=null,sa=null,Je=null,jo=!1,Bm=null,ge="";function sO(e){Q.DEBUG&&console.log(`#### scanning ${e}`),pc=null,Ze=[],Cl=[],zo=!0,sa=[],Je=[""],Bm=!1,ge=e,Vm=0;let t=Q.defs.expanding;if(Q.defs.expanding=!0,Xr=0,W=0,Ce(),ee==="")return Q.defs.expanding=t,[0,dt.symbol(Q.NIL)];let r=co();return Q.defs.expanding=t,Bm||(Q.defs.symbolsInExpressionsWithoutAssignments=Q.defs.symbolsInExpressionsWithoutAssignments.concat(Cl)),[ia-Xr,r]}aa.scan=sO;function aO(e){ge=e,Vm=1;let t=Q.defs.expanding;if(Q.defs.expanding=!0,Xr=0,W=0,Ce(),ee==="")return Q.defs.expanding=t,dt.symbol(Q.NIL);let r=co();return Q.defs.expanding=t,r}aa.scan_meta=aO;function co(){let e=dv(),t=!1;if(ee===Um&&(t=!0),ee===Um||ee==="="){let r=pc;Q.DEBUG&&console.log("assignment!"),Bm=!0,zo=!1,Ce();let n=dv();if(t&&(n=Vt.makeList(dt.symbol(Q.QUOTE),n)),e=Vt.makeList(dt.symbol(Q.SETQ),e,n),zo=!0,Q.defs.codeGen){let o=Ze.indexOf(r);if(o!==-1&&(Ze.splice(o,1),Q.defs.symbolsHavingReassignments.push(r)),Q.DEBUG){console.log(`locally, ${r} depends on: `);for(let s of Array.from(Ze))console.log(`  ${s}`)}Q.defs.symbolsDependencies[r]==null&&(Q.defs.symbolsDependencies[r]=[]);let i=Q.defs.symbolsDependencies[r];for(let s of Array.from(Ze))i.indexOf(s)===-1&&i.push(s);Ze=[]}}return e}function dv(){let e=uo(),t;switch(ee){case bv:return Ce(),t=uo(),Vt.makeList(dt.symbol(Q.TESTEQ),e,t);case gv:return Ce(),t=uo(),Vt.makeList(dt.symbol(Q.NOT),Vt.makeList(dt.symbol(Q.TESTEQ),e,t));case _v:return Ce(),t=uo(),Vt.makeList(dt.symbol(Q.TESTLE),e,t);case mv:return Ce(),t=uo(),Vt.makeList(dt.symbol(Q.TESTGE),e,t);case"<":return Ce(),t=uo(),Vt.makeList(dt.symbol(Q.TESTLT),e,t);case">":return Ce(),t=uo(),Vt.makeList(dt.symbol(Q.TESTGT),e,t)}return e}function uo(){let e=[dt.symbol(Q.ADD)];switch(ee){case"+":Ce(),e.push(Ll());break;case"-":Ce(),e.push(Ec.negate(Ll()));break;default:e.push(Ll())}for(;Pl===0&&(ee==="+"||ee==="-");)ee==="+"?(Ce(),e.push(Ll())):(Ce(),e.push(Ec.negate(Ll())));return e.length===2?e[1]:Vt.makeList(...e)}function Zm(){if(typeof ee=="string")return ee.charCodeAt(0)}function lO(){if(Zm()===Q.dotprod_unicode)return!0;switch(ee){case"*":case"/":return!0;case"(":case xc:case zm:case Fm:case jm:case Ym:return Pl?(W=ia,!1):!0}return!1}function Dm(e){e.length>0&&Q.isrational(e[e.length-1])&&oO.equaln(e[e.length-1],1)&&e.pop()}function uO(e){if(e.length>1&&Q.isNumericAtom(e[e.length-2])&&Q.isNumericAtom(e[e.length-1])){let t=e.pop(),r=e.pop();e.push(Ec.multiply(r,t))}}function Ll(){let e=[oa()];for(Q.parse_time_simplifications&&Dm(e);lO();)ee==="*"?(Ce(),e.push(oa())):ee==="/"?(Dm(e),Ce(),e.push(Ec.inverse(oa()))):Zm()===Q.dotprod_unicode?(Ce(),e.push(Vt.makeList(dt.symbol(Q.INNER),e.pop(),oa()))):e.push(oa()),Q.parse_time_simplifications&&(uO(e),Dm(e));return e.length===0?Q.Constants.one:e.length==1?e[0]:Vt.makeList(dt.symbol(Q.MULTIPLY),...e)}function cO(e){return ee==="^"?(Ce(),Vt.makeList(dt.symbol(Q.POWER),e,oa())):e}function fO(e){Ce();let t=[dt.symbol(Q.INDEX),e,uo()];for(;ee===",";)Ce(),t.push(uo());return ee!=="]"&&In("] expected"),Ce(),Vt.makeList(...t)}function oa(){let e=!1,t;for(ee==="("?t=yO():ee===xc?t=mO():ee===zm?t=bO():ee==="["?t=vO():ee===Fm?(e=!0,t=fv.bignum_scan_integer(ft),ee=Ce()):ee===jm?(e=!0,t=fv.bignum_scan_float(ft),ee=Ce()):ee===Ym?t=_O():In("syntax error");ee==="["||ee==="("&&Pl===0&&!e;)ee==="["?t=fO(t):ee==="("&&(t=gO(t));for(;ee==="!";)Ce(),t=Vt.makeList(dt.symbol(Q.FACTORIAL),t);for(;Zm()===Q.transpose_unicode;)Ce(),t=Vt.makeList(dt.symbol(Q.TRANSPOSE),t);return cO(t)}function Gm(e){if(Q.predefinedSymbolsInGlobalScope_doNotTrackInDependencies.indexOf(e)===-1&&Ze.indexOf(e)===-1&&Ze.indexOf("'"+e)===-1&&!jo){Q.DEBUG&&console.log(`... adding symbol: ${e} to the set of the symbols right of assignment`);let t="";for(let r=1;r<Je.length;r++)Je[r]!==""&&(t+=Je[r]+"_"+r+"_");e=t+e,Ze.push(e)}}function dO(e){if(Q.predefinedSymbolsInGlobalScope_doNotTrackInDependencies.indexOf(e)===-1&&Cl.indexOf(e)===-1&&Cl.indexOf("'"+e)===-1&&!jo){Q.DEBUG&&console.log(`... adding symbol: ${e} to the set of the symbols left of assignment`);let t="";for(let r=1;r<Je.length;r++)Je[r]!==""&&(t+=Je[r]+"_"+r+"_");e=t+e,Cl.push(e)}}function mO(){ee!==xc&&In("symbol expected");let e;if(Vm&&typeof ft=="string"&&ft.length===1)switch(ft[0]){case"a":e=dt.symbol(Q.METAA);break;case"b":e=dt.symbol(Q.METAB);break;case"x":e=dt.symbol(Q.METAX);break;default:e=dt.usr_symbol(ft)}else e=dt.usr_symbol(ft);return sa.length===0?(Q.DEBUG&&console.log(`out of scanning parameters, processing ${ft}`),pc=ft,zo&&dO(ft)):(Q.DEBUG&&console.log(`still scanning parameters, skipping ${ft}`),zo&&Gm("'"+ft)),Q.DEBUG&&console.log(`found symbol: ${ft} left of assignment: ${zo}`),zo||Gm(ft),Ce(),e}function _O(){let e=new Q.Str(ft);return Ce(),e}function bO(){Q.DEBUG&&console.log("-- scan_function_call_with_function_name start");let e=1,r=[dt.usr_symbol(ft)],n=ft;if((n==="roots"||n==="defint"||n==="sum"||n==="product"||n==="for")&&Je.push(ft),pc=ft,zo||Gm(ft),Ce(),Ce(),sa.push(!0),ee!==")"){for(r.push(co()),e++;ee===",";)Ce(),e===2&&Je[Je.length-1].indexOf("roots")!==-1&&(Ze=Ze.filter(o=>!new RegExp("roots_"+(Je.length-1)+"_"+ft).test(o)),jo=!0),e===2&&Je[Je.length-1].indexOf("sum")!==-1&&(Ze=Ze.filter(o=>!new RegExp("sum_"+(Je.length-1)+"_"+ft).test(o)),jo=!0),e===2&&Je[Je.length-1].indexOf("product")!==-1&&(Ze=Ze.filter(o=>!new RegExp("product_"+(Je.length-1)+"_"+ft).test(o)),jo=!0),e===2&&Je[Je.length-1].indexOf("for")!==-1&&(Ze=Ze.filter(o=>!new RegExp("for_"+(Je.length-1)+"_"+ft).test(o)),jo=!0),Je[Je.length-1].indexOf("defint")!==-1&&(e===2||e>2&&(e-2)%3===0)&&(Ze=Ze.filter(o=>!new RegExp("defint_"+(Je.length-1)+"_"+ft).test(o)),jo=!0),r.push(co()),jo=!1,e++;e===2&&Je[Je.length-1].indexOf("roots")!==-1&&(Ze=Ze.filter(o=>!new RegExp("roots_"+(Je.length-1)+"_x").test(o)))}sa.pop();for(let o=0;o<=Ze.length;o++)Ze[o]!=null&&(n==="roots"&&(Ze[o]=Ze[o].replace(new RegExp("roots_"+(Je.length-1)+"_"),"")),n==="defint"&&(Ze[o]=Ze[o].replace(new RegExp("defint_"+(Je.length-1)+"_"),"")),n==="sum"&&(Ze[o]=Ze[o].replace(new RegExp("sum_"+(Je.length-1)+"_"),"")),n==="product"&&(Ze[o]=Ze[o].replace(new RegExp("product_"+(Je.length-1)+"_"),"")),n==="for"&&(Ze[o]=Ze[o].replace(new RegExp("for_"+(Je.length-1)+"_"),"")));return ee!==")"&&In(") expected"),Ce(),(n==="roots"||n==="defint"||n==="sum"||n==="product"||n==="for")&&Je.pop(),n===dt.symbol(Q.PATTERN).printname&&(Q.defs.patternHasBeenFound=!0),Q.DEBUG&&console.log("-- scan_function_call_with_function_name end"),Vt.makeList(...r)}function gO(e){Q.DEBUG&&console.log("-- scan_function_call_without_function_name start");let r=[Vt.makeList(dt.symbol(Q.EVAL),e)];if(Ce(),sa.push(!0),ee!==")")for(r.push(co());ee===",";)Ce(),r.push(co());return sa.pop(),ee!==")"&&In(") expected"),Ce(),Q.DEBUG&&console.log(`-- scan_function_call_without_function_name end: ${r[r.length-1]}`),Vt.makeList(...r)}function yO(){ee!=="("&&In("( expected"),ee=Ce();let t=co();return ee!==")"&&In(") expected"),Ce(),t}function vO(){ee!=="["&&In("[ expected"),Ce();let e=[co()];for(;ee===",";)ee=Ce(),e.push(co());let t=qO(e);return ee!=="]"&&In("] expected"),Ce(),t}function In(e){for(Q.defs.errorMessage="";Xr!==W&&!((ge[Xr]===`
`||ge[Xr]==="\r")&&Xr+1===W);)Q.defs.errorMessage+=ge[Xr++];for(Q.defs.errorMessage+=" ? ";ge[Xr]&&ge[Xr]!==`
`&&ge[Xr]!=="\r";)Q.defs.errorMessage+=ge[Xr++];Q.defs.errorMessage+=`
`,nO.stop(e)}function qO(e){let t=rO.alloc_tensor(e.length);t.tensor.ndim=1,t.tensor.dim[0]=e.length;for(let r=0;r<e.length;r++)t.tensor.elem[r]=e[r];return iO.check_tensor_dimensions(t),t}function Ce(){for(Pl=0;EO(),ee===$m;)Pl=1;return Q.DEBUG&&console.log(`get_next_token token: ${ee}`),ee}function EO(){for(;Fo.isspace(ge[W]);){if(ge[W]===`
`||ge[W]==="\r"){ee=$m,W++;return}W++}if(ia=W,W===ge.length){ee="";return}if(Fo.isdigit(ge[W])||ge[W]==="."){for(;Fo.isdigit(ge[W]);)W++;if(ge[W]==="."){for(W++;Fo.isdigit(ge[W]);)W++;if(ge[W]==="e"&&(ge[W+1]==="+"||ge[W+1]==="-"||Fo.isdigit(ge[W+1])))for(W+=2;Fo.isdigit(ge[W]);)W++;ee=jm}else ee=Fm;km(ia,W);return}if(Fo.isalpha(ge[W])){for(;Fo.isalnumorunderscore(ge[W]);)W++;ge[W]==="("?ee=zm:ee=xc,km(ia,W);return}if(ge[W]==='"'){for(W++;ge[W]!=='"';)W===ge.length-1&&(W++,In("runaway string"),W--),W++;W++,ee=Ym,km(ia+1,W-1);return}if(ge[W]==="#"||ge[W]==="-"&&ge[W+1]==="-"){for(;ge[W]&&ge[W]!==`
`&&ge[W]!=="\r";)W++;ge[W]&&W++,ee=$m;return}if(ge[W]===":"&&ge[W+1]==="="){W+=2,ee=Um;return}if(ge[W]==="="&&ge[W+1]==="="){W+=2,ee=bv;return}if(ge[W]==="!"&&ge[W+1]==="="){W+=2,ee=gv;return}if(ge[W]==="<"&&ge[W+1]==="="){W+=2,ee=_v;return}if(ge[W]===">"&&ge[W+1]==="="){W+=2,ee=mv;return}ee=ge[W++]}function km(e,t){ft=ge.substring(e,t)}});var Rn=A(Vo=>{"use strict";Object.defineProperty(Vo,"__esModule",{value:!0});Vo.yyfloat=Vo.zzfloat=Vo.Eval_float=void 0;var YB=Ac(),Sn=N(),VB=Ee(),yv=U(),vv=F(),hc=G(),xO=K(),pO=qt();function hO(e){return Sn.evalFloats(()=>hc.Eval(Hm(hc.Eval(Sn.cadr(e)))))}Vo.Eval_float=hO;function AO(e){return Sn.evalFloats(()=>{e=hc.Eval(e),e=Hm(e),e=hc.Eval(e)}),e}Vo.zzfloat=AO;function Hm(e){return Sn.evalFloats(Xm,e)}Vo.yyfloat=Hm;function Xm(e){return Sn.iscons(e)?xO.makeList(...e.map(Xm)):Sn.istensor(e)?(e=pO.copy_tensor(e),e.tensor.elem=e.tensor.elem.map(Xm),e):Sn.isrational(e)?vv.bignum_float(e):e===yv.symbol(Sn.PI)?Sn.Constants.piAsDouble:e===yv.symbol(Sn.E)?vv.double(Math.E):e}});var Qm=A(ua=>{"use strict";Object.defineProperty(ua,"__esModule",{value:!0});ua.roots=ua.Eval_roots=void 0;var OO=It(),we=N(),xv=Ee(),cr=U(),MO=Ne(),Oc=on(),he=ue(),j=F(),TO=gi(),la=G(),NO=Es(),IO=Vr(),_r=H(),M=Z(),Xe=Et(),Wt=Zo(),nt={debug:e=>{we.DEBUG&&console.log(e)}},SO=e=>[].concat(...e);function RO(e){let t=we.cadr(e),r;we.car(t)===cr.symbol(we.SETQ)||we.car(t)===cr.symbol(we.TESTEQ)?r=he.subtract(la.Eval(we.cadr(t)),la.Eval(we.caddr(t))):(t=la.Eval(t),we.car(t)===cr.symbol(we.SETQ)||we.car(t)===cr.symbol(we.TESTEQ)?r=he.subtract(la.Eval(we.cadr(t)),la.Eval(we.caddr(t))):r=t),t=la.Eval(we.caddr(e));let n=t===cr.symbol(we.NIL)?IO.guess(r):t;return _r.ispolyexpandedform(r,n)||xv.stop("roots: 1st argument is not a polynomial in the variable "+n),Dl(r,n)}ua.Eval_roots=RO;function wO(e){return e.some(t=>_r.iscomplexnumber(t))}function LO(e){return e.length<=2||_r.isZeroAtomOrTensor(e[0])?!1:e.slice(1,e.length-1).every(t=>_r.isZeroAtomOrTensor(t))}function Mc(e,t){let r=TO.coeff(e,t),n=r[r.length-1];return r.map(o=>M.divide(o,n))}function Dl(e,t){if(we.defs.recursionLevelNestedRadicalsRemoval>1)return cr.symbol(we.NIL);nt.debug(`checking if ${e} is a case of simple roots`);let r=Mc(e,t),n=[];if(LO(r)){nt.debug(`yes, ${r[r.length-1]} is a case of simple roots`);let s=r.length,u=r[0],c=r.pop(),d=CO(s,c,u);n.push(...d)}else{let s=PO(e,t);n.push(...s)}let o=n.length;if(o===0&&xv.stop("roots: the polynomial is not factorable, try nroots"),o===1)return n[0];MO.sort(n);let i=OO.alloc_tensor(o);i.tensor.ndim=1,i.tensor.dim[0]=o;for(let s=0;s<o;s++)i.tensor.elem[s]=n[s];return console.log(`roots returning ${i}`),i}ua.roots=Dl;function CO(e,t,r){nt.debug("getSimpleRoots"),e=e-1;let n=M.divide(Xe.power(r,j.rational(1,e)),Xe.power(t,j.rational(1,e))),o=[];if(e%2===0){for(let i=1;i<=e;i+=2){let s=M.multiply(n,Xe.power(we.Constants.negOne,j.rational(i,e)));o.push(s),o.push(M.negate(s))}return o}for(let i=1;i<=e;i++){let s=M.multiply(n,Xe.power(we.Constants.negOne,j.rational(i,e)));i%2===0&&(s=M.negate(s)),o.push(s)}return o}function PO(e,t){let r=Mc(e,t);if(wO(r)||(e=NO.factorpoly(e,t)),we.ismultiply(e)){let n=e.tail().map(o=>qv(o,t));return SO(n)}return qv(e,t)}function qv(e,t){if(we.ispower(e)&&_r.ispolyexpandedform(we.cadr(e),t)&&_r.isposint(we.caddr(e))){let r=Mc(we.cadr(e),t);return Ev(r)}if(_r.ispolyexpandedform(e,t)){let r=Mc(e,t);return Ev(r)}return[]}function Ev(e){let t=e.length;if(t===2){let r=e.pop(),n=e.pop();return DO(r,n)}if(t===3){let r=e.pop(),n=e.pop(),o=e.pop();return kO(r,n,o)}if(t===4){let r=e.pop(),n=e.pop(),o=e.pop(),i=e.pop();return $O(r,n,o,i)}if(t===5){let r=e.pop(),n=e.pop(),o=e.pop(),i=e.pop(),s=e.pop();return BO(r,n,o,i,s)}return[]}function DO(e,t){return[M.negate(M.divide(t,e))]}function kO(e,t,r){let n=Xe.power(he.subtract(Xe.power(t,j.integer(2)),M.multiply(M.multiply(j.integer(4),e),r)),j.rational(1,2)),o=M.divide(he.subtract(n,t),M.multiply(e,j.integer(2))),i=M.multiply(M.divide(M.negate(he.add(n,t)),e),j.rational(1,2));return[o,i]}function $O(e,t,r,n){let o=M.multiply(M.multiply(r,r),r),i=M.multiply(t,t),s=M.multiply(i,t),u=M.multiply(M.multiply(s,n),j.integer(-4)),c=M.multiply(s,j.integer(2)),d=M.multiply(j.integer(3),e),_=M.multiply(M.multiply(e,e),n),R=M.multiply(_,j.integer(27)),T=M.multiply(M.multiply(_,n),j.integer(-27)),k=M.multiply(M.multiply(e,r),t),V=M.multiply(M.multiply(e,r),j.integer(3)),z=M.multiply(j.integer(-4),M.multiply(e,o)),Ae=M.negate(M.multiply(k,j.integer(9))),et=M.multiply(M.multiply(k,n),j.integer(18)),Ve=he.subtract(i,V),De=M.multiply(i,M.multiply(r,r)),it=M.divide(M.negate(t),d),Oe=M.multiply(Xe.power(Ve,j.integer(3)),j.integer(4)),st=Oc.absValFloat(Wt.simplify(Ve)),or=Oc.absValFloat(Wt.simplify(he.add_all([et,u,De,z,T]))),Bt=he.add_all([c,Ae,R]),vr=Wt.simplify(Xe.power(he.subtract(Xe.power(Bt,j.integer(2)),Oe),j.rational(1,2)));if(nt.debug(">>>>>>>>>>>>>>>> actually using cubic formula <<<<<<<<<<<<<<< "),nt.debug(`cubic: D0: ${Ve}`),nt.debug(`cubic: D0 as float: ${st}`),nt.debug(`cubic: DETERMINANT: ${or}`),nt.debug(`cubic: D1: ${Bt}`),_r.isZeroAtomOrTensor(or))return UO(e,t,r,n,{R_DELTA0_toBeCheckedIfZero:st,R_m_b_over_3a:it,R_DELTA0:Ve,R_b3:s,R_a_b_c:k});let Nt=!1,ci=!1,Yn;for(;!Nt;){let ol=ci?M.negate(vr):vr;Yn=Wt.simplify(Xe.power(M.multiply(he.add(ol,Bt),j.rational(1,2)),j.rational(1,3)));let os=Oc.absValFloat(Wt.simplify(Yn));nt.debug(`cubic: C: ${Yn}`),nt.debug(`cubic: C as absval and float: ${os}`),_r.isZeroAtomOrTensor(os)?(nt.debug(" cubic: C IS ZERO flipping the sign"),ci=!0):Nt=!0}let Ka=M.multiply(M.multiply(Yn,d),j.integer(2)),Eu=M.multiply(we.Constants.imaginaryunit,Xe.power(j.integer(3),j.rational(1,2))),xu=he.add(we.Constants.one,Eu),el=he.subtract(we.Constants.one,Eu),rn=M.divide(Yn,d),Vn=it,pu=M.negate(rn),tl=M.negate(M.divide(Ve,M.multiply(Yn,d))),nn=Wt.simplify(he.add_all([Vn,pu,tl])),fi=it,Zn=M.divide(M.multiply(rn,xu),j.integer(2)),hu=M.divide(M.multiply(el,Ve),Ka),rl=Wt.simplify(he.add_all([fi,Zn,hu])),nl=it,Nd=M.divide(M.multiply(rn,el),j.integer(2)),ns=M.divide(M.multiply(xu,Ve),Ka),Au=Wt.simplify(he.add_all([nl,Nd,ns]));return[nn,rl,Au]}function UO(e,t,r,n,o){let{R_DELTA0_toBeCheckedIfZero:i,R_m_b_over_3a:s,R_DELTA0:u,R_b3:c,R_a_b_c:d}=o;if(_r.isZeroAtomOrTensor(i))return nt.debug(" cubic: DETERMINANT IS ZERO and delta0 is zero"),[s];nt.debug(" cubic: DETERMINANT IS ZERO and delta0 is not zero");let _=M.divide(he.subtract(M.multiply(e,M.multiply(n,j.integer(9))),M.multiply(t,r)),M.multiply(u,j.integer(2))),R=M.negate(c),T=M.negate(M.multiply(e,M.multiply(e,M.multiply(n,j.integer(9))))),k=M.multiply(d,j.integer(4)),V=M.divide(he.add_all([k,T,R]),M.multiply(e,u));return[_,_,V]}function BO(e,t,r,n,o){return nt.debug(">>>>>>>>>>>>>>>> actually using quartic formula <<<<<<<<<<<<<<< "),_r.isZeroAtomOrTensor(t)&&_r.isZeroAtomOrTensor(n)&&!_r.isZeroAtomOrTensor(r)&&!_r.isZeroAtomOrTensor(o)?GO(e,t,r,n,o):_r.isZeroAtomOrTensor(t)?FO(e,t,r,n,o):jO(e,t,r,n,o)}function GO(e,t,r,n,o){nt.debug("biquadratic case");let i=Dl(he.add(M.multiply(e,Xe.power(cr.symbol(we.SECRETX),j.integer(2))),he.add(M.multiply(r,cr.symbol(we.SECRETX)),o)),cr.symbol(we.SECRETX)),s=[];for(let u of i.tensor.elem)s.push(Wt.simplify(Xe.power(u,j.rational(1,2)))),s.push(Wt.simplify(M.negate(Xe.power(u,j.rational(1,2)))));return s}function FO(e,t,r,n,o){let i=r,s=n,u=o,c=M.multiply(j.rational(5,2),i),d=he.subtract(M.multiply(j.integer(2),Xe.power(i,j.integer(2))),u),_=he.add(M.multiply(j.rational(-1,2),M.multiply(i,u)),he.add(M.divide(Xe.power(i,j.integer(3)),j.integer(2)),M.multiply(j.rational(-1,8),Xe.power(s,j.integer(2))))),R=he.add(Xe.power(cr.symbol(we.SECRETX),j.integer(3)),he.add(M.multiply(c,Xe.power(cr.symbol(we.SECRETX),j.integer(2))),he.add(M.multiply(d,cr.symbol(we.SECRETX)),_)));nt.debug(`resolventCubic: ${R}`);let T=Dl(R,cr.symbol(we.SECRETX));nt.debug(`resolventCubicSolutions: ${T}`);let k=null;for(let vr of T.tensor.elem){nt.debug(`examining solution: ${vr}`);let Nt=Oc.absValFloat(he.add(M.multiply(vr,j.integer(2)),i));if(nt.debug(`abs value is: ${vr}`),!_r.isZeroAtomOrTensor(Nt)){k=vr;break}}nt.debug(`chosen solution: ${k}`);let V=Wt.simplify(Xe.power(he.add(M.multiply(k,j.integer(2)),i),j.rational(1,2))),z=Wt.simplify(M.divide(M.multiply(s,j.integer(2)),V)),Ae=he.add(M.multiply(i,j.integer(3)),M.multiply(k,j.integer(2))),et=Wt.simplify(Xe.power(M.negate(he.add(Ae,z)),j.rational(1,2))),Ve=M.divide(he.add(V,et),j.integer(2)),De=Wt.simplify(Xe.power(M.negate(he.add(Ae,z)),j.rational(1,2))),it=M.divide(he.subtract(V,De),j.integer(2)),Oe=Wt.simplify(Xe.power(M.negate(he.subtract(Ae,z)),j.rational(1,2))),st=M.divide(he.add(M.negate(V),Oe),j.integer(2)),or=Wt.simplify(Xe.power(M.negate(he.subtract(Ae,z)),j.rational(1,2))),Bt=M.divide(he.subtract(M.negate(V),or),j.integer(2));return[Ve,it,st,Bt]}function jO(e,t,r,n,o){let i=M.divide(he.add(M.multiply(j.integer(8),M.multiply(r,e)),M.multiply(j.integer(-3),Xe.power(t,j.integer(2)))),M.multiply(j.integer(8),Xe.power(e,j.integer(2)))),s=M.divide(he.add(Xe.power(t,j.integer(3)),he.add(M.multiply(j.integer(-4),M.multiply(e,M.multiply(t,r))),M.multiply(j.integer(8),M.multiply(n,Xe.power(e,j.integer(2)))))),M.multiply(j.integer(8),Xe.power(e,j.integer(3)))),u=M.multiply(M.multiply(e,e),e),c=M.multiply(t,t),d=M.multiply(M.multiply(e,e),n),_=M.divide(he.add(M.multiply(Xe.power(t,j.integer(4)),j.integer(-3)),he.add(M.multiply(j.integer(256),M.multiply(u,o)),he.add(M.multiply(j.integer(-64),M.multiply(d,t)),M.multiply(j.integer(16),M.multiply(c,M.multiply(e,r)))))),M.multiply(j.integer(256),Xe.power(e,j.integer(4)))),R=Xe.power(cr.symbol(we.SECRETX),j.integer(4)),T=M.multiply(i,Xe.power(cr.symbol(we.SECRETX),j.integer(2))),k=M.multiply(s,cr.symbol(we.SECRETX)),V=Wt.simplify(he.add_all([R,T,k,_])),z=Dl(V,cr.symbol(we.SECRETX));return nt.debug(`p for depressed quartic: ${i}`),nt.debug(`q for depressed quartic: ${s}`),nt.debug(`r for depressed quartic: ${_}`),nt.debug(`4 * x^4: ${R}`),nt.debug(`R_p * x^2: ${T}`),nt.debug(`R_q * x: ${k}`),nt.debug(`R_r: ${_}`),nt.debug(`solving depressed quartic: ${V}`),nt.debug(`depressedSolutions: ${z}`),z.tensor.elem.map(Ae=>{let et=Wt.simplify(he.subtract(Ae,M.divide(t,M.multiply(j.integer(4),e))));return nt.debug(`solution from depressed: ${et}`),et})}});var Av=A(Nc=>{"use strict";Object.defineProperty(Nc,"__esModule",{value:!0});Nc.simfac=void 0;var _e=N(),Wm=U(),pv=Ne(),Xo=ue(),HB=G(),Tc=pi(),fn=H(),ca=Z();function zO(e){if(_e.isadd(e)){let t=e.tail().map(hv);return Xo.add_all(t)}return hv(e)}Nc.simfac=zO;function hv(e){if(!_e.ismultiply(e))return e;let t=e.tail();for(;YO(t););return ca.multiply_all_noexpand(t)}function YO(e){for(let t=0;t<e.length;t++){let r=e[t];for(let n=0;n<e.length;n++){if(t===n)continue;let o=e[n];if(_e.isfactorial(r)&&_e.ispower(o)&&fn.isminusone(_e.caddr(o))&&pv.equal(_e.cadr(r),_e.cadr(o)))return e[t]=Tc.factorial(Xo.subtract(_e.cadr(r),_e.Constants.one)),e[n]=_e.Constants.one,!0;if(_e.ispower(o)&&fn.isminusone(_e.caddr(o))&&_e.caadr(o)===Wm.symbol(_e.FACTORIAL)&&pv.equal(r,_e.cadadr(o)))return e[t]=ca.reciprocate(Tc.factorial(Xo.add(r,_e.Constants.negOne))),e[n]=_e.Constants.one,!0;if(_e.isfactorial(o)){let i=Xo.subtract(r,_e.cadr(o));if(fn.isplusone(i))return e[t]=Tc.factorial(r),e[n]=_e.Constants.one,!0}if(_e.ispower(r)&&fn.isminusone(_e.caddr(r))&&_e.ispower(o)&&fn.isminusone(_e.caddr(o))&&_e.caadr(o)===Wm.symbol(_e.FACTORIAL)){let i=Xo.subtract(_e.cadr(r),_e.cadr(_e.cadr(o)));if(fn.isplusone(i))return e[t]=ca.reciprocate(Tc.factorial(_e.cadr(r))),e[n]=_e.Constants.one,!0}if(_e.isfactorial(r)&&_e.ispower(o)&&fn.isminusone(_e.caddr(o))&&_e.caadr(o)===Wm.symbol(_e.FACTORIAL)){let i=Xo.subtract(_e.cadr(r),_e.cadr(_e.cadr(o)));if(fn.isplusone(i))return e[t]=_e.cadr(r),e[n]=_e.Constants.one,!0;if(fn.isminusone(i))return e[t]=ca.reciprocate(_e.cadr(_e.cadr(o))),e[n]=_e.Constants.one,!0;if(fn.equaln(i,2))return e[t]=_e.cadr(r),e[n]=Xo.add(_e.cadr(r),_e.Constants.negOne),!0;if(fn.equaln(i,-2))return e[t]=ca.reciprocate(_e.cadr(_e.cadr(o))),e[n]=ca.reciprocate(Xo.add(_e.cadr(_e.cadr(o)),_e.Constants.negOne)),!0}}}return!1}});var Jm=A(fa=>{"use strict";Object.defineProperty(fa,"__esModule",{value:!0});fa.decomp=fa.Eval_decomp=void 0;var je=N(),kl=ir(),Ov=U(),Tv=Ne(),VO=ue(),Mv=G(),ZO=Vr(),XO=K(),Nv=Z();function HO(e){console.log("Eval_decomp is being called!!!!!!!!!!!!!!!!!!!!");let t=Mv.Eval(je.cadr(e));e=Mv.Eval(je.caddr(e));let r=e===Ov.symbol(je.NIL)?ZO.guess(t):e,n=$l(!1,t,r);return XO.makeList(Ov.symbol(je.NIL),...n)}fa.Eval_decomp=HO;function QO(e,t){return e.length>0&&Tv.equal(t,e[e.length-1])?!1:(e.push(t),!0)}function $l(e,t,r){if(je.DEBUG&&console.log(`DECOMPOSING ${t}`),e){if(!je.iscons(t))return je.DEBUG&&console.log(` ground thing: ${t}`),[t]}else if(!kl.Find(t,r))return je.DEBUG&&console.log(" entire expression is constant"),[t];if(je.isadd(t))return WO(e,t,r);if(je.ismultiply(t))return JO(e,t,r);let n=je.cdr(t);je.DEBUG&&(console.log(" naive decomp"),console.log(`startig p3: ${n}`));let o=[];for(;je.iscons(n);)e&&o.push(je.car(n)),je.DEBUG&&(console.log("recursive decomposition"),console.log(`car(p3): ${je.car(n)}`),console.log(`p2: ${r}`)),o.push(...$l(e,je.car(n),r)),n=je.cdr(n);return o}fa.decomp=$l;function WO(e,t,r){je.DEBUG&&console.log(" decomposing the sum ");let n=je.cdr(t),o=[];for(;je.iscons(n);)(kl.Find(je.car(n),r)||e)&&o.push(...$l(e,je.car(n),r)),n=je.cdr(n);n=je.cdr(t);let i=[...n].filter(s=>!kl.Find(s,r));return i.length&&(n=VO.add_all(i),QO(o,n),o.push(Nv.negate(n))),o}function JO(e,t,r){je.DEBUG&&console.log(" decomposing the product ");let n=je.cdr(t),o=[];for(;je.iscons(n);)(kl.Find(je.car(n),r)||e)&&o.push(...$l(e,je.car(n),r)),n=je.cdr(n);n=je.cdr(t);let i=[];for(;je.iscons(n);){let s=je.car(n);kl.Find(s,r)||(i.length<1||!Tv.equal(s,i[i.length-1]))&&i.push(s),n=je.cdr(n)}return i.length>0&&o.push(Nv.multiply_all(i)),o}});var e_=A(Sc=>{"use strict";Object.defineProperty(Sc,"__esModule",{value:!0});Sc.transform=void 0;var ne=N(),Te=U(),KO=ue(),eM=t_(),tM=Jm(),Ic=G(),Iv=H(),rM=K(),nM=Yo(),Km=Yr();function Rv(e,t,r,n){ne.DEBUG&&console.log(`         !!!!!!!!!   transform on: ${e}`);let o=oM();Te.set_binding(Te.symbol(ne.METAX),t);let i=eM.polyform(e,t),s=tM.decomp(n,i,t);if(ne.DEBUG){console.log(`  ${s.length} decomposed elements ====== `);for(let _=0;_<s.length;_++)console.log(`  decomposition element ${_}: ${s[_]}`)}let u=!1,c;if(n){if(!ne.isNumericAtom(e)){let _=r;ne.DEBUG&&(console.log(`applying transform: ${_}`),console.log(`scanning table entry ${_}`));let R=Km.subst(_,Te.symbol(ne.SYMBOL_A_UNDERSCORE),Te.symbol(ne.METAA));R=Km.subst(R,Te.symbol(ne.SYMBOL_B_UNDERSCORE),Te.symbol(ne.METAB));let T=Km.subst(R,Te.symbol(ne.SYMBOL_X_UNDERSCORE),Te.symbol(ne.METAX)),k=ne.car(T);ne.DEBUG&&console.log(`template expression: ${k}`),c=ne.cadr(T);let V=ne.cddr(T);if(Sv([ne.Constants.one,...s],n,e,k,V))u=!0;else{ne.DEBUG&&(console.log(`p3 at this point: ${e}`),console.log(`car(p3): ${ne.car(e)}`));let z=[],Ae=e;for(ne.iscons(Ae)&&(z.push(ne.car(e)),Ae=ne.cdr(e));ne.iscons(Ae);){let et=ne.car(Ae);Ae=ne.cdr(Ae),ne.DEBUG&&(console.log(`testing: ${et}`),console.log(`about to try to simplify other term: ${et}`));let[Ve,De]=Rv(et,Te.symbol(ne.NIL),r,n);u=u||De,z.push(Ve),ne.DEBUG&&console.log(`tried to simplify other term: ${et} ...successful?: ${De} ...transformed: ${z[z.length-1]}`)}z.length!==0&&(c=rM.makeList(...z))}}}else for(let _ of Array.from(r))if(ne.DEBUG&&(console.log(`scanning table entry ${_}`),(_+"").indexOf("f(sqrt(a+b*x),2/3*1/b*sqrt((a+b*x)^3))")!==-1&&ne.breakpoint),_){let R=nM.scan_meta(_),T=ne.cadr(R);c=ne.caddr(R);let k=ne.cdddr(R);if(Sv([ne.Constants.one,...s],n,e,T,k)){u=!0;break}}let d=u?Ic.Eval(c):n?e:Te.symbol(ne.NIL);return iM(o),[d,u]}Sc.transform=Rv;function oM(){return{METAA:Te.get_binding(Te.symbol(ne.METAA)),METAB:Te.get_binding(Te.symbol(ne.METAB)),METAX:Te.get_binding(Te.symbol(ne.METAX))}}function iM(e){Te.set_binding(Te.symbol(ne.METAX),e.METAX),Te.set_binding(Te.symbol(ne.METAB),e.METAB),Te.set_binding(Te.symbol(ne.METAA),e.METAA)}function Sv(e,t,r,n,o){for(let i of e){Te.set_binding(Te.symbol(ne.METAA),i),ne.DEBUG&&console.log(`  binding METAA to ${Te.get_binding(Te.symbol(ne.METAA))}`);for(let s of e){Te.set_binding(Te.symbol(ne.METAB),s),ne.DEBUG&&console.log(`  binding METAB to ${Te.get_binding(Te.symbol(ne.METAB))}`);let u=o;for(;ne.iscons(u);){let d=Ic.Eval(ne.car(u));if(Iv.isZeroAtomOrTensor(d))break;u=ne.cdr(u)}if(ne.iscons(u))continue;let c=t?ne.noexpand(Ic.Eval,n):Ic.Eval(n);if(ne.DEBUG&&(console.log(`about to evaluate template expression: ${n} binding METAA to ${Te.get_binding(Te.symbol(ne.METAA))} and binding METAB to ${Te.get_binding(Te.symbol(ne.METAB))} and binding METAX to ${Te.get_binding(Te.symbol(ne.METAX))}`),console.log(`  comparing ${c} to: ${r}`)),Iv.isZeroAtomOrTensor(KO.subtract(r,c)))return ne.DEBUG&&(console.log(`binding METAA to ${Te.get_binding(Te.symbol(ne.METAA))}`),console.log(`binding METAB to ${Te.get_binding(Te.symbol(ne.METAB))}`),console.log(`binding METAX to ${Te.get_binding(Te.symbol(ne.METAX))}`),console.log(`comparing ${r} to: ${n}`)),!0}}return!1}});var o_=A(_a=>{"use strict";Object.defineProperty(_a,"__esModule",{value:!0});_a.transpose=_a.Eval_transpose=void 0;var sM=It(),$e=N(),aM=Ee(),ma=U(),da=Ne(),lM=ue(),n_=F(),r_=G(),uM=Go(),Cr=H(),wv=K(),cM=Z();function fM(e){let t=r_.Eval($e.cadr(e)),r=$e.Constants.one,n=n_.integer(2);return $e.cddr(e)!==ma.symbol($e.NIL)&&(r=r_.Eval($e.caddr(e)),n=r_.Eval($e.cadddr(e))),Ul(t,r,n)}_a.Eval_transpose=fM;function Ul(e,t,r){let n=0,o=Array($e.MAXDIM).fill(0),i=Array($e.MAXDIM).fill(0);if($e.isNumericAtom(e)||(Cr.isplusone(t)&&Cr.isplustwo(r)||Cr.isplusone(r)&&Cr.isplustwo(t))&&$e.isidentitymatrix(e))return e;if($e.istranspose(e)){let T=$e.car($e.cdr($e.cdr(e))),k=$e.car($e.cdr($e.cdr($e.cdr(e))));if(da.equal(T,r)&&da.equal(k,t)||da.equal(k,r)&&da.equal(T,t)||da.equal(T,ma.symbol($e.NIL))&&da.equal(k,ma.symbol($e.NIL))&&(Cr.isplusone(r)&&Cr.isplustwo(t)||Cr.isplusone(t)&&Cr.isplustwo(r)))return $e.car($e.cdr(e))}if($e.defs.expanding&&$e.isadd(e))return e.tail().reduce((T,k)=>lM.add(T,Ul(k,t,r)),$e.Constants.zero);if($e.defs.expanding&&$e.ismultiply(e))return e.tail().reduce((T,k)=>cM.multiply(T,Ul(k,t,r)),$e.Constants.one);if($e.defs.expanding&&$e.isinnerordot(e)){let T=[];return $e.iscons(e)&&T.push(...e.tail().map(k=>[k,t,r])),T.reverse(),T.reduce((k,V)=>uM.inner(k,Ul(V[0],V[1],V[2])),ma.symbol($e.SYMBOL_IDENTITY_MATRIX))}if(!$e.istensor(e))return Cr.isZeroAtomOrTensor(e)?$e.Constants.zero:(!Cr.isplusone(t)||!Cr.isplustwo(r))&&(!Cr.isplusone(r)||!Cr.isplustwo(t))?wv.makeList(ma.symbol($e.TRANSPOSE),e,t,r):wv.makeList(ma.symbol($e.TRANSPOSE),e);let{ndim:s,nelem:u}=e.tensor;if(s===1)return e;let c=n_.nativeInt(t),d=n_.nativeInt(r);(c<1||c>s||d<1||d>s)&&aM.stop("transpose: index out of range"),c--,d--,t=sM.alloc_tensor(u),t.tensor.ndim=s,t.tensor.dim=[...e.tensor.dim],t.tensor.dim[c]=e.tensor.dim[d],t.tensor.dim[d]=e.tensor.dim[c];let _=e.tensor.elem,R=t.tensor.elem;for(let T=0;T<s;T++)o[T]=0,i[T]=e.tensor.dim[T];for(let T=0;T<u;T++){n=o[c],o[c]=o[d],o[d]=n,n=i[c],i[c]=i[d],i[d]=n;let k=0;for(let V=0;V<s;V++)k=k*i[V]+o[V];n=o[c],o[c]=o[d],o[d]=n,n=i[c],i[c]=i[d],i[d]=n,R[k]=_[T];for(let V=s-1;V>=0&&!(++o[V]<i[V]);V--)o[V]=0}return t}_a.transpose=Ul});var Zo=A(wn=>{"use strict";Object.defineProperty(wn,"__esModule",{value:!0});wn.simplify_trig=wn.simplify=wn.simplifyForCodeGeneration=wn.Eval_simplify=void 0;var dM=It(),mt=Ac(),I=N(),Ti=ir(),s_=Ee(),He=U(),fo=ue(),Pt=F(),mM=Pu(),l_=bl(),Ni=G(),Oi=Rn(),_M=Go(),$t=H(),Pv=K(),ba=Ne(),Ue=Z(),bM=Du(),dn=Et(),Ho=gl(),Mi=Us(),gM=Kn(),yM=Qm(),Lv=Av(),vM=qt(),qM=e_(),EM=o_(),xM=Mn(),Cv=_i(),i_=fl(),pM=oo();function hM(e){let t=Dv(I.cadr(e));return Hr(Ni.Eval(t))}wn.Eval_simplify=hM;function Dv(e){if(I.defs.userSimplificationsInListForm.length===0||Ti.Find(e,He.symbol(I.INTEGRAL)))return e;I.DEBUG&&console.log(`runUserDefinedSimplifications passed: ${e}`);let t=I.noexpand(Ni.Eval,e);if(I.DEBUG){console.log(`runUserDefinedSimplifications after eval no expanding: ${t}`),console.log("patterns to be checked: ");for(let o of Array.from(I.defs.userSimplificationsInListForm))console.log(`...${o}`)}let r=!0,n=0;for(;r&&n<I.MAX_CONSECUTIVE_APPLICATIONS_OF_ALL_RULES;){r=!1,n++;for(let o of Array.from(I.defs.userSimplificationsInListForm)){let i=!0,s=0;for(;i&&s<I.MAX_CONSECUTIVE_APPLICATIONS_OF_SINGLE_RULE;)s++,I.DEBUG&&console.log(`simplify - checking pattern: ${o} on: ${t}`),[t,i]=qM.transform(t,He.symbol(I.NIL),o,!0),i&&(r=!0),I.DEBUG&&console.log(`p1 at this stage of simplification: ${t}`);s===I.MAX_CONSECUTIVE_APPLICATIONS_OF_SINGLE_RULE&&s_.stop(`maximum application of single transformation rule exceeded: ${o}`)}}return n===I.MAX_CONSECUTIVE_APPLICATIONS_OF_ALL_RULES&&s_.stop("maximum application of all transformation rules exceeded "),I.DEBUG&&(console.log(`METAX = ${He.get_binding(He.symbol(I.METAX))}`),console.log(`METAA = ${He.get_binding(He.symbol(I.METAA))}`),console.log(`METAB = ${He.get_binding(He.symbol(I.METAB))}`)),t}function AM(e){let t=Dv(e);I.defs.codeGen=!0;let r=Hr(t);return I.defs.codeGen=!1,r}wn.simplifyForCodeGeneration=AM;function Hr(e){if(I.defs.codeGen&&I.car(e)===He.symbol(I.FUNCTION)){let t=I.cadr(e),r=Hr(Ni.Eval(t)),n=I.caddr(e);e=Pv.makeList(He.symbol(I.FUNCTION),r,n)}if(I.istensor(e))return OM(e);if(Ti.Find(e,He.symbol(I.FACTORIAL))){let t=Lv.simfac(e),r=Lv.simfac(Ho.rationalize(e));e=mt.count(t)<mt.count(r)?t:r}if(e=IM(e),e=MM(e),e=TM(e),e=NM(e),e=SM(e),e=kv(e),e=wM(e),e=CM(e),I.do_simplify_nested_radicals){let t;if([t,e]=PM(e),t)return I.DEBUG&&console.log("de-nesting successful into: "+e.toString()),Hr(e)}return e=LM(e),e=$v(e),e}wn.simplify=Hr;function OM(e){let t=dM.alloc_tensor(e.tensor.nelem);return t.tensor.ndim=e.tensor.ndim,t.tensor.dim=Array.from(e.tensor.dim),t.tensor.elem=e.tensor.elem.map(Hr),vM.check_tensor_dimensions(t),$t.isZeroAtomOrTensor(t)&&(t=I.Constants.zero),t}function MM(e){if(!I.isadd(e))return e;let t=Ho.rationalize(e);return mt.count(t)<mt.count(e)&&(e=t),e}function TM(e){if(!I.isadd(e))return e;let t=l_.Condense(e);return mt.count(t)<=mt.count(e)&&(e=t),e}function NM(e){let t=Ho.rationalize(Ue.negate(Ho.rationalize(Ue.negate(Ho.rationalize(e)))));return mt.count(t)<mt.count(e)&&(e=t),e}function IM(e){let t=I.car(e);if((t===He.symbol(I.MULTIPLY)||I.isinnerordot(e))&&I.car(I.car(I.cdr(e)))===He.symbol(I.TRANSPOSE)&&I.car(I.car(I.cdr(I.cdr(e))))===He.symbol(I.TRANSPOSE)){I.DEBUG&&console.log(`maybe collecting a transpose ${e}`);let r=I.cadr(I.car(I.cdr(e))),n=I.cadr(I.car(I.cdr(I.cdr(e)))),o;t===He.symbol(I.MULTIPLY)?o=Ue.multiply(r,n):I.isinnerordot(e)?o=_M.inner(n,r):o=s_.stop("f10: nothing to pop.");let i=I.noexpand(()=>EM.transpose(o,I.Constants.one,Pt.integer(2)));mt.count(i)<mt.count(e)&&(e=i),I.DEBUG&&console.log(`collecting a transpose ${i}`)}return e}function SM(e){if($t.isZeroAtomOrTensor(e))return e;let t=Ho.rationalize(Ue.inverse(Ho.rationalize(Ue.inverse(Ho.rationalize(e)))));return mt.count(t)<mt.count(e)&&(e=t),e}function RM(e){return kv(e)}wn.simplify_trig=RM;function kv(e){if(!Ti.Find(e,He.symbol(I.SIN))&&!Ti.Find(e,He.symbol(I.COS)))return e;let t=e;I.defs.trigmode=1;let r=Ni.Eval(t);I.defs.trigmode=2;let n=Ni.Eval(t);return I.defs.trigmode=0,(mt.count(n)<mt.count(r)||Rc(n)<Rc(r))&&(r=n),(mt.count(r)<mt.count(e)||Rc(r)<Rc(e))&&(e=r),e}function wM(e){if(!I.isadd(e))return e;let t=I.cdr(e);return I.iscons(t)&&(t=[...t].reduce((r,n)=>$v(fo.add(r,Hr(n))),I.Constants.zero)),mt.count(t)<mt.count(e)&&(e=t),e}function $v(e){var t,r,n,o,i;if(t=xM.denominator(e),$t.isone(t)||(r=pM.numerator(e),$t.isone(r))||!(o=Cv.areunivarpolysfactoredorexpandedform(r,t))||(i=i_.factor(Cv.gcd(r,t),o),$t.isone(i)))return e;let s=i_.factor(r,o),u=Ue.inverse(i),c=Ue.multiply_noexpand(s,u),d=Hr(c),_=i_.factor(t,o),R=Ue.multiply_noexpand(_,u),T=Hr(R),k=Ue.divide(d,T);return n=l_.Condense(k),mt.count(n)<mt.count(e)?n:e}function LM(e){let t;return!Ti.Find(e,He.symbol(I.SIN))&&!Ti.Find(e,He.symbol(I.COS))||(t=mM.clockform(Ni.Eval(e)),I.DEBUG&&console.log(`before simplification clockform: ${e} after: ${t}`),mt.count(t)<mt.count(e)&&(e=t)),e}function CM(e){let t=a_(e),r=Ni.Eval(t);return mt.count(r)<mt.count(e)&&(e=r),e}function a_(e){if($t.isimaginaryunit(e))return e;if(ba.equal(I.car(e),He.symbol(I.POWER))&&$t.isminusone(I.cadr(e))){let t=Ue.negate(I.Constants.one),r=a_(I.caddr(e));return gM.rect(bM.polar(dn.power(t,r)))}else return I.iscons(e)?e.map(a_):e}function Rc(e){return I.isadd(e)?ba.length(e)-1:1}function PM(e){if(I.defs.recursionLevelNestedRadicalsRemoval>0)return I.DEBUG&&console.log("denesting bailing out because of too much recursion"),[!1,e];let[t,r]=wc(e),n=I.noexpand(l_.yycondense,t);return e=mt.countOccurrencesOfSymbol(He.symbol(I.POWER),t)<mt.countOccurrencesOfSymbol(He.symbol(I.POWER),n)?t:n,[r,e]}function wc(e){return I.defs.recursionLevelNestedRadicalsRemoval>0?(I.DEBUG&&console.log("denesting bailing out because of too much recursion"),[e,!1]):ba.equal(I.car(e),He.symbol(I.POWER))?DM(e):I.iscons(e)?$M(e):[e,!1]}function DM(e){let t=I.cadr(e),r=I.caddr(e);if($t.isminusone(r)||!ba.equal(I.car(t),He.symbol(I.ADD))||!$t.isfraction(r)||!$t.equalq(r,1,3)&&!$t.equalq(r,1,2))return[e,!1];let n=I.cadr(t);wc(n);let o=I.caddr(t);wc(o);let i=0,s=t;for(;I.cdr(s)!==He.symbol(I.NIL);)i++,s=I.cdr(s);if(i>2)return[e,!1];let{commonBases:u,termsThatAreNotPowers:c}=kM(o);if(u.length===0)return[e,!1];let d=n,_=u.reduce(Ue.multiply,I.Constants.one),R=c.reduce(Ue.multiply,I.Constants.one),T;if($t.equalq(r,1,3)){let De=Ue.divide(Ue.multiply(Ue.negate(d),_),R),it=Pt.nativeDouble(Oi.yyfloat(Mi.real(De)));if(Math.abs(it)>Math.pow(2,32))return[e,!1];let Oe=Ue.multiply(Pt.integer(3),_),st=Pt.nativeDouble(Oi.yyfloat(Mi.real(Oe)));if(Math.abs(st)>Math.pow(2,32))return[e,!1];let or=Ue.multiply(Oe,He.symbol(I.SECRETX)),Bt=Ue.divide(Ue.multiply(Pt.integer(-3),d),R),vr=Pt.nativeDouble(Oi.yyfloat(Mi.real(Bt)));if(Math.abs(vr)>Math.pow(2,32))return[e,!1];T=fo.add_all([De,or,Ue.multiply(Bt,dn.power(He.symbol(I.SECRETX),Pt.integer(2))),Ue.multiply(I.Constants.one,dn.power(He.symbol(I.SECRETX),Pt.integer(3)))])}else if($t.equalq(r,1,2)){let De=Pt.nativeDouble(Oi.yyfloat(Mi.real(_)));if(Math.abs(De)>Math.pow(2,32))return[e,!1];let it=Ue.divide(Ue.multiply(Pt.integer(-2),d),R),Oe=Pt.nativeDouble(Oi.yyfloat(Mi.real(it)));if(Math.abs(Oe)>Math.pow(2,32))return[e,!1];T=fo.add(_,fo.add(Ue.multiply(it,He.symbol(I.SECRETX)),Ue.multiply(I.Constants.one,dn.power(He.symbol(I.SECRETX),Pt.integer(2)))))}I.defs.recursionLevelNestedRadicalsRemoval++;let k=yM.roots(T,He.symbol(I.SECRETX));if(I.defs.recursionLevelNestedRadicalsRemoval--,ba.equal(k,He.symbol(I.NIL)))return I.DEBUG&&console.log("roots bailed out because of too much recursion"),[e,!1];let V=k.elem.filter(De=>!Ti.Find(De,He.symbol(I.POWER)));if(V.length===0)return[e,!1];let z=[],Ae=[];for(let De of Array.from(V)){let it=Pt.nativeDouble(Oi.yyfloat(Mi.real(De)));z.push(De),Ae.push(it)}let et=Ae.indexOf(Math.max.apply(Math,Ae)),Ve=z[et];if(!$t.equalq(r,1,3)&&!$t.equalq(r,1,2))return[e,!1];if($t.equalq(r,1,3)){let De=dn.power(Ue.divide(d,fo.add(dn.power(Ve,Pt.integer(3)),Ue.multiply(Ue.multiply(Pt.integer(3),_),Ve))),Pt.rational(1,3)),it=Ue.multiply(De,Ve);return[Hr(fo.add(Ue.multiply(De,dn.power(_,Pt.rational(1,2))),it)),!0]}if($t.equalq(r,1,2)){let De=dn.power(Ue.divide(d,fo.add(dn.power(Ve,Pt.integer(2)),_)),Pt.rational(1,2)),it=Ue.multiply(De,Ve),Oe=Hr(fo.add(Ue.multiply(De,dn.power(_,Pt.rational(1,2))),it)),st=Oi.yyfloat(Mi.real(Oe));return $t.isnegativenumber(st)?[Hr(fo.add(Ue.multiply(Ue.negate(De),dn.power(_,Pt.rational(1,2))),Ue.negate(it))),!0]:[Oe,!0]}return[null,!0]}function kM(e){let t=null,r=[],n=[];if(I.ismultiply(e)){let o=I.cdr(e);if(I.iscons(o))for(;I.iscons(o);){let i=I.car(o);if(I.ispower(i)){let s=I.cadr(i),u=I.caddr(i);$t.equalq(u,1,2)&&(t==null?(t=u,r.push(s)):ba.equal(u,t)&&r.push(s))}else n.push(i);o=I.cdr(o)}}else if(I.ispower(e)){let o=I.cadr(e),i=I.caddr(e);t==null&&$t.equalq(i,1,2)&&(t=i,r.push(o))}return{commonBases:r,termsThatAreNotPowers:n}}function $M(e){let t=!1,r=[];if(I.iscons(e)){let n=Array.from(e).map(o=>{if(!t){let i;return[i,t]=wc(o),i}return o});r.push(...n)}return[Pv.makeList(...r),t]}});var Gl=A(Qo=>{"use strict";Object.defineProperty(Qo,"__esModule",{value:!0});Qo.make_hashed_itab=Qo.integral=Qo.Eval_integral=void 0;var de=N(),ga=ir(),Gv=Ee(),Ln=U(),UM=Ne(),BM=ue(),Fv=F(),GM=Ri(),Ii=G(),Uv=Vr(),Bl=H(),Bv=K(),FM=Z(),jM=cv(),zM=Yo(),YM=Zo(),VM=e_(),ZM=["f(a,a*x)","f(1/x,log(x))","f(x^a,x^(a+1)/(a+1))","f(x^(-2),-x^(-1))","f(x^(-1/2),2*x^(1/2))","f(x^(1/2),2/3*x^(3/2))","f(x,x^2/2)","f(x^2,x^3/3)","f(exp(a*x),1/a*exp(a*x))","f(exp(a*x+b),1/a*exp(a*x+b))","f(x*exp(a*x^2),exp(a*x^2)/(2*a))","f(x*exp(a*x^2+b),exp(a*x^2+b)/(2*a))","f(log(a*x),x*log(a*x)-x)","f(a^x,a^x/log(a),or(not(number(a)),a>0))","f(1/(a+x^2),1/sqrt(a)*arctan(x/sqrt(a)),or(not(number(a)),a>0))","f(1/(a-x^2),1/sqrt(a)*arctanh(x/sqrt(a)))","f(1/sqrt(a-x^2),arcsin(x/(sqrt(a))))","f(1/sqrt(a+x^2),log(x+sqrt(a+x^2)))","f(1/(a+b*x),1/b*log(a+b*x))","f(1/(a+b*x)^2,-1/(b*(a+b*x)))","f(1/(a+b*x)^3,-1/(2*b)*1/(a+b*x)^2)","f(x/(a+b*x),x/b-a*log(a+b*x)/b/b)","f(x/(a+b*x)^2,1/b^2*(log(a+b*x)+a/(a+b*x)))","f(x^2/(a+b*x),1/b^2*(1/2*(a+b*x)^2-2*a*(a+b*x)+a^2*log(a+b*x)))","f(x^2/(a+b*x)^2,1/b^3*(a+b*x-2*a*log(a+b*x)-a^2/(a+b*x)))","f(x^2/(a+b*x)^3,1/b^3*(log(a+b*x)+2*a/(a+b*x)-1/2*a^2/(a+b*x)^2))","f(1/x*1/(a+b*x),-1/a*log((a+b*x)/x))","f(1/x*1/(a+b*x)^2,1/a*1/(a+b*x)-1/a^2*log((a+b*x)/x))","f(1/x*1/(a+b*x)^3,1/a^3*(1/2*((2*a+b*x)/(a+b*x))^2+log(x/(a+b*x))))","f(1/x^2*1/(a+b*x),-1/(a*x)+b/a^2*log((a+b*x)/x))","f(1/x^3*1/(a+b*x),(2*b*x-a)/(2*a^2*x^2)+b^2/a^3*log(x/(a+b*x)))","f(1/x^2*1/(a+b*x)^2,-(a+2*b*x)/(a^2*x*(a+b*x))+2*b/a^3*log((a+b*x)/x))","f(1/(a+b*x^2),1/sqrt(a*b)*arctan(x*sqrt(a*b)/a),or(not(number(a*b)),a*b>0))","f(1/(a+b*x^2),1/(2*sqrt(-a*b))*log((a+x*sqrt(-a*b))/(a-x*sqrt(-a*b))),or(not(number(a*b)),a*b<0))","f(x/(a+b*x^2),1/2*1/b*log(a+b*x^2))","f(x^2/(a+b*x^2),x/b-a/b*integral(1/(a+b*x^2),x))","f(1/(a+b*x^2)^2,x/(2*a*(a+b*x^2))+1/2*1/a*integral(1/(a+b*x^2),x))","f(1/x*1/(a+b*x^2),1/2*1/a*log(x^2/(a+b*x^2)))","f(1/x^2*1/(a+b*x^2),-1/(a*x)-b/a*integral(1/(a+b*x^2),x))","f(1/(a+b*x^3),1/3*1/a*(a/b)^(1/3)*(1/2*log(((a/b)^(1/3)+x)^3/(a+b*x^3))+sqrt(3)*arctan((2*x-(a/b)^(1/3))*(a/b)^(-1/3)/sqrt(3))))","f(x^2/(a+b*x^3),1/3*1/b*log(a+b*x^3))","f(x/(a+b*x^4),1/2*sqrt(b/a)/b*arctan(x^2*sqrt(b/a)),or(not(number(a*b)),a*b>0))","f(x/(a+b*x^4),1/4*sqrt(-b/a)/b*log((x^2-sqrt(-a/b))/(x^2+sqrt(-a/b))),or(not(number(a*b)),a*b<0))","f(x^3/(a+b*x^4),1/4*1/b*log(a+b*x^4))","f(sqrt(a+b*x),2/3*1/b*sqrt((a+b*x)^3))","f(x*sqrt(a+b*x),-2*(2*a-3*b*x)*sqrt((a+b*x)^3)/15/b^2)","f(x^2*sqrt(a+b*x),2*(8*a^2-12*a*b*x+15*b^2*x^2)*sqrt((a+b*x)^3)/105/b^3)","f(sqrt(a+b*x)/x,2*sqrt(a+b*x)+a*integral(1/x*1/sqrt(a+b*x),x))","f(sqrt(a+b*x)/x^2,-sqrt(a+b*x)/x+b/2*integral(1/x*1/sqrt(a+b*x),x))","f(1/sqrt(a+b*x),2*sqrt(a+b*x)/b)","f(x/sqrt(a+b*x),-2/3*(2*a-b*x)*sqrt(a+b*x)/b^2)","f(x^2/sqrt(a+b*x),2/15*(8*a^2-4*a*b*x+3*b^2*x^2)*sqrt(a+b*x)/b^3)","f(1/x*1/sqrt(a+b*x),1/sqrt(a)*log((sqrt(a+b*x)-sqrt(a))/(sqrt(a+b*x)+sqrt(a))),or(not(number(a)),a>0))","f(1/x*1/sqrt(a+b*x),2/sqrt(-a)*arctan(sqrt(-(a+b*x)/a)),or(not(number(a)),a<0))","f(1/x^2*1/sqrt(a+b*x),-sqrt(a+b*x)/a/x-1/2*b/a*integral(1/x*1/sqrt(a+b*x),x))","f(sqrt(x^2+a),1/2*(x*sqrt(x^2+a)+a*log(x+sqrt(x^2+a))))","f(1/sqrt(x^2+a),log(x+sqrt(x^2+a)))","f(1/x*1/sqrt(x^2+a),arcsec(x/sqrt(-a))/sqrt(-a),or(not(number(a)),a<0))","f(1/x*1/sqrt(x^2+a),-1/sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(-a)*arcsec(x/sqrt(-a)),or(not(number(a)),a<0))","f(x/sqrt(x^2+a),sqrt(x^2+a))","f(x*sqrt(x^2+a),1/3*sqrt((x^2+a)^3))","f(sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2+a^(1/3))^3)+3/2*a^(1/3)*x*sqrt(x^2+a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2+a^(1/3)))))","f(sqrt(-a+x^6-3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2-a^(1/3))^3)-3/2*a^(1/3)*x*sqrt(x^2-a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2-a^(1/3)))))","f(1/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),x/a^(1/3)/sqrt(x^2+a^(1/3)))","f(x/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),-1/sqrt(x^2+a^(1/3)))","f(x*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/5*sqrt((x^2+a^(1/3))^5))","f(x^2*sqrt(x^2+a),1/4*x*sqrt((x^2+a)^3)-1/8*a*x*sqrt(x^2+a)-1/8*a^2*log(x+sqrt(x^2+a)))","f(x^3*sqrt(x^2+a),(1/5*x^2-2/15*a)*sqrt((x^2+a)^3),and(number(a),a>0))","f(x^3*sqrt(x^2+a),sqrt((x^2+a)^5)/5-a*sqrt((x^2+a)^3)/3,and(number(a),a<0))","f(x^2/sqrt(x^2+a),1/2*x*sqrt(x^2+a)-1/2*a*log(x+sqrt(x^2+a)))","f(x^3/sqrt(x^2+a),1/3*sqrt((x^2+a)^3)-a*sqrt(x^2+a))","f(1/x^2*1/sqrt(x^2+a),-sqrt(x^2+a)/a/x)","f(1/x^3*1/sqrt(x^2+a),-1/2*sqrt(x^2+a)/a/x^2+1/2*log((sqrt(a)+sqrt(x^2+a))/x)/a^(3/2),or(not(number(a)),a>0))","f(1/x^3*1/sqrt(x^2-a),1/2*sqrt(x^2-a)/a/x^2+1/2*1/(a^(3/2))*arcsec(x/(a^(1/2))),or(not(number(a)),a>0))","f(x^2*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/6*x*sqrt((x^2+a^(1/3))^5)-1/24*a^(1/3)*x*sqrt((x^2+a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2+a^(1/3))-1/16*a*log(x+sqrt(x^2+a^(1/3))),or(not(number(a)),a>0))","f(x^2*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/6*x*sqrt((x^2-a^(1/3))^5)+1/24*a^(1/3)*x*sqrt((x^2-a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2-a^(1/3))+1/16*a*log(x+sqrt(x^2-a^(1/3))),or(not(number(a)),a>0))","f(x^3*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/7*sqrt((x^2+a^(1/3))^7)-1/5*a^(1/3)*sqrt((x^2+a^(1/3))^5),or(not(number(a)),a>0))","f(x^3*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/7*sqrt((x^2-a^(1/3))^7)+1/5*a^(1/3)*sqrt((x^2-a^(1/3))^5),or(not(number(a)),a>0))","f(1/(x-a)/sqrt(x^2-a^2),-sqrt(x^2-a^2)/a/(x-a))","f(1/(x+a)/sqrt(x^2-a^2),sqrt(x^2-a^2)/a/(x+a))","f(sqrt(a-x^2),1/2*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(abs(a)))))","f(1/x*1/sqrt(a-x^2),-1/sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x,sqrt(a-x^2)-sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))","f(x/sqrt(a-x^2),-sqrt(a-x^2))","f(x*sqrt(a-x^2),-1/3*sqrt((a-x^2)^3))","f(x^2*sqrt(a-x^2),-x/4*sqrt((a-x^2)^3)+1/8*a*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(a))),or(not(number(a)),a>0))","f(x^3*sqrt(a-x^2),(-1/5*x^2-2/15*a)*sqrt((a-x^2)^3),or(not(number(a)),a>0))","f(x^2/sqrt(a-x^2),-x/2*sqrt(a-x^2)+a/2*arcsin(x/sqrt(a)),or(not(number(a)),a>0))","f(1/x^2*1/sqrt(a-x^2),-sqrt(a-x^2)/a/x,or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^2,-sqrt(a-x^2)/x-arcsin(x/sqrt(a)),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^3,-1/2*sqrt(a-x^2)/x^2+1/2*log((sqrt(a)+sqrt(a-x^2))/x)/sqrt(a),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^4,-1/3*sqrt((a-x^2)^3)/a/x^3,or(not(number(a)),a>0))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*log(x*sqrt(a)+sqrt(a*x^2+b))/2/sqrt(a),and(number(a),a>0))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*arcsin(x*sqrt(-a/b))/2/sqrt(-a),and(number(a),a<0))","f(sin(a*x),-cos(a*x)/a)","f(cos(a*x),sin(a*x)/a)","f(tan(a*x),-log(cos(a*x))/a)","f(1/tan(a*x),log(sin(a*x))/a)","f(1/cos(a*x),log(tan(pi/4+a*x/2))/a)","f(1/sin(a*x),log(tan(a*x/2))/a)","f(sin(a*x)^2,x/2-sin(2*a*x)/(4*a))","f(sin(a*x)^3,-cos(a*x)*(sin(a*x)^2+2)/(3*a))","f(sin(a*x)^4,3/8*x-sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))","f(cos(a*x)^2,x/2+sin(2*a*x)/(4*a))","f(cos(a*x)^3,sin(a*x)*(cos(a*x)^2+2)/(3*a))","f(cos(a*x)^4,3/8*x+sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))","f(1/sin(a*x)^2,-1/(a*tan(a*x)))","f(1/cos(a*x)^2,tan(a*x)/a)","f(sin(a*x)*cos(a*x),sin(a*x)^2/(2*a))","f(sin(a*x)^2*cos(a*x)^2,-sin(4*a*x)/(32*a)+x/8)","f(sin(a*x)/cos(a*x)^2,1/(a*cos(a*x)))","f(sin(a*x)^2/cos(a*x),(log(tan(pi/4+a*x/2))-sin(a*x))/a)","f(cos(a*x)/sin(a*x)^2,-1/(a*sin(a*x)))","f(1/(sin(a*x)*cos(a*x)),log(tan(a*x))/a)","f(1/(sin(a*x)*cos(a*x)^2),(1/cos(a*x)+log(tan(a*x/2)))/a)","f(1/(sin(a*x)^2*cos(a*x)),(log(tan(pi/4+a*x/2))-1/sin(a*x))/a)","f(1/(sin(a*x)^2*cos(a*x)^2),-2/(a*tan(2*a*x)))","f(sin(a+b*x),-cos(a+b*x)/b)","f(cos(a+b*x),sin(a+b*x)/b)","f(1/(b+b*sin(a*x)),-tan(pi/4-a*x/2)/a/b)","f(1/(b-b*sin(a*x)),tan(pi/4+a*x/2)/a/b)","f(1/(b+b*cos(a*x)),tan(a*x/2)/a/b)","f(1/(b-b*cos(a*x)),-1/tan(a*x/2)/a/b)","f(1/(a+b*sin(x)),1/sqrt(b^2-a^2)*log((a*tan(x/2)+b-sqrt(b^2-a^2))/(a*tan(x/2)+b+sqrt(b^2-a^2))),b^2-a^2)","f(1/(a+b*cos(x)),1/sqrt(b^2-a^2)*log((sqrt(b^2-a^2)*tan(x/2)+a+b)/(sqrt(b^2-a^2)*tan(x/2)-a-b)),b^2-a^2)","f(x*sin(a*x),sin(a*x)/a^2-x*cos(a*x)/a)","f(x^2*sin(a*x),2*x*sin(a*x)/a^2-(a^2*x^2-2)*cos(a*x)/a^3)","f(x*cos(a*x),cos(a*x)/a^2+x*sin(a*x)/a)","f(x^2*cos(a*x),2*x*cos(a*x)/a^2+(a^2*x^2-2)*sin(a*x)/a^3)","f(arcsin(a*x),x*arcsin(a*x)+sqrt(1-a^2*x^2)/a)","f(arccos(a*x),x*arccos(a*x)-sqrt(1-a^2*x^2)/a)","f(arctan(a*x),x*arctan(a*x)-1/2*log(1+a^2*x^2)/a)","f(x*log(a*x),x^2*log(a*x)/2-x^2/4)","f(x^2*log(a*x),x^3*log(a*x)/3-1/9*x^3)","f(log(x)^2,x*log(x)^2-2*x*log(x)+2*x)","f(1/x*1/(a+log(x)),log(a+log(x)))","f(log(a*x+b),(a*x+b)*log(a*x+b)/a-x)","f(log(a*x+b)/x^2,a/b*log(x)-(a*x+b)*log(a*x+b)/b/x)","f(sinh(x),cosh(x))","f(cosh(x),sinh(x))","f(tanh(x),log(cosh(x)))","f(x*sinh(x),x*cosh(x)-sinh(x))","f(x*cosh(x),x*sinh(x)-cosh(x))","f(sinh(x)^2,sinh(2*x)/4-x/2)","f(tanh(x)^2,x-tanh(x))","f(cosh(x)^2,sinh(2*x)/4+x/2)","f(x^3*exp(a*x^2),exp(a*x^2)*(x^2/a-1/(a^2))/2)","f(x^3*exp(a*x^2+b),exp(a*x^2)*exp(b)*(x^2/a-1/(a^2))/2)","f(exp(a*x^2),-i*sqrt(pi)*erf(i*sqrt(a)*x)/sqrt(a)/2)","f(erf(a*x),x*erf(a*x)+exp(-a^2*x^2)/a/sqrt(pi))","f(x^2*(1-x^2)^(3/2),(x*sqrt(1-x^2)*(-8*x^4+14*x^2-3)+3*arcsin(x))/48)","f(x^2*(1-x^2)^(5/2),(x*sqrt(1-x^2)*(48*x^6-136*x^4+118*x^2-15)+15*arcsin(x))/384)","f(x^4*(1-x^2)^(3/2),(-x*sqrt(1-x^2)*(16*x^6-24*x^4+2*x^2+3)+3*arcsin(x))/128)","f(x*exp(a*x),exp(a*x)*(a*x-1)/(a^2))","f(x*exp(a*x+b),exp(a*x+b)*(a*x-1)/(a^2))","f(x^2*exp(a*x),exp(a*x)*(a^2*x^2-2*a*x+2)/(a^3))","f(x^2*exp(a*x+b),exp(a*x+b)*(a^2*x^2-2*a*x+2)/(a^3))","f(x^3*exp(a*x),exp(a*x)*x^3/a-3/a*integral(x^2*exp(a*x),x))","f(x^3*exp(a*x+b),exp(a*x+b)*x^3/a-3/a*integral(x^2*exp(a*x+b),x))"];function XM(e){let t=0;e=de.cdr(e);let r=Ii.Eval(de.car(e));e=de.cdr(e);let n=Ii.Eval(de.car(e)),o,i;for(n===Ln.symbol(de.NIL)?(i=Uv.guess(r),o=Ln.symbol(de.NIL)):de.isNumericAtom(n)?(i=Uv.guess(r),o=n):(i=n,e=de.cdr(e),o=Ii.Eval(de.car(e)));;){de.isNumericAtom(o)?(t=Fv.nativeInt(o),isNaN(t)&&Gv.stop("nth integral: check n")):t=1;let s=r;if(t>=0)for(let u=0;u<t;u++)s=Lc(s,i);else{t=-t;for(let u=0;u<t;u++)s=GM.derivative(s,i)}if(r=s,o===Ln.symbol(de.NIL))break;if(de.isNumericAtom(o)){if(e=de.cdr(e),o=Ii.Eval(de.car(e)),o===Ln.symbol(de.NIL))break;de.isNumericAtom(o)||(i=o,e=de.cdr(e),o=Ii.Eval(de.car(e)))}else i=o,e=de.cdr(e),o=Ii.Eval(de.car(e))}return r}Qo.Eval_integral=XM;function Lc(e,t){let r;return de.isadd(e)?r=HM(e,t):de.ismultiply(e)?r=QM(e,t):r=jv(e,t),ga.Find(r,Ln.symbol(de.INTEGRAL))&&Gv.stop("integral: sorry, could not find a solution"),Ii.Eval(YM.simplify(r))}Qo.integral=Lc;function HM(e,t){e=de.cdr(e);let r=Lc(de.car(e),t);return de.iscons(e)&&(r=e.tail().reduce((n,o)=>BM.add(n,Lc(o,t)),r)),r}function QM(e,t){let[r,n]=jM.partition(e,t);return FM.multiply(r,jv(n,t))}function jv(e,t){let r=Si(e,t).toFixed(6),n=tT[r];if(!n)return Bv.makeList(Ln.symbol(de.INTEGRAL),e,t);let[o,i]=VM.transform(e,t,n,!1);return o===Ln.symbol(de.NIL)?Bv.makeList(Ln.symbol(de.INTEGRAL),e,t):o}var Cn={x:.95532,constexp:1.43762,constant:1.1441659362941434,constbase:1.2036412230421882,sin:1.7330548251830322,arcsin:1.6483368529465805,cos:1.0586721236863401,arccos:1.8405225918106694,tan:1.1224943776292506,arctan:1.1297397925394963,sinh:1.8176164926060079,cosh:1.9404934661708022,tanh:1.6421307715103122,log:1.477443701354924,erf:1.0825269225702916};function Si(e,t){if(de.issymbol(e))return UM.equal(e,t)?Cn.x:Cn.constant;if(de.iscons(e)){let n=de.car(e);switch(de.issymbol(n)&&n.printname){case de.ADD:return JM(de.cdr(e),t);case de.MULTIPLY:return KM(de.cdr(e),t);case de.POWER:return u_(de.cadr(e),de.caddr(e),t);case de.EXP:return u_(Ln.symbol(de.E),de.cadr(e),t);case de.SQRT:var r=Fv.double(.5);return u_(de.cadr(e),r,t);default:return WM(e,t)}}return Cn.constant}function WM(e,t){if(!ga.Find(de.cadr(e),t))return Cn.constant;let r=de.car(e),n=Si(de.cadr(e),t),o=Cn[r.printname];if(!o)throw new Error("Unsupported function "+r.printname);return Math.pow(o,n)}function JM(e,t){let r={};for(;de.iscons(e);){let o=de.car(e);e=de.cdr(e);let i=0;ga.Find(o,t)?i=Si(o,t):i=Cn.constant,r[i.toFixed(6)]=!0}let n=0;for(let o of Object.keys(r||{})){let i=r[o];n=n+Number(o)}return n}function KM(e,t){let r=1;return de.iscons(e)&&[...e].forEach(n=>{ga.Find(n,t)&&(r=r*Si(n,t))}),r}function u_(e,t,r){let n=Cn.constant,o=Cn.constexp;if(ga.Find(e,r)&&(n=Si(e,r)),ga.Find(t,r))o=Si(t,r);else{if(n===Cn.constant)return Cn.constant;Bl.isminusone(t)?o=-1:Bl.isoneovertwo(t)?o=.5:Bl.isminusoneovertwo(t)?o=-.5:Bl.equalq(t,2,1)?o=2:Bl.equalq(t,-2,1)&&(o=-2)}return Math.pow(n,o)}function eT(){let e={};for(let t of Array.from(ZM)){let r=zM.scan_meta(t),n=de.cadr(r),i=Si(n,Ln.symbol(de.METAX)).toFixed(6);e[i]||(e[i]=[]),e[i].push(t)}return console.log(`hashed_itab = ${JSON.stringify(e,null,2)}`),e}Qo.make_hashed_itab=eT;var tT={"1.144166":["f(a,a*x)"],"1.046770":["f(1/x,log(x))"],"0.936400":["f(x^a,x^(a+1)/(a+1))"],"1.095727":["f(x^(-2),-x^(-1))"],"1.023118":["f(x^(-1/2),2*x^(1/2))"],"0.977405":["f(x^(1/2),2/3*x^(3/2))"],"0.955320":["f(x,x^2/2)"],"0.912636":["f(x^2,x^3/3)"],"1.137302":["f(exp(a*x),1/a*exp(a*x))","f(a^x,a^x/log(a),or(not(number(a)),a>0))"],"1.326774":["f(exp(a*x+b),1/a*exp(a*x+b))"],"1.080259":["f(x*exp(a*x^2),exp(a*x^2)/(2*a))"],"1.260228":["f(x*exp(a*x^2+b),exp(a*x^2+b)/(2*a))"],"1.451902":["f(log(a*x),x*log(a*x)-x)"],"0.486192":["f(1/(a+x^2),1/sqrt(a)*arctan(x/sqrt(a)),or(not(number(a)),a>0))","f(1/(a-x^2),1/sqrt(a)*arctanh(x/sqrt(a)))","f(1/(a+b*x^2),1/sqrt(a*b)*arctan(x*sqrt(a*b)/a),or(not(number(a*b)),a*b>0))","f(1/(a+b*x^2),1/(2*sqrt(-a*b))*log((a+x*sqrt(-a*b))/(a-x*sqrt(-a*b))),or(not(number(a*b)),a*b<0))"],"0.697274":["f(1/sqrt(a-x^2),arcsin(x/(sqrt(a))))","f(1/sqrt(a+x^2),log(x+sqrt(a+x^2)))","f(1/sqrt(x^2+a),log(x+sqrt(x^2+a)))"],"0.476307":["f(1/(a+b*x),1/b*log(a+b*x))"],"0.226868":["f(1/(a+b*x)^2,-1/(b*(a+b*x)))"],"2.904531":["f(1/(a+b*x)^3,-1/(2*b)*1/(a+b*x)^2)"],"0.455026":["f(x/(a+b*x),x/b-a*log(a+b*x)/b/b)"],"0.216732":["f(x/(a+b*x)^2,1/b^2*(log(a+b*x)+a/(a+b*x)))"],"0.434695":["f(x^2/(a+b*x),1/b^2*(1/2*(a+b*x)^2-2*a*(a+b*x)+a^2*log(a+b*x)))"],"0.207048":["f(x^2/(a+b*x)^2,1/b^3*(a+b*x-2*a*log(a+b*x)-a^2/(a+b*x)))"],"2.650781":["f(x^2/(a+b*x)^3,1/b^3*(log(a+b*x)+2*a/(a+b*x)-1/2*a^2/(a+b*x)^2))"],"0.498584":["f(1/x*1/(a+b*x),-1/a*log((a+b*x)/x))"],"0.237479":["f(1/x*1/(a+b*x)^2,1/a*1/(a+b*x)-1/a^2*log((a+b*x)/x))"],"3.040375":["f(1/x*1/(a+b*x)^3,1/a^3*(1/2*((2*a+b*x)/(a+b*x))^2+log(x/(a+b*x))))"],"0.521902":["f(1/x^2*1/(a+b*x),-1/(a*x)+b/a^2*log((a+b*x)/x))"],"0.446014":["f(1/x^3*1/(a+b*x),(2*b*x-a)/(2*a^2*x^2)+b^2/a^3*log(x/(a+b*x)))"],"0.248586":["f(1/x^2*1/(a+b*x)^2,-(a+2*b*x)/(a^2*x*(a+b*x))+2*b/a^3*log((a+b*x)/x))"],"0.464469":["f(x/(a+b*x^2),1/2*1/b*log(a+b*x^2))"],"0.443716":["f(x^2/(a+b*x^2),x/b-a/b*integral(1/(a+b*x^2),x))"],"0.236382":["f(1/(a+b*x^2)^2,x/(2*a*(a+b*x^2))+1/2*1/a*integral(1/(a+b*x^2),x))"],"0.508931":["f(1/x*1/(a+b*x^2),1/2*1/a*log(x^2/(a+b*x^2)))"],"0.532733":["f(1/x^2*1/(a+b*x^2),-1/(a*x)-b/a*integral(1/(a+b*x^2),x))"],"0.480638":["f(1/(a+b*x^3),1/3*1/a*(a/b)^(1/3)*(1/2*log(((a/b)^(1/3)+x)^3/(a+b*x^3))+sqrt(3)*arctan((2*x-(a/b)^(1/3))*(a/b)^(-1/3)/sqrt(3))))"],"0.438648":["f(x^2/(a+b*x^3),1/3*1/b*log(a+b*x^3))"],"0.459164":["f(x/(a+b*x^4),1/2*sqrt(b/a)/b*arctan(x^2*sqrt(b/a)),or(not(number(a*b)),a*b>0))","f(x/(a+b*x^4),1/4*sqrt(-b/a)/b*log((x^2-sqrt(-a/b))/(x^2+sqrt(-a/b))),or(not(number(a*b)),a*b<0))"],"0.450070":["f(x^3/(a+b*x^4),1/4*1/b*log(a+b*x^4))"],"1.448960":["f(sqrt(a+b*x),2/3*1/b*sqrt((a+b*x)^3))"],"1.384221":["f(x*sqrt(a+b*x),-2*(2*a-3*b*x)*sqrt((a+b*x)^3)/15/b^2)"],"1.322374":["f(x^2*sqrt(a+b*x),2*(8*a^2-12*a*b*x+15*b^2*x^2)*sqrt((a+b*x)^3)/105/b^3)"],"1.516728":["f(sqrt(a+b*x)/x,2*sqrt(a+b*x)+a*integral(1/x*1/sqrt(a+b*x),x))"],"1.587665":["f(sqrt(a+b*x)/x^2,-sqrt(a+b*x)/x+b/2*integral(1/x*1/sqrt(a+b*x),x))"],"0.690150":["f(1/sqrt(a+b*x),2*sqrt(a+b*x)/b)"],"0.659314":["f(x/sqrt(a+b*x),-2/3*(2*a-b*x)*sqrt(a+b*x)/b^2)"],"0.629856":["f(x^2/sqrt(a+b*x),2/15*(8*a^2-4*a*b*x+3*b^2*x^2)*sqrt(a+b*x)/b^3)"],"0.722428":["f(1/x*1/sqrt(a+b*x),1/sqrt(a)*log((sqrt(a+b*x)-sqrt(a))/(sqrt(a+b*x)+sqrt(a))),or(not(number(a)),a>0))","f(1/x*1/sqrt(a+b*x),2/sqrt(-a)*arctan(sqrt(-(a+b*x)/a)),or(not(number(a)),a<0))"],"0.756216":["f(1/x^2*1/sqrt(a+b*x),-sqrt(a+b*x)/a/x-1/2*b/a*integral(1/x*1/sqrt(a+b*x),x))"],"1.434156":["f(sqrt(x^2+a),1/2*(x*sqrt(x^2+a)+a*log(x+sqrt(x^2+a))))","f(sqrt(a-x^2),1/2*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(abs(a)))))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*log(x*sqrt(a)+sqrt(a*x^2+b))/2/sqrt(a),and(number(a),a>0))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*arcsin(x*sqrt(-a/b))/2/sqrt(-a),and(number(a),a<0))"],"0.729886":["f(1/x*1/sqrt(x^2+a),arcsec(x/sqrt(-a))/sqrt(-a),or(not(number(a)),a<0))","f(1/x*1/sqrt(x^2+a),-1/sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(1/x*1/sqrt(a-x^2),-1/sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))"],"1.501230":["f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(-a)*arcsec(x/sqrt(-a)),or(not(number(a)),a<0))","f(sqrt(a-x^2)/x,sqrt(a-x^2)-sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))"],"0.666120":["f(x/sqrt(x^2+a),sqrt(x^2+a))","f(x/sqrt(a-x^2),-sqrt(a-x^2))"],"1.370077":["f(x*sqrt(x^2+a),1/3*sqrt((x^2+a)^3))","f(x*sqrt(a-x^2),-1/3*sqrt((a-x^2)^3))"],"1.730087":["f(sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2+a^(1/3))^3)+3/2*a^(1/3)*x*sqrt(x^2+a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2+a^(1/3)))))","f(sqrt(-a+x^6-3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2-a^(1/3))^3)-3/2*a^(1/3)*x*sqrt(x^2-a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2-a^(1/3)))))"],"0.578006":["f(1/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),x/a^(1/3)/sqrt(x^2+a^(1/3)))"],"0.552180":["f(x/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),-1/sqrt(x^2+a^(1/3)))"],"1.652787":["f(x*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/5*sqrt((x^2+a^(1/3))^5))"],"1.308862":["f(x^2*sqrt(x^2+a),1/4*x*sqrt((x^2+a)^3)-1/8*a*x*sqrt(x^2+a)-1/8*a^2*log(x+sqrt(x^2+a)))","f(x^2*sqrt(a-x^2),-x/4*sqrt((a-x^2)^3)+1/8*a*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(a))),or(not(number(a)),a>0))"],"1.342944":["f(x^3*sqrt(x^2+a),(1/5*x^2-2/15*a)*sqrt((x^2+a)^3),and(number(a),a>0))","f(x^3*sqrt(x^2+a),sqrt((x^2+a)^5)/5-a*sqrt((x^2+a)^3)/3,and(number(a),a<0))","f(x^3*sqrt(a-x^2),(-1/5*x^2-2/15*a)*sqrt((a-x^2)^3),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^3,-1/2*sqrt(a-x^2)/x^2+1/2*log((sqrt(a)+sqrt(a-x^2))/x)/sqrt(a),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^4,-1/3*sqrt((a-x^2)^3)/a/x^3,or(not(number(a)),a>0))"],"0.636358":["f(x^2/sqrt(x^2+a),1/2*x*sqrt(x^2+a)-1/2*a*log(x+sqrt(x^2+a)))","f(x^2/sqrt(a-x^2),-x/2*sqrt(a-x^2)+a/2*arcsin(x/sqrt(a)),or(not(number(a)),a>0))"],"0.652928":["f(x^3/sqrt(x^2+a),1/3*sqrt((x^2+a)^3)-a*sqrt(x^2+a))","f(1/x^3*1/sqrt(x^2+a),-1/2*sqrt(x^2+a)/a/x^2+1/2*log((sqrt(a)+sqrt(x^2+a))/x)/a^(3/2),or(not(number(a)),a>0))","f(1/x^3*1/sqrt(x^2-a),1/2*sqrt(x^2-a)/a/x^2+1/2*1/(a^(3/2))*arcsec(x/(a^(1/2))),or(not(number(a)),a>0))"],"0.764022":["f(1/x^2*1/sqrt(x^2+a),-sqrt(x^2+a)/a/x)","f(1/x^2*1/sqrt(a-x^2),-sqrt(a-x^2)/a/x,or(not(number(a)),a>0))"],"1.578940":["f(x^2*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/6*x*sqrt((x^2+a^(1/3))^5)-1/24*a^(1/3)*x*sqrt((x^2+a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2+a^(1/3))-1/16*a*log(x+sqrt(x^2+a^(1/3))),or(not(number(a)),a>0))","f(x^2*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/6*x*sqrt((x^2-a^(1/3))^5)+1/24*a^(1/3)*x*sqrt((x^2-a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2-a^(1/3))+1/16*a*log(x+sqrt(x^2-a^(1/3))),or(not(number(a)),a>0))"],"1.620055":["f(x^3*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/7*sqrt((x^2+a^(1/3))^7)-1/5*a^(1/3)*sqrt((x^2+a^(1/3))^5),or(not(number(a)),a>0))","f(x^3*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/7*sqrt((x^2-a^(1/3))^7)+1/5*a^(1/3)*sqrt((x^2-a^(1/3))^5),or(not(number(a)),a>0))"],"0.332117":["f(1/(x-a)/sqrt(x^2-a^2),-sqrt(x^2-a^2)/a/(x-a))","f(1/(x+a)/sqrt(x^2-a^2),sqrt(x^2-a^2)/a/(x+a))"],"1.571443":["f(sqrt(a-x^2)/x^2,-sqrt(a-x^2)/x-arcsin(x/sqrt(a)),or(not(number(a)),a>0))"],"1.690994":["f(sin(a*x),-cos(a*x)/a)"],"1.055979":["f(cos(a*x),sin(a*x)/a)"],"1.116714":["f(tan(a*x),-log(cos(a*x))/a)"],"0.895484":["f(1/tan(a*x),log(sin(a*x))/a)"],"0.946989":["f(1/cos(a*x),log(tan(pi/4+a*x/2))/a)"],"0.591368":["f(1/sin(a*x),log(tan(a*x/2))/a)"],"2.859462":["f(sin(a*x)^2,x/2-sin(2*a*x)/(4*a))"],"2.128050":["f(sin(a*x)^3,-cos(a*x)*(sin(a*x)^2+2)/(3*a))","f(sin(a*x)^4,3/8*x-sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))"],"1.115091":["f(cos(a*x)^2,x/2+sin(2*a*x)/(4*a))"],"1.081452":["f(cos(a*x)^3,sin(a*x)*(cos(a*x)^2+2)/(3*a))","f(cos(a*x)^4,3/8*x+sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))"],"0.349716":["f(1/sin(a*x)^2,-1/(a*tan(a*x)))"],"0.896788":["f(1/cos(a*x)^2,tan(a*x)/a)"],"1.785654":["f(sin(a*x)*cos(a*x),sin(a*x)^2/(2*a))"],"3.188560":["f(sin(a*x)^2*cos(a*x)^2,-sin(4*a*x)/(32*a)+x/8)"],"1.516463":["f(sin(a*x)/cos(a*x)^2,1/(a*cos(a*x)))"],"2.707879":["f(sin(a*x)^2/cos(a*x),(log(tan(pi/4+a*x/2))-sin(a*x))/a)"],"0.369293":["f(cos(a*x)/sin(a*x)^2,-1/(a*sin(a*x)))"],"0.560019":["f(1/(sin(a*x)*cos(a*x)),log(tan(a*x))/a)"],"0.530332":["f(1/(sin(a*x)*cos(a*x)^2),(1/cos(a*x)+log(tan(a*x/2)))/a)"],"0.331177":["f(1/(sin(a*x)^2*cos(a*x)),(log(tan(pi/4+a*x/2))-1/sin(a*x))/a)"],"0.313621":["f(1/(sin(a*x)^2*cos(a*x)^2),-2/(a*tan(2*a*x)))"],"3.172365":["f(sin(a+b*x),-cos(a+b*x)/b)"],"1.127162":["f(cos(a+b*x),sin(a+b*x)/b)"],"0.352714":["f(1/(b+b*sin(a*x)),-tan(pi/4-a*x/2)/a/b)","f(1/(b-b*sin(a*x)),tan(pi/4+a*x/2)/a/b)","f(1/(a+b*sin(x)),1/sqrt(b^2-a^2)*log((a*tan(x/2)+b-sqrt(b^2-a^2))/(a*tan(x/2)+b+sqrt(b^2-a^2))),b^2-a^2)"],"0.454515":["f(1/(b+b*cos(a*x)),tan(a*x/2)/a/b)","f(1/(b-b*cos(a*x)),-1/tan(a*x/2)/a/b)","f(1/(a+b*cos(x)),1/sqrt(b^2-a^2)*log((sqrt(b^2-a^2)*tan(x/2)+a+b)/(sqrt(b^2-a^2)*tan(x/2)-a-b)),b^2-a^2)"],"1.615441":["f(x*sin(a*x),sin(a*x)/a^2-x*cos(a*x)/a)"],"1.543263":["f(x^2*sin(a*x),2*x*sin(a*x)/a^2-(a^2*x^2-2)*cos(a*x)/a^3)"],"1.008798":["f(x*cos(a*x),cos(a*x)/a^2+x*sin(a*x)/a)"],"0.963724":["f(x^2*cos(a*x),2*x*cos(a*x)/a^2+(a^2*x^2-2)*sin(a*x)/a^3)"],"1.611938":["f(arcsin(a*x),x*arcsin(a*x)+sqrt(1-a^2*x^2)/a)"],"1.791033":["f(arccos(a*x),x*arccos(a*x)-sqrt(1-a^2*x^2)/a)"],"1.123599":["f(arctan(a*x),x*arctan(a*x)-1/2*log(1+a^2*x^2)/a)"],"1.387031":["f(x*log(a*x),x^2*log(a*x)/2-x^2/4)"],"1.325058":["f(x^2*log(a*x),x^3*log(a*x)/3-1/9*x^3)"],"2.108018":["f(log(x)^2,x*log(x)^2-2*x*log(x)+2*x)"],"0.403214":["f(1/x*1/(a+log(x)),log(a+log(x)))"],"2.269268":["f(log(a*x+b),(a*x+b)*log(a*x+b)/a-x)"],"2.486498":["f(log(a*x+b)/x^2,a/b*log(x)-(a*x+b)*log(a*x+b)/b/x)"],"1.769733":["f(sinh(x),cosh(x))"],"1.883858":["f(cosh(x),sinh(x))"],"1.606140":["f(tanh(x),log(cosh(x)))"],"1.690661":["f(x*sinh(x),x*cosh(x)-sinh(x))"],"1.799688":["f(x*cosh(x),x*sinh(x)-cosh(x))"],"3.131954":["f(sinh(x)^2,sinh(2*x)/4-x/2)"],"2.579685":["f(tanh(x)^2,x-tanh(x))"],"3.548923":["f(cosh(x)^2,sinh(2*x)/4+x/2)"],"1.058866":["f(x^3*exp(a*x^2),exp(a*x^2)*(x^2/a-1/(a^2))/2)"],"1.235270":["f(x^3*exp(a*x^2+b),exp(a*x^2)*exp(b)*(x^2/a-1/(a^2))/2)"],"1.130783":["f(exp(a*x^2),-i*sqrt(pi)*erf(i*sqrt(a)*x)/sqrt(a)/2)"],"1.078698":["f(erf(a*x),x*erf(a*x)+exp(-a^2*x^2)/a/sqrt(pi))"],"2.573650":["f(x^2*(1-x^2)^(3/2),(x*sqrt(1-x^2)*(-8*x^4+14*x^2-3)+3*arcsin(x))/48)","f(x^2*(1-x^2)^(5/2),(x*sqrt(1-x^2)*(48*x^6-136*x^4+118*x^2-15)+15*arcsin(x))/384)"],"2.640666":["f(x^4*(1-x^2)^(3/2),(-x*sqrt(1-x^2)*(16*x^6-24*x^4+2*x^2+3)+3*arcsin(x))/128)"],"1.086487":["f(x*exp(a*x),exp(a*x)*(a*x-1)/(a^2))"],"1.267493":["f(x*exp(a*x+b),exp(a*x+b)*(a*x-1)/(a^2))"],"1.037943":["f(x^2*exp(a*x),exp(a*x)*(a^2*x^2-2*a*x+2)/(a^3))"],"1.210862":["f(x^2*exp(a*x+b),exp(a*x+b)*(a^2*x^2-2*a*x+2)/(a^3))"],"1.064970":["f(x^3*exp(a*x),exp(a*x)*x^3/a-3/a*integral(x^2*exp(a*x),x))"],"1.242392":["f(x^3*exp(a*x+b),exp(a*x+b)*x^3/a-3/a*integral(x^2*exp(a*x+b),x))"]}});var m_=A(ya=>{"use strict";Object.defineProperty(ya,"__esModule",{value:!0});ya.logarithm=ya.Eval_log=void 0;var Pr=N(),zv=U(),c_=ue(),rT=F(),nT=Mn(),oT=G(),f_=H(),iT=K(),d_=Z(),sT=oo();function aT(e){return wi(oT.Eval(Pr.cadr(e)))}ya.Eval_log=aT;function wi(e){return e===zv.symbol(Pr.E)?Pr.Constants.one:f_.equaln(e,1)?Pr.Constants.zero:f_.isnegativenumber(e)?c_.add(wi(d_.negate(e)),d_.multiply(Pr.Constants.imaginaryunit,Pr.Constants.Pi())):Pr.isdouble(e)?rT.double(Math.log(e.d)):f_.isfraction(e)?c_.subtract(wi(sT.numerator(e)),wi(nT.denominator(e))):Pr.ispower(e)?d_.multiply(Pr.caddr(e),wi(Pr.cadr(e))):Pr.ismultiply(e)?e.tail().map(wi).reduce(c_.add,Pr.Constants.zero):iT.makeList(zv.symbol(Pr.LOG),e)}ya.logarithm=wi});var b_=A(va=>{"use strict";Object.defineProperty(va,"__esModule",{value:!0});va.sgn=va.Eval_sgn=void 0;var xr=N(),Yv=U(),lT=on(),uT=G(),Vv=H(),Zv=K(),Xv=ln(),__=Z(),cT=Et();function fT(e){return Hv(uT.Eval(xr.cadr(e)))}va.Eval_sgn=fT;function Hv(e){return xr.isdouble(e)?e.d>0||e.d===0?xr.Constants.one:xr.Constants.negOne:xr.isrational(e)?xr.MSIGN(Xv.mmul(e.q.a,e.q.b))===-1?xr.Constants.negOne:xr.MZERO(Xv.mmul(e.q.a,e.q.b))?xr.Constants.zero:xr.Constants.one:Vv.iscomplexnumber(e)?__.multiply(cT.power(xr.Constants.negOne,lT.absval(e)),e):Vv.isnegativeterm(e)?__.multiply(Zv.makeList(Yv.symbol(xr.SGN),__.negate(e)),xr.Constants.negOne):Zv.makeList(Yv.symbol(xr.SGN),e)}va.sgn=Hv});var g_=A(qa=>{"use strict";Object.defineProperty(qa,"__esModule",{value:!0});qa.ysinh=qa.Eval_sinh=void 0;var Li=N(),Qv=U(),dT=F(),mT=G(),_T=H(),bT=K();function gT(e){return Wv(mT.Eval(Li.cadr(e)))}qa.Eval_sinh=gT;function Wv(e){if(Li.car(e)===Qv.symbol(Li.ARCSINH))return Li.cadr(e);if(Li.isdouble(e)){let t=Math.sinh(e.d);return Math.abs(t)<1e-10&&(t=0),dT.double(t)}return _T.isZeroAtomOrTensor(e)?Li.Constants.zero:bT.makeList(Qv.symbol(Li.SINH),e)}qa.ysinh=Wv});var Ri=A(xa=>{"use strict";Object.defineProperty(xa,"__esModule",{value:!0});xa.derivative=xa.Eval_derivative=void 0;var E=N(),yT=ir(),t1=Ee(),Pe=U(),jl=Ne(),Tr=ue(),Cc=Nm(),Jv=Im(),Dt=F(),r1=Lo(),n1=Sm(),vT=Cm(),Ea=G(),Kv=Vr(),qT=vm(),ET=Gl(),o1=H(),Fl=K(),xT=m_(),ye=Z(),br=Et(),pT=b_(),hT=Zo(),AT=Qn(),OT=g_(),e1=Yr(),y_=qt();function MT(e){e=E.cdr(e);let t=Ea.Eval(E.car(e));e=E.cdr(e);let r,n,o=Ea.Eval(E.car(e));for(o===Pe.symbol(E.NIL)?(r=Kv.guess(t),n=Pe.symbol(E.NIL)):E.isNumericAtom(o)?(r=Kv.guess(t),n=o):(r=o,e=E.cdr(e),n=Ea.Eval(E.car(e)));;){let i;E.isNumericAtom(n)?(i=Dt.nativeInt(n),isNaN(i)&&t1.stop("nth derivative: check n")):i=1;let s=t;if(i>=0)for(let u=0;u<i;u++)s=tt(s,r);else{i=-i;for(let u=0;u<i;u++)s=ET.integral(s,r)}if(t=s,n===Pe.symbol(E.NIL))break;if(E.isNumericAtom(n)){if(e=E.cdr(e),n=Ea.Eval(E.car(e)),n===Pe.symbol(E.NIL))break;E.isNumericAtom(n)||(r=n,e=E.cdr(e),n=Ea.Eval(E.car(e)))}else r=n,e=E.cdr(e),n=Ea.Eval(E.car(e))}return t}xa.Eval_derivative=MT;function tt(e,t){return E.isNumericAtom(t)&&t1.stop("undefined function"),E.istensor(e)?E.istensor(t)?y_.d_tensor_tensor(e,t):y_.d_tensor_scalar(e,t):E.istensor(t)?y_.d_scalar_tensor(e,t):TT(e,t)}xa.derivative=tt;function TT(e,t){if(E.issymbol(t))return NT(e,t);let r=e1.subst(e,t,Pe.symbol(E.SECRETX));return e1.subst(tt(r,Pe.symbol(E.SECRETX)),Pe.symbol(E.SECRETX),t)}function NT(e,t){if(jl.equal(e,t))return E.Constants.one;if(!E.iscons(e))return E.Constants.zero;if(E.isadd(e))return IT(e,t);switch(E.car(e)){case Pe.symbol(E.MULTIPLY):return ST(e,t);case Pe.symbol(E.POWER):return RT(e,t);case Pe.symbol(E.DERIVATIVE):return LT(e,t);case Pe.symbol(E.LOG):return wT(e,t);case Pe.symbol(E.SIN):return PT(e,t);case Pe.symbol(E.COS):return DT(e,t);case Pe.symbol(E.TAN):return kT(e,t);case Pe.symbol(E.ARCSIN):return $T(e,t);case Pe.symbol(E.ARCCOS):return UT(e,t);case Pe.symbol(E.ARCTAN):return BT(e,t);case Pe.symbol(E.SINH):return GT(e,t);case Pe.symbol(E.COSH):return FT(e,t);case Pe.symbol(E.TANH):return jT(e,t);case Pe.symbol(E.ARCSINH):return zT(e,t);case Pe.symbol(E.ARCCOSH):return YT(e,t);case Pe.symbol(E.ARCTANH):return VT(e,t);case Pe.symbol(E.ABS):return ZT(e,t);case Pe.symbol(E.SGN):return XT(e,t);case Pe.symbol(E.HERMITE):return HT(e,t);case Pe.symbol(E.ERF):return QT(e,t);case Pe.symbol(E.ERFC):return WT(e,t);case Pe.symbol(E.BESSELJ):return JT(e,t);case Pe.symbol(E.BESSELY):return tN(e,t);default:}return E.car(e)===Pe.symbol(E.INTEGRAL)&&E.caddr(e)===t?oN(e):CT(e,t)}function IT(e,t){let r=E.iscons(e)?e.tail().map(n=>tt(n,t)):[];return Tr.add_all(r)}function ST(e,t){let r=jl.length(e)-1,n=[];for(let o=0;o<r;o++){let i=[],s=E.cdr(e);for(let u=0;u<r;u++){let c=E.car(s);o===u&&(c=tt(c,t)),i.push(c),s=E.cdr(s)}n.push(ye.multiply_all(i))}return Tr.add_all(n)}function RT(e,t){let r=ye.divide(E.caddr(e),E.cadr(e)),n=tt(E.cadr(e),t),o=xT.logarithm(E.cadr(e)),i=tt(E.caddr(e),t);return ye.multiply(Tr.add(ye.multiply(r,n),ye.multiply(o,i)),e)}function wT(e,t){let r=tt(E.cadr(e),t);return ye.divide(r,E.cadr(e))}function LT(e,t){let r=tt(E.cadr(e),t);return E.car(r)===Pe.symbol(E.DERIVATIVE)?jl.lessp(E.caddr(r),E.caddr(e))?Fl.makeList(Pe.symbol(E.DERIVATIVE),Fl.makeList(Pe.symbol(E.DERIVATIVE),E.cadr(r),E.caddr(r)),E.caddr(e)):Fl.makeList(Pe.symbol(E.DERIVATIVE),Fl.makeList(Pe.symbol(E.DERIVATIVE),E.cadr(r),E.caddr(e)),E.caddr(r)):tt(r,E.caddr(e))}function CT(e,t){let r=E.cdr(e);return r===Pe.symbol(E.NIL)||yT.Find(r,t)?Fl.makeList(Pe.symbol(E.DERIVATIVE),e,t):E.Constants.zero}function PT(e,t){let r=tt(E.cadr(e),t);return ye.multiply(r,r1.cosine(E.cadr(e)))}function DT(e,t){let r=tt(E.cadr(e),t);return ye.negate(ye.multiply(r,AT.sine(E.cadr(e))))}function kT(e,t){let r=tt(E.cadr(e),t);return ye.multiply(r,br.power(r1.cosine(E.cadr(e)),Dt.integer(-2)))}function $T(e,t){let r=tt(E.cadr(e),t);return ye.multiply(r,br.power(Tr.subtract(E.Constants.one,br.power(E.cadr(e),Dt.integer(2))),Dt.rational(-1,2)))}function UT(e,t){let r=tt(E.cadr(e),t);return ye.negate(ye.multiply(r,br.power(Tr.subtract(E.Constants.one,br.power(E.cadr(e),Dt.integer(2))),Dt.rational(-1,2))))}function BT(e,t){let r=tt(E.cadr(e),t);return hT.simplify(ye.multiply(r,ye.inverse(Tr.add(E.Constants.one,br.power(E.cadr(e),Dt.integer(2))))))}function GT(e,t){let r=tt(E.cadr(e),t);return ye.multiply(r,n1.ycosh(E.cadr(e)))}function FT(e,t){let r=tt(E.cadr(e),t);return ye.multiply(r,OT.ysinh(E.cadr(e)))}function jT(e,t){let r=tt(E.cadr(e),t);return ye.multiply(r,br.power(n1.ycosh(E.cadr(e)),Dt.integer(-2)))}function zT(e,t){let r=tt(E.cadr(e),t);return ye.multiply(r,br.power(Tr.add(br.power(E.cadr(e),Dt.integer(2)),E.Constants.one),Dt.rational(-1,2)))}function YT(e,t){let r=tt(E.cadr(e),t);return ye.multiply(r,br.power(Tr.add(br.power(E.cadr(e),Dt.integer(2)),E.Constants.negOne),Dt.rational(-1,2)))}function VT(e,t){let r=tt(E.cadr(e),t);return ye.multiply(r,ye.inverse(Tr.subtract(E.Constants.one,br.power(E.cadr(e),Dt.integer(2)))))}function ZT(e,t){let r=tt(E.cadr(e),t);return ye.multiply(r,pT.sgn(E.cadr(e)))}function XT(e,t){let r=tt(E.cadr(e),t);return ye.multiply(ye.multiply(r,vT.dirac(E.cadr(e))),Dt.integer(2))}function HT(e,t){let r=tt(E.cadr(e),t);return ye.multiply(ye.multiply(r,ye.multiply(Dt.integer(2),E.caddr(e))),qT.hermite(E.cadr(e),Tr.add(E.caddr(e),E.Constants.negOne)))}function QT(e,t){let r=tt(E.cadr(e),t);return ye.multiply(ye.multiply(ye.multiply(jl.exponential(ye.multiply(br.power(E.cadr(e),Dt.integer(2)),E.Constants.negOne)),br.power(E.Constants.Pi(),Dt.rational(-1,2))),Dt.integer(2)),r)}function WT(e,t){let r=tt(E.cadr(e),t);return ye.multiply(ye.multiply(ye.multiply(jl.exponential(ye.multiply(br.power(E.cadr(e),Dt.integer(2)),E.Constants.negOne)),br.power(E.Constants.Pi(),Dt.rational(-1,2))),Dt.integer(-2)),r)}function JT(e,t){return o1.isZeroAtomOrTensor(E.caddr(e))?KT(e,t):eN(e,t)}function KT(e,t){let r=tt(E.cadr(e),t);return ye.multiply(ye.multiply(r,Cc.besselj(E.cadr(e),E.Constants.one)),E.Constants.negOne)}function eN(e,t){let r=tt(E.cadr(e),t);return ye.multiply(r,Tr.add(Cc.besselj(E.cadr(e),Tr.add(E.caddr(e),E.Constants.negOne)),ye.multiply(ye.divide(ye.multiply(E.caddr(e),E.Constants.negOne),E.cadr(e)),Cc.besselj(E.cadr(e),E.caddr(e)))))}function tN(e,t){return o1.isZeroAtomOrTensor(E.caddr(e))?rN(e,t):nN(e,t)}function rN(e,t){let r=tt(E.cadr(e),t);return ye.multiply(ye.multiply(r,Cc.besselj(E.cadr(e),E.Constants.one)),E.Constants.negOne)}function nN(e,t){let r=tt(E.cadr(e),t);return ye.multiply(r,Tr.add(Jv.bessely(E.cadr(e),Tr.add(E.caddr(e),E.Constants.negOne)),ye.multiply(ye.divide(ye.multiply(E.caddr(e),E.Constants.negOne),E.cadr(e)),Jv.bessely(E.cadr(e),E.caddr(e)))))}function oN(e){return E.cadr(e)}});var s1=A(Dc=>{"use strict";Object.defineProperty(Dc,"__esModule",{value:!0});Dc.Eval_user_function=void 0;var ze=N(),v_=Ee(),Ci=U(),iN=Ri(),q_=G(),E_=K(),i1=qt();function sN(e){if(ze.DEBUG&&console.log(`Eval_user_function evaluating: ${ze.car(e)}`),ze.car(e)===Ci.symbol(ze.SYMBOL_D)&&Ci.get_binding(Ci.symbol(ze.SYMBOL_D))===Ci.symbol(ze.SYMBOL_D))return iN.Eval_derivative(e);let t=q_.Eval(ze.car(e));ze.isNumericAtom(t)?v_.stop("expected function invocation, found multiplication instead. Use '*' symbol explicitly for multiplication."):ze.istensor(t)?v_.stop("expected function invocation, found tensor product instead. Use 'dot/inner' explicitly."):ze.isstr(t)&&v_.stop("expected function, found string instead.");let r=ze.car(ze.cdr(t)),n=ze.car(ze.cdr(ze.cdr(t))),o=ze.cdr(e);if(ze.car(t)!==Ci.symbol(ze.FUNCTION)||t===ze.car(e))return E_.makeList(t,...q_.evalList(o));e=n;let i=o,s=[];for(;ze.iscons(e)&&ze.iscons(i);)s.push(ze.car(e)),s.push(ze.car(i)),e=ze.cdr(e),i=ze.cdr(i);return s.length&&(r=Pc(r,s)),q_.Eval(r)}Dc.Eval_user_function=sN;function Pc(e,t){if(ze.istensor(e))return aN(e,t);if(ze.iscons(e)){let n=[];for(ze.car(e)===t[0]?n.push(E_.makeList(Ci.symbol(ze.EVAL),t[1])):n.push(ze.car(e)),e=ze.cdr(e);ze.iscons(e);)n.push(Pc(ze.car(e),t)),e=ze.cdr(e);return E_.makeList(...n)}if(!ze.issymbol(e))return e;for(let n=0;n<t.length;n+=2)if(e===t[n])return t[n+1];let r=Ci.get_binding(e);return e!==r&&Pc(r,t)===r?e:r}function aN(e,t){return e=i1.copy_tensor(e),e.tensor.elem=e.tensor.elem.map(r=>Pc(r,t)),i1.check_tensor_dimensions(e),e}});var G=A(J=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0});J.evalList=J.Eval_predicate=J.Eval_unit=J.Eval_subst=J.Eval_stop=J.Eval_sqrt=J.Eval_setq=J.Eval_rank=J.Eval_quote=J.Eval_operator=J.Eval_number=J.Eval_isinteger=J.Eval_invg=J.Eval_inv=J.Eval_index=J.Eval_hilbert=J.Eval_hermite=J.Eval_factorpoly=J.Eval_factorial=J.Eval_exp=J.Eval_Eval=J.Eval_dsolve=J.Eval_do=J.Eval_divisors=J.Eval_dim=J.Eval_det=J.Eval_check=J.Eval_binding=J.Eval_cons=J.Eval_sym=J.Eval=J.evaluate_integer=void 0;var u1=Kb(),lN=It(),w=N(),mo=Ee(),pr=U(),Pi=F(),uN=Cd(),cN=dc(),fN=Zd(),dN=pi(),a1=Es(),mN=vm(),_N=ky(),c1=Nl(),kc=H(),$c=K(),bN=Ne(),gN=Et(),f1=Yr(),d1=qt(),l1=s1();function x_(e){return Pi.nativeInt(Re(e))}J.evaluate_integer=x_;function Re(e){let t;mo.check_esc_flag(),e==null&&w.breakpoint,!w.defs.evaluatingAsFloats&&kc.isfloating(e)&&(t=!0,w.defs.evaluatingAsFloats=!0);try{switch(e.k){case w.CONS:return _1(e);case w.NUM:return w.defs.evaluatingAsFloats?Pi.double(Pi.convert_rational_to_double(e)):e;case w.DOUBLE:case w.STR:return e;case w.TENSOR:return d1.Eval_tensor(e);case w.SYM:return m1(e);default:mo.stop("atom?")}}finally{t&&(w.defs.evaluatingAsFloats=!1)}}J.Eval=Re;function m1(e){if(pr.iskeyword(e))return Re($c.makeList(e,pr.symbol(w.LAST)));if(e===pr.symbol(w.PI)&&w.defs.evaluatingAsFloats)return w.Constants.piAsDouble;let t=pr.get_binding(e);if(w.DEBUG&&console.log(`looked up: ${e} which contains: ${t}`),e!==t){let r=w.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated.indexOf(e);if(r!==-1){let n="";for(let o=r;o<w.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated.length;o++)n+=w.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated[o].printname+" -> ";n+=e.printname,mo.stop("recursive evaluation of symbols: "+n);return}w.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated.push(e),t=Re(t),w.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated.pop()}return t}J.Eval_sym=m1;function _1(e){let t=w.car(e);return w.car(t)===pr.symbol(w.EVAL)?l1.Eval_user_function(e):(w.issymbol(t)||mo.stop("cons?"),t.keyword?t.keyword(e):l1.Eval_user_function(e))}J.Eval_cons=_1;function yN(e){return pr.get_binding(w.cadr(e))}J.Eval_binding=yN;function vN(e){let t=kc.isZeroLikeOrNonZeroLikeOrUndetermined(w.cadr(e));return t==null?e:Pi.integer(Number(t))}J.Eval_check=vN;function qN(e){let t=Re(w.cadr(e));return cN.det(t)}J.Eval_det=qN;function EN(e){let t=Re(w.cadr(e)),r=w.iscons(w.cddr(e))?x_(w.caddr(e)):1;return w.istensor(t)?r<1||r>t.tensor.ndim?e:Pi.integer(t.tensor.dim[r-1]):w.Constants.one}J.Eval_dim=EN;function xN(e){return fN.divisors(Re(w.cadr(e)))}J.Eval_divisors=xN;function pN(e){let t=w.car(e);for(e=w.cdr(e);w.iscons(e);)t=Re(w.car(e)),e=w.cdr(e);return t}J.Eval_do=pN;function hN(e){let t=Re(w.cadr(e)),r=Re(w.caddr(e)),n=Re(w.cadddr(e));mo.stop("dsolve")}J.Eval_dsolve=hN;function AN(e){let t=Re(w.cadr(e));for(e=w.cddr(e);w.iscons(e);)t=f1.subst(t,Re(w.car(e)),Re(w.cadr(e))),e=w.cddr(e);return Re(t)}J.Eval_Eval=AN;function ON(e){return bN.exponential(Re(w.cadr(e)))}J.Eval_exp=ON;function MN(e){return dN.factorial(Re(w.cadr(e)))}J.Eval_factorial=MN;function TN(e){e=w.cdr(e);let t=Re(w.car(e));e=w.cdr(e);let r=Re(w.car(e)),n=a1.factorpoly(t,r);return w.iscons(e)&&(n=e.tail().reduce((o,i)=>a1.factorpoly(o,Re(i)),n)),n}J.Eval_factorpoly=TN;function NN(e){let t=Re(w.caddr(e)),r=Re(w.cadr(e));return mN.hermite(r,t)}J.Eval_hermite=NN;function IN(e){return _N.hilbert(Re(w.cadr(e)))}J.Eval_hilbert=IN;function SN(e){let t=e;e=w.cdr(e);let r=Re(w.car(e));if(w.isNumericAtom(r)&&mo.stop("trying to access a scalar as a tensor"),!w.istensor(r))return t;let n=[];for(e=w.cdr(e);w.iscons(e);){if(n.push(Re(w.car(e))),!kc.isintegerorintegerfloat(n[n.length-1]))return t;e=w.cdr(e)}return u1.index_function(r,n)}J.Eval_index=SN;function RN(e){let t=Re(w.cadr(e));return c1.inv(t)}J.Eval_inv=RN;function wN(e){let t=Re(w.cadr(e));return c1.invg(t)}J.Eval_invg=wN;function LN(e){return e=Re(w.cadr(e)),w.isrational(e)?kc.isinteger(e)?w.Constants.one:w.Constants.zero:w.isdouble(e)?Math.floor(e.d)===e.d?w.Constants.one:w.Constants.zero:$c.makeList(pr.symbol(w.ISINTEGER),e)}J.Eval_isinteger=LN;function CN(e){return e=Re(w.cadr(e)),e.k===w.NUM||e.k===w.DOUBLE?w.Constants.one:w.Constants.zero}J.Eval_number=CN;function PN(e){return $c.makeList(pr.symbol(w.OPERATOR),...b1(w.cdr(e)))}J.Eval_operator=PN;function DN(e){return w.cadr(e)}J.Eval_quote=DN;function kN(e){return e=Re(w.cadr(e)),w.istensor(e)?Pi.integer(e.tensor.ndim):w.Constants.zero}J.Eval_rank=kN;function $N(e){if(w.caadr(e)===pr.symbol(w.INDEX))return UN(e);if(w.iscons(w.cadr(e)))return uN.define_user_function(e);w.issymbol(w.cadr(e))||mo.stop("symbol assignment: error in symbol");let t=Re(w.caddr(e));return pr.set_binding(w.cadr(e),t),pr.symbol(w.NIL)}J.Eval_setq=$N;function UN(e){let t=w.cadadr(e);console.log(`p4: ${t}`),w.issymbol(t)||mo.stop("indexed assignment: expected a symbol name");let r=Re(w.caddr(e)),n=[],o=w.cdadr(e);w.iscons(o)&&(n=[...o].map(Re));let i=u1.set_component(r,...n);return pr.set_binding(t,i),pr.symbol(w.NIL)}function BN(e){let t=Re(w.cadr(e));return gN.power(t,Pi.rational(1,2))}J.Eval_sqrt=BN;function GN(){mo.stop("user stop")}J.Eval_stop=GN;function FN(e){let t=Re(w.cadr(e)),r=Re(w.caddr(e)),n=Re(w.cadddr(e));return Re(f1.subst(n,r,t))}J.Eval_subst=FN;function jN(e){let t=x_(w.cadr(e));if(isNaN(t)||t<1)return e;e=lN.alloc_tensor(t*t),e.tensor.ndim=2,e.tensor.dim[0]=t,e.tensor.dim[1]=t;for(let r=0;r<t;r++)e.tensor.elem[t*r+r]=w.Constants.one;return d1.check_tensor_dimensions(e),e}J.Eval_unit=jN;function zN(e){return w.car(e)===pr.symbol(w.SETQ)&&(e=$c.makeList(pr.symbol(w.TESTEQ),w.cadr(e),w.caddr(e))),Re(e)}J.Eval_predicate=zN;function*b1(e){if(w.iscons(e))for(let t of e)yield Re(t)}J.evalList=b1});var ue=A(Pn=>{"use strict";Object.defineProperty(Pn,"__esModule",{value:!0});Pn.subtract=Pn.add_all=Pn.add=Pn.Eval_add=void 0;var ae=N(),YN=Ee(),Di=U(),g1=F(),VN=G(),p_=H(),ZN=K(),y1=Ne(),v1=Z(),XN=eo(),HN=qt(),zl=0;function QN(e){let t=[];e=ae.cdr(e);for(let r of e){let n=VN.Eval(r);Uc(t,n)}return h_(t)}Pn.Eval_add=QN;function h_(e){if(ae.DEBUG)for(let t of e)console.log(XN.print_list(t));for(let t=0;t<10&&!(e.length<2||(zl=0,e.sort(JN),zl===0));t++)KN(e);switch(e.length){case 0:return ae.Constants.Zero();case 1:return e[0];default:return e.unshift(Di.symbol(ae.ADD)),ZN.makeList(...e)}}var WN=0;function JN(e,t){if(WN++,ae.isNumericAtom(e)&&ae.isNumericAtom(t))return zl=1,0;if(ae.istensor(e)&&ae.istensor(t)){if(e.tensor.ndim<t.tensor.ndim)return-1;if(e.tensor.ndim>t.tensor.ndim)return 1;for(let n=0;n<e.tensor.ndim;n++){if(e.tensor.dim[n]<t.tensor.dim[n])return-1;if(e.tensor.dim[n]>t.tensor.dim[n])return 1}return zl=1,0}ae.ismultiply(e)&&(e=ae.cdr(e),ae.isNumericAtom(ae.car(e))&&(e=ae.cdr(e),ae.cdr(e)===Di.symbol(ae.NIL)&&(e=ae.car(e)))),ae.ismultiply(t)&&(t=ae.cdr(t),ae.isNumericAtom(ae.car(t))&&(t=ae.cdr(t),ae.cdr(t)===Di.symbol(ae.NIL)&&(t=ae.car(t))));let r=y1.cmp_expr(e,t);return r===0&&(zl=1),r}function KN(e){let t=0;for(;t<e.length-1;){YN.check_esc_flag();let r,n,o=e[t],i=e[t+1];if(ae.istensor(o)&&ae.istensor(i)){r=HN.tensor_plus_tensor(o,i),r!==Di.symbol(ae.NIL)&&(e.splice(t,2,r),t--),t++;continue}if(ae.istensor(o)||ae.istensor(i)){t++;continue}if(ae.isNumericAtom(o)&&ae.isNumericAtom(i)){r=g1.add_numbers(o,i),p_.isZeroAtomOrTensor(r)?e.splice(t,2):e.splice(t,2,r),t--,t++;continue}if(ae.isNumericAtom(o)||ae.isNumericAtom(i)){t++;continue}r=ae.Constants.One(),n=ae.Constants.One();let s=0;if(ae.ismultiply(o)&&(o=ae.cdr(o),s=1,ae.isNumericAtom(ae.car(o))&&(r=ae.car(o),o=ae.cdr(o),ae.cdr(o)===Di.symbol(ae.NIL)&&(o=ae.car(o),s=0))),ae.ismultiply(i)&&(i=ae.cdr(i),ae.isNumericAtom(ae.car(i))&&(n=ae.car(i),i=ae.cdr(i),ae.cdr(i)===Di.symbol(ae.NIL)&&(i=ae.car(i)))),!y1.equal(o,i)){t++;continue}if(r=g1.add_numbers(r,n),p_.isZeroAtomOrTensor(r)){e.splice(t,2),t--,t++;continue}let u=s?new ae.Cons(Di.symbol(ae.MULTIPLY),o):o;e.splice(t,2,v1.multiply(r,u)),t--,t++}}function Uc(e,t){ae.isadd(t)?e.push(...t.tail()):p_.isZeroAtom(t)||e.push(t)}function q1(e,t){let r=[];return Uc(r,e),Uc(r,t),h_(r)}Pn.add=q1;function eI(e){let t=[];for(let r of e)Uc(t,r);return h_(t)}Pn.add_all=eI;function tI(e,t){return q1(e,v1.negate(t))}Pn.subtract=tI});var on=A(Dn=>{"use strict";Object.defineProperty(Dn,"__esModule",{value:!0});Dn.absval=Dn.abs=Dn.absValFloat=Dn.Eval_abs=void 0;var ct=N(),A_=ir(),rI=Ee(),Yl=U(),nI=Ne(),oI=ue(),Bc=F(),iI=yi(),sI=Mn(),Fc=G(),aI=Rn(),lI=vl(),uI=Go(),ki=H(),E1=K(),Gc=Z(),cI=oo(),Vl=Et(),x1=Us(),fI=Kn(),p1=Zo(),Nr=!1;function dI(e){return O_(Fc.Eval(ct.cadr(e)))}Dn.Eval_abs=dI;function mI(e){return aI.zzfloat(Fc.Eval(Zl(Fc.Eval(e))))}Dn.absValFloat=mI;function O_(e){let t=cI.numerator(e),r=Zl(t),n=sI.denominator(e),o=Zl(n),i=Gc.divide(r,o);return Nr&&(console.trace(">>>>  ABS of "+e),console.log(`ABS numerator ${t}`),console.log(`ABSVAL numerator: ${r}`),console.log(`ABS denominator: ${n}`),console.log(`ABSVAL denominator: ${o}`),console.log(`ABSVAL divided: ${i}`),console.log("<<<<<<<  ABS")),i}Dn.abs=O_;function Zl(e){let t=e;if(Nr&&console.log(`ABS of ${e}`),ki.isZeroAtomOrTensor(e))return Nr&&(console.log(` abs: ${e} just zero`),console.log(" --> ABS of "+t+" : "+ct.Constants.zero)),ct.Constants.zero;if(ki.isnegativenumber(e))return Nr&&console.log(` abs: ${e} just a negative`),Gc.negate(e);if(ki.ispositivenumber(e))return Nr&&(console.log(` abs: ${e} just a positive`),console.log(` --> ABS of ${t} : ${e}`)),e;if(e===Yl.symbol(ct.PI))return Nr&&(console.log(` abs: ${e} of PI`),console.log(` --> ABS of ${t} : ${e}`)),e;if(ct.isadd(e)&&(A_.findPossibleClockForm(e,e)||A_.findPossibleExponentialForm(e)||A_.Find(e,ct.Constants.imaginaryunit))){Nr&&(console.log(` abs: ${e} is a sum`),console.log("abs of a sum")),e=fI.rect(e);let n=p1.simplify_trig(Vl.power(oI.add(Vl.power(x1.real(e),Bc.integer(2)),Vl.power(lI.imag(e),Bc.integer(2))),Bc.rational(1,2)));return Nr&&console.log(` --> ABS of ${t} : ${n}`),n}if(ct.ispower(e)&&ki.equaln(ct.cadr(e),-1)){let n=ct.Constants.One();if(Nr){console.log(` abs: ${e} is -1 to any power`);let o=ct.defs.evaluatingAsFloats?" abs: numeric, so result is 1.0":" abs: symbolic, so result is 1";console.log(o),console.log(` --> ABS of ${t} : ${n}`)}return n}if(ct.ispower(e)&&ki.ispositivenumber(ct.caddr(e))){let n=Vl.power(O_(ct.cadr(e)),ct.caddr(e));return Nr&&(console.log(` abs: ${e} is something to the power of a positive number`),console.log(` --> ABS of ${t} : ${n}`)),n}if(ct.ispower(e)&&ct.cadr(e)===Yl.symbol(ct.E)){let n=nI.exponential(x1.real(ct.caddr(e)));return Nr&&(console.log(` abs: ${e} is an exponential`),console.log(` --> ABS of ${t} : ${n}`)),n}if(ct.ismultiply(e)){let n=e.tail().map(Zl).reduce(Gc.multiply);return Nr&&(console.log(` abs: ${e} is a product`),console.log(` --> ABS of ${t} : ${n}`)),n}if(ct.car(e)===Yl.symbol(ct.ABS)){let n=E1.makeList(Yl.symbol(ct.ABS),ct.cadr(e));return Nr&&(console.log(` abs: ${e} is abs of a abs`),console.log(` --> ABS of ${t} : ${n}`)),n}if(ct.istensor(e))return _I(e);(ki.isnegativeterm(e)||ct.isadd(e)&&ki.isnegativeterm(ct.cadr(e)))&&(e=Gc.negate(e));let r=E1.makeList(Yl.symbol(ct.ABS),e);return Nr&&(console.log(` abs: ${e} is nothing decomposable`),console.log(` --> ABS of ${t} : ${r}`)),r}Dn.absval=Zl;function _I(e){return e.tensor.ndim!==1&&rI.stop("abs(tensor) with tensor rank > 1"),Fc.Eval(p1.simplify(Vl.power(uI.inner(e,iI.conjugate(e)),Bc.rational(1,2))))}});var H=A(Y=>{"use strict";Object.defineProperty(Y,"__esModule",{value:!0});Y.isnpi=Y.isquarterturn=Y.isimaginaryunit=Y.isfloating=Y.isMinusSqrtThreeOverTwo=Y.isSqrtThreeOverTwo=Y.isminusoneoversqrttwo=Y.isoneoversqrttwo=Y.isminusoneovertwo=Y.isoneovertwo=Y.equalq=Y.equaln=Y.isfraction=Y.isoneover=Y.isNumberOneOverSomething=Y.isintegerfactor=Y.issymbolic=Y.isnegative=Y.iseveninteger=Y.iscomplexnumber=Y.iscomplexnumberdouble=Y.isimaginarynumber=Y.isnegativeterm=Y.ispolyexpandedform=Y.isunivarpolyfactoredorexpandedform=Y.isposint=Y.isnonnegativeinteger=Y.isintegerorintegerfloat=Y.isinteger=Y.isone=Y.isminusone=Y.isplusone=Y.isplustwo=Y.ispositivenumber=Y.isnegativenumber=Y.isZeroLikeOrNonZeroLikeOrUndetermined=Y.isZeroAtomOrTensor=Y.isZeroAtom=void 0;var h=N(),pa=ir(),Wo=U(),Jt=Ne(),bI=on(),zc=F(),h1=G(),gI=Rn(),yI=Vr(),N1=Z(),Hl=!1;function I1(e){switch(e.k){case h.NUM:if(h.MZERO(e.q.a))return!0;break;case h.DOUBLE:if(e.d===0)return!0;break}return!1}Y.isZeroAtom=I1;function vI(e){return h.istensor(e)?e.tensor.elem.every(t=>Xl(t)):!1}function Xl(e){return I1(e)||vI(e)}Y.isZeroAtomOrTensor=Xl;function qI(e){let t=h1.Eval_predicate(e);if(Xl(t))return!1;if(h.isNumericAtomOrTensor(t))return!0;if(t=gI.zzfloat(t),Xl(t))return!1;if(h.isNumericAtomOrTensor(t))return!0;if(pa.Find(t,h.Constants.imaginaryunit)){if(t=h1.Eval_predicate(bI.absValFloat(t)),Xl(t))return!1;if(h.isNumericAtomOrTensor(t))return!0}return null}Y.isZeroLikeOrNonZeroLikeOrUndetermined=qI;function Yc(e){switch(e.k){case h.NUM:if(h.MSIGN(e.q.a)===-1)return!0;break;case h.DOUBLE:if(e.d<0)return!0;break}return!1}Y.isnegativenumber=Yc;function EI(e){switch(e.k){case h.NUM:if(h.MSIGN(e.q.a)===1)return!0;break;case h.DOUBLE:if(e.d>0)return!0;break}return!1}Y.ispositivenumber=EI;function xI(e){switch(e.k){case h.NUM:if(h.MEQUAL(e.q.a,2)&&h.MEQUAL(e.q.b,1))return!0;break;case h.DOUBLE:if(e.d===2)return!0;break}return!1}Y.isplustwo=xI;function S1(e){switch(e.k){case h.NUM:if(h.MEQUAL(e.q.a,1)&&h.MEQUAL(e.q.b,1))return!0;break;case h.DOUBLE:if(e.d===1)return!0;break}return!1}Y.isplusone=S1;function N_(e){switch(e.k){case h.NUM:if(h.MEQUAL(e.q.a,-1)&&h.MEQUAL(e.q.b,1))return!0;break;case h.DOUBLE:if(e.d===-1)return!0;break}return!1}Y.isminusone=N_;function pI(e){return S1(e)||N_(e)}Y.isone=pI;function $i(e){return e.k===h.NUM&&h.MEQUAL(e.q.b,1)}Y.isinteger=$i;function hI(e){return e.k===h.DOUBLE?e.d===Math.round(e.d):$i(e)}Y.isintegerorintegerfloat=hI;function AI(e){return h.isrational(e)&&h.MEQUAL(e.q.b,1)&&h.MSIGN(e.q.a)===1}Y.isnonnegativeinteger=AI;function Vc(e){return $i(e)&&h.MSIGN(e.q.a)===1}Y.isposint=Vc;function OI(e,t){return t==null&&(t=yI.guess(e)),TI(e,t)&&MI(pa.Find(e,Wo.symbol(h.SYMBOL_X)),pa.Find(e,Wo.symbol(h.SYMBOL_Y)),pa.Find(e,Wo.symbol(h.SYMBOL_Z)))===1?t:!1}Y.isunivarpolyfactoredorexpandedform=OI;function MI(...e){return e.reduce((t,r)=>t+Number(r),0)}function TI(e,t){return NI(e,t)}function NI(e,t){return h.ismultiply(e)?e.tail().every(r=>{let n=A1(r,t);return h.DEBUG&&(console.log(`ispolyfactoredorexpandedform_factor testing ${r}`),n&&console.log(`... tested negative:${r}`)),n}):A1(e,t)}function A1(e,t){return h.ispower(e)?(h.DEBUG&&console.log("ispolyfactoredorexpandedform_power (isposint(caddr(p)) "+(Vc(h.caddr(e)),h.DEBUG?console.log("ispolyfactoredorexpandedform_power ispolyexpandedform_expr(cadr(p), x)) "+jc(h.cadr(e),t)):void 0)),Vc(h.caddr(e))&&jc(h.cadr(e),t)):(h.DEBUG&&console.log(`ispolyfactoredorexpandedform_power not a power, testing if this is exp form: ${e}`),jc(e,t))}function II(e,t){return pa.Find(e,t)?jc(e,t):!1}Y.ispolyexpandedform=II;function jc(e,t){return h.isadd(e)?e.tail().every(r=>O1(r,t)):O1(e,t)}function O1(e,t){return h.ismultiply(e)?e.tail().every(r=>M1(r,t)):M1(e,t)}function M1(e,t){return Jt.equal(e,t)?!0:h.ispower(e)&&Jt.equal(h.cadr(e),t)?Vc(h.caddr(e)):!pa.Find(e,t)}function M_(e){return Yc(e)||h.ismultiply(e)&&Yc(h.cadr(e))}Y.isnegativeterm=M_;function R1(e){return h.ispower(e)&&h.isrational(h.car(h.cdr(h.cdr(e))))&&Yc(h.car(h.cdr(e)))?(Hl&&console.log(`hasNegativeRationalExponent: ${e} has imaginary component`),!0):(Hl&&console.log(`hasNegativeRationalExponent: ${e} has NO imaginary component`),!1)}function T1(e){return h.ismultiply(e)&&Jt.length(e)===3&&h.isdouble(h.cadr(e))&&R1(h.caddr(e))||Jt.equal(e,h.Constants.imaginaryunit)}function T_(e){return h.ismultiply(e)&&Jt.length(e)===3&&h.isNumericAtom(h.cadr(e))&&Jt.equal(h.caddr(e),h.Constants.imaginaryunit)||Jt.equal(e,h.Constants.imaginaryunit)||R1(h.caddr(e))?(Hl&&console.log(`isimaginarynumber: ${e} is imaginary number`),!0):(Hl&&console.log(`isimaginarynumber: ${e} isn't an imaginary number`),!1)}Y.isimaginarynumber=T_;function SI(e){return h.isadd(e)&&Jt.length(e)===3&&h.isdouble(h.cadr(e))&&T1(h.caddr(e))||T1(e)}Y.iscomplexnumberdouble=SI;function RI(e){return Hl&&h.breakpoint,h.isadd(e)&&Jt.length(e)===3&&h.isNumericAtom(h.cadr(e))&&T_(h.caddr(e))||T_(e)?(h.DEBUG&&console.log(`iscomplexnumber: ${e} is imaginary number`),!0):(h.DEBUG&&console.log(`iscomplexnumber: ${e} is imaginary number`),!1)}Y.iscomplexnumber=RI;function wI(e){return $i(e)&&e.q.a.isEven()}Y.iseveninteger=wI;function LI(e){return h.isadd(e)&&M_(h.cadr(e))||M_(e)}Y.isnegative=LI;function w1(e){return h.issymbol(e)?!0:h.iscons(e)?[...e].some(w1):!1}Y.issymbolic=w1;function CI(e){return $i(e)||h.ispower(e)&&$i(h.cadr(e))&&$i(h.caddr(e))}Y.isintegerfactor=CI;function PI(e){return L1(e)&&h.MEQUAL(e.q.a.abs(),1)}Y.isNumberOneOverSomething=PI;function DI(e){return h.ispower(e)&&N_(h.caddr(e))}Y.isoneover=DI;function L1(e){return e.k===h.NUM&&!h.MEQUAL(e.q.b,1)}Y.isfraction=L1;function Zc(e,t){switch(e.k){case h.NUM:return h.MEQUAL(e.q.a,t)&&h.MEQUAL(e.q.b,1);case h.DOUBLE:return e.d===t;default:return!1}}Y.equaln=Zc;function Xc(e,t,r){switch(e.k){case h.NUM:return h.MEQUAL(e.q.a,t)&&h.MEQUAL(e.q.b,r);case h.DOUBLE:return e.d===t/r;default:return!1}}Y.equalq=Xc;function I_(e){return Xc(e,1,2)}Y.isoneovertwo=I_;function C1(e){return Xc(e,-1,2)}Y.isminusoneovertwo=C1;function P1(e){return h.ispower(e)&&Zc(h.cadr(e),2)&&Xc(h.caddr(e),-1,2)}Y.isoneoversqrttwo=P1;function kI(e){return h.ismultiply(e)&&Zc(h.cadr(e),-1)&&P1(h.caddr(e))&&Jt.length(e)===3}Y.isminusoneoversqrttwo=kI;function $I(e){return h.ismultiply(e)&&I_(h.cadr(e))&&D1(h.caddr(e))&&Jt.length(e)===3}Y.isSqrtThreeOverTwo=$I;function UI(e){return h.ismultiply(e)&&C1(h.cadr(e))&&D1(h.caddr(e))&&Jt.length(e)===3}Y.isMinusSqrtThreeOverTwo=UI;function D1(e){return h.ispower(e)&&Zc(h.cadr(e),3)&&I_(h.caddr(e))}function k1(e){return e.k===h.DOUBLE||e===Wo.symbol(h.FLOATF)?!0:h.iscons(e)?[...e].some(k1):!1}Y.isfloating=k1;function BI(e){return Jt.equal(e,h.Constants.imaginaryunit)}Y.isimaginaryunit=BI;function GI(e){let t=0;if(!h.ismultiply(e))return 0;if(Jt.equal(h.cadr(e),h.Constants.imaginaryunit))return h.caddr(e)!==Wo.symbol(h.PI)||Jt.length(e)!==3?0:2;if(!h.isNumericAtom(h.cadr(e))||!Jt.equal(h.caddr(e),h.Constants.imaginaryunit)||h.cadddr(e)!==Wo.symbol(h.PI)||Jt.length(e)!==4)return 0;let r=zc.nativeInt(N1.multiply(h.cadr(e),zc.integer(2)));if(isNaN(r))return 0;switch(r<1&&(t=1,r=-r),r%4){case 0:r=1;break;case 1:r=t?4:3;break;case 2:r=2;break;case 3:r=t?3:4}return r}Y.isquarterturn=GI;function FI(e){let t=0;return e===Wo.symbol(h.PI)?2:!h.ismultiply(e)||!h.isNumericAtom(h.cadr(e))||h.caddr(e)!==Wo.symbol(h.PI)||Jt.length(e)!==3||(t=zc.nativeInt(N1.multiply(h.cadr(e),zc.integer(2))),isNaN(t))?0:(t<0?t=4- -t%4:t=1+(t-1)%4,t)}Y.isnpi=FI});var lo=A(Rt=>{"use strict";Object.defineProperty(Rt,"__esModule",{value:!0});Rt.yn=Rt.jn=Rt.append=Rt.isalnumorunderscore=Rt.isalpha=Rt.isdigit=Rt.isspace=Rt.clear_term=Rt.doubleToReasonableString=Rt.strcmp=void 0;var jI=F(),zI=H(),YI=K(),Jo=N(),$1=Ee(),Hc=U();function VI(e,t){return e===t?0:e>t?1:-1}Rt.strcmp=VI;function ZI(e){let t;if(Jo.defs.codeGen||Jo.defs.fullDoubleOutput)return""+e;if(zI.isZeroAtomOrTensor(Hc.get_binding(Hc.symbol(Jo.FORCE_FIXED_PRINTOUT))))t=""+e,Jo.defs.printMode===Jo.PRINTMODE_LATEX?/\d*\.\d*e.*/gm.test(t)?t=t.replace(/e(.*)/gm,"\\mathrm{e}{$1}"):t=t.replace(/(\d+)e(.*)/gm,"$1.0\\mathrm{e}{$2}"):/\d*\.\d*e.*/gm.test(t)?t=t.replace(/e(.*)/gm,"*10^($1)"):t=t.replace(/(\d+)e(.*)/gm,"$1.0*10^($2)");else{let r=jI.nativeInt(Hc.get_binding(Hc.symbol(Jo.MAX_FIXED_PRINTOUT_DIGITS)));t=""+e.toFixed(r),t=t.replace(/(\.\d*?[1-9])0+$/gm,"$1"),t=t.replace(/\.0+$/gm,""),t.indexOf(".")===-1&&(t+=".0"),parseFloat(t)!==e&&(t=e.toFixed(r)+"...")}return t}Rt.doubleToReasonableString=ZI;function XI(){}Rt.clear_term=XI;function HI(e){return e==null?!1:e===" "||e==="	"||e===`
`||e==="\v"||e==="\f"||e==="\r"}Rt.isspace=HI;function U1(e){return e==null?!1:/^\d+$/.test(e)}Rt.isdigit=U1;function QI(e){return e==null?!1:e.search(/[^A-Za-z]/)===-1}Rt.isalpha=QI;function WI(e){return e==null?!1:e.search(/[^A-Za-z_]/)===-1}function JI(e){return e==null?!1:WI(e)||U1(e)}Rt.isalnumorunderscore=JI;function KI(e,t){let r=[];return Jo.iscons(e)&&r.push(...e),Jo.iscons(t)&&r.push(...t),YI.makeList(...r)}Rt.append=KI;function eS(e,t){$1.stop("Not implemented")}Rt.jn=eS;function tS(e,t){$1.stop("Not implemented")}Rt.yn=tS});var B1=A(Qc=>{"use strict";Object.defineProperty(Qc,"__esModule",{value:!0});Qc.qadd=void 0;var S_=N(),rS=F(),nS=Gd(),oS=ys(),Ql=ln();function iS(e,t){let r=Ql.mmul(e.q.a,t.q.b),n=Ql.mmul(e.q.b,t.q.a),o=nS.madd(r,n);if(S_.MZERO(o))return S_.Constants.zero;let i=Ql.mmul(e.q.b,t.q.b),s=oS.mgcd(o,i);s=rS.makeSignSameAs(s,i);let u=Ql.mdiv(o,s),c=Ql.mdiv(i,s);return new S_.Num(u,c)}Qc.qadd=iS});var G1=A(Kc=>{"use strict";Object.defineProperty(Kc,"__esModule",{value:!0});Kc.qdiv=void 0;var Wc=N(),sS=Ee(),aS=F(),lS=ys(),Jc=ln();function uS(e,t){if(Wc.MZERO(t.q.a)&&sS.stop("divide by zero"),Wc.MZERO(e.q.a))return Wc.Constants.zero;let r=Jc.mmul(e.q.a,t.q.b),n=Jc.mmul(e.q.b,t.q.a),o=lS.mgcd(r,n);return o=aS.makeSignSameAs(o,n),new Wc.Num(Jc.mdiv(r,o),Jc.mdiv(n,o))}Kc.qdiv=uS});var F1=A(rf=>{"use strict";Object.defineProperty(rf,"__esModule",{value:!0});rf.qmul=void 0;var ef=N(),cS=F(),fS=ys(),tf=ln();function dS(e,t){if(ef.MZERO(e.q.a)||ef.MZERO(t.q.a))return ef.Constants.zero;let r=tf.mmul(e.q.a,t.q.a),n=tf.mmul(e.q.b,t.q.b),o=fS.mgcd(r,n);return o=cS.makeSignSameAs(o,n),new ef.Num(tf.mdiv(r,o),tf.mdiv(n,o))}rf.qmul=dS});var F=A(oe=>{"use strict";var mS=oe&&oe.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(oe,"__esModule",{value:!0});oe.bignum_factorial=oe.bignum_float=oe.nativeDouble=oe.gcd_numbers=oe.print_number=oe.bignum_scan_float=oe.bignum_scan_integer=oe.nativeInt=oe.rational=oe.double=oe.integer=oe.convert_rational_to_double=oe.bignum_power_number=oe.mp_denominator=oe.mp_numerator=oe.bignum_truncate=oe.negate_number=oe.compare_numbers=oe.invert_number=oe.divide_numbers=oe.multiply_numbers=oe.add_numbers=oe.makePositive=oe.makeSignSameAs=oe.setSignTo=oe.isSmall=oe.mint=void 0;var kt=mS(To()),fe=N(),_S=Mu(),bS=lo(),R_=Ee(),ha=H(),j1=ys(),nf=ln(),z1=rc(),gS=Z(),yS=B1(),vS=G1(),qS=F1();function ES(e){return kt.default(e)}oe.mint=ES;function Y1(e){return e.geq(Number.MIN_SAFE_INTEGER)&&e.leq(Number.MAX_SAFE_INTEGER)}oe.isSmall=Y1;function of(e,t){if(e.isPositive()){if(t<0)return e.multiply(kt.default(-1))}else if(t>0)return e.multiply(kt.default(-1));return e}oe.setSignTo=of;function w_(e,t){if(e.isPositive()){if(t.isNegative())return e.multiply(kt.default(-1))}else if(t.isPositive())return e.multiply(kt.default(-1));return e}oe.makeSignSameAs=w_;function xS(e){return e.isNegative()?e.multiply(kt.default(-1)):e}oe.makePositive=xS;function pS(e,t){if(fe.isrational(e)&&fe.isrational(t))return yS.qadd(e,t);let r=fe.isdouble(e)?e.d:mn(e),n=fe.isdouble(t)?t.d:mn(t);return L_(r+n)}oe.add_numbers=pS;function hS(e,t){if(fe.isrational(e)&&fe.isrational(t))return qS.qmul(e,t);let r=fe.isdouble(e)?e.d:mn(e),n=fe.isdouble(t)?t.d:mn(t);return new fe.Double(r*n)}oe.multiply_numbers=hS;function AS(e,t){if(fe.isrational(e)&&fe.isrational(t))return vS.qdiv(e,t);ha.isZeroAtomOrTensor(t)&&R_.stop("divide by zero");let r=fe.isdouble(e)?e.d:mn(e),n=fe.isdouble(t)?t.d:mn(t);return new fe.Double(r/n)}oe.divide_numbers=AS;function OS(e){if(ha.isZeroAtomOrTensor(e)&&R_.stop("divide by zero"),fe.isdouble(e))return new fe.Double(1/e.d);let t=kt.default(e.q.a),r=kt.default(e.q.b);return r=w_(r,t),t=of(t,1),new fe.Num(r,t)}oe.invert_number=OS;function MS(e,t){let r=nf.mmul(e.q.a,t.q.b),n=nf.mmul(e.q.b,t.q.a);return _S.mcmp(r,n)}function TS(e,t){if(fe.isrational(e)&&fe.isrational(t))return MS(e,t);let r=fe.isdouble(e)?e.d:mn(e),n=fe.isdouble(t)?t.d:mn(t);return r<n?-1:r>n?1:0}oe.compare_numbers=TS;function NS(e){if(ha.isZeroAtomOrTensor(e))return e;switch(e.k){case fe.NUM:return new fe.Num(kt.default(e.q.a.multiply(kt.default.minusOne)),kt.default(e.q.b));case fe.DOUBLE:return new fe.Double(-e.d);default:R_.stop("bug caught in mp_negate_number")}}oe.negate_number=NS;function IS(e){let t=nf.mdiv(e.q.a,e.q.b);return new fe.Num(t)}oe.bignum_truncate=IS;function SS(e){return fe.isrational(e)?new fe.Num(kt.default(e.q.a)):fe.Constants.one}oe.mp_numerator=SS;function RS(e){return fe.isrational(e)?new fe.Num(kt.default(e.q.b)):fe.Constants.one}oe.mp_denominator=RS;function wS(e,t){let r=z1.mpow(e.q.a,Math.abs(t)),n=z1.mpow(e.q.b,Math.abs(t));if(t<0){let o=r;r=n,n=o,r=w_(r,n),n=of(n,1)}return new fe.Num(r,n)}oe.bignum_power_number=wS;function mn(e){e.q==null&&fe.breakpoint;let t=e.q.a.divmod(e.q.b);return t.quotient.toJSNumber()+t.remainder.toJSNumber()/e.q.b.toJSNumber()}oe.convert_rational_to_double=mn;function LS(e){return new fe.Num(kt.default(e))}oe.integer=LS;function L_(e){return new fe.Double(e)}oe.double=L_;function CS(e,t){return new fe.Num(kt.default(e),kt.default(t))}oe.rational=CS;function PS(e){let t=NaN;switch(e.k){case fe.NUM:ha.isinteger(e)&&Y1(e.q.a)&&(t=e.q.a.toJSNumber());break;case fe.DOUBLE:fe.DEBUG&&console.log("popping integer but double is found"),Math.floor(e.d)===e.d&&(fe.DEBUG&&console.log("...although it's an integer"),t=e.d);break}return t}oe.nativeInt=PS;function DS(e){let t=0,r=e[t];(r==="+"||r==="-")&&t++;let n=kt.default(e.substring(t)),o=new fe.Num(n);return r==="-"&&(o=gS.negate(o)),o}oe.bignum_scan_integer=DS;function kS(e){return L_(parseFloat(e))}oe.bignum_scan_float=kS;function $S(e,t){let r="",n="",o="";switch(e.k){case fe.NUM:var i=e.q.a.toString();t||i[0]==="-"&&(i=i.substring(1)),fe.defs.printMode===fe.PRINTMODE_LATEX&&ha.isfraction(e)&&(i="\\frac{"+i+"}{"),r+=i,ha.isfraction(e)&&(fe.defs.printMode!==fe.PRINTMODE_LATEX&&(r+="/"),n=e.q.b.toString(),fe.defs.printMode===fe.PRINTMODE_LATEX&&(n+="}"),r+=n);break;case fe.DOUBLE:i=bS.doubleToReasonableString(e.d),t||i[0]==="-"&&(i=i.substring(1)),r+=i;break}return r}oe.print_number=$S;function US(e,t){let r=j1.mgcd(e.q.a,t.q.a),n=j1.mgcd(e.q.b,t.q.b);return new fe.Num(of(r,1),n)}oe.gcd_numbers=US;function BS(e){let t=0;switch(e.k){case fe.NUM:t=mn(e);break;case fe.DOUBLE:({d:t}=e);break;default:t=0}return t}oe.nativeDouble=BS;function GS(e){let t=mn(e);return new fe.Double(t)}oe.bignum_float=GS;function FS(e){return new fe.Num(jS(e))}oe.bignum_factorial=FS;function jS(e){let t;if(e===0||e===1)return t=kt.default(1),t;t=kt.default(2);let r=kt.default(0);if(3<=e)for(let n=3;n<=e;n++)r=kt.default(n),t=nf.mmul(t,r);return t}});var t_=A(Oa=>{"use strict";Object.defineProperty(Oa,"__esModule",{value:!0});Oa.polyform=Oa.bake=void 0;var Mt=N(),zS=F(),YS=gi(),Ko=H(),Wl=K(),Ir=U();function V1(e){return Mt.doexpand(VS,e)}Oa.bake=V1;function VS(e){let t=Ko.ispolyexpandedform(e,Ir.symbol(Mt.SYMBOL_S)),r=Ko.ispolyexpandedform(e,Ir.symbol(Mt.SYMBOL_T)),n=Ko.ispolyexpandedform(e,Ir.symbol(Mt.SYMBOL_X)),o=Ko.ispolyexpandedform(e,Ir.symbol(Mt.SYMBOL_Y)),i=Ko.ispolyexpandedform(e,Ir.symbol(Mt.SYMBOL_Z)),s;return t&&!r&&!n&&!o&&!i?s=Aa(e,Ir.symbol(Mt.SYMBOL_S)):!t&&r&&!n&&!o&&!i?s=Aa(e,Ir.symbol(Mt.SYMBOL_T)):!t&&!r&&n&&!o&&!i?s=Aa(e,Ir.symbol(Mt.SYMBOL_X)):!t&&!r&&!n&&o&&!i?s=Aa(e,Ir.symbol(Mt.SYMBOL_Y)):!t&&!r&&!n&&!o&&i?s=Aa(e,Ir.symbol(Mt.SYMBOL_Z)):Mt.iscons(e)&&Mt.car(e)!==Ir.symbol(Mt.FOR)?s=Wl.makeList(Mt.car(e),...e.tail().map(V1)):s=e,s}function Z1(e,t){return Ko.ispolyexpandedform(e,t)?Aa(e,t):Mt.iscons(e)?Wl.makeList(Mt.car(e),...e.tail().map(r=>Z1(r,t))):e}Oa.polyform=Z1;function Aa(e,t){let r=YS.coeff(e,t),n=[];for(let o=r.length-1;o>=0;o--){let i=r[o];n.push(...ZS(o,i,t))}return n.length>1?new Mt.Cons(Ir.symbol(Mt.ADD),Wl.makeList(...n)):n[0]}function ZS(e,t,r){if(Ko.isZeroAtomOrTensor(t))return[];if(e===0)return Mt.isadd(t)?t.tail():[t];let n=[];return Mt.ismultiply(t)?n.push(...t.tail()):Ko.equaln(t,1)||n.push(t),e===1?n.push(r):n.push(Wl.makeList(Ir.symbol(Mt.POWER),r,zS.integer(e))),n.length>1?[Wl.makeList(Ir.symbol(Mt.MULTIPLY),...n)]:n}});var D_=A(Qr=>{"use strict";Object.defineProperty(Qr,"__esModule",{value:!0});Qr.testApprox=Qr.approxAll=Qr.approxRationalsOfLogs=Qr.approxRadicals=Qr.Eval_approxratio=void 0;var XS=It(),_o=N(),HS=U(),X1=F(),QS=Rn(),WS=K(),JS=qt();function KS(e){return sf(_o.cadr(e))}Qr.Eval_approxratio=KS;function sf(e){if(_o.istensor(e)){let t=XS.alloc_tensor(e.tensor.nelem);return t.tensor.ndim=e.tensor.ndim,t.tensor.dim=Array.from(e.tensor.dim),t.tensor.elem=t.tensor.elem.map(r=>{let n=sf(r);return JS.check_tensor_dimensions(t),n}),t}return e.k===_o.DOUBLE?eR(e):_o.iscons(e)?new _o.Cons(sf(_o.car(e)),sf(_o.cdr(e))):e}function eR(e){let t=QS.zzfloat(e);if(t.k===_o.DOUBLE){let r=t.d,n=r.toString().split(".");if(n.length===2){let o=n[1].length,i=1/Math.pow(10,o),s=tR(r,i);return X1.rational(s[0],s[1])}return X1.integer(r)}return WS.makeList(HS.symbol(_o.APPROXRATIO),t)}function tR(e,t){if(isNaN(e))return[0,0];if(e===1/0)return[1,0];if(e===-1/0)return[-1,0];let r=e<0?-1:1;if(e=Math.abs(e),Math.abs(e-Math.floor(e))<t)return[e*r,1];if(e<1e-19)return[r,1e19];if(e>1e19)return[1e19*r,1];let n=e,o=0,i=1,s;for(;;){n=1/(n-Math.floor(n));let u=i;if(i=i*Math.floor(n)+o,o=u,s=Math.floor(e*i+.5),!(Math.abs(e-s/i)>t)||n===Math.floor(n))break}return s=r*s,[s,i]}var Wr=0,rR=1,H1=2,Q1=3,C_=4,nR=6,W1=7,oR=8,iR=9;function sR(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,o=Number.MAX_VALUE;for(let i of[2,3,5,6,7,8,10])for(let s=1;s<=10;s++){let u,c,d,_=Math.sqrt(i)/s;if(Math.abs(_)>1e-10?(d=e/_,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-_)),u<2*t){let R=Dr(c,i,s);R<o&&(o=R,n=[`${c} * sqrt( ${i} ) / ${s}`,nR,c,i,s])}}return n}function aR(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,o=Number.MAX_VALUE;for(let i of[1,2,3,5,6,7,8,10])for(let s of[1,2,3,5,6,7,8,10]){let u,c,d,_=Math.sqrt(i/s);if(Math.abs(_)>1e-10?(d=e/_,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-_)),u<2*t){let R=Dr(c,i,s);R<o&&(o=R,n=[`${c} * (sqrt( ${i} / ${s} )`,C_,c,i,s])}}return n}function Ui(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=sR(e);if(n!=null)return n;let o=aR(e);return o!=null?o:null}Qr.approxRadicals=Ui;function Jl(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=J1(e);if(n!=null)return n;let o=lR(e);return o!=null?o:null}function J1(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,o=Number.MAX_VALUE;for(let i=2;i<=5;i++)for(let s=1;s<=5;s++){let u,c,d,_=Math.log(i)/s;if(Math.abs(_)>1e-10?(d=e/_,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-_)),!(c!==1&&Math.abs(Math.floor(c/s))===Math.abs(c/s))&&u<2.2*t){let R=Dr(c,i,s);R<o&&(o=R,n=[`${c} * log( ${i} ) / ${s}`,iR,c,i,s])}}return n}Qr.approxRationalsOfLogs=J1;function lR(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,o=Number.MAX_VALUE;for(let i=1;i<=5;i++)for(let s=1;s<=5;s++){let u,c,d,_=Math.log(i/s);if(Math.abs(_)>1e-10?(d=e/_,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-_)),u<1.96*t){let R=Dr(c,i,s);R<o&&(o=R,n=[`${c} * log( ${i} / ${s} )`,oR,c,i,s])}}return n}function K1(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,o=Number.MAX_VALUE;for(let i=1;i<=2;i++)for(let s=1;s<=12;s++){let u,c,d,_=Math.pow(Math.E,i)/s;if(Math.abs(_)>1e-10?(d=e/_,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-_)),u<2*t){let R=Dr(c,i,s);R<o&&(o=R,n=[`${c} * (e ^ ${i} ) / ${s}`,W1,c,i,s])}}return n}function P_(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,o=Number.MAX_VALUE;for(let i=1;i<=5;i++)for(let s=1;s<=12;s++){let u,c,d,_=Math.pow(Math.PI,i)/s;if(Math.abs(_)>1e-10?(d=e/_,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-_)),u<2*t){let R=Dr(c,i,s);R<o&&(o=R,n=[`${c} * (pi ^ ${i} ) / ${s} )`,Q1,c,i,s])}}return n}function Kl(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=uR(e);if(n!=null)return n;let o=cR(e);return o!=null?o:null}function uR(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,o=Number.MAX_VALUE;for(let i=1;i<=4;i++)for(let s=1;s<=4;s++){let u,c,d,_=i/s,R=Math.sin(_);if(Math.abs(R)>1e-10?(d=e/R,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-R)),u<2*t){let T=Dr(c,i,s);T<o&&(o=T,n=[`${c} * sin( ${i}/${s} )`,rR,c,i,s])}}return n}function cR(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,o=Number.MAX_VALUE;for(let i=1;i<=13;i++)for(let s=1;s<=13;s++){let u,c,d,_=i/s,R=Math.sin(Math.PI*_);if(Math.abs(R)>1e-10?(d=e/R,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-R)),u<23*t){let T=Dr(c,i,s);T<o&&(o=T,n=[`${c} * sin( ${i}/${s} * pi )`,H1,c,i,s])}}return n}function Ie(e){let t,r=e.toString().split(".");if(r.length===2){let T=r[1].length;t=1/Math.pow(10,T)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=Number.MAX_VALUE,o=0,i=null,s=!0,u=Ui(e);u!=null&&(o=Dr(u),o<n?(s&&console.log(`better explanation by approxRadicals: ${u} complexity: ${o}`),n=o,i=u):s&&console.log(`subpar explanation by approxRadicals: ${u} complexity: ${o}`));let c=Jl(e);c!=null&&(o=Dr(c),o<n?(s&&console.log(`better explanation by approxLogs: ${c} complexity: ${o}`),n=o,i=c):s&&console.log(`subpar explanation by approxLogs: ${c} complexity: ${o}`));let d=K1(e);d!=null&&(o=Dr(d),o<n?(s&&console.log(`better explanation by approxRationalsOfPowersOfE: ${d} complexity: ${o}`),n=o,i=d):s&&console.log(`subpar explanation by approxRationalsOfPowersOfE: ${d} complexity: ${o}`));let _=P_(e);_!=null&&(o=Dr(_),o<n?(s&&console.log(`better explanation by approxRationalsOfPowersOfPI: ${_} complexity: ${o}`),n=o,i=_):s&&console.log(`subpar explanation by approxRationalsOfPowersOfPI: ${_} complexity: ${o}`));let R=Kl(e);return R!=null&&(o=Dr(R),o<n?(s&&console.log(`better explanation by approxTrigonometric: ${R} complexity: ${o}`),n=o,i=R):s&&console.log(`subpar explanation by approxTrigonometric: ${R} complexity: ${o}`)),i}Qr.approxAll=Ie;function Dr(e,t,r){let n=0;if(e instanceof Array){switch(e[1]){case H1:n=4;break;case Q1:n=Math.pow(4,Math.abs(e[3]))*Math.abs(e[2]);break;case W1:n=Math.pow(3,Math.abs(e[3]))*Math.abs(e[2]);break;default:n=0}n+=Math.abs(e[2])*(Math.abs(e[3])+Math.abs(e[4]))}else n+=Math.abs(e)*(Math.abs(t)+Math.abs(r));return e[2]===1?n-=1:n+=1,e[3]===1?n-=1:n+=1,e[4]===1?n-=1:n+=1,n<0&&(n=0),n}function fR(){for(let t of[2,3,5,6,7,8,10])for(let r of[2,3,5,6,7,8,10]){if(t===r)continue;console.log(`testapproxRadicals testing: 1 * sqrt( ${t} ) / ${r}`);let n=t/r,o=Math.sqrt(t)/r,i=Ui(o),s=i[2]*Math.sqrt(i[3])/i[4];Math.abs(o-s)>1e-15&&console.log(`fail testapproxRadicals: 1 * sqrt( ${t} ) / ${r} . obtained: ${i}`)}for(let t of[2,3,5,6,7,8,10])for(let r of[2,3,5,6,7,8,10]){if(t===r)continue;console.log(`testapproxRadicals testing with 4 digits: 1 * sqrt( ${t} ) / ${r}`);let n=t/r,o=Math.sqrt(t)/r,i=o.toFixed(4),s=Ui(Number(i)),u=s[2]*Math.sqrt(s[3])/s[4];Math.abs(o-u)>1e-15&&console.log(`fail testapproxRadicals with 4 digits: 1 * sqrt( ${t} ) / ${r} . obtained: ${s}`)}for(let t of[2,3,5,6,7,8,10])for(let r of[2,3,5,6,7,8,10]){if(t===r)continue;console.log(`testapproxRadicals testing: 1 * sqrt( ${t} / ${r} )`);let n=t/r,o=Math.sqrt(t/r),i=Ui(o);if(i!=null){let s=i[2]*Math.sqrt(i[3]/i[4]);i[1]===C_&&Math.abs(o-s)>1e-15&&console.log(`fail testapproxRadicals: 1 * sqrt( ${t} / ${r} ) . obtained: ${i}`)}}for(let t of[1,2,3,5,6,7,8,10])for(let r of[1,2,3,5,6,7,8,10]){if(t===1&&r===1)continue;console.log(`testapproxRadicals testing with 4 digits:: 1 * sqrt( ${t} / ${r} )`);let n=t/r,o=Math.sqrt(t/r),i=o.toFixed(4),s=Ui(Number(i)),u=s[2]*Math.sqrt(s[3]/s[4]);s[1]===C_&&Math.abs(o-u)>1e-15&&console.log(`fail testapproxRadicals with 4 digits:: 1 * sqrt( ${t} / ${r} ) . obtained: ${s}`)}for(let t=1;t<=5;t++)for(let r=1;r<=5;r++){console.log(`testApproxAll testing: 1 * log(${t} ) / ${r}`);let n=t/r,o=Math.log(t)/r,i=Ie(o),s=i[2]*Math.log(i[3])/i[4];Math.abs(o-s)>1e-15&&console.log(`fail testApproxAll: 1 * log(${t} ) / ${r} . obtained: ${i}`)}for(let t=1;t<=5;t++)for(let r=1;r<=5;r++){console.log(`testApproxAll testing with 4 digits: 1 * log(${t} ) / ${r}`);let n=t/r,o=Math.log(t)/r,i=o.toFixed(4),s=Ie(Number(i)),u=s[2]*Math.log(s[3])/s[4];Math.abs(o-u)>1e-15&&console.log(`fail testApproxAll with 4 digits: 1 * log(${t} ) / ${r} . obtained: ${s}`)}for(let t=1;t<=5;t++)for(let r=1;r<=5;r++){console.log(`testApproxAll testing: 1 * log(${t} / ${r} )}`);let n=t/r,o=Math.log(t/r),i=Ie(o),s=i[2]*Math.log(i[3]/i[4]);Math.abs(o-s)>1e-15&&console.log(`fail testApproxAll: 1 * log(${t} / ${r} ) . obtained: ${i}`)}for(let t=1;t<=5;t++)for(let r=1;r<=5;r++){console.log(`testApproxAll testing with 4 digits: 1 * log(${t} / ${r} )`);let n=t/r,o=Math.log(t/r),i=o.toFixed(4),s=Ie(Number(i)),u=s[2]*Math.log(s[3]/s[4]);Math.abs(o-u)>1e-15&&console.log(`fail testApproxAll with 4 digits: 1 * log(${t} / ${r} ) . obtained: ${s}`)}for(let t=1;t<=2;t++)for(let r=1;r<=12;r++){console.log(`testApproxAll testing: 1 * (e ^ ${t} ) / ${r}`);let n=t/r,o=Math.pow(Math.E,t)/r,i=Ie(o),s=i[2]*Math.pow(Math.E,i[3])/i[4];Math.abs(o-s)>1e-15&&console.log(`fail testApproxAll: 1 * (e ^ ${t} ) / ${r} . obtained: ${i}`)}for(let t=1;t<=2;t++)for(let r=1;r<=12;r++){console.log(`approxRationalsOfPowersOfE testing with 4 digits: 1 * (e ^ ${t} ) / ${r}`);let n=t/r,o=Math.pow(Math.E,t)/r,i=o.toFixed(4),s=K1(Number(i)),u=s[2]*Math.pow(Math.E,s[3])/s[4];Math.abs(o-u)>1e-15&&console.log(`fail approxRationalsOfPowersOfE with 4 digits: 1 * (e ^ ${t} ) / ${r} . obtained: ${s}`)}for(let t=1;t<=2;t++)for(let r=1;r<=12;r++){console.log(`testApproxAll testing: 1 * pi ^ ${t} / ${r}`);let n=t/r,o=Math.pow(Math.PI,t)/r,i=Ie(o),s=i[2]*Math.pow(Math.PI,i[3])/i[4];Math.abs(o-s)>1e-15&&console.log(`fail testApproxAll: 1 * pi ^ ${t} / ${r} ) . obtained: ${i}`)}for(let t=1;t<=2;t++)for(let r=1;r<=12;r++){console.log(`approxRationalsOfPowersOfPI testing with 4 digits: 1 * pi ^ ${t} / ${r}`);let n=t/r,o=Math.pow(Math.PI,t)/r,i=o.toFixed(4),s=P_(Number(i)),u=s[2]*Math.pow(Math.PI,s[3])/s[4];Math.abs(o-u)>1e-15&&console.log(`fail approxRationalsOfPowersOfPI with 4 digits: 1 * pi ^ ${t} / ${r} ) . obtained: ${s}`)}for(let t=1;t<=4;t++)for(let r=1;r<=4;r++){console.log(`testApproxAll testing: 1 * sin( ${t}/${r} )}`);let n=t/r,o=Math.sin(n),i=Ie(o),s=i[3]/i[4],u=i[2]*Math.sin(s);Math.abs(o-u)>1e-15&&console.log(`fail testApproxAll: 1 * sin( ${t}/${r} ) . obtained: ${i}`)}for(let t=1;t<=4;t++)for(let r=1;r<=4;r++){console.log(`testApproxAll testing with 5 digits: 1 * sin( ${t}/${r} )`);let n=t/r,o=Math.sin(n),i=o.toFixed(5),s=Ie(Number(i));s==null&&console.log(`fail testApproxAll with 5 digits: 1 * sin( ${t}/${r} ) . obtained:  undefined `);let u=s[3]/s[4],c=s[2]*Math.sin(u),d=Math.abs(o-c);d>1e-14&&console.log(`fail testApproxAll with 5 digits: 1 * sin( ${t}/${r} ) . obtained: ${s} error: ${d}`)}for(let t=1;t<=4;t++)for(let r=1;r<=4;r++){console.log(`testApproxAll testing with 4 digits: 1 * sin( ${t}/${r} )`);let n=t/r,o=Math.sin(n),i=o.toFixed(4),s=Ie(Number(i));s==null&&console.log(`fail testApproxAll with 4 digits: 1 * sin( ${t}/${r} ) . obtained:  undefined `);let u=s[3]/s[4],c=s[2]*Math.sin(u),d=Math.abs(o-c);d>1e-14&&console.log(`fail testApproxAll with 4 digits: 1 * sin( ${t}/${r} ) . obtained: ${s} error: ${d}`)}let e=0;Ie(e)[0]!=="0"&&console.log("fail testApproxAll: 0"),e=0,Ie(e)[0]!=="0"&&console.log("fail testApproxAll: 0.0"),e=0,Ie(e)[0]!=="0"&&console.log("fail testApproxAll: 0.00"),e=0,Ie(e)[0]!=="0"&&console.log("fail testApproxAll: 0.000"),e=0,Ie(e)[0]!=="0"&&console.log("fail testApproxAll: 0.0000"),e=1,Ie(e)[0]!=="1"&&console.log("fail testApproxAll: 1"),e=1,Ie(e)[0]!=="1"&&console.log("fail testApproxAll: 1.0"),e=1,Ie(e)[0]!=="1"&&console.log("fail testApproxAll: 1.00"),e=1,Ie(e)[0]!=="1"&&console.log("fail testApproxAll: 1.000"),e=1,Ie(e)[0]!=="1"&&console.log("fail testApproxAll: 1.0000"),e=1,Ie(e)[0]!=="1"&&console.log("fail testApproxAll: 1.00000"),e=Math.sqrt(2),Ie(e)[0]!=="1 * sqrt( 2 ) / 1"&&console.log("fail testApproxAll: Math.sqrt(2)"),e=1.41,Ie(e)[0]!=="1 * sqrt( 2 ) / 1"&&console.log("fail testApproxAll: 1.41"),e=1.4,Ui(e)[0]!=="1 * sqrt( 2 ) / 1"&&console.log("fail approxRadicals: 1.4"),e=.6,Jl(e)[0]!=="1 * log( 2 ) / 1"&&console.log("fail approxLogs: 0.6"),e=.69,Jl(e)[0]!=="1 * log( 2 ) / 1"&&console.log("fail approxLogs: 0.69"),e=.7,Jl(e)[0]!=="1 * log( 2 ) / 1"&&console.log("fail approxLogs: 0.7"),e=1.09,Jl(e)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxLogs: 1.09"),e=1.09,Ie(e)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.09"),e=1.098,Ie(e)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.098"),e=1.1,Ie(e)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.1"),e=1.11,Ie(e)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.11"),e=Math.sqrt(3),Ie(e)[0]!=="1 * sqrt( 3 ) / 1"&&console.log("fail testApproxAll: Math.sqrt(3)"),e=1,Ie(e)[0]!=="1"&&console.log("fail testApproxAll: 1.0000"),e=3.141592,Ie(e)[0]!=="1 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 3.141592"),e=31.41592,Ie(e)[0]!=="10 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 31.41592"),e=314.1592,Ie(e)[0]!=="100 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 314.1592"),e=3141592653589793e-8,Ie(e)[0]!=="10000000 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 31415926.53589793"),e=Math.sqrt(2),Kl(e)[0]!=="2 * sin( 1/4 * pi )"&&console.log("fail approxTrigonometric: Math.sqrt(2)"),e=Math.sqrt(3),Kl(e)[0]!=="2 * sin( 1/3 * pi )"&&console.log("fail approxTrigonometric: Math.sqrt(3)"),e=(Math.sqrt(6)-Math.sqrt(2))/4,Ie(e)[0]!=="1 * sin( 1/12 * pi )"&&console.log("fail testApproxAll: (Math.sqrt(6) - Math.sqrt(2))/4"),e=Math.sqrt(2-Math.sqrt(2))/2,Ie(e)[0]!=="1 * sin( 1/8 * pi )"&&console.log("fail testApproxAll: Math.sqrt(2 - Math.sqrt(2))/2"),e=(Math.sqrt(6)+Math.sqrt(2))/4,Ie(e)[0]!=="1 * sin( 5/12 * pi )"&&console.log("fail testApproxAll: (Math.sqrt(6) + Math.sqrt(2))/4"),e=Math.sqrt(2+Math.sqrt(3))/2,Ie(e)[0]!=="1 * sin( 5/12 * pi )"&&console.log("fail testApproxAll: Math.sqrt(2 + Math.sqrt(3))/2"),e=(Math.sqrt(5)-1)/4,Ie(e)[0]!=="1 * sin( 1/10 * pi )"&&console.log("fail testApproxAll: (Math.sqrt(5) - 1)/4"),e=Math.sqrt(10-2*Math.sqrt(5))/4,Ie(e)[0]!=="1 * sin( 1/5 * pi )"&&console.log("fail testApproxAll: Math.sqrt(10 - 2*Math.sqrt(5))/4"),e=Math.sin(Math.PI/7),Ie(e)[0]!=="1 * sin( 1/7 * pi )"&&console.log("fail testApproxAll: Math.sin(Math.PI/7)"),e=Math.sin(Math.PI/9),Ie(e)[0]!=="1 * sin( 1/9 * pi )"&&console.log("fail testApproxAll: Math.sin(Math.PI/9)"),e=1836.15267,P_(e)[0]!=="6 * (pi ^ 5 ) / 1 )"&&console.log("fail approxRationalsOfPowersOfPI: 1836.15267");for(let t=1;t<=13;t++)for(let r=1;r<=13;r++){console.log(`approxTrigonometric testing: 1 * sin( ${t}/${r} * pi )`);let n=t/r;e=Math.sin(Math.PI*n);let o=Kl(e),i=o[3]/o[4],s=o[2]*Math.sin(Math.PI*i);Math.abs(e-s)>1e-15&&console.log(`fail approxTrigonometric: 1 * sin( ${t}/${r} * pi ) . obtained: ${o}`)}for(let t=1;t<=13;t++)for(let r=1;r<=13;r++){if(t===5&&r===11||t===6&&r===11)continue;console.log(`approxTrigonometric testing with 4 digits: 1 * sin( ${t}/${r} * pi )`);let n=t/r,o=Math.sin(Math.PI*n),i=o.toFixed(4),s=Kl(Number(i)),u=s[3]/s[4],c=s[2]*Math.sin(Math.PI*u),d=Math.abs(o-c);d>1e-14&&console.log(`fail approxTrigonometric with 4 digits: 1 * sin( ${t}/${r} * pi ) . obtained: ${s} error: ${d}`)}return console.log("testApprox done")}Qr.testApprox=fR});var tq=A(af=>{"use strict";Object.defineProperty(af,"__esModule",{value:!0});af.Eval_arccos=void 0;var te=N(),Jr=U(),fr=F(),dR=G(),kn=H(),eq=K(),ei=Z();function mR(e){return _R(dR.Eval(te.cadr(e)))}af.Eval_arccos=mR;function _R(e){if(te.car(e)===Jr.symbol(te.COS))return te.cadr(e);if(te.isdouble(e))return fr.double(Math.acos(e.d));if(kn.isoneoversqrttwo(e)||te.ismultiply(e)&&kn.equalq(te.car(te.cdr(e)),1,2)&&te.car(te.car(te.cdr(te.cdr(e))))===Jr.symbol(te.POWER)&&kn.equaln(te.car(te.cdr(te.car(te.cdr(te.cdr(e))))),2)&&kn.equalq(te.car(te.cdr(te.cdr(te.car(te.cdr(te.cdr(e)))))),1,2))return te.defs.evaluatingAsFloats?fr.double(Math.PI/4):ei.multiply(fr.rational(1,4),Jr.symbol(te.PI));if(kn.isminusoneoversqrttwo(e)||te.ismultiply(e)&&kn.equalq(te.car(te.cdr(e)),-1,2)&&te.car(te.car(te.cdr(te.cdr(e))))===Jr.symbol(te.POWER)&&kn.equaln(te.car(te.cdr(te.car(te.cdr(te.cdr(e))))),2)&&kn.equalq(te.car(te.cdr(te.cdr(te.car(te.cdr(te.cdr(e)))))),1,2))return te.defs.evaluatingAsFloats?fr.double(Math.PI*3/4):ei.multiply(fr.rational(3,4),Jr.symbol(te.PI));if(kn.isSqrtThreeOverTwo(e))return te.defs.evaluatingAsFloats?fr.double(Math.PI/6):ei.multiply(fr.rational(1,6),Jr.symbol(te.PI));if(kn.isMinusSqrtThreeOverTwo(e))return te.defs.evaluatingAsFloats?fr.double(5*Math.PI/6):ei.multiply(fr.rational(5,6),Jr.symbol(te.PI));if(!te.isrational(e))return eq.makeList(Jr.symbol(te.ARCCOS),e);switch(fr.nativeInt(ei.multiply(e,fr.integer(2)))){case-2:return te.Constants.Pi();case-1:return te.defs.evaluatingAsFloats?fr.double(Math.PI*2/3):ei.multiply(fr.rational(2,3),Jr.symbol(te.PI));case 0:return te.defs.evaluatingAsFloats?fr.double(Math.PI/2):ei.multiply(fr.rational(1,2),Jr.symbol(te.PI));case 1:return te.defs.evaluatingAsFloats?fr.double(Math.PI/3):ei.multiply(fr.rational(1,3),Jr.symbol(te.PI));case 2:return te.Constants.Zero();default:return eq.makeList(Jr.symbol(te.ARCCOS),e)}}});var nq=A(lf=>{"use strict";Object.defineProperty(lf,"__esModule",{value:!0});lf.Eval_arccosh=void 0;var Bi=N(),bR=Ee(),rq=U(),gR=F(),yR=G(),vR=H(),qR=K();function ER(e){return xR(yR.Eval(Bi.cadr(e)))}lf.Eval_arccosh=ER;function xR(e){if(Bi.car(e)===rq.symbol(Bi.COSH))return Bi.cadr(e);if(Bi.isdouble(e)){let{d:t}=e;return t<1&&bR.stop("arccosh function argument is less than 1.0"),t=Math.log(t+Math.sqrt(t*t-1)),gR.double(t)}return vR.isplusone(e)?Bi.Constants.zero:qR.makeList(rq.symbol(Bi.ARCCOSH),e)}});var iq=A(uf=>{"use strict";Object.defineProperty(uf,"__esModule",{value:!0});uf.Eval_arcsin=void 0;var re=N(),kr=U(),Kt=F(),pR=G(),$n=H(),oq=K(),bo=Z();function hR(e){return AR(pR.Eval(re.cadr(e)))}uf.Eval_arcsin=hR;function AR(e){if(re.car(e)===kr.symbol(re.SIN))return re.cadr(e);if(re.isdouble(e))return Kt.double(Math.asin(e.d));if($n.isoneoversqrttwo(e)||re.ismultiply(e)&&$n.equalq(re.car(re.cdr(e)),1,2)&&re.car(re.car(re.cdr(re.cdr(e))))===kr.symbol(re.POWER)&&$n.equaln(re.car(re.cdr(re.car(re.cdr(re.cdr(e))))),2)&&$n.equalq(re.car(re.cdr(re.cdr(re.car(re.cdr(re.cdr(e)))))),1,2))return bo.multiply(Kt.rational(1,4),kr.symbol(re.PI));if($n.isminusoneoversqrttwo(e)||re.ismultiply(e)&&$n.equalq(re.car(re.cdr(e)),-1,2)&&re.car(re.car(re.cdr(re.cdr(e))))===kr.symbol(re.POWER)&&$n.equaln(re.car(re.cdr(re.car(re.cdr(re.cdr(e))))),2)&&$n.equalq(re.car(re.cdr(re.cdr(re.car(re.cdr(re.cdr(e)))))),1,2))return re.defs.evaluatingAsFloats?Kt.double(-Math.PI/4):bo.multiply(Kt.rational(-1,4),kr.symbol(re.PI));if($n.isSqrtThreeOverTwo(e))return re.defs.evaluatingAsFloats?Kt.double(Math.PI/3):bo.multiply(Kt.rational(1,3),kr.symbol(re.PI));if($n.isMinusSqrtThreeOverTwo(e))return re.defs.evaluatingAsFloats?Kt.double(-Math.PI/3):bo.multiply(Kt.rational(-1,3),kr.symbol(re.PI));if(!re.isrational(e))return oq.makeList(kr.symbol(re.ARCSIN),e);switch(Kt.nativeInt(bo.multiply(e,Kt.integer(2)))){case-2:return re.defs.evaluatingAsFloats?Kt.double(-Math.PI/2):bo.multiply(Kt.rational(-1,2),kr.symbol(re.PI));case-1:return re.defs.evaluatingAsFloats?Kt.double(-Math.PI/6):bo.multiply(Kt.rational(-1,6),kr.symbol(re.PI));case 0:return re.Constants.Zero();case 1:return re.defs.evaluatingAsFloats?Kt.double(Math.PI/6):bo.multiply(Kt.rational(1,6),kr.symbol(re.PI));case 2:return re.defs.evaluatingAsFloats?Kt.double(Math.PI/2):bo.multiply(Kt.rational(1,2),kr.symbol(re.PI));default:return oq.makeList(kr.symbol(re.ARCSIN),e)}}});var aq=A(cf=>{"use strict";Object.defineProperty(cf,"__esModule",{value:!0});cf.Eval_arcsinh=void 0;var Gi=N(),sq=U(),OR=F(),MR=G(),TR=H(),NR=K();function IR(e){return SR(MR.Eval(Gi.cadr(e)))}cf.Eval_arcsinh=IR;function SR(e){if(Gi.car(e)===sq.symbol(Gi.SINH))return Gi.cadr(e);if(Gi.isdouble(e)){let{d:t}=e;return t=Math.log(t+Math.sqrt(t*t+1)),OR.double(t)}return TR.isZeroAtomOrTensor(e)?Gi.Constants.zero:NR.makeList(sq.symbol(Gi.ARCSINH),e)}});var uq=A(ff=>{"use strict";Object.defineProperty(ff,"__esModule",{value:!0});ff.Eval_arctanh=void 0;var Fi=N(),RR=Ee(),lq=U(),wR=F(),LR=G(),CR=H(),PR=K();function DR(e){return kR(LR.Eval(Fi.cadr(e)))}ff.Eval_arctanh=DR;function kR(e){if(Fi.car(e)===lq.symbol(Fi.TANH))return Fi.cadr(e);if(Fi.isdouble(e)){let{d:t}=e;return(t<-1||t>1)&&RR.stop("arctanh function argument is not in the interval [-1,1]"),t=Math.log((1+t)/(1-t))/2,wR.double(t)}return CR.isZeroAtomOrTensor(e)?Fi.Constants.zero:PR.makeList(lq.symbol(Fi.ARCTANH),e)}});var dq=A(df=>{"use strict";Object.defineProperty(df,"__esModule",{value:!0});df.Eval_binomial=void 0;var go=N(),k_=Ne(),$R=ue(),cq=G(),$_=pi(),fq=Z();function UR(e){let t=cq.Eval(go.cadr(e)),r=cq.Eval(go.caddr(e));return BR(t,r)}df.Eval_binomial=UR;function BR(e,t){return GR(e,t)}function GR(e,t){return FR(e,t)?fq.divide(fq.divide($_.factorial(e),$_.factorial(t)),$_.factorial($R.subtract(e,t))):go.Constants.zero}function FR(e,t){return go.isNumericAtom(e)&&k_.lessp(e,go.Constants.zero)||go.isNumericAtom(t)&&k_.lessp(t,go.Constants.zero)?!1:!(go.isNumericAtom(e)&&go.isNumericAtom(t)&&k_.lessp(e,t))}});var _q=A(mf=>{"use strict";Object.defineProperty(mf,"__esModule",{value:!0});mf.Eval_ceiling=void 0;var Ma=N(),jR=U(),zR=ue(),YR=F(),VR=G(),mq=H(),ZR=K(),XR=ln();function HR(e){return QR(VR.Eval(Ma.cadr(e)))}mf.Eval_ceiling=HR;function QR(e){return WR(e)}function WR(e){if(!Ma.isNumericAtom(e))return ZR.makeList(jR.symbol(Ma.CEILING),e);if(Ma.isdouble(e))return YR.double(Math.ceil(e.d));if(mq.isinteger(e))return e;let t=new Ma.Num(XR.mdiv(e.q.a,e.q.b));return mq.isnegativenumber(e)||(t=zR.add(t,Ma.Constants.one)),t}});var yq=A(_f=>{"use strict";Object.defineProperty(_f,"__esModule",{value:!0});_f.Eval_choose=void 0;var yo=N(),U_=Ne(),JR=ue(),bq=G(),B_=pi(),gq=Z();function KR(e){let t=bq.Eval(yo.cadr(e)),r=bq.Eval(yo.caddr(e));return ew(t,r)}_f.Eval_choose=KR;function ew(e,t){return tw(e,t)?gq.divide(gq.divide(B_.factorial(e),B_.factorial(t)),B_.factorial(JR.subtract(e,t))):yo.Constants.zero}function tw(e,t){return yo.isNumericAtom(e)&&U_.lessp(e,yo.Constants.zero)||yo.isNumericAtom(t)&&U_.lessp(t,yo.Constants.zero)?!1:!(yo.isNumericAtom(e)&&yo.isNumericAtom(t)&&U_.lessp(e,t))}});var F_=A(Ta=>{"use strict";Object.defineProperty(Ta,"__esModule",{value:!0});Ta.expcos=Ta.Eval_expcos=void 0;var G_=N(),vq=Ne(),rw=ue(),qq=F(),nw=G(),eu=Z();function ow(e){return Eq(nw.Eval(G_.cadr(e)))}Ta.Eval_expcos=ow;function Eq(e){return rw.add(eu.multiply(vq.exponential(eu.multiply(G_.Constants.imaginaryunit,e)),qq.rational(1,2)),eu.multiply(vq.exponential(eu.multiply(eu.negate(G_.Constants.imaginaryunit),e)),qq.rational(1,2)))}Ta.expcos=Eq});var j_=A(Na=>{"use strict";Object.defineProperty(Na,"__esModule",{value:!0});Na.expsin=Na.Eval_expsin=void 0;var tu=N(),xq=Ne(),iw=ue(),pq=F(),sw=G(),ji=Z();function aw(e){return hq(sw.Eval(tu.cadr(e)))}Na.Eval_expsin=aw;function hq(e){return iw.subtract(ji.multiply(ji.divide(xq.exponential(ji.multiply(tu.Constants.imaginaryunit,e)),tu.Constants.imaginaryunit),pq.rational(1,2)),ji.multiply(ji.divide(xq.exponential(ji.multiply(ji.negate(tu.Constants.imaginaryunit),e)),tu.Constants.imaginaryunit),pq.rational(1,2)))}Na.expsin=hq});var Oq=A(bf=>{"use strict";Object.defineProperty(bf,"__esModule",{value:!0});bf.Eval_circexp=void 0;var _t=N(),Ia=U(),zi=Ne(),Sa=ue(),z_=F(),Aq=G(),lw=F_(),uw=j_(),_n=Z(),cw=qt();function fw(e){let t=Y_(Aq.Eval(_t.cadr(e)));return Aq.Eval(t)}bf.Eval_circexp=fw;function Y_(e){if(_t.car(e)===Ia.symbol(_t.COS))return lw.expcos(_t.cadr(e));if(_t.car(e)===Ia.symbol(_t.SIN))return uw.expsin(_t.cadr(e));if(_t.car(e)===Ia.symbol(_t.TAN)){e=_t.cadr(e);let t=zi.exponential(_n.multiply(_t.Constants.imaginaryunit,e)),r=zi.exponential(_n.negate(_n.multiply(_t.Constants.imaginaryunit,e)));return _n.divide(_n.multiply(Sa.subtract(r,t),_t.Constants.imaginaryunit),Sa.add(t,r))}return _t.car(e)===Ia.symbol(_t.COSH)?(e=_t.cadr(e),_n.multiply(Sa.add(zi.exponential(e),zi.exponential(_n.negate(e))),z_.rational(1,2))):_t.car(e)===Ia.symbol(_t.SINH)?(e=_t.cadr(e),_n.multiply(Sa.subtract(zi.exponential(e),zi.exponential(_n.negate(e))),z_.rational(1,2))):_t.car(e)===Ia.symbol(_t.TANH)?(e=zi.exponential(_n.multiply(_t.cadr(e),z_.integer(2))),_n.divide(Sa.subtract(e,_t.Constants.one),Sa.add(e,_t.Constants.one))):_t.iscons(e)?e.map(Y_):(e.k===_t.TENSOR&&(e=cw.copy_tensor(e),e.tensor.elem=e.tensor.elem.map(Y_)),e)}});var Tq=A(gf=>{"use strict";Object.defineProperty(gf,"__esModule",{value:!0});gf.Eval_contract=void 0;var dw=It(),vo=N(),Mq=Ee(),mw=U(),_w=ue(),Z_=F(),V_=G(),bw=H();function gw(e){let t=V_.Eval(vo.cadr(e)),r,n;return vo.cddr(e)===mw.symbol(vo.NIL)?(r=vo.Constants.one,n=Z_.integer(2)):(r=V_.Eval(vo.caddr(e)),n=V_.Eval(vo.cadddr(e))),yw(t,r,n)}gf.Eval_contract=gw;function yw(e,t,r){let n=[],o=[];if(!vo.istensor(e))return bw.isZeroAtomOrTensor(e)||Mq.stop("contract: tensor expected, 1st arg is not a tensor"),vo.Constants.zero;let i=Z_.nativeInt(t),s=Z_.nativeInt(r),{ndim:u}=e.tensor;(i<1||i>u||s<1||s>u||i===s||e.tensor.dim[i-1]!==e.tensor.dim[s-1])&&Mq.stop("contract: index out of range"),i--,s--;let c=e.tensor.dim[i],d=1;for(let k=0;k<u;k++)k!==i&&k!==s&&(d*=e.tensor.dim[k]);t=dw.alloc_tensor(d),t.tensor.ndim=u-2;let _=0;for(let k=0;k<u;k++)k!==i&&k!==s&&(t.tensor.dim[_++]=e.tensor.dim[k]);let R=e.tensor.elem,T=t.tensor.elem;for(let k=0;k<u;k++)n[k]=0,o[k]=e.tensor.dim[k];for(let k=0;k<d;k++){let V=vo.Constants.zero;for(let z=0;z<c;z++){n[i]=z,n[s]=z;let Ae=0;for(let et=0;et<u;et++)Ae=Ae*o[et]+n[et];V=_w.add(V,R[Ae])}T[k]=V;for(let z=u-1;z>=0;z--)if(!(z===i||z===s)){if(++n[z]<o[z])break;n[z]=0}}return d===1?T[0]:t}});var Iq=A(yf=>{"use strict";Object.defineProperty(yf,"__esModule",{value:!0});yf.Eval_defint=void 0;var qo=N(),vw=ue(),Ra=G(),qw=Gl(),Nq=Yr();function Ew(e){let t=Ra.Eval(qo.cadr(e));for(e=qo.cddr(e);qo.iscons(e);){let r=Ra.Eval(qo.car(e));e=qo.cdr(e);let n=Ra.Eval(qo.car(e));e=qo.cdr(e);let o=Ra.Eval(qo.car(e));e=qo.cdr(e),t=qw.integral(t,r);let i=Ra.Eval(Nq.subst(t,r,o)),s=Ra.Eval(Nq.subst(t,r,n));t=vw.subtract(i,s)}return t}yf.Eval_defint=Ew});var vf=A(wa=>{"use strict";Object.defineProperty(wa,"__esModule",{value:!0});wa.degree=wa.Eval_degree=void 0;var Kr=N(),xw=U(),X_=Ne(),Sq=G(),pw=Vr(),hw=H();function Aw(e){let t=Sq.Eval(Kr.cadr(e));e=Sq.Eval(Kr.caddr(e));let r=e===xw.symbol(Kr.NIL)?pw.guess(t):e;return Rq(t,r)}wa.Eval_degree=Aw;function Rq(e,t){return wq(e,t,Kr.Constants.zero)}wa.degree=Rq;function wq(e,t,r){return X_.equal(e,t)?hw.isZeroAtomOrTensor(r)&&(r=Kr.Constants.one):Kr.ispower(e)?X_.equal(Kr.cadr(e),t)&&Kr.isNumericAtom(Kr.caddr(e))&&X_.lessp(r,Kr.caddr(e))&&(r=Kr.caddr(e)):Kr.iscons(e)&&(r=e.tail().reduce((n,o)=>wq(o,t,n),r)),r}});var kq=A(ti=>{"use strict";Object.defineProperty(ti,"__esModule",{value:!0});ti.Eval_eigenvec=ti.Eval_eigenval=ti.Eval_eigen=void 0;var $r=N(),qf=Ee(),Yi=U(),Lq=F(),Cq=G(),Ow=Rn(),Dq=K(),Mw=eo(),Pq=qt(),le=0,Zt=[],Eo=[];function Tw(e){let{arg:t}=H_(e);t||qf.stop("eigen: argument is not a square matrix");let[r,n]=Q_($r.EIGEN,t);return e=Yi.usr_symbol("D"),Yi.set_binding(e,r),e=Yi.usr_symbol("Q"),Yi.set_binding(e,n),Yi.symbol($r.NIL)}ti.Eval_eigen=Tw;function Nw(e){let{arg:t,invalid:r}=H_(e);if(r)return Dq.makeList(Yi.symbol($r.EIGENVAL),r);let[n,o]=Q_($r.EIGENVAL,t);return n}ti.Eval_eigenval=Nw;function Iw(e){let{arg:t,invalid:r}=H_(e);if(r)return Dq.makeList(Yi.symbol($r.EIGENVEC),r);let[n,o]=Q_($r.EIGENVEC,t);return o}ti.Eval_eigenvec=Iw;function H_(e){if(e=Cq.Eval(Ow.yyfloat(Cq.Eval($r.cadr(e)))),!$r.istensor(e))return{invalid:e};(e.tensor.ndim!==2||e.tensor.dim[0]!==e.tensor.dim[1])&&qf.stop("eigen: argument is not a square matrix"),le=e.tensor.dim[0],Sw(e)||qf.stop("eigen: matrix is not numerical");for(let t=0;t<le-1;t++)for(let r=t+1;r<le;r++){let n=e.tensor.elem[le*t+r],o=e.tensor.elem[le*r+t];Math.abs(n.d-o.d)>1e-10&&qf.stop("eigen: matrix is not symmetrical")}return{arg:e}}function Sw(e){for(let t=0;t<le;t++)for(let r=0;r<le;r++)if(!$r.isdouble(e.tensor.elem[le*t+r]))return!1;return!0}function Q_(e,t){for(let i=0;i<le*le;i++)Zt[i]=0;for(let i=0;i<le*le;i++)Eo[i]=0;for(let i=0;i<le;i++){Zt[le*i+i]=t.tensor.elem[le*i+i].d;for(let s=i+1;s<le;s++)Zt[le*i+s]=t.tensor.elem[le*i+s].d,Zt[le*s+i]=t.tensor.elem[le*i+s].d}for(let i=0;i<le;i++){Eo[le*i+i]=1;for(let s=i+1;s<le;s++)Eo[le*i+s]=0,Eo[le*s+i]=0}let r=0;for(r=0;r<100&&Rw()!==0;r++);r===100&&Mw.print_str(`
note: eigen did not converge
`);let n;if(e===$r.EIGEN||e===$r.EIGENVAL){n=Pq.copy_tensor(t);for(let i=0;i<le;i++)for(let s=0;s<le;s++)n.tensor.elem[le*i+s]=Lq.double(Zt[le*i+s])}let o;if(e===$r.EIGEN||e===$r.EIGENVEC){o=Pq.copy_tensor(t);for(let i=0;i<le;i++)for(let s=0;s<le;s++)o.tensor.elem[le*i+s]=Lq.double(Eo[le*i+s])}return[n,o]}function Rw(){let e=0;for(let t=0;t<le-1;t++)for(let r=t+1;r<le;r++)Zt[le*t+r]!==0&&(ww(t,r),e++);return e}function ww(e,t){let r=.5*(Zt[le*e+e]-Zt[le*t+t])/Zt[le*e+t],n=1/(Math.abs(r)+Math.sqrt(r*r+1));r<0&&(n=-n);let o=1/Math.sqrt(n*n+1),i=n*o;for(let s=0;s<le;s++){let u=Zt[le*e+s],c=Zt[le*t+s];Zt[le*e+s]=o*u+i*c,Zt[le*t+s]=o*c-i*u}for(let s=0;s<le;s++){let u=Zt[le*s+e],c=Zt[le*s+t];Zt[le*s+e]=o*u+i*c,Zt[le*s+t]=o*c-i*u}for(let s=0;s<le;s++){let u=Eo[le*e+s],c=Eo[le*t+s];Eo[le*e+s]=o*u+i*c,Eo[le*t+s]=o*c-i*u}Zt[le*e+t]=0,Zt[le*t+e]=0}});var W_=A(La=>{"use strict";Object.defineProperty(La,"__esModule",{value:!0});La.erfc=La.Eval_erfc=void 0;var Ef=N(),Lw=U(),Cw=F(),Pw=G(),Dw=H(),kw=K();function $w(e){return Uw(Pw.Eval(Ef.cadr(e)))}La.Eval_erfc=$w;function Uw(e){if(Ef.isdouble(e)){let t=$q(e.d);return Cw.double(t)}return Dw.isZeroAtomOrTensor(e)?Ef.Constants.one:kw.makeList(Lw.symbol(Ef.ERFC),e)}function $q(e){if(e===0)return 1;let t=Math.abs(e),r=1/(1+.5*t),n=r*Math.exp(-t*t-1.26551223+r*(1.00002368+r*(.37409196+r*(.09678418+r*(-.18628806+r*(.27886807+r*(-1.13520398+r*(1.48851587+r*(-.82215223+r*.17087277)))))))));return e>=0?n:2-n}La.erfc=$q});var jq=A(xf=>{"use strict";Object.defineProperty(xf,"__esModule",{value:!0});xf.Eval_erf=void 0;var ru=N(),Uq=U(),Bw=F(),Gw=W_(),Fw=G(),Bq=H(),Gq=K(),Fq=Z();function jw(e){return zw(Fw.Eval(ru.cadr(e)))}xf.Eval_erf=jw;function zw(e){return ru.isdouble(e)?Bw.double(1-Gw.erfc(e.d)):Bq.isZeroAtomOrTensor(e)?ru.Constants.zero:Bq.isnegativeterm(e)?Fq.negate(Gq.makeList(Uq.symbol(ru.ERF),Fq.negate(e))):Gq.makeList(Uq.symbol(ru.ERF),e)}});var Vq=A(pf=>{"use strict";Object.defineProperty(pf,"__esModule",{value:!0});pf.factors=void 0;var Yq=N();function Yw(e){let t=[];return Yq.isadd(e)?e.tail().forEach(r=>t.push(...zq(r))):t.push(...zq(e)),t}pf.factors=Yw;function zq(e){return Yq.ismultiply(e)?e.tail():[e]}});var eE=A(hf=>{"use strict";Object.defineProperty(hf,"__esModule",{value:!0});hf.Eval_expand=void 0;var eb=It(),at=N(),Wq=ir(),Vw=U(),Zw=Ne(),J_=ue(),Ur=F(),Jq=vf(),Xw=Mn(),K_=G(),Hw=Es(),Zq=Vq(),Kq=al(),Qw=Vr(),Xq=Go(),Ww=Nl(),nu=H(),Br=Z(),Jw=oo(),ri=Et(),Kw=Gu(),eL=qt();function tL(e){let t=K_.Eval(at.cadr(e)),r=K_.Eval(at.caddr(e)),n=r===Vw.symbol(at.NIL)?Qw.guess(t):r;return tb(t,n)}hf.Eval_expand=tL;function tb(e,t){if(at.istensor(e))return rL(e,t);if(at.isadd(e))return e.tail().reduce((u,c)=>J_.add(u,tb(c,t)),at.Constants.zero);let r=Jw.numerator(e),n=Xw.denominator(e);if([n,r]=nL(n,r,t),(nu.isone(r)||nu.isone(n))&&(!nu.ispolyexpandedform(n,t)||nu.isone(n)))return e;let o=Kw.divpoly(r,n,t);if(r=J_.subtract(r,Br.multiply(n,o)),nu.isZeroAtomOrTensor(r))return o;n=Hw.factorpoly(n,t);let i=oL(n,t);r=sL(r,i,t),n=aL(n,i,t);let s;if(at.istensor(i)){let u=at.doexpand(Ww.inv,i);s=Xq.inner(Xq.inner(u,r),n)}else{let u=at.doexpand(Br.divide,r,i);s=Br.multiply(u,n)}return J_.add(s,o)}function rL(e,t){return e=eL.copy_tensor(e),e.tensor.elem=e.tensor.elem.map(r=>tb(r,t)),e}function nL(e,t,r){let n=[...Zq.factors(e),...Zq.factors(t)],o=0;for(let i=0;i<n.length;i++){let s=n[i];if(!at.ispower(s)||at.cadr(s)!==r)continue;let u=Ur.nativeInt(at.caddr(s));isNaN(u)||u<o&&(o=u)}return o===0?[e,t]:(e=Br.multiply(e,ri.power(r,Ur.integer(-o))),t=Br.multiply(t,ri.power(r,Ur.integer(-o))),[e,t])}function oL(e,t){let r=[];at.ismultiply(e)?e.tail().forEach(i=>r.push(...Hq(e,i,t))):r.push(...Hq(e,e,t));let n=r.length;if(n===1)return r[0];let o=eb.alloc_tensor(n*n);o.tensor.ndim=2,o.tensor.dim[0]=n,o.tensor.dim[1]=n;for(let i=0;i<n;i++)for(let s=0;s<n;s++){let u=ri.power(t,Ur.integer(i)),c=at.doexpand(Br.divide,r[s],u);o.tensor.elem[n*i+s]=Kq.filter(c,t)}return o}function Hq(e,t,r){let n,o=0;if(!Wq.Find(t,r))return[];let i=at.doexpand(iL,e,t);at.ispower(t)?(o=Ur.nativeInt(at.caddr(t)),n=at.cadr(t)):(o=1,n=t);let s=[],u=Ur.nativeInt(Jq.degree(n,r));for(let c=0;c<o;c++)for(let d=0;d<u;d++){let _=ri.power(n,Ur.integer(c)),R=at.doexpand(Br.multiply,i,_);_=ri.power(r,Ur.integer(d));let T=at.doexpand(Br.multiply,R,_);s.push(T)}return s}function iL(e,t){let r=at.Constants.one;if(at.ismultiply(e)){let n=[];e.tail().forEach(o=>{Zw.equal(o,t)||n.push(K_.Eval(o))}),r=Br.multiply_all(n)}return r}function sL(e,t,r){if(!at.istensor(t))return e;let n=t.tensor.dim[0],o=eb.alloc_tensor(n);o.tensor.ndim=1,o.tensor.dim[0]=n;for(let i=0;i<n;i++){let s=ri.power(r,Ur.integer(i)),u=at.doexpand(Br.divide,e,s);o.tensor.elem[i]=Kq.filter(u,r)}return o}function aL(e,t,r){if(!at.istensor(t))return Br.reciprocate(e);let n=[];at.ismultiply(e)?e.tail().forEach(s=>{n.push(...Qq(s,r))}):n=Qq(e,r);let o=n.length,i=eb.alloc_tensor(o);return i.tensor.ndim=1,i.tensor.dim[0]=o,i.tensor.elem=n,i}function Qq(e,t){let r=1;if(!Wq.Find(e,t))return[];at.ispower(e)&&(r=Ur.nativeInt(at.caddr(e)),e=at.cadr(e));let n=[],o=Ur.nativeInt(Jq.degree(e,t));for(let i=r;i>0;i--)for(let s=0;s<o;s++)n.push(Br.multiply(Br.reciprocate(ri.power(e,Ur.integer(i))),ri.power(t,Ur.integer(s))));return n}});var rE=A(Af=>{"use strict";Object.defineProperty(Af,"__esModule",{value:!0});Af.Eval_floor=void 0;var Ca=N(),lL=U(),uL=ue(),cL=F(),fL=G(),tE=H(),dL=K(),mL=ln();function _L(e){return bL(fL.Eval(Ca.cadr(e)))}Af.Eval_floor=_L;function bL(e){return gL(e)}function gL(e){if(!Ca.isNumericAtom(e))return dL.makeList(lL.symbol(Ca.FLOOR),e);if(Ca.isdouble(e))return cL.double(Math.floor(e.d));if(tE.isinteger(e))return e;let t=new Ca.Num(mL.mdiv(e.q.a,e.q.b));return tE.isnegativenumber(e)&&(t=uL.add(t,Ca.Constants.negOne)),t}});var nE=A(Mf=>{"use strict";Object.defineProperty(Mf,"__esModule",{value:!0});Mf.Eval_for=void 0;var Pa=N(),yL=Ee(),Of=U(),vL=F(),rb=G();function qL(e){let t=Pa.caddr(e);Pa.issymbol(t)||yL.stop("for: 2nd arg should be the variable to loop over");let r=rb.evaluate_integer(Pa.cadddr(e));if(isNaN(r))return e;let n=rb.evaluate_integer(Pa.caddddr(e));if(isNaN(n))return e;let o=Of.get_binding(t);for(let i=r;i<=n;i++)Of.set_binding(t,vL.integer(i)),rb.Eval(Pa.cadr(e));return Of.set_binding(t,o),Of.symbol(Pa.NIL)}Mf.Eval_for=qL});var aE=A(Nf=>{"use strict";Object.defineProperty(Nf,"__esModule",{value:!0});Nf.Eval_gamma=void 0;var Qe=N(),iE=U(),EL=ue(),nb=F(),xL=G(),pL=H(),sE=K(),xo=Z(),oE=Et(),hL=Qn();function AL(e){return Tf(xL.Eval(Qe.cadr(e)))}Nf.Eval_gamma=AL;function Tf(e){return OL(e)}function OL(e){return Qe.isrational(e)&&Qe.MEQUAL(e.q.a,1)&&Qe.MEQUAL(e.q.b,2)?oE.power(Qe.Constants.Pi(),nb.rational(1,2)):Qe.isrational(e)&&Qe.MEQUAL(e.q.a,3)&&Qe.MEQUAL(e.q.b,2)?xo.multiply(oE.power(Qe.Constants.Pi(),nb.rational(1,2)),nb.rational(1,2)):pL.isnegativeterm(e)?xo.divide(xo.multiply(Qe.Constants.Pi(),Qe.Constants.negOne),xo.multiply(xo.multiply(hL.sine(xo.multiply(Qe.Constants.Pi(),e)),e),Tf(xo.negate(e)))):Qe.isadd(e)?ML(e):sE.makeList(iE.symbol(Qe.GAMMA),e)}function ML(e){let t=Qe.cdr(e);return Qe.isrational(Qe.car(t))&&Qe.MEQUAL(Qe.car(t).q.a,1)&&Qe.MEQUAL(Qe.car(t).q.b,1)?xo.multiply(Qe.cadr(t),Tf(Qe.cadr(t))):Qe.isrational(Qe.car(t))&&Qe.MEQUAL(Qe.car(t).q.a,-1)&&Qe.MEQUAL(Qe.car(t).q.b,1)?xo.divide(Tf(Qe.cadr(t)),EL.add(Qe.cadr(t),Qe.Constants.negOne)):sE.makeList(iE.symbol(Qe.GAMMA),e)}});var lE=A(If=>{"use strict";Object.defineProperty(If,"__esModule",{value:!0});If.Eval_isprime=void 0;var ob=N(),TL=G(),NL=H(),IL=Fd();function SL(e){return RL(TL.Eval(ob.cadr(e)))}If.Eval_isprime=SL;function RL(e){return NL.isnonnegativeinteger(e)&&IL.mprime(e.q.a)?ob.Constants.one:ob.Constants.zero}});var cE=A(Cf=>{"use strict";Object.defineProperty(Cf,"__esModule",{value:!0});Cf.Eval_laguerre=void 0;var bn=N(),Rf=U(),Sf=ue(),wf=F(),Lf=G(),wL=K(),ib=Z(),LL=Yr();function CL(e){let t=Lf.Eval(bn.cadr(e)),r=Lf.Eval(bn.caddr(e)),n=Lf.Eval(bn.cadddr(e)),o=n===Rf.symbol(bn.NIL)?bn.Constants.zero:n;return PL(t,r,o)}Cf.Eval_laguerre=CL;function PL(e,t,r){let n=wf.nativeInt(t);return n<0||isNaN(n)?wL.makeList(Rf.symbol(bn.LAGUERRE),e,t,r):bn.issymbol(e)?uE(n,e,r):Lf.Eval(LL.subst(uE(n,Rf.symbol(bn.SECRETX),r),Rf.symbol(bn.SECRETX),e))}function uE(e,t,r){let n=bn.Constants.zero,o=bn.Constants.one;for(let i=0;i<e;i++){let s=ib.divide(Sf.subtract(ib.multiply(Sf.add(Sf.subtract(wf.integer(2*i+1),t),r),o),ib.multiply(Sf.add(wf.integer(i),r),n)),wf.integer(i+1));n=o,o=s}return o}});var dE=A(Pf=>{"use strict";Object.defineProperty(Pf,"__esModule",{value:!0});Pf.Eval_leading=void 0;var sb=N(),DL=U(),kL=vf(),fE=G(),$L=al(),UL=Vr(),BL=Z(),GL=Et();function FL(e){let t=fE.Eval(sb.cadr(e));e=fE.Eval(sb.caddr(e));let r=e===DL.symbol(sb.NIL)?UL.guess(t):e;return jL(t,r)}Pf.Eval_leading=FL;function jL(e,t){let r=kL.degree(e,t);return $L.filter(BL.divide(e,GL.power(t,r)),t)}});var bE=A(kf=>{"use strict";Object.defineProperty(kf,"__esModule",{value:!0});kf.Eval_legendre=void 0;var er=N(),Da=U(),ab=Ne(),_E=ue(),Zi=F(),zL=Lo(),YL=Ri(),Df=G(),VL=K(),Vi=Z(),ZL=Et(),XL=Qn(),HL=Yr();function QL(e){let t=Df.Eval(er.cadr(e)),r=Df.Eval(er.caddr(e)),n=Df.Eval(er.cadddr(e)),o=n===Da.symbol(er.NIL)?er.Constants.zero:n;return WL(t,r,o)}kf.Eval_legendre=QL;function WL(e,t,r){return JL(e,t,r)}function JL(e,t,r){let n=Zi.nativeInt(t),o=Zi.nativeInt(r);if(n<0||isNaN(n)||o<0||isNaN(o))return VL.makeList(Da.symbol(er.LEGENDRE),e,t,r);let i;if(er.issymbol(e))i=mE(n,o,e);else{let s=mE(n,o,Da.symbol(er.SECRETX));i=Df.Eval(HL.subst(s,Da.symbol(er.SECRETX),e))}return i=KL(i,o,e)||i,i}function mE(e,t,r){let n=er.Constants.zero,o=er.Constants.one;for(let i=0;i<e;i++){let s=Vi.divide(_E.subtract(Vi.multiply(Vi.multiply(Zi.integer(2*i+1),r),o),Vi.multiply(Zi.integer(i),n)),Zi.integer(i+1));n=o,o=s}for(let i=0;i<t;i++)o=YL.derivative(o,r);return o}function KL(e,t,r){if(t===0)return;let n=_E.subtract(er.Constants.one,ab.square(r));er.car(r)===Da.symbol(er.COS)?n=ab.square(XL.sine(er.cadr(r))):er.car(r)===Da.symbol(er.SIN)&&(n=ab.square(zL.cosine(er.cadr(r))));let o=Vi.multiply(e,ZL.power(n,Vi.multiply(Zi.integer(t),Zi.rational(1,2))));return t%2&&(o=Vi.negate(o)),o}});var gE=A(Uf=>{"use strict";Object.defineProperty(Uf,"__esModule",{value:!0});Uf.Eval_lookup=void 0;var $f=N(),eC=U();function tC(e){return e=$f.cadr(e),!$f.iscons(e)&&$f.cadr(e).k===$f.SYM&&(e=eC.get_binding(e)),e}Uf.Eval_lookup=tC});var vE=A(Ff=>{"use strict";Object.defineProperty(Ff,"__esModule",{value:!0});Ff.Eval_mod=void 0;var ni=N(),Bf=Ee(),rC=U(),Gf=F(),yE=G(),lb=H(),nC=K(),oC=ln();function iC(e){let t=yE.Eval(ni.cadr(e)),r=yE.Eval(ni.caddr(e));return sC(t,r)}Ff.Eval_mod=iC;function sC(e,t){if(lb.isZeroAtomOrTensor(t)&&Bf.stop("mod function: divide by zero"),!ni.isNumericAtom(e)||!ni.isNumericAtom(t))return nC.makeList(rC.symbol(ni.MOD),e,t);if(ni.isdouble(e)){let r=Gf.nativeInt(e);isNaN(r)&&Bf.stop("mod function: cannot convert float value to integer"),e=Gf.integer(r)}if(ni.isdouble(t)){let r=Gf.nativeInt(t);isNaN(r)&&Bf.stop("mod function: cannot convert float value to integer"),t=Gf.integer(r)}return(!lb.isinteger(e)||!lb.isinteger(t))&&Bf.stop("mod function: integer arguments expected"),new ni.Num(oC.mmod(e.q.a,t.q.a))}});var hE=A(Vf=>{"use strict";Object.defineProperty(Vf,"__esModule",{value:!0});Vf.Eval_nroots=void 0;var aC=It(),Xi=N(),iu=Ee(),lC=U(),uC=Ne(),cC=ue(),qE=F(),fC=gi(),jf=G(),EE=Rn(),dC=Vr(),mC=vl(),_C=H(),bC=Z(),gC=Us(),pE=101,Yf=1e-6,yC=1e-9;function ou(e){return Math.sqrt(e.r*e.r+e.i*e.i)}function zf(){return 4*Math.random()-2}var gn=class{constructor(){this.r=0,this.i=0}},Ke=new gn,Un=new gn,pt=new gn,gr=new gn,Sr=new gn,Gr=new gn,ka=new gn,Bn=new gn,Ye=[];for(let e=0;e<pE;e++)Ye[e]=new gn;function vC(e){let t=jf.Eval(Xi.caddr(e));e=jf.Eval(Xi.cadr(e)),t=t===lC.symbol(Xi.NIL)?dC.guess(e):t,_C.ispolyexpandedform(e,t)||iu.stop("nroots: polynomial?");let r=fC.coeff(e,t),n=r.length;n>pE&&iu.stop("nroots: degree?");for(let i=0;i<n;i++)e=jf.Eval(EE.yyfloat(gC.real(r[i]))),t=jf.Eval(EE.yyfloat(mC.imag(r[i]))),(!Xi.isdouble(e)||!Xi.isdouble(t))&&iu.stop("nroots: coefficients?"),Ye[i].r=e.d,Ye[i].i=t.d;qC(n);let o=[];for(let i=n;i>1;i--)EC(i),Math.abs(Ke.r)<Yf&&(Ke.r=0),Math.abs(Ke.i)<Yf&&(Ke.i=0),o.push(cC.add(qE.double(Ke.r),bC.multiply(qE.double(Ke.i),Xi.Constants.imaginaryunit))),xC(i);if(n=o.length,n==1)return o[0];if(n>1)return o.sort(uC.cmp_expr),e=aC.alloc_tensor(n),e.tensor.ndim=1,e.tensor.dim[0]=n,e.tensor.elem=o,e}Vf.Eval_nroots=vC;function qC(e){gr.r=Ye[e-1].r,gr.i=Ye[e-1].i;let t=gr.r*gr.r+gr.i*gr.i;for(let r=0;r<e-1;r++)Ye[r].r=(Ye[r].r*gr.r+Ye[r].i*gr.i)/t,Ye[r].i=(Ye[r].i*gr.r-Ye[r].r*gr.i)/t;Ye[e-1].r=1,Ye[e-1].i=0}function EC(e){if(ou(Ye[0])<Yf){Ke.r=0,Ke.i=0;return}for(let t=0;t<100;t++){Ke.r=zf(),Ke.i=zf(),xE(e),Un.r=Ke.r,Un.i=Ke.i,Gr.r=Sr.r,Gr.i=Sr.i,Ke.r=zf(),Ke.i=zf();for(let r=0;r<1e3;r++){xE(e);let n=ou(Sr);if(Xi.DEBUG&&console.log(`nrabs: ${n}`),n<yC)return;ou(Sr)<ou(Gr)&&(pt.r=Ke.r,pt.i=Ke.i,Ke.r=Un.r,Ke.i=Un.i,Un.r=pt.r,Un.i=pt.i,pt.r=Sr.r,pt.i=Sr.i,Sr.r=Gr.r,Sr.i=Gr.i,Gr.r=pt.r,Gr.i=pt.i),ka.r=Un.r-Ke.r,ka.i=Un.i-Ke.i,Bn.r=Gr.r-Sr.r,Bn.i=Gr.i-Sr.i;let o=Bn.r*Bn.r+Bn.i*Bn.i;if(o===0)break;gr.r=(ka.r*Bn.r+ka.i*Bn.i)/o,gr.i=(ka.i*Bn.r-ka.r*Bn.i)/o,Ke.r=Un.r-(gr.r*Gr.r-gr.i*Gr.i),Ke.i=Un.i-(gr.r*Gr.i+gr.i*Gr.r)}}iu.stop("nroots: convergence error")}function xE(e){pt.r=Ke.r,pt.i=Ke.i,Sr.r=Ye[0].r+Ye[1].r*pt.r-Ye[1].i*pt.i,Sr.i=Ye[0].i+Ye[1].r*pt.i+Ye[1].i*pt.r;for(let t=2;t<e;t++){let r=Ke.r*pt.r-Ke.i*pt.i;pt.i=Ke.r*pt.i+Ke.i*pt.r,pt.r=r,Sr.r+=Ye[t].r*pt.r-Ye[t].i*pt.i,Sr.i+=Ye[t].r*pt.i+Ye[t].i*pt.r}}function xC(e){for(let t=e-1;t>0;t--)Ye[t-1].r+=Ye[t].r*Ke.r-Ye[t].i*Ke.i,Ye[t-1].i+=Ye[t].i*Ke.r+Ye[t].r*Ke.i;ou(Ye[0])>Yf&&iu.stop("nroots: residual error");for(let t=0;t<e-1;t++)Ye[t].r=Ye[t+1].r,Ye[t].i=Ye[t+1].i}});var TE=A(Zf=>{"use strict";Object.defineProperty(Zf,"__esModule",{value:!0});Zf.Eval_outer=void 0;var pC=It(),oi=N(),hC=Ee(),AE=G(),ME=Z(),OE=qt();function AC(e){e=oi.cdr(e);let t=AE.Eval(oi.car(e));return oi.iscons(e)?e.tail().reduce((n,o)=>OC(n,AE.Eval(o)),t):t}Zf.Eval_outer=AC;function OC(e,t){return oi.istensor(e)&&oi.istensor(t)?MC(e,t):oi.istensor(e)?OE.tensor_times_scalar(e,t):oi.istensor(t)?OE.scalar_times_tensor(e,t):ME.multiply(e,t)}function MC(e,t){let r=e.tensor.ndim+t.tensor.ndim;r>oi.MAXDIM&&hC.stop("outer: rank of result exceeds maximum");let n=e.tensor.nelem*t.tensor.nelem,o=pC.alloc_tensor(n);o.tensor.ndim=r,o.tensor.dim=[...e.tensor.dim,...t.tensor.dim];let i=0;for(let s=0;s<e.tensor.nelem;s++)for(let u=0;u<t.tensor.nelem;u++)o.tensor.elem[i++]=ME.multiply(e.tensor.elem[s],t.tensor.elem[u]);return o}});var cb=A(en=>{"use strict";Object.defineProperty(en,"__esModule",{value:!0});en.Eval_patternsinfo=en.Eval_clearpatterns=en.do_clearPatterns=en.Eval_pattern=en.Eval_silentpattern=void 0;var Be=N(),ub=Ee(),$a=U(),TC=Ne(),NC=K(),NE=eo();function IC(e){return IE(e),$a.symbol(Be.NIL)}en.Eval_silentpattern=IC;function IE(e){let t;Be.iscons(Be.cdr(e))||ub.stop("pattern needs at least a template and a transformed version");let r=Be.car(Be.cdr(e)),n=Be.car(Be.cdr(Be.cdr(e)));n===$a.symbol(Be.NIL)&&ub.stop("pattern needs at least a template and a transformed version"),Be.iscons(Be.cdr(Be.cdr(e)))?t=Be.car(Be.cdr(Be.cdr(Be.cdr(e)))):t=$a.symbol(Be.NIL),TC.equal(r,n)&&ub.stop("recursive pattern");let o="template: "+NE.print_list(r);o+=" tests: "+NE.print_list(t),Be.DEBUG&&console.log(`pattern stringkey: ${o}`);let i=Be.defs.userSimplificationsInStringForm.indexOf(o);return i===-1?(Be.defs.userSimplificationsInStringForm.push(o),Be.defs.userSimplificationsInListForm.push(Be.cdr(e))):(Be.DEBUG&&console.log(`pattern already exists, replacing. ${Be.cdr(e)}`),Be.defs.userSimplificationsInStringForm[i]=o,Be.defs.userSimplificationsInListForm[i]=Be.cdr(e)),NC.makeList($a.symbol(Be.PATTERN),Be.cdr(e))}en.Eval_pattern=IE;function SE(){Be.defs.userSimplificationsInListForm=[],Be.defs.userSimplificationsInStringForm=[]}en.do_clearPatterns=SE;function SC(){return SE(),$a.symbol(Be.NIL)}en.Eval_clearpatterns=SC;function RC(){let e=wC();return e!==""?new Be.Str(e):$a.symbol(Be.NIL)}en.Eval_patternsinfo=RC;function wC(){let e="";for(let t of Array.from(Be.defs.userSimplificationsInListForm))e+=Be.defs.userSimplificationsInListForm+`
`;return e}});var wE=A(Xf=>{"use strict";Object.defineProperty(Xf,"__esModule",{value:!0});Xf.Eval_prime=void 0;var fb=N(),LC=Ee(),RE=F(),CC=G();function PC(e){return DC(CC.Eval(fb.cadr(e)))}Xf.Eval_prime=PC;function DC(e){let t=RE.nativeInt(e);return(t<1||t>fb.MAXPRIMETAB)&&LC.stop("prime: Argument out of range."),t=fb.primetab[t-1],RE.integer(t)}});var LE=A(Hf=>{"use strict";Object.defineProperty(Hf,"__esModule",{value:!0});Hf.Eval_product=void 0;var Hi=N(),kC=Ee(),db=U(),$C=F(),mb=G(),UC=Z();function BC(e){let t=Hi.cadr(e),r=Hi.caddr(e);Hi.issymbol(r)||kC.stop("sum: 2nd arg?");let n=mb.evaluate_integer(Hi.cadddr(e));if(isNaN(n))return e;let o=mb.evaluate_integer(Hi.caddddr(e));if(isNaN(o))return e;let i=db.get_binding(r),s=Hi.Constants.one;for(let u=n;u<=o;u++){db.set_binding(r,$C.integer(u));let c=mb.Eval(t),d=UC.multiply(s,c);Hi.DEBUG&&(console.log(`product - factor 1: ${c}`),console.log(`product - factor 2: ${s}`),console.log(`product - result: ${d}`)),s=d}return db.set_binding(r,i),s}Hf.Eval_product=BC});var PE=A(Wf=>{"use strict";Object.defineProperty(Wf,"__esModule",{value:!0});Wf.Eval_round=void 0;var Qf=N(),GC=U(),CE=F(),FC=G(),jC=Rn(),zC=H(),YC=K();function VC(e){return ZC(FC.Eval(Qf.cadr(e)))}Wf.Eval_round=VC;function ZC(e){return Qf.isNumericAtom(e)?Qf.isdouble(e)?CE.double(Math.round(e.d)):zC.isinteger(e)?e:(e=jC.yyfloat(e),CE.integer(Math.round(e.d))):YC.makeList(GC.symbol(Qf.ROUND),e)}});var DE=A(Jf=>{"use strict";Object.defineProperty(Jf,"__esModule",{value:!0});Jf.Eval_shape=void 0;var XC=It(),_b=N(),HC=Ee(),QC=F(),WC=G(),JC=H();function KC(e){return e3(WC.Eval(_b.cadr(e)))}Jf.Eval_shape=KC;function e3(e){if(!_b.istensor(e))return JC.isZeroAtomOrTensor(e)||HC.stop("transpose: tensor expected, 1st arg is not a tensor"),_b.Constants.zero;let{ndim:t}=e.tensor,r=XC.alloc_tensor(t);r.tensor.ndim=1,r.tensor.dim[0]=t;for(let n=0;n<t;n++)r.tensor.elem[n]=QC.integer(e.tensor.dim[n]);return r}});var kE=A(Kf=>{"use strict";Object.defineProperty(Kf,"__esModule",{value:!0});Kf.Eval_sum=void 0;var Ua=N(),t3=Ee(),bb=U(),r3=ue(),n3=F(),gb=G();function o3(e){let t=Ua.cadr(e),r=Ua.caddr(e);Ua.issymbol(r)||t3.stop("sum: 2nd arg?");let n=gb.evaluate_integer(Ua.cadddr(e));if(isNaN(n))return e;let o=gb.evaluate_integer(Ua.caddddr(e));if(isNaN(o))return e;let i=bb.get_binding(r),s=Ua.Constants.zero;for(let u=n;u<=o;u++)bb.set_binding(r,n3.integer(u)),s=r3.add(s,gb.Eval(t));return bb.set_binding(r,i),s}Kf.Eval_sum=o3});var BE=A(td=>{"use strict";Object.defineProperty(td,"__esModule",{value:!0});td.Eval_tan=void 0;var yn=N(),yb=U(),Fr=F(),i3=G(),s3=H(),$E=K(),Qi=Z(),ed=Et();function a3(e){return UE(i3.Eval(yn.cadr(e)))}td.Eval_tan=a3;function UE(e){if(yn.car(e)===yb.symbol(yn.ARCTAN))return yn.cadr(e);if(yn.isdouble(e)){let r=Math.tan(e.d);return Math.abs(r)<1e-10&&(r=0),Fr.double(r)}if(s3.isnegative(e))return Qi.negate(UE(Qi.negate(e)));let t=Fr.nativeInt(Qi.divide(Qi.multiply(e,Fr.integer(180)),yn.Constants.Pi()));if(t<0||isNaN(t))return $E.makeList(yb.symbol(yn.TAN),e);switch(t%360){case 0:case 180:return yn.Constants.zero;case 30:case 210:return Qi.multiply(Fr.rational(1,3),ed.power(Fr.integer(3),Fr.rational(1,2)));case 150:case 330:return Qi.multiply(Fr.rational(-1,3),ed.power(Fr.integer(3),Fr.rational(1,2)));case 45:case 225:return yn.Constants.one;case 135:case 315:return yn.Constants.negOne;case 60:case 240:return ed.power(Fr.integer(3),Fr.rational(1,2));case 120:case 300:return Qi.negate(ed.power(Fr.integer(3),Fr.rational(1,2)));default:return $E.makeList(yb.symbol(yn.TAN),e)}}});var FE=A(rd=>{"use strict";Object.defineProperty(rd,"__esModule",{value:!0});rd.Eval_tanh=void 0;var Wi=N(),GE=U(),l3=F(),u3=G(),c3=H(),f3=K();function d3(e){return m3(u3.Eval(Wi.cadr(e)))}rd.Eval_tanh=d3;function m3(e){if(Wi.car(e)===GE.symbol(Wi.ARCTANH))return Wi.cadr(e);if(Wi.isdouble(e)){let t=Math.tanh(e.d);return Math.abs(t)<1e-10&&(t=0),l3.double(t)}return c3.isZeroAtomOrTensor(e)?Wi.Constants.zero:f3.makeList(GE.symbol(Wi.TANH),e)}});var YE=A(od=>{"use strict";Object.defineProperty(od,"__esModule",{value:!0});od.Eval_taylor=void 0;var Rr=N(),nd=U(),jE=ue(),qb=F(),_3=Ri(),Ba=G(),b3=pi(),g3=Vr(),y3=H(),v3=K(),vb=Z(),zE=Yr();function q3(e){e=Rr.cdr(e);let t=Ba.Eval(Rr.car(e));e=Rr.cdr(e);let r=Ba.Eval(Rr.car(e)),n=r===nd.symbol(Rr.NIL)?g3.guess(t):r;e=Rr.cdr(e),r=Ba.Eval(Rr.car(e));let o=r===nd.symbol(Rr.NIL)?qb.integer(24):r;e=Rr.cdr(e),r=Ba.Eval(Rr.car(e));let i=r===nd.symbol(Rr.NIL)?Rr.Constants.zero:r;return E3(t,n,o,i)}od.Eval_taylor=q3;function E3(e,t,r,n){let o=qb.nativeInt(r);if(isNaN(o))return v3.makeList(nd.symbol(Rr.TAYLOR),e,t,r,n);let i=Rr.Constants.one,s=Ba.Eval(zE.subst(e,t,n));for(let u=1;u<=o&&(e=_3.derivative(e,t),!y3.isZeroAtomOrTensor(e));u++){i=vb.multiply(i,jE.subtract(t,n));let c=Ba.Eval(zE.subst(e,t,n));s=jE.add(s,vb.divide(vb.multiply(c,i),b3.factorial(qb.integer(u))))}return s}});var VE=A(Ut=>{"use strict";Object.defineProperty(Ut,"__esModule",{value:!0});Ut.Eval_or=Ut.Eval_and=Ut.Eval_not=Ut.Eval_testlt=Ut.Eval_testle=Ut.Eval_testgt=Ut.Eval_testge=Ut.Eval_testeq=Ut.Eval_test=void 0;var be=N(),x3=U(),Eb=ue(),po=G(),p3=Rn(),Ji=H(),id=Zo();function h3(e){let t=e;for(e=be.cdr(e);be.iscons(e);){if(be.cdr(e)===x3.symbol(be.NIL))return po.Eval(be.car(e));let r=Ji.isZeroLikeOrNonZeroLikeOrUndetermined(be.car(e));if(r==null)return t;if(r)return po.Eval(be.cadr(e));e=be.cddr(e)}return be.Constants.zero}Ut.Eval_test=h3;function A3(e){let t=e,r=Eb.subtract(po.Eval(be.cadr(e)),po.Eval(be.caddr(e))),n=Ji.isZeroLikeOrNonZeroLikeOrUndetermined(r);if(n)return be.Constants.zero;if(n!=null&&!n)return be.Constants.one;let o=id.simplify(po.Eval(be.cadr(e))),i=id.simplify(po.Eval(be.caddr(e)));return r=Eb.subtract(o,i),n=Ji.isZeroLikeOrNonZeroLikeOrUndetermined(r),n?be.Constants.zero:n!=null&&!n?be.Constants.one:t}Ut.Eval_testeq=A3;function O3(e){let t=e,r=sd(e);return r==null?t:r>=0?be.Constants.one:be.Constants.zero}Ut.Eval_testge=O3;function M3(e){let t=e,r=sd(e);return r==null?t:r>0?be.Constants.one:be.Constants.zero}Ut.Eval_testgt=M3;function T3(e){let t=e,r=sd(e);return r==null?t:r<=0?be.Constants.one:be.Constants.zero}Ut.Eval_testle=T3;function N3(e){let t=e,r=sd(e);return r==null?t:r<0?be.Constants.one:be.Constants.zero}Ut.Eval_testlt=N3;function I3(e){let t=e,r=Ji.isZeroLikeOrNonZeroLikeOrUndetermined(be.cadr(e));return r==null?t:r?be.Constants.zero:be.Constants.one}Ut.Eval_not=I3;function S3(e){let t=e,r=be.cdr(t),n=!1;for(;be.iscons(r);){let o=Ji.isZeroLikeOrNonZeroLikeOrUndetermined(be.car(r));if(o==null)n=!0,r=be.cdr(r);else if(o)r=be.cdr(r);else if(!o)return be.Constants.zero}return n?t:be.Constants.one}Ut.Eval_and=S3;function R3(e){let t=e,r=be.cdr(t),n=!1;for(;be.iscons(r);){let o=Ji.isZeroLikeOrNonZeroLikeOrUndetermined(be.car(r));if(o==null)n=!0,r=be.cdr(r);else{if(o)return be.Constants.one;o||(r=be.cdr(r))}}return n?t:be.Constants.zero}Ut.Eval_or=R3;function sd(e){let t=0,r=id.simplify(po.Eval(be.cadr(e))),n=id.simplify(po.Eval(be.caddr(e)));if(e=Eb.subtract(r,n),e.k!==be.NUM&&e.k!==be.DOUBLE&&(e=po.Eval(p3.yyfloat(e))),Ji.isZeroAtomOrTensor(e))return 0;switch(e.k){case be.NUM:be.MSIGN(e.q.a)===-1?t=-1:t=1;break;case be.DOUBLE:e.d<0?t=-1:t=1;break;default:t=null}return t}});var ZE=A(ld=>{"use strict";Object.defineProperty(ld,"__esModule",{value:!0});ld.Eval_zero=void 0;var w3=It(),ad=N(),L3=G();function C3(e){let t=Array(ad.MAXDIM).fill(0),r=1,n=0;if(ad.iscons(e))for(let o of e.tail()){let i=L3.evaluate_integer(o);if(i<1||isNaN(i))return ad.Constants.zero;r*=i,t[n++]=i}if(n===0)return ad.Constants.zero;e=w3.alloc_tensor(r),e.tensor.ndim=n;for(let o=0;o<n;o++)e.tensor.dim[o]=t[o];return e}ld.Eval_zero=C3});var su=A(Ga=>{"use strict";Object.defineProperty(Ga,"__esModule",{value:!0});Ga.defn=Ga.init=void 0;var P3=on(),D3=ue(),k3=hm(),$3=D_(),U3=tq(),B3=nq(),G3=iq(),F3=aq(),j3=um(),z3=uq(),Y3=ds(),V3=Nm(),Z3=Im(),XE=F(),X3=dq(),H3=_q(),Q3=yq(),W3=Oq(),HE=hb(),J3=Pu(),K3=gi(),eP=pm(),tP=bl(),rP=yi(),nP=Tq(),oP=Lo(),iP=Sm(),sP=Jm(),aP=Cd(),lP=Iq(),uP=vf(),cP=Mn(),fP=Ri(),dP=Cm(),xb=kq(),mP=jq(),_P=W_(),bt=G(),bP=eE(),gP=F_(),yP=j_(),vP=fl(),qP=al(),EP=Rn(),xP=rE(),pP=nE(),hP=aE(),AP=_i(),OP=vl(),QE=Go(),MP=Gl(),TP=lE(),NP=cE(),IP=Dd(),SP=dE(),RP=bE(),wP=K(),LP=m_(),CP=gE(),PP=vE(),DP=Z(),kP=hE(),$P=oo(),UP=TE(),ud=cb(),BP=Du(),GP=Et(),FP=wE(),ii=eo(),jP=LE(),zP=Gu(),YP=gl(),VP=Us(),ZP=Kn(),XP=Qm(),HP=PE(),QP=Yo(),WP=b_(),JP=DE(),KP=Zo(),eD=Qn(),tD=g_(),rD=kE(),nD=BE(),oD=FE(),iD=YE(),ho=VE(),sD=o_(),aD=ZE(),g=N(),y=U(),pb=0;function lD(){pb=0,g.reset_after_error(),g.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated=[],!pb&&(pb=1,y.reset_symbols(),JE())}Ga.init=lD;var WE=['version="'+g.version+'"',"e=exp(1)","i=sqrt(-1)","autoexpand=1","assumeRealVariables=1","trange=[-pi,pi]","xrange=[-10,10]","yrange=[-10,10]","last=0","trace=0","forceFixedPrintout=1","maxFixedPrintoutDigits=6","printLeaveEAlone=1","printLeaveXAlone=0","cross(u,v)=[u[2]*v[3]-u[3]*v[2],u[3]*v[1]-u[1]*v[3],u[1]*v[2]-u[2]*v[1]]","curl(v)=[d(v[3],y)-d(v[2],z),d(v[1],z)-d(v[3],x),d(v[2],x)-d(v[1],y)]","div(v)=d(v[1],x)+d(v[2],y)+d(v[3],z)","ln(x)=log(x)"];function JE(){y.std_symbol(g.ABS,P3.Eval_abs),y.std_symbol(g.ADD,D3.Eval_add),y.std_symbol(g.ADJ,k3.Eval_adj),y.std_symbol(g.AND,ho.Eval_and),y.std_symbol(g.APPROXRATIO,$3.Eval_approxratio),y.std_symbol(g.ARCCOS,U3.Eval_arccos),y.std_symbol(g.ARCCOSH,B3.Eval_arccosh),y.std_symbol(g.ARCSIN,G3.Eval_arcsin),y.std_symbol(g.ARCSINH,F3.Eval_arcsinh),y.std_symbol(g.ARCTAN,j3.Eval_arctan),y.std_symbol(g.ARCTANH,z3.Eval_arctanh),y.std_symbol(g.ARG,Y3.Eval_arg),y.std_symbol(g.ATOMIZE),y.std_symbol(g.BESSELJ,V3.Eval_besselj),y.std_symbol(g.BESSELY,Z3.Eval_bessely),y.std_symbol(g.BINDING,bt.Eval_binding),y.std_symbol(g.BINOMIAL,X3.Eval_binomial),y.std_symbol(g.CEILING,H3.Eval_ceiling),y.std_symbol(g.CHECK,bt.Eval_check),y.std_symbol(g.CHOOSE,Q3.Eval_choose),y.std_symbol(g.CIRCEXP,W3.Eval_circexp),y.std_symbol(g.CLEAR,HE.Eval_clear),y.std_symbol(g.CLEARALL,HE.Eval_clearall),y.std_symbol(g.CLEARPATTERNS,ud.Eval_clearpatterns),y.std_symbol(g.CLOCK,J3.Eval_clock),y.std_symbol(g.COEFF,K3.Eval_coeff),y.std_symbol(g.COFACTOR,eP.Eval_cofactor),y.std_symbol(g.CONDENSE,tP.Eval_condense),y.std_symbol(g.CONJ,rP.Eval_conj),y.std_symbol(g.CONTRACT,nP.Eval_contract),y.std_symbol(g.COS,oP.Eval_cos),y.std_symbol(g.COSH,iP.Eval_cosh),y.std_symbol(g.DECOMP,sP.Eval_decomp),y.std_symbol(g.DEFINT,lP.Eval_defint),y.std_symbol(g.DEGREE,uP.Eval_degree),y.std_symbol(g.DENOMINATOR,cP.Eval_denominator),y.std_symbol(g.DET,bt.Eval_det),y.std_symbol(g.DERIVATIVE,fP.Eval_derivative),y.std_symbol(g.DIM,bt.Eval_dim),y.std_symbol(g.DIRAC,dP.Eval_dirac),y.std_symbol(g.DIVISORS,bt.Eval_divisors),y.std_symbol(g.DO,bt.Eval_do),y.std_symbol(g.DOT,QE.Eval_inner),y.std_symbol(g.DRAW),y.std_symbol(g.DSOLVE),y.std_symbol(g.ERF,mP.Eval_erf),y.std_symbol(g.ERFC,_P.Eval_erfc),y.std_symbol(g.EIGEN,xb.Eval_eigen),y.std_symbol(g.EIGENVAL,xb.Eval_eigenval),y.std_symbol(g.EIGENVEC,xb.Eval_eigenvec),y.std_symbol(g.EVAL,bt.Eval_Eval),y.std_symbol(g.EXP,bt.Eval_exp),y.std_symbol(g.EXPAND,bP.Eval_expand),y.std_symbol(g.EXPCOS,gP.Eval_expcos),y.std_symbol(g.EXPSIN,yP.Eval_expsin),y.std_symbol(g.FACTOR,vP.Eval_factor),y.std_symbol(g.FACTORIAL,bt.Eval_factorial),y.std_symbol(g.FACTORPOLY,bt.Eval_factorpoly),y.std_symbol(g.FILTER,qP.Eval_filter),y.std_symbol(g.FLOATF,EP.Eval_float),y.std_symbol(g.FLOOR,xP.Eval_floor),y.std_symbol(g.FOR,pP.Eval_for),y.std_symbol(g.FUNCTION,aP.Eval_function_reference),y.std_symbol(g.GAMMA,hP.Eval_gamma),y.std_symbol(g.GCD,AP.Eval_gcd),y.std_symbol(g.HERMITE,bt.Eval_hermite),y.std_symbol(g.HILBERT,bt.Eval_hilbert),y.std_symbol(g.IMAG,OP.Eval_imag),y.std_symbol(g.INDEX,bt.Eval_index),y.std_symbol(g.INNER,QE.Eval_inner),y.std_symbol(g.INTEGRAL,MP.Eval_integral),y.std_symbol(g.INV,bt.Eval_inv),y.std_symbol(g.INVG,bt.Eval_invg),y.std_symbol(g.ISINTEGER,bt.Eval_isinteger),y.std_symbol(g.ISPRIME,TP.Eval_isprime),y.std_symbol(g.LAGUERRE,NP.Eval_laguerre),y.std_symbol(g.LCM,IP.Eval_lcm),y.std_symbol(g.LEADING,SP.Eval_leading),y.std_symbol(g.LEGENDRE,RP.Eval_legendre),y.std_symbol(g.LOG,LP.Eval_log),y.std_symbol(g.LOOKUP,CP.Eval_lookup),y.std_symbol(g.MOD,PP.Eval_mod),y.std_symbol(g.MULTIPLY,DP.Eval_multiply),y.std_symbol(g.NOT,ho.Eval_not),y.std_symbol(g.NROOTS,kP.Eval_nroots),y.std_symbol(g.NUMBER,bt.Eval_number),y.std_symbol(g.NUMERATOR,$P.Eval_numerator),y.std_symbol(g.OPERATOR,bt.Eval_operator),y.std_symbol(g.OR,ho.Eval_or),y.std_symbol(g.OUTER,UP.Eval_outer),y.std_symbol(g.PATTERN,ud.Eval_pattern),y.std_symbol(g.PATTERNSINFO,ud.Eval_patternsinfo),y.std_symbol(g.POLAR,BP.Eval_polar),y.std_symbol(g.POWER,GP.Eval_power),y.std_symbol(g.PRIME,FP.Eval_prime),y.std_symbol(g.PRINT,ii.Eval_print),y.std_symbol(g.PRINT2DASCII,ii.Eval_print2dascii),y.std_symbol(g.PRINTFULL,ii.Eval_printcomputer),y.std_symbol(g.PRINTLATEX,ii.Eval_printlatex),y.std_symbol(g.PRINTLIST,ii.Eval_printlist),y.std_symbol(g.PRINTPLAIN,ii.Eval_printhuman),y.std_symbol(g.PRINT_LEAVE_E_ALONE),y.std_symbol(g.PRINT_LEAVE_X_ALONE),y.std_symbol(g.PRODUCT,jP.Eval_product),y.std_symbol(g.QUOTE,bt.Eval_quote),y.std_symbol(g.QUOTIENT,zP.Eval_quotient),y.std_symbol(g.RANK,bt.Eval_rank),y.std_symbol(g.RATIONALIZE,YP.Eval_rationalize),y.std_symbol(g.REAL,VP.Eval_real),y.std_symbol(g.YYRECT,ZP.Eval_rect),y.std_symbol(g.ROOTS,XP.Eval_roots),y.std_symbol(g.ROUND,HP.Eval_round),y.std_symbol(g.SETQ,bt.Eval_setq),y.std_symbol(g.SGN,WP.Eval_sgn),y.std_symbol(g.SILENTPATTERN,ud.Eval_silentpattern),y.std_symbol(g.SIMPLIFY,KP.Eval_simplify),y.std_symbol(g.SIN,eD.Eval_sin),y.std_symbol(g.SINH,tD.Eval_sinh),y.std_symbol(g.SHAPE,JP.Eval_shape),y.std_symbol(g.SQRT,bt.Eval_sqrt),y.std_symbol(g.STOP,bt.Eval_stop),y.std_symbol(g.SUBST,bt.Eval_subst),y.std_symbol(g.SUM,rD.Eval_sum),y.std_symbol(g.SYMBOLSINFO,y.Eval_symbolsinfo),y.std_symbol(g.TAN,nD.Eval_tan),y.std_symbol(g.TANH,oD.Eval_tanh),y.std_symbol(g.TAYLOR,iD.Eval_taylor),y.std_symbol(g.TEST,ho.Eval_test),y.std_symbol(g.TESTEQ,ho.Eval_testeq),y.std_symbol(g.TESTGE,ho.Eval_testge),y.std_symbol(g.TESTGT,ho.Eval_testgt),y.std_symbol(g.TESTLE,ho.Eval_testle),y.std_symbol(g.TESTLT,ho.Eval_testlt),y.std_symbol(g.TRANSPOSE,sD.Eval_transpose),y.std_symbol(g.UNIT,bt.Eval_unit),y.std_symbol(g.ZERO,aD.Eval_zero),y.std_symbol(g.NIL),y.std_symbol(g.AUTOEXPAND),y.std_symbol(g.BAKE),y.std_symbol(g.ASSUME_REAL_VARIABLES),y.std_symbol(g.LAST),y.std_symbol(g.LAST_PRINT),y.std_symbol(g.LAST_2DASCII_PRINT),y.std_symbol(g.LAST_FULL_PRINT),y.std_symbol(g.LAST_LATEX_PRINT),y.std_symbol(g.LAST_LIST_PRINT),y.std_symbol(g.LAST_PLAIN_PRINT),y.std_symbol(g.TRACE),y.std_symbol(g.FORCE_FIXED_PRINTOUT),y.std_symbol(g.MAX_FIXED_PRINTOUT_DIGITS),y.std_symbol(g.YYE),y.std_symbol(g.DRAWX),y.std_symbol(g.METAA),y.std_symbol(g.METAB),y.std_symbol(g.METAX),y.std_symbol(g.SECRETX),y.std_symbol(g.VERSION),y.std_symbol(g.PI),y.std_symbol(g.SYMBOL_A),y.std_symbol(g.SYMBOL_B),y.std_symbol(g.SYMBOL_C),y.std_symbol(g.SYMBOL_D),y.std_symbol(g.SYMBOL_I),y.std_symbol(g.SYMBOL_J),y.std_symbol(g.SYMBOL_N),y.std_symbol(g.SYMBOL_R),y.std_symbol(g.SYMBOL_S),y.std_symbol(g.SYMBOL_T),y.std_symbol(g.SYMBOL_X),y.std_symbol(g.SYMBOL_Y),y.std_symbol(g.SYMBOL_Z),y.std_symbol(g.SYMBOL_IDENTITY_MATRIX),y.std_symbol(g.SYMBOL_A_UNDERSCORE),y.std_symbol(g.SYMBOL_B_UNDERSCORE),y.std_symbol(g.SYMBOL_X_UNDERSCORE),y.std_symbol(g.C1),y.std_symbol(g.C2),y.std_symbol(g.C3),y.std_symbol(g.C4),y.std_symbol(g.C5),y.std_symbol(g.C6),uD();let e=g.defs.codeGen;g.defs.codeGen=!1;for(let t=0;t<WE.length;t++){let r=WE[t],[,n]=QP.scan(r);g.DEBUG&&(console.log(`... evaling ${r}`),console.log("top of stack:"),console.log(ii.print_list(n))),bt.Eval(n)}g.defs.codeGen=e}Ga.defn=JE;function uD(){let e=wP.makeList(y.symbol(g.POWER),XE.integer(-1),XE.rational(1,2));g.DEBUG&&console.log(ii.print_list(e)),g.Constants.imaginaryunit=e}});var hb=A(si=>{"use strict";Object.defineProperty(si,"__esModule",{value:!0});si.Eval_clear=si.do_clearall=si.Eval_clearall=void 0;var Ao=N(),cD=su(),fD=lo(),dD=Ee(),cd=U(),mD=cb();function _D(){return KE(),cd.symbol(Ao.NIL)}si.Eval_clearall=_D;function KE(){return Ao.defs.test_flag||fD.clear_term(),mD.do_clearPatterns(),cd.clear_symbols(),cD.defn(),Ao.defs.codeGen=!1}si.do_clearall=KE;function bD(e){let t;for(t=Ao.cdr(e);Ao.iscons(t);){let r=Ao.car(t);r.k!==Ao.SYM&&dD.stop("symbol error"),cd.clear_symbol(r),t=Ao.cdr(t)}return cd.symbol(Ao.NIL)}si.Eval_clear=bD});var Sb=A(dd=>{"use strict";Object.defineProperty(dd,"__esModule",{value:!0});dd.print2dascii=void 0;var v=N(),gD=lo(),vn=U(),lu=on(),za=F(),tr=H(),yD=eo(),ix=1e4,Ab=class{constructor(){this.c=0,this.x=0,this.y=0}},gt=[];for(let e=0;e<ix;e++)gt[e]=new Ab;var ut=0,Gn=0,Fn=0,ex=0;function Ob(e){let t="";return t+=e,t}function vD(e){return Ob(e)}function qD(e){ut=0,Gn=0,Fn=0,ED(e);let[t,r,n]=Array.from(Ya(0,ut));if(r>100){yD.printline(e);return}return LD()}dd.print2dascii=qD;function ED(e){if(v.car(e)===vn.symbol(v.SETQ)){yr(v.cadr(e)),Ib(" = "),yr(v.caddr(e));return}v.istensor(e)?PD(e):yr(e)}function tx(e){if(Gn>0)return!1;if(tr.isfraction(e))return!0;if(!v.ismultiply(e))return!1;if(tr.isfraction(v.cadr(e)))return!0;for(;v.iscons(e);){if(Ki(v.car(e)))return!0;e=v.cdr(e)}return!1}function yr(e){if(ex++,v.isadd(e))for(e=v.cdr(e),Fa(v.car(e))&&(me("-"),tx(v.car(e))&&me(" ")),ja(v.car(e)),e=v.cdr(e);v.iscons(e);)Fa(v.car(e))?(me(" "),me("-"),me(" ")):(me(" "),me("+"),me(" ")),ja(v.car(e)),e=v.cdr(e);else Fa(e)&&(me("-"),tx(e)&&me(" ")),ja(e);ex--}function xD(e){if(v.isadd(e))for(e=v.cdr(e),ja(v.car(e)),e=v.cdr(e);v.iscons(e);)Fa(v.car(e))?(me(" "),me("-"),me(" ")):(me(" "),me("+"),me(" ")),ja(v.car(e)),e=v.cdr(e);else ja(e)}function Fa(e){return!!(tr.isnegativenumber(e)||v.ismultiply(e)&&tr.isnegativenumber(v.cadr(e)))}function ja(e){if(v.ismultiply(e)){let t=pD(e);t&&Gn===0?AD(e,t):hD(e,t)}else qn(e)}function Ki(e){return v.ispower(e)&&v.cadr(e)!==vn.symbol(v.E)&&Fa(v.caddr(e))}function pD(e){let t=0;for(e=v.cdr(e);v.iscons(e);){let r=v.car(e);Ki(r)&&t++,e=v.cdr(e)}return t}function hD(e,t){if(t===0)for(e=v.cdr(e),(tr.isplusone(v.car(e))||tr.isminusone(v.car(e)))&&(e=v.cdr(e)),qn(v.car(e)),e=v.cdr(e);v.iscons(e);)me(" "),qn(v.car(e)),e=v.cdr(e);else OD(e),me("/"),t>1||tr.isfraction(v.cadr(e))?(me("("),rx(e),me(")")):rx(e)}function AD(e,t){let r,n,o=0,i=0,s=0,u=0,c=0,d=v.Constants.one,_=v.Constants.one;for(v.isrational(v.cadr(e))&&(d=lu.absval(za.mp_numerator(v.cadr(e))),_=za.mp_denominator(v.cadr(e))),v.isdouble(v.cadr(e))&&(d=lu.absval(v.cadr(e))),u=tr.isplusone(d)?0:1,r=v.cdr(e),v.isNumericAtom(v.car(r))&&(r=v.cdr(r));v.iscons(r);)n=v.car(r),Ki(n)||u++,r=v.cdr(r);for(c=Fn,i=ut,o=0,tr.isplusone(d)||(Oo(d,0),o++),r=v.cdr(e),v.isNumericAtom(v.car(r))&&(r=v.cdr(r));v.iscons(r);)n=v.car(r),Ki(n)||(o>0&&me(" "),u===1?yr(n):qn(n),o++),r=v.cdr(r);for(o===0&&me("1"),s=ut,o=0,tr.isplusone(_)||(Oo(_,0),o++,t++),r=v.cdr(e),v.isrational(v.car(r))&&(r=v.cdr(r));v.iscons(r);)n=v.car(r),Ki(n)&&(o>0&&me(" "),Tb(n,t),o++),r=v.cdr(r);Nb(c,i,s)}function OD(e){let t=v.Constants.one;e=v.cdr(e),v.isrational(v.car(e))?(t=lu.absval(za.mp_numerator(v.car(e))),e=v.cdr(e)):v.isdouble(v.car(e))&&(t=lu.absval(v.car(e)),e=v.cdr(e));let r=0;for(tr.isplusone(t)||(Oo(t,0),r++);v.iscons(e);)Ki(v.car(e))||(r>0&&me(" "),qn(v.car(e)),r++),e=v.cdr(e);r===0&&me("1")}function rx(e){let t=0;if(e=v.cdr(e),tr.isfraction(v.car(e))){let r=za.mp_denominator(v.car(e));Oo(r,0),t++,e=v.cdr(e)}for(;v.iscons(e);)Ki(v.car(e))&&(t>0&&me(" "),Tb(v.car(e),0),t++),e=v.cdr(e)}function qn(e){if(v.istensor(e)){fd(e);return}if(v.isdouble(e)){Oo(e,0);return}if(v.isadd(e)||v.ismultiply(e)){ai(e);return}if(v.ispower(e)){TD(e);return}if(v.iscons(e)){ND(e);return}if(v.isNumericAtom(e)){Gn===0?MD(e):Oo(e,0);return}if(v.issymbol(e)){sx(e);return}v.isstr(e)&&RD(e)}function MD(e){let t=lu.absval(za.mp_numerator(e)),r=za.mp_denominator(e);if(tr.isplusone(r)){Oo(t,0);return}let n=Fn,o=ut;Oo(t,0);let i=ut;Oo(r,0),Nb(n,o,i)}function au(e){return v.iscons(e)&&!v.isadd(e)&&!v.ismultiply(e)&&!v.ispower(e)||v.issymbol(e)?!0:tr.isfraction(e)||tr.isnegativenumber(e)?!1:!!v.isNumericAtom(e)}function TD(e){let t=0,r=0,n=0;if(v.cadr(e)===vn.symbol(v.E)){Ib("exp("),yr(v.caddr(e)),me(")");return}if(Gn>0){tr.isminusone(v.caddr(e))?(me("1"),me("/"),au(v.cadr(e))?qn(v.cadr(e)):ai(v.cadr(e))):(au(v.cadr(e))?qn(v.cadr(e)):ai(v.cadr(e)),me("^"),au(v.caddr(e))?qn(v.caddr(e)):ai(v.caddr(e)));return}if(Fa(v.caddr(e))){n=Fn,t=ut,me("1"),r=ut,Tb(e,1),Nb(n,t,r);return}t=ut,au(v.cadr(e))?qn(v.cadr(e)):ai(v.cadr(e)),r=ut,Gn++,yr(v.caddr(e)),Gn--,ax(t,r)}function Tb(e,t){let r=0,n=0;if(tr.isminusone(v.caddr(e))){t===1?yr(v.cadr(e)):qn(v.cadr(e));return}r=ut,au(v.cadr(e))?qn(v.cadr(e)):ai(v.cadr(e)),n=ut,Gn++,xD(v.caddr(e)),Gn--,ax(r,n)}function ND(e){if(v.car(e)===vn.symbol(v.INDEX)&&v.issymbol(v.cadr(e))){ID(e);return}if(v.isfactorial(e)){SD(e);return}if(v.car(e)===vn.symbol(v.DERIVATIVE)?me("d"):sx(v.car(e)),me("("),e=v.cdr(e),v.iscons(e))for(yr(v.car(e)),e=v.cdr(e);v.iscons(e);)me(","),yr(v.car(e)),e=v.cdr(e);me(")")}function ID(e){if(e=v.cdr(e),v.caar(e)===vn.symbol(v.ADD)||v.caar(e)===vn.symbol(v.MULTIPLY)||v.caar(e)===vn.symbol(v.POWER)||v.caar(e)===vn.symbol(v.FACTORIAL)?ai(v.car(e)):yr(v.car(e)),me("["),e=v.cdr(e),v.iscons(e))for(yr(v.car(e)),e=v.cdr(e);v.iscons(e);)me(","),yr(v.car(e)),e=v.cdr(e);me("]")}function SD(e){e=v.cadr(e),tr.isfraction(e)||v.isadd(e)||v.ismultiply(e)||v.ispower(e)||v.isfactorial(e)?ai(e):yr(e),me("!")}function ai(e){me("("),yr(e),me(")")}function sx(e){if(e===vn.symbol(v.E)){Ib("exp(1)");return}let t=vn.get_printname(e);for(let r=0;r<t.length;r++)me(t[r])}function RD(e){let t=e.str;me('"');for(let r=0;r<t.length;r++)me(t[r]);me('"')}function Nb(e,t,r){let n=0,o=0,[i,s,u]=Array.from(Ya(t,r)),[c,d,_]=Array.from(Ya(r,ut));d>s?n=(d-s)/2:n=0,n++,o=-(u+i-1)-1,uu(t,r,n,o),d>s?n=-s:n=-s+(s-d)/2,n++,o=-_+1,uu(r,ut,n,o);let T=0;d>s?T=d:T=s,T+=2,Fn=e;for(let k=0;k<T;k++)me("-")}function ax(e,t){let r=0,n=0,o=0,i=0,s=0,u=0,c=0;[n,o,i]=Array.from(Ya(e,t)),[s,u,c]=Array.from(Ya(t,ut)),r=-c-s+1,r+=i-1,uu(t,ut,0,r)}function uu(e,t,r,n){for(let o=e;o<t;o++)gt[o].x+=r,gt[o].y+=n}function Ya(e,t){let r=gt[e].x,n=gt[e].x,o=gt[e].y,i=gt[e].y;for(let d=e+1;d<t;d++)gt[d].x<r&&(r=gt[d].x),gt[d].x>n&&(n=gt[d].x),gt[d].y<o&&(o=gt[d].y),gt[d].y>i&&(i=gt[d].y);let s=i-o+1,u=n-r+1;return[s,u,o]}function me(e){if(ut!==ix)return gt[ut]==null&&v.breakpoint,gt[ut].c=e,gt[ut].x=Fn,gt[ut].y=0,ut++,Fn++}function Ib(e){for(let t=0;t<e.length;t++)me(e[t])}function Oo(e,t){let r="";switch(e.k){case v.NUM:r=e.q.a.toString(),r[0]==="-"&&t===0&&(r=r.substring(1));for(let n=0;n<r.length;n++)me(r[n]);if(r=e.q.b.toString(),r==="1")break;me("/");for(let n=0;n<r.length;n++)me(r[n]);break;case v.DOUBLE:r=gD.doubleToReasonableString(e.d),r[0]==="-"&&t===0&&(r=r.substring(1));for(let n=0;n<r.length;n++)me(r[n]);break}}function wD(e,t){return e.y<t.y?-1:e.y>t.y?1:e.x<t.x?-1:e.x>t.x?1:0}function LD(){let e="",t=gt.slice(0,ut);t.sort(wD),gt=[].concat(t).concat(gt.slice(ut));let r=0,{y:n}=gt[0];for(let o=0;o<ut;o++){for(;gt[o].y>n;)e+=vD(`
`),r=0,n++;for(;gt[o].x>r;)e+=Ob(" "),r++;e+=Ob(gt[o].c),r++}return e}var CD=100,Mb=class{constructor(){this.x=0,this.y=0,this.h=0,this.w=0,this.index=0,this.count=0}},Tt=[];for(let e=0;e<1e4;e++)Tt[e]=new Mb;var nx=3,ox=1;function PD(e){let t=0,r=0,n=0;if(e.tensor.ndim>2){fd(e);return}let o=e.tensor.dim[0];e.tensor.ndim===2?t=e.tensor.dim[1]:t=1;let i=o*t;if(i>CD){fd(e);return}let s=Fn;for(let T=0;T<i;T++)Tt[T].index=ut,Tt[T].x=Fn,yr(e.tensor.elem[T]),Tt[T].count=ut-Tt[T].index,[Tt[T].h,Tt[T].w,Tt[T].y]=Array.from(Ya(Tt[T].index,ut));let u=0,c=0;for(let T=0;T<i;T++)Tt[T].h>u&&(u=Tt[T].h),Tt[T].w>c&&(c=Tt[T].w);let d=o*u+(o-1)*ox,_=t*c+(t-1)*nx,R=-(d/2);for(let T=0;T<o;T++)for(let k=0;k<t;k++){let V=T*t+k;r=s-Tt[V].x,n=R-Tt[V].y,uu(Tt[V].index,Tt[V].index+Tt[V].count,r,n),r=0,k>0&&(r=k*(c+nx)),n=0,T>0&&(n=T*(u+ox)),r+=(c-Tt[V].w)/2,n+=(u-Tt[V].h)/2,uu(Tt[V].index,Tt[V].index+Tt[V].count,r,n)}Fn=s+_}function fd(e){lx(e,0,0)}function lx(e,t,r){me("(");for(let n=0;n<e.tensor.dim[t];n++)t+1===e.tensor.ndim?(yr(e.tensor.elem[r]),r=r+1):r=lx(e,t+1,r),n+1<e.tensor.dim[t]&&me(",");return me(")"),r}});var Ee=A(rr=>{"use strict";Object.defineProperty(rr,"__esModule",{value:!0});rr.computeResultsAndJavaScriptFromAlgebra=rr.computeDependenciesFromAlgebra=rr.check_esc_flag=rr.top_level_eval=rr.check_stack=rr.run=rr.findDependenciesInScript=rr.stop=void 0;var DD=t_(),cx=hb(),kD=G(),cu=H(),ux=eo(),$D=Sb(),fx=Yo(),UD=Zo(),md=Yr(),p=N(),_d=su(),yt=U();function fu(e){p.defs.errorMessage+="Stop: ",p.defs.errorMessage+=e;let t=p.defs.errorMessage;throw p.defs.errorMessage="",new Error(t)}rr.stop=fu;function wb(e,t=!1){p.DEBUG&&console.log(`stringToBeParsed: ${e}`);let r=new Date().getTime(),n=!0;p.defs.codeGen=!0,p.defs.symbolsDependencies={},p.defs.symbolsHavingReassignments=[],p.defs.symbolsInExpressionsWithoutAssignments=[],p.defs.patternHasBeenFound=!1;let o=0,i="",s="",u=0,c={affectsVariables:[],affectedBy:[]},d=e;for(;;){try{p.defs.errorMessage="",Va(),p.DEBUG&&console.log("findDependenciesInScript: scanning"),[u]=fx.scan(e.substring(o)),p.DEBUG&&console.log("scanned"),Va()}catch(z){p.PRINTOUTRESULT&&console.log(z),p.defs.errorMessage=z+"",p.reset_after_error();break}if(u===0)break;o+=u}let _="";p.DEBUG&&console.log("all local dependencies ----------------"),_+="All local dependencies: ";for(let z in p.defs.symbolsDependencies){let Ae=p.defs.symbolsDependencies[z];p.DEBUG&&console.log(`variable ${z} depends on: `),c.affectsVariables.push(z),_+=" variable "+z+" depends on: ";for(let et of Array.from(Ae))p.DEBUG&&console.log(`    ${et}`),et[0]!=="'"&&c.affectedBy.push(et),_+=et+", ";_+="; "}_+=". ",p.DEBUG&&console.log("Symbols with reassignments ----------------"),_+="Symbols with reassignments: ";for(let z of Array.from(p.defs.symbolsHavingReassignments))c.affectedBy.indexOf(z)===-1&&(c.affectedBy.push(z),_+=z+", ");_+=". ",p.DEBUG&&console.log("Symbols in expressions without assignments ----------------"),_+="Symbols in expressions without assignments: ";for(let z of Array.from(p.defs.symbolsInExpressionsWithoutAssignments))c.affectedBy.indexOf(z)===-1&&(c.affectedBy.push(z),_+=z+", ");_+=". ",c.affectedBy.push("PATTERN_DEPENDENCY"),p.defs.patternHasBeenFound&&(c.affectsVariables.push("PATTERN_DEPENDENCY"),_+=" - PATTERN_DEPENDENCY inserted - "),p.DEBUG&&console.log("All dependencies recursively ----------------"),_+="All dependencies recursively: ";let R=["",""],T="",k="";if(p.defs.errorMessage===""&&!t){try{i="",s="",R=mx(e,!0),i="",s=""}catch(z){let Ae=z;p.PRINTOUTRESULT&&console.log(Ae),p.defs.errorMessage=Ae.toString(),_d.init()}if(p.defs.errorMessage==="")for(let z in p.defs.symbolsDependencies){p.defs.codeGen=!0,p.DEBUG&&console.log("  variable "+z+" is: "+yt.get_binding(yt.usr_symbol(z)).toString()),p.defs.codeGen=!1,p.DEBUG&&console.log(`  variable ${z} depends on: `),_+=" variable "+z+" depends on: ";var V=[];let Ae=[],et=[];dx(z,V,[],Ae,[],et);for(let Oe of Array.from(Ae))p.DEBUG&&console.log(`    --> cycle through ${Oe}`);for(let Oe of Array.from(V))p.DEBUG&&console.log(`    ${Oe}`),_+=Oe+", ";_+="; ";for(let Oe of Array.from(et))_+=" "+Oe+", ";p.DEBUG&&console.log(`  code generation:${z} is: ${yt.get_binding(yt.usr_symbol(z))}`);let Ve=yt.get_binding(yt.usr_symbol(z)),De=[],it=[];for(let Oe of Array.from(V))if(Oe[0]==="'"){let st=Oe.substring(1),or=yt.usr_symbol(st),Bt=yt.usr_symbol("AVOID_BINDING_TO_EXTERNAL_SCOPE_VALUE"+st);De.push(or),it.push(Bt),Ve=md.subst(Ve,or,Bt),p.DEBUG&&console.log(`after substitution: ${Ve}`)}try{Ve=UD.simplifyForCodeGeneration(Ve)}catch(Oe){p.PRINTOUTRESULT&&console.log(Oe),p.defs.errorMessage=Oe+"",_d.init()}for(let Oe=0;Oe<De.length;Oe++)Ve=md.subst(Ve,it[Oe],De[Oe]);if(yt.clearRenamedVariablesToAvoidBindingToExternalScope(),p.defs.errorMessage===""){let Oe=Ve,st=[];yt.collectUserSymbols(Oe,st),i="",s="",p.defs.codeGen=!0;let or=Oe.toString();p.defs.codeGen=!1;let Bt=p.defs.printMode;p.defs.printMode=p.PRINTMODE_LATEX;let vr=Oe.toString();if(p.defs.printMode=Bt,Ae.indexOf(z)!==-1)T+="// "+z+" is part of a cyclic dependency, no code generated.",k+="#"+z+" is part of a cyclic dependency, no code generated.";else if(st=st.filter(Nt=>p.predefinedSymbolsInGlobalScope_doNotTrackInDependencies.indexOf(Nt+"")===-1),st=st.filter(Nt=>V.indexOf(Nt+"")!==-1||V.indexOf("'"+Nt)!==-1),st.length!==0){let Nt="(";for(let ci of Array.from(st))ci.printname!==z&&(Nt+=ci.printname+", ");Nt=Nt.replace(/, $/gm,""),Nt+=")",T+=z+" = function "+Nt+" { return ( "+or+" ); }",k+=z+Nt+" = "+vr}else T+=z+" = "+or+";",k+=z+" = "+vr;T+=`
`,k+=`
`,p.DEBUG&&console.log(`    ${T}`)}}}return T=T.replace(/\n$/gm,""),k=k.replace(/\n$/gm,""),p.defs.symbolsDependencies={},p.defs.symbolsHavingReassignments=[],p.defs.patternHasBeenFound=!1,p.defs.symbolsInExpressionsWithoutAssignments=[],p.DEBUG&&console.log(`testable string: ${_}`),bd&&console.log(`findDependenciesInScript time for: ${d} : ${new Date().getTime()-r}ms`),[_,R[0],T,k,R[1],p.defs.errorMessage,c]}rr.findDependenciesInScript=wb;function dx(e,t,r,n,o,i){if(r.push(e),p.defs.symbolsDependencies[o[o.length-1]]!=null&&p.defs.symbolsDependencies[o[o.length-1]].indexOf("'"+e)!==-1){p.DEBUG&&console.log("can't keep following the chain of "+e+" because it's actually a variable bound to a parameter"),t.indexOf("'"+e)===-1&&t.indexOf(e)===-1&&t.push(e);return}if(o.push(e),p.defs.symbolsDependencies[e]==null)t.indexOf(e)===-1&&t.push(e);else for(let s of Array.from(p.defs.symbolsDependencies[e]))if(o.indexOf(s)!==-1){p.DEBUG&&console.log("  found cycle:");let u="";for(let c of Array.from(o))n.indexOf(c)===-1&&n.push(c),p.DEBUG&&console.log(c+" --> "),u+=c+" --> ";p.DEBUG&&console.log(` ... then ${s} again`),u+=" ... then "+s+" again",i.push(u),n.indexOf(s)===-1&&n.push(s)}else dx(s,t,r,n,o,i),o.pop()}var BD="\\rlap{\\large\\color{red}\\bigtriangleup}{\\ \\ \\tiny\\color{red}!}";function Rb(e){return e=e.replace(/\n/g,""),e=e.replace(/_/g,"} \\_ \\text{"),e=e.replace(new RegExp(String.fromCharCode(p.transpose_unicode),"g"),"}{}^{T}\\text{"),e=e.replace(new RegExp(String.fromCharCode(p.dotprod_unicode),"g"),"}\\cdot \\text{"),e=e.replace("Stop:","}  \\quad \\text{Stop:"),e=e.replace("->","}  \\rightarrow \\text{"),e=e.replace("?","}\\enspace "+BD+" \\enspace  \\text{"),e="$$\\text{"+e.replace(/\n/g,"")+"}$$",e}function Lb(e){return e=e.replace(new RegExp(String.fromCharCode(8901),"g"),String.fromCharCode(p.dotprod_unicode)),e=e.replace(new RegExp(String.fromCharCode(8226),"g"),String.fromCharCode(p.dotprod_unicode)),e=e.replace(new RegExp(String.fromCharCode(12539),"g"),String.fromCharCode(p.dotprod_unicode)),e=e.replace(new RegExp(String.fromCharCode(55296),"g"),String.fromCharCode(p.dotprod_unicode)),e=e.replace(new RegExp(String.fromCharCode(65381),"g"),String.fromCharCode(p.dotprod_unicode)),e}var bd=!1;function mx(e,t=!1){let r,n,o,i=new Date().getTime();e=Lb(e),p.defs.inited||(p.defs.inited=!0,_d.init());let s=0,u=0,c="",d="",_,R;for(;;){try{p.defs.errorMessage="",Va(),[s,r]=fx.scan(e.substring(u)),Va()}catch(k){p.PRINTOUTRESULT&&console.log(k),c+=k.message,t&&(d+=Rb(k.message)),p.reset_after_error();break}if(s===0)break;u+=s;let T=!1;try{p.defs.stringsEmittedByUserPrintouts="",n=_x(r),Va(),p.isstr(n)&&(p.DEBUG&&console.log(n.str),p.DEBUG&&console.log(`
`)),n===yt.symbol(p.NIL)?(R=p.defs.stringsEmittedByUserPrintouts,t&&(_="$$"+p.defs.stringsEmittedByUserPrintouts+"$$")):(R=ux.print_expr(n),R+=`
`,t&&(_="$$"+ux.collectLatexStringFromReturnValue(n)+"$$",p.DEBUG&&console.log(`collectedLatexResult: ${_}`))),c+=R,t&&(d+=_),p.PRINTOUTRESULT&&(p.DEBUG&&console.log("printline"),p.DEBUG&&console.log(R)),p.PRINTOUTRESULT&&(p.DEBUG&&console.log("display:"),$D.print2dascii(n)),t&&(d+=`
`)}catch(k){T=!0,R=k.message,t&&(_=Rb(k.message)),p.PRINTOUTRESULT&&console.log(R),c+=R,R!==""&&(c+=`
`),t&&(d+=_,d+=`
`),_d.init()}}if(c[c.length-1]===`
`&&(c=c.substring(0,c.length-1)),t&&d[d.length-1]===`
`&&(d=d.substring(0,d.length-1)),t?(p.DEBUG&&console.log(`allReturnedLatexStrings: ${d}`),o=[c,d]):o=c,bd){let T="run time on: "+e+" : "+(new Date().getTime()-i)+"ms";console.log(T)}return c="",d="",o}rr.run=mx;function Va(){p.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated.length!==0&&(p.breakpoint,fu("symbols evaluation still ongoing?")),p.defs.evaluatingAsFloats&&(p.breakpoint,fu("numeric evaluation still ongoing?")),p.defs.evaluatingPolar&&(p.breakpoint,fu("evaluation of polar still ongoing?"))}rr.check_stack=Va;function _x(e){p.DEBUG&&console.log("#### top level eval"),p.defs.trigmode=0;let t=yt.symbol(p.AUTOEXPAND);p.defs.expanding=!cu.isZeroAtomOrTensor(yt.get_binding(t));let r=e,n=kD.Eval(e);return n===yt.symbol(p.NIL)||(yt.set_binding(yt.symbol(p.LAST),n),cu.isZeroAtomOrTensor(yt.get_binding(yt.symbol(p.BAKE)))||(n=DD.bake(n)),(r===yt.symbol(p.SYMBOL_I)||r===yt.symbol(p.SYMBOL_J))&&cu.isimaginaryunit(n))?n:cu.isimaginaryunit(yt.get_binding(yt.symbol(p.SYMBOL_J)))?md.subst(n,p.Constants.imaginaryunit,yt.symbol(p.SYMBOL_J)):cu.isimaginaryunit(yt.get_binding(yt.symbol(p.SYMBOL_I)))?md.subst(n,p.Constants.imaginaryunit,yt.symbol(p.SYMBOL_I)):n}rr.top_level_eval=_x;function GD(){p.defs.esc_flag&&fu("esc key")}rr.check_esc_flag=GD;function FD(e){let t,r;p.DEBUG&&console.log("computeDependenciesFromAlgebra!!!");let n=e,o=!0;if(p.defs.called_from_Algebra_block=!0,e=Lb(e),!o){p.defs.userSimplificationsInListForm=[];let i="";for(let s of Array.from(p.defs.userSimplificationsInListForm))i+="silentpattern("+p.car(s)+","+p.car(p.cdr(s))+","+p.car(p.cdr(p.cdr(s)))+`)
`;cx.do_clearall(),e=i+e,p.DEBUG&&console.log("codeFromAlgebraBlock including patterns: "+e)}if(p.DEBUG){console.log("computeDependenciesFromAlgebra: patterns in the list --------------- ");for(let i of Array.from(p.defs.userSimplificationsInListForm))console.log(p.car(i)+","+p.cdr(i)+")");console.log("...end of list --------------- ")}return p.defs.called_from_Algebra_block=!1,wb(e,!0)[6]}rr.computeDependenciesFromAlgebra=FD;function jD(e){let t,r,n,o,i,s,u,c,d,_=e,R=!0;p.defs.called_from_Algebra_block=!0;let T=new Date().getTime();bd&&console.log(" --------- computeResultsAndJavaScriptFromAlgebra input: "+e+" at: "+new Date),e=Lb(e);let k=e;if(p.DEBUG){console.log("computeResultsAndJavaScriptFromAlgebra: patterns in the list --------------- ");for(i of Array.from(p.defs.userSimplificationsInListForm))console.log(p.car(i)+","+p.cdr(i)+")");console.log("...end of list --------------- ")}if(!R){p.defs.userSimplificationsInListForm=[];let V="";for(i of Array.from(p.defs.userSimplificationsInListForm))V+="silentpattern("+p.car(i)+","+p.car(p.cdr(i))+","+p.car(p.cdr(p.cdr(i)))+`)
`;cx.do_clearall(),e=V+e,p.DEBUG&&console.log("codeFromAlgebraBlock including patterns: "+e)}return[d,c,n,u,s,p.defs.errorMessage,o]=wb(e),p.defs.called_from_Algebra_block=!1,(u!==""||p.defs.errorMessage!=="")&&(c+=`
`+u,p.defs.errorMessage!==""&&(c+=`
`+p.defs.errorMessage),c=c.replace(/\n/g,`

`),s+=`
$$`+u+"$$",p.defs.errorMessage!==""&&(s+=Rb(p.defs.errorMessage)),s=s.replace(/\n/g,`

`)),s=s.replace(/\n*/,""),s=s.replace(/\$\$\$\$\n*/g,""),n=n.replace(/Math\./g,""),n=n.replace(/\n/g,`

`),bd&&console.log("computeResultsAndJavaScriptFromAlgebra time (total time from notebook and back) for: "+k+" : "+(new Date().getTime()-T)+"ms"),{code:n,result:s,latexResult:s,dependencyInfo:o}}rr.computeResultsAndJavaScriptFromAlgebra=jD});var qt=A(vt=>{"use strict";Object.defineProperty(vt,"__esModule",{value:!0});vt.copy_tensor=vt.power_tensor=vt.compare_tensors=vt.d_tensor_scalar=vt.d_scalar_tensor=vt.d_tensor_tensor=vt.is_square_matrix=vt.check_tensor_dimensions=vt.scalar_times_tensor=vt.tensor_times_scalar=vt.tensor_plus_tensor=vt.Eval_tensor=void 0;var zn=It(),dr=N(),Cb=Ee(),du=U(),bx=Ne(),zD=ue(),YD=F(),Db=Ri(),VD=G(),ZD=Go(),XD=Nl(),HD=H(),Pb=K(),gx=Z();function QD(e){jn(e);let{nelem:t,ndim:r}=e.tensor,n=zn.alloc_tensor(t);return n.tensor.ndim=r,n.tensor.dim=Array.from(e.tensor.dim),jn(n),n.tensor.elem=e.tensor.elem.map(VD.Eval),jn(e),jn(n),ak(n)}vt.Eval_tensor=QD;function WD(e,t){if(e.tensor.ndim!==t.tensor.ndim||e.tensor.dim.some((c,d)=>c!==t.tensor.dim[d]))return du.symbol(dr.NIL);let{nelem:r,ndim:n}=e.tensor,o=zn.alloc_tensor(r);o.tensor.ndim=n,o.tensor.dim=Array.from(e.tensor.dim);let i=e.tensor.elem,s=t.tensor.elem,u=o.tensor.elem;for(let c=0;c<r;c++)u[c]=zD.add(i[c],s[c]);return o}vt.tensor_plus_tensor=WD;function JD(e,t){let{ndim:r,nelem:n}=e.tensor,o=zn.alloc_tensor(n);return o.tensor.ndim=r,o.tensor.dim=Array.from(e.tensor.dim),o.tensor.elem=e.tensor.elem.map(i=>gx.multiply(i,t)),o}vt.tensor_times_scalar=JD;function KD(e,t){let{ndim:r,nelem:n}=t.tensor,o=zn.alloc_tensor(n);return o.tensor.ndim=r,o.tensor.dim=Array.from(t.tensor.dim),o.tensor.elem=t.tensor.elem.map(i=>gx.multiply(e,i)),o}vt.scalar_times_tensor=KD;function jn(e){if(e.tensor.nelem!==e.tensor.elem.length)return console.log("something wrong in tensor dimensions"),dr.breakpoint}vt.check_tensor_dimensions=jn;function ek(e){return dr.istensor(e)&&e.tensor.ndim===2&&e.tensor.dim[0]===e.tensor.dim[1]}vt.is_square_matrix=ek;function tk(e,t){let{ndim:r,nelem:n}=e.tensor;if(r+1>=dr.MAXDIM)return Pb.makeList(du.symbol(dr.DERIVATIVE),e,t);let o=zn.alloc_tensor(n*t.tensor.nelem);o.tensor.ndim=r+1,o.tensor.dim=[...e.tensor.dim,t.tensor.dim[0]];let i=e.tensor.elem,s=t.tensor.elem,u=o.tensor.elem;for(let c=0;c<n;c++)for(let d=0;d<t.tensor.nelem;d++)u[c*t.tensor.nelem+d]=Db.derivative(i[c],s[d]);return o}vt.d_tensor_tensor=tk;function rk(e,t){let r=zn.alloc_tensor(t.tensor.nelem);return r.tensor.ndim=1,r.tensor.dim[0]=t.tensor.dim[0],r.tensor.elem=t.tensor.elem.map(n=>Db.derivative(e,n)),r}vt.d_scalar_tensor=rk;function nk(e,t){let r=zn.alloc_tensor(e.tensor.nelem);return r.tensor.ndim=e.tensor.ndim,r.tensor.dim=[...e.tensor.dim],r.tensor.elem=e.tensor.elem.map(n=>Db.derivative(n,t)),r}vt.d_tensor_scalar=nk;function ok(e,t){if(e.tensor.ndim<t.tensor.ndim)return-1;if(e.tensor.ndim>t.tensor.ndim)return 1;for(let r=0;r<e.tensor.ndim;r++){if(e.tensor.dim[r]<t.tensor.dim[r])return-1;if(e.tensor.dim[r]>t.tensor.dim[r])return 1}for(let r=0;r<e.tensor.nelem;r++)if(!bx.equal(e.tensor.elem[r],t.tensor.elem[r]))return bx.lessp(e.tensor.elem[r],t.tensor.elem[r])?-1:1;return 0}vt.compare_tensors=ok;function ik(e,t){let r=e.tensor.ndim-1;if(e.tensor.dim[0]!==e.tensor.dim[r])return Pb.makeList(du.symbol(dr.POWER),e,t);let n=YD.nativeInt(t);if(isNaN(n))return Pb.makeList(du.symbol(dr.POWER),e,t);if(n===0){e.tensor.ndim!==2&&Cb.stop("power(tensor,0) with tensor rank not equal to 2"),n=e.tensor.dim[0],e=zn.alloc_tensor(n*n),e.tensor.ndim=2,e.tensor.dim[0]=n,e.tensor.dim[1]=n;for(let s=0;s<n;s++)e.tensor.elem[n*s+s]=dr.Constants.one;return jn(e),e}let o=e;n<0&&(n=-n,o=XD.inv(o));let i=o;for(let s=1;s<n&&(i=ZD.inner(i,o),!HD.isZeroAtomOrTensor(i));s++);return i}vt.power_tensor=ik;function sk(e){let t=zn.alloc_tensor(e.tensor.nelem);return t.tensor.ndim=e.tensor.ndim,t.tensor.dim=[...e.tensor.dim],t.tensor.elem=[...e.tensor.elem],jn(e),jn(t),t}vt.copy_tensor=sk;function ak(e){if(!dr.istensor(e))return e;let t=e.tensor.elem[0];if(e.tensor.elem.some(i=>!lk(t,i))&&Cb.stop("Cannot promote tensor due to inconsistent tensor components."),!dr.istensor(t))return e;let r=e.tensor.ndim+t.tensor.ndim;r>dr.MAXDIM&&Cb.stop("tensor rank > "+dr.MAXDIM);let n=e.tensor.nelem*t.tensor.nelem,o=zn.alloc_tensor(n);return o.tensor.ndim=r,o.tensor.dim=[...e.tensor.dim,...t.tensor.dim],o.tensor.elem=[].concat(...e.tensor.elem.map(i=>i.tensor.elem)),jn(t),jn(o),o}function lk(e,t){if(!dr.istensor(e)&&!dr.istensor(t))return!0;if(!dr.istensor(e)||!dr.istensor(t)||e.tensor.ndim!==t.tensor.ndim)return!1;for(let r=0;r<e.tensor.ndim;r++)if(e.tensor.dim[r]!==t.tensor.dim[r])return!1;return!0}});var It=A(gd=>{"use strict";Object.defineProperty(gd,"__esModule",{value:!0});gd.alloc_tensor=void 0;var uk=qt(),yx=N();function ck(e){let t=new yx.Tensor;for(let r=0;r<e;r++)t.tensor.elem[r]=yx.Constants.zero;return uk.check_tensor_dimensions(t),t}gd.alloc_tensor=ck});var Ne=A(wt=>{"use strict";Object.defineProperty(wt,"__esModule",{value:!0});wt.sort=wt.square=wt.exponential=wt.yyexpand=wt.length=wt.cmp_expr=wt.sign=wt.lessp=wt.equal=wt.zero_matrix=void 0;var fk=It(),lt=N(),vx=lo(),mu=U(),qx=F(),dk=G(),Ex=Et(),mk=qt();function _k(e,t){let r=fk.alloc_tensor(e*t);return r.ndim=2,r.dim[0]=e,r.dim[1]=t,r}wt.zero_matrix=_k;function bk(e,t){return _u(e,t)===0}wt.equal=bk;function gk(e,t){return _u(e,t)<0}wt.lessp=gk;function yd(e){return e<0?-1:e>0?1:0}wt.sign=yd;function _u(e,t){let r=0;if(e===t)return 0;if(e===mu.symbol(lt.NIL))return-1;if(t===mu.symbol(lt.NIL))return 1;if(lt.isNumericAtom(e)&&lt.isNumericAtom(t))return yd(qx.compare_numbers(e,t));if(lt.isNumericAtom(e))return-1;if(lt.isNumericAtom(t))return 1;if(lt.isstr(e)&&lt.isstr(t))return yd(vx.strcmp(e.str,t.str));if(lt.isstr(e))return-1;if(lt.isstr(t))return 1;if(lt.issymbol(e)&&lt.issymbol(t))return yd(vx.strcmp(mu.get_printname(e),mu.get_printname(t)));if(lt.issymbol(e))return-1;if(lt.issymbol(t))return 1;if(lt.istensor(e)&&lt.istensor(t))return mk.compare_tensors(e,t);if(lt.istensor(e))return-1;if(lt.istensor(t))return 1;for(;lt.iscons(e)&&lt.iscons(t);){if(r=_u(lt.car(e),lt.car(t)),r!==0)return r;e=lt.cdr(e),t=lt.cdr(t)}return lt.iscons(t)?-1:lt.iscons(e)?1:0}wt.cmp_expr=_u;function yk(e){return lt.iscons(e)?[...e].length:0}wt.length=yk;function vk(e){return lt.doexpand(dk.Eval,e)}wt.yyexpand=vk;function qk(e){return Ex.power(mu.symbol(lt.E),e)}wt.exponential=qk;function Ek(e){return Ex.power(e,qx.integer(2))}wt.square=Ek;function xk(e){e.sort(_u)}wt.sort=xk});var Ac=A(li=>{"use strict";Object.defineProperty(li,"__esModule",{value:!0});li.countsize=li.countOccurrencesOfSymbol=li.count=void 0;var pk=Ne(),vd=N(),kb=e=>e.reduce((t,r)=>t+r,0);function qd(e){let t;if(vd.iscons(e)){let r=[...e];t=kb(r.map(qd))+r.length}else t=1;return t}li.count=qd;function xx(e,t){let r=0;return vd.iscons(t)?r=kb([...t].map(n=>xx(e,n))):pk.equal(e,t)&&(r=1),r}li.countOccurrencesOfSymbol=xx;function hk(e){let t=0;if(vd.istensor(e))for(let r=0;r<e.tensor.nelem;r++)t+=qd(e.tensor.elem[r]);else if(vd.iscons(e)){let r=[...e];t=kb(r.map(qd))+r.length}else t=1;return t}li.countsize=hk});var U=A(ot=>{"use strict";Object.defineProperty(ot,"__esModule",{value:!0});ot.clear_symbol=ot.clearRenamedVariablesToAvoidBindingToExternalScope=ot.iskeyword=ot.symbol=ot.collectUserSymbols=ot.clear_symbols=ot.reset_symbols=ot.get_binding=ot.set_binding=ot.get_printname=ot.usr_symbol=ot.std_symbol=ot.inChildScope=ot.Eval_symbolsinfo=void 0;var Ak=Ac(),tn=N(),Ed=Ee();function Ok(){let e=Mk();return e!==""?new tn.Str(e):px(tn.NIL)}ot.Eval_symbolsinfo=Ok;function Mk(){return[...jr.symbolinfo()].join(`
`)}var ui=class{constructor(t){this.parent=t,this.symbols=new Map,this.bindings=new Map}getOrCreate(t){let r=this.getExisting(t);if(r)return r;let n=new tn.Sym(t);return this.symbols.set(t,n),n}getExisting(t){var r;return((r=this.parent)===null||r===void 0?void 0:r.getExisting(t))||this.symbols.get(t)}mustGet(t){var r;return this.symbols.get(t)||((r=this.parent)===null||r===void 0?void 0:r.mustGet(t))||Ed.stop(`${t} not defined`)}has(t){return this.symbols.has(t.printname)}binding(t){var r;return this.bindings.get(t.printname)||((r=this.parent)===null||r===void 0?void 0:r.binding(t))||t}set(t,r){this.bindings.set(t.printname,r)}clear(){this.bindings.clear()}delete(t){var r;this.symbols.delete(t.printname),this.bindings.delete(t.printname),(r=this.parent)===null||r===void 0||r.delete(t)}*symbolinfo(){this.parent&&(yield*this.parent.symbolinfo());for(let[t,r]of this.symbols.entries()){let n=this.bindings.get(t)||r,o=(n+"").substring(0,4);yield`symbol: ${r} size: ${Ak.countsize(n)} value: ${o}...`}}clearRenamedVariablesToAvoidBindingToExternalScope(){var t;for(let r of this.symbols.keys())r.indexOf("AVOID_BINDING_TO_EXTERNAL_SCOPE_VALUE")!==-1&&this.symbols.delete(r);for(let r of this.bindings.keys())r.indexOf("AVOID_BINDING_TO_EXTERNAL_SCOPE_VALUE")!==-1&&this.bindings.delete(r);(t=this.parent)===null||t===void 0||t.clearRenamedVariablesToAvoidBindingToExternalScope()}},es=new ui,jr=new ui(es);function Tk(e){let t=jr;try{return jr=new ui(jr),e()}finally{jr=t}}ot.inChildScope=Tk;function Nk(e,t){let r=es.getOrCreate(e);r.latexPrint=e,r.keyword=t}ot.std_symbol=Nk;function Ik(e){return jr.getOrCreate(e)}ot.usr_symbol=Ik;function Sk(e){return e.k!==tn.SYM&&Ed.stop("symbol error"),e.printname}ot.get_printname=Sk;function Rk(e,t){e.k!==tn.SYM&&Ed.stop("symbol error"),jr.set(e,t)}ot.set_binding=Rk;function wk(e){return e.k!==tn.SYM&&Ed.stop("symbol error"),jr.binding(e)}ot.get_binding=wk;function Lk(e){return e.k!==tn.SYM?!1:/^[abcdjnrstxyz]_?$/.test(e.printname)||!es.has(e)}function Ck(){es=new ui,jr=new ui(es)}ot.reset_symbols=Ck;function Pk(){jr=new ui(es),es.clear()}ot.clear_symbols=Pk;function $b(e,t){if(t==null&&(t=[]),Lk(e)&&t.indexOf(e)===-1){t.push(e);return}if(tn.istensor(e)){for(let r=0;r<e.tensor.nelem;r++)$b(e.tensor.elem[r],t);return}for(;tn.iscons(e);)$b(tn.car(e),t),e=tn.cdr(e)}ot.collectUserSymbols=$b;function px(e){return jr.mustGet(e)}ot.symbol=px;function Dk(e){return tn.issymbol(e)&&e.keyword!=null}ot.iskeyword=Dk;function kk(){jr.clearRenamedVariablesToAvoidBindingToExternalScope()}ot.clearRenamedVariablesToAvoidBindingToExternalScope=kk;function $k(e){jr.delete(e)}ot.clear_symbol=$k});var eo=A(At=>{"use strict";Object.defineProperty(At,"__esModule",{value:!0});At.print_list=At.print_expr=At.printline=At.collectLatexStringFromReturnValue=At.print_str=At.Eval_printlist=At.Eval_printhuman=At.Eval_printlatex=At.Eval_printcomputer=At.Eval_print2dascii=At.Eval_print=void 0;var l=N(),ie=U(),ts=Ne(),Uk=on(),hd=F(),Bk=Mn(),Gk=G(),ht=H(),Ax=Z(),Fk=oo(),jk=Sb(),zk=Yo(),Yk="^";function Vk(e){return l.defs.stringsEmittedByUserPrintouts+=Xa(l.cdr(e),l.defs.printMode),ie.symbol(l.NIL)}At.Eval_print=Vk;function Zk(e){return l.defs.stringsEmittedByUserPrintouts+=Xa(l.cdr(e),l.PRINTMODE_2DASCII),ie.symbol(l.NIL)}At.Eval_print2dascii=Zk;function Xk(e){return l.defs.stringsEmittedByUserPrintouts+=Xa(l.cdr(e),l.PRINTMODE_COMPUTER),ie.symbol(l.NIL)}At.Eval_printcomputer=Xk;function Hk(e){return l.defs.stringsEmittedByUserPrintouts+=Xa(l.cdr(e),l.PRINTMODE_LATEX),ie.symbol(l.NIL)}At.Eval_printlatex=Hk;function Qk(e){let t=l.defs.test_flag;return l.defs.test_flag=!1,l.defs.stringsEmittedByUserPrintouts+=Xa(l.cdr(e),l.PRINTMODE_HUMAN),l.defs.test_flag=t,ie.symbol(l.NIL)}At.Eval_printhuman=Qk;function Wk(e){let t=Xa(l.cdr(e),l.PRINTMODE_LIST);return l.defs.stringsEmittedByUserPrintouts+=t,ie.symbol(l.NIL)}At.Eval_printlist=Wk;function Xa(e,t){let r="";for(;l.iscons(e);){let n=Gk.Eval(l.car(e)),o=l.defs.printMode;t===l.PRINTMODE_COMPUTER?(l.defs.printMode=l.PRINTMODE_COMPUTER,r=xd(n),bu(r,l.LAST_FULL_PRINT)):t===l.PRINTMODE_HUMAN?(l.defs.printMode=l.PRINTMODE_HUMAN,r=xd(n),bu(r,l.LAST_PLAIN_PRINT)):t===l.PRINTMODE_2DASCII?(l.defs.printMode=l.PRINTMODE_2DASCII,r=jk.print2dascii(n),bu(r,l.LAST_2DASCII_PRINT)):t===l.PRINTMODE_LATEX?(l.defs.printMode=l.PRINTMODE_LATEX,r=xd(n),bu(r,l.LAST_LATEX_PRINT)):t===l.PRINTMODE_LIST&&(l.defs.printMode=l.PRINTMODE_LIST,r=Za(n),bu(r,l.LAST_LIST_PRINT)),l.defs.printMode=o,e=l.cdr(e)}return l.DEBUG&&console.log(`emttedString from display: ${l.defs.stringsEmittedByUserPrintouts}`),r}function bu(e,t){let[,r]=zk.scan('"'+e+'"');ie.set_binding(ie.symbol(t),r)}function S(e){return l.DEBUG&&console.log(`emttedString from print_str: ${l.defs.stringsEmittedByUserPrintouts}`),e}At.print_str=S;function Jk(e){let t=l.defs.printMode;l.defs.printMode=l.PRINTMODE_LATEX;let r=l.defs.codeGen;l.defs.codeGen=!1;let n=C(e);return n=n.replace(/_/g,"\\_"),l.defs.printMode=t,l.defs.codeGen=r,l.DEBUG&&console.log(`emttedString from collectLatexStringFromReturnValue: ${l.defs.stringsEmittedByUserPrintouts}`),n}At.collectLatexStringFromReturnValue=Jk;function xd(e){let t="";return t+=C(e),t}At.printline=xd;function Ox(e){let t="";return ht.isfraction(e)||l.isadd(e)||l.ismultiply(e)||l.ispower(e)||ts.lessp(e,l.Constants.zero)?(t+="(",t+=C(e),t+=")"):t+=C(e),t}function hx(e){let t="";return ht.isfraction(e)||l.isadd(e)||l.ismultiply(e)||l.ispower(e)?(t+="(",t+=C(e),t+=")"):t+=C(e),t}function Kk(e,t){let r="",n=l.cadr(e),o=l.caddr(e);return ht.isminusone(o)?(r+=Ox(n),r):(t===1&&(r+="("),o=Ax.negate(o),r+=yu(n,o),t===1&&(r+=")"),r)}function e$(e){let t,r,n="",o=0,i=0,s=0,u=l.cdr(e),c=l.car(u);for(l.isrational(c)?(t=Uk.absval(hd.mp_numerator(c)),r=hd.mp_denominator(c),ht.isplusone(t)||i++,ht.isplusone(r)||s++,u=l.cdr(u)):(t=l.Constants.one,r=l.Constants.one);l.iscons(u);)c=l.car(u),pd(c)?s++:i++,u=l.cdr(u);if(l.defs.printMode===l.PRINTMODE_LATEX&&(n+=S("\\frac{")),i===0)n+="1";else for(o=0,u=l.cdr(e),l.isrational(l.car(u))&&(u=l.cdr(u)),ht.isplusone(t)||(n+=En(t),o=1);l.iscons(u);)c=l.car(u),pd(c)||(o&&(n+=Bb()),n+=En(c),o=1),u=l.cdr(u);for(l.defs.printMode===l.PRINTMODE_LATEX?n+=S("}{"):l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag?n+=S(" / "):n+=S("/"),s>1&&l.defs.printMode!==l.PRINTMODE_LATEX&&(n+="("),o=0,u=l.cdr(e),l.isrational(l.car(u))&&(u=l.cdr(u)),ht.isplusone(r)||(n+=En(r),o=1);l.iscons(u);)c=l.car(u),pd(c)&&(o&&(n+=Bb()),n+=Kk(c,s),o=1),u=l.cdr(u);return s>1&&l.defs.printMode!==l.PRINTMODE_LATEX&&(n+=")"),l.defs.printMode===l.PRINTMODE_LATEX&&(n+=S("}")),n}function C(e){let t="";if(l.isadd(e))for(e=l.cdr(e),gu(l.car(e))==="-"&&(t+=S("-")),t+=Ub(l.car(e)),e=l.cdr(e);l.iscons(e);)gu(l.car(e))==="+"?l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag?t+=S(" + "):t+=S("+"):l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag?t+=S(" - "):t+=S("-"),t+=Ub(l.car(e)),e=l.cdr(e);else gu(e)==="-"&&(t+=S("-")),t+=Ub(e);return t}At.print_expr=C;function gu(e){let t="";return l.ismultiply(e)&&l.isNumericAtom(l.cadr(e))&&ts.lessp(l.cadr(e),l.Constants.zero)||l.isNumericAtom(e)&&ts.lessp(e,l.Constants.zero)?t+="-":t+="+",t}function Ub(e){let t="";if(l.ismultiply(e)&&D$(e))return t+=e$(e),t;if(l.ismultiply(e)){let r,n;e=l.cdr(e),ht.isminusone(l.car(e))&&(e=l.cdr(e));let o=!1;l.isNumericAtom(l.car(e))&&(o=!0);let i=!1;for(l.defs.printMode===l.PRINTMODE_LATEX&&l.iscons(l.cdr(e))&&ht.isNumberOneOverSomething(l.car(e))&&(i=!0,r=l.car(e).q.b.toString()),i?(n=t,t=""):t+=En(l.car(e)),e=l.cdr(e);l.iscons(e);)l.defs.printMode===l.PRINTMODE_LATEX&&o&&l.caar(e)===ie.symbol(l.POWER)&&l.isNumericAtom(l.car(l.cdr(l.car(e))))&&(ht.isfraction(l.car(l.cdr(l.cdr(l.car(e)))))||(t+=" \\cdot ")),t+=Bb(),t+=En(l.car(e),!1,!0),o=!1,l.isNumericAtom(l.car(e))&&(o=!0),e=l.cdr(e);i&&(t=n+"\\frac{"+t+"}{"+r+"}")}else t+=En(e);return t}function Mx(e){let t="";return t+="(",t+=C(e),t+=")",t}function t$(e){let t="";return e=l.cadr(e),ht.isfraction(e)||l.isadd(e)||l.ismultiply(e)||l.ispower(e)||l.isfactorial(e)?t+=Mx(e):t+=C(e),t+="!",t}function r$(e){let t="";return t+=S("\\left |"),t+=C(l.cadr(e)),t+=S(" \\right |"),t}function n$(e){let t="";return t+=S("\\binom{"),t+=C(l.cadr(e)),t+=S("}{"),t+=C(l.caddr(e)),t+=S("} "),t}function o$(e){let t="";return t+=C(l.cadr(e)),t+=S(" \\cdot "),t+=C(l.caddr(e)),t}function i$(e){let t="dot(";return t+=C(l.cadr(e)),t+=", ",t+=C(l.caddr(e)),t+=")",t}function s$(e){let t="Math.sin(";return t+=C(l.cadr(e)),t+=")",t}function a$(e){let t="Math.cos(";return t+=C(l.cadr(e)),t+=")",t}function l$(e){let t="Math.tan(";return t+=C(l.cadr(e)),t+=")",t}function u$(e){let t="Math.asin(";return t+=C(l.cadr(e)),t+=")",t}function c$(e){let t="Math.acos(";return t+=C(l.cadr(e)),t+=")",t}function f$(e){let t="Math.atan(";return t+=C(l.cadr(e)),t+=")",t}function d$(e){let t="";return t+=S("\\sqrt{"),t+=C(l.cadr(e)),t+=S("} "),t}function m$(e){let t="";return t+=S("{"),l.iscons(l.cadr(e))&&(t+=S("(")),t+=C(l.cadr(e)),l.iscons(l.cadr(e))&&(t+=S(")")),t+=S("}"),t+=S("^T"),t}function _$(e){let t="";return t+=S("transpose("),t+=C(l.cadr(e)),t+=S(")"),t}function b$(e){let t="";return t+=S("identity("),t+=C(l.cadr(e)),t+=S(")"),t}function g$(e){let t="";return t+=S("{"),l.iscons(l.cadr(e))&&(t+=S("(")),t+=C(l.cadr(e)),l.iscons(l.cadr(e))&&(t+=S(")")),t+=S("}"),t+=S("^{-1}"),t}function y$(e){let t="";return t+=S("inv("),t+=C(l.cadr(e)),t+=S(")"),t}function v$(e){let t="",r=l.car(l.cdr(e));e=l.cdr(e);let n=e,o=0;for(;l.iscons(l.cdr(l.cdr(e)));){o++;let i=l.cdr(l.cdr(e));t+=S("\\int^{"),t+=C(l.car(l.cdr(i))),t+=S("}_{"),t+=C(l.car(i)),t+=S("} \\! "),e=l.cdr(i)}t+=C(r),t+=S(" \\,"),e=n;for(let i=1;i<=o;i++){let s=l.cdr(e);t+=S(" \\mathrm{d} "),t+=C(l.car(s)),i<o&&(t+=S(" \\, ")),e=l.cdr(l.cdr(s))}return t}function q$(e){let t="";return t+=Tx(e,0,0)[1],t}function Tx(e,t,r){let n="";if(n+=S("["),t<e.tensor.ndim-1)for(let o=0;o<e.tensor.dim[t];o++){let i;[r,i]=Array.from(Tx(e,t+1,r)),n+=i,o!==e.tensor.dim[t]-1&&(n+=S(","))}else for(let o=0;o<e.tensor.dim[t];o++)n+=C(e.tensor.elem[r]),o!==e.tensor.dim[t]-1&&(n+=S(",")),r++;return n+=S("]"),[r,n]}function E$(e){let t="";return e.tensor.ndim<=2&&(t+=Nx(!0,e,0,0)[1]),t}function Nx(e,t,r,n){let o="";if(e&&(o+="\\begin{bmatrix} "),r<t.tensor.ndim-1)for(let i=0;i<t.tensor.dim[r];i++){let s;[n,s]=Array.from(Nx(!1,t,r+1,n)),o+=s,i!==t.tensor.dim[r]-1&&(o+=S(" \\\\ "))}else for(let i=0;i<t.tensor.dim[r];i++)o+=C(t.tensor.elem[n]),i!==t.tensor.dim[r]-1&&(o+=S(" & ")),n++;return e&&(o+=" \\end{bmatrix}"),[n,o]}function x$(e){let t="\\sum_{";return t+=C(l.caddr(e)),t+="=",t+=C(l.cadddr(e)),t+="}^{",t+=C(l.caddddr(e)),t+="}{",t+=C(l.cadr(e)),t+="}",t}function p$(e){let t=l.cadr(e),r=l.caddr(e),n=l.cadddr(e),o=l.caddddr(e);return"(function(){ var "+r+";  var holderSum = 0;  var lowerlimit = "+C(n)+";  var upperlimit = "+C(o)+";  for ("+r+" = lowerlimit; "+r+" < upperlimit; "+r+"++) {    holderSum += "+C(t)+"; }  return holderSum;})()"}function h$(e){let t="\\left\\{ \\begin{array}{ll}";for(e=l.cdr(e);l.iscons(e);){if(l.cdr(e)===ie.symbol(l.NIL)){t+="{",t+=C(l.car(e)),t+="} & otherwise ",t+=" \\\\\\\\";break}t+="{",t+=C(l.cadr(e)),t+="} & if & ",t+=C(l.car(e)),t+=" \\\\\\\\",e=l.cddr(e)}return t=t.substring(0,t.length-4),t+="\\end{array} \\right."}function A$(e){let t="(function(){";e=l.cdr(e);let r=0;for(;l.iscons(e);){if(l.cdr(e)===ie.symbol(l.NIL)){t+="else {",t+="return ("+C(l.car(e))+");",t+="}";break}r&&(t+=" else "),t+="if ("+C(l.car(e))+"){",t+="return ("+C(l.cadr(e))+");",t+="}",r++,e=l.cddr(e)}return t+="})()",t}function O$(e){let t="{";return t+=C(l.cadr(e)),t+="}",t+=" < ",t+="{",t+=C(l.caddr(e)),t+="}"}function M$(e){let t="{";return t+=C(l.cadr(e)),t+="}",t+=" \\leq ",t+="{",t+=C(l.caddr(e)),t+="}"}function T$(e){let t="{";return t+=C(l.cadr(e)),t+="}",t+=" > ",t+="{",t+=C(l.caddr(e)),t+="}"}function N$(e){let t="{";return t+=C(l.cadr(e)),t+="}",t+=" \\geq ",t+="{",t+=C(l.caddr(e)),t+="}"}function I$(e){let t="{";return t+=C(l.cadr(e)),t+="}",t+=" = ",t+="{",t+=C(l.caddr(e)),t+="}"}function S$(e){let t=l.cadr(e),r=l.caddr(e),n=l.cadddr(e),o=l.caddddr(e);return"(function(){ var "+r+";  var lowerlimit = "+C(n)+";  var upperlimit = "+C(o)+";  for ("+r+" = lowerlimit; "+r+" < upperlimit; "+r+"++) {    "+C(t)+" } })()"}function R$(e){let t="";for(e=l.cdr(e);l.iscons(e);)t+=C(l.car(e)),e=l.cdr(e);return t}function w$(e){let t="";return t+=C(l.cadr(e)),t+=" = ",t+=C(l.caddr(e)),t+="; ",t}function L$(e){let t="\\prod_{";return t+=C(l.caddr(e)),t+="=",t+=C(l.cadddr(e)),t+="}^{",t+=C(l.caddddr(e)),t+="}{",t+=C(l.cadr(e)),t+="}",t}function C$(e){let t=l.cadr(e),r=l.caddr(e),n=l.cadddr(e),o=l.caddddr(e);return"(function(){ var "+r+";  var holderProduct = 1;  var lowerlimit = "+C(n)+";  var upperlimit = "+C(o)+";  for ("+r+" = lowerlimit; "+r+" < upperlimit; "+r+"++) {    holderProduct *= "+C(t)+"; }  return holderProduct;})()"}function yu(e,t){let r="";if(l.DEBUG&&console.log("power base: "+e+"  exponent: "+t),ht.isoneovertwo(t))if(ht.equaln(e,2)){if(l.defs.codeGen)return r+=S("Math.SQRT2"),r}else{if(l.defs.printMode===l.PRINTMODE_LATEX)return r+=S("\\sqrt{"),r+=C(e),r+=S("}"),r;if(l.defs.codeGen)return r+=S("Math.sqrt("),r+=C(e),r+=S(")"),r}if(ht.equaln(ie.get_binding(ie.symbol(l.PRINT_LEAVE_E_ALONE)),1)&&e===ie.symbol(l.E))return l.defs.codeGen?(r+=S("Math.exp("),r+=hx(t),r+=S(")"),r):(l.defs.printMode===l.PRINTMODE_LATEX?(r+=S("e^{"),r+=C(t),r+=S("}")):(r+=S("exp("),r+=C(t),r+=S(")")),r);if(l.defs.codeGen)return r+=S("Math.pow("),r+=Ox(e),r+=S(", "),r+=hx(t),r+=S(")"),r;if(ht.equaln(ie.get_binding(ie.symbol(l.PRINT_LEAVE_X_ALONE)),0)||e.printname!=="x"){if(e!==ie.symbol(l.E)){if(ht.isminusone(t))return l.defs.printMode===l.PRINTMODE_LATEX?r+=S("\\frac{1}{"):l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag?r+=S("1 / "):r+=S("1/"),l.iscons(e)&&l.defs.printMode!==l.PRINTMODE_LATEX?(r+=S("("),r+=C(e),r+=S(")")):r+=C(e),l.defs.printMode===l.PRINTMODE_LATEX&&(r+=S("}")),r;if(ht.isnegativeterm(t)){l.defs.printMode===l.PRINTMODE_LATEX?r+=S("\\frac{1}{"):l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag?r+=S("1 / "):r+=S("1/");let n=Ax.multiply(t,l.Constants.negOne);return l.iscons(e)&&l.defs.printMode!==l.PRINTMODE_LATEX?(r+=S("("),r+=yu(e,n),r+=S(")")):r+=yu(e,n),l.defs.printMode===l.PRINTMODE_LATEX&&(r+=S("}")),r}}if(ht.isfraction(t)&&l.defs.printMode===l.PRINTMODE_LATEX){r+=S("\\sqrt");let n=Bk.denominator(t);return ht.isplustwo(n)||(r+=S("["),r+=C(n),r+=S("]")),r+=S("{"),t=Fk.numerator(t),r+=yu(e,t),r+=S("}"),r}}return l.defs.printMode===l.PRINTMODE_LATEX&&ht.isplusone(t)?r+=C(e):(l.isadd(e)||ht.isnegativenumber(e)?(r+=S("("),r+=C(e),r+=S(")")):l.ismultiply(e)||l.ispower(e)?(l.defs.printMode!==l.PRINTMODE_LATEX&&(r+=S("(")),r+=En(e,!0),l.defs.printMode!==l.PRINTMODE_LATEX&&(r+=S(")"))):l.isNumericAtom(e)&&(ts.lessp(e,l.Constants.zero)||ht.isfraction(e))?(r+=S("("),r+=En(e),r+=S(")")):r+=En(e),l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag?r+=S(Yk):r+=S("^"),l.defs.printMode===l.PRINTMODE_LATEX?C(t).length>1?(r+=S("{"),r+=C(t),r+=S("}")):r+=C(t):l.iscons(t)||ht.isfraction(t)||l.isNumericAtom(t)&&ts.lessp(t,l.Constants.zero)?(r+=S("("),r+=C(t),r+=S(")")):r+=En(t)),r}function P$(e){let t="";if(e=l.cdr(e),l.caar(e)===ie.symbol(l.ADD)||l.caar(e)===ie.symbol(l.MULTIPLY)||l.caar(e)===ie.symbol(l.POWER)||l.caar(e)===ie.symbol(l.FACTORIAL)?t+=Mx(l.car(e)):t+=C(l.car(e)),t+=S("["),e=l.cdr(e),l.iscons(e))for(t+=C(l.car(e)),e=l.cdr(e);l.iscons(e);)t+=S(","),t+=C(l.car(e)),e=l.cdr(e);return t+=S("]"),t}function En(e,t=!1,r=!1){let n="";if(l.isNumericAtom(e))return r&&ts.lessp(e,l.Constants.zero)&&(n+="("),n+=hd.print_number(e,r),r&&ts.lessp(e,l.Constants.zero)&&(n+=")"),n;if(l.isstr(e))return n+=S('"'),n+=S(e.str),n+=S('"'),n;if(l.istensor(e))return l.defs.printMode===l.PRINTMODE_LATEX?n+=E$(e):n+=q$(e),n;if(l.ismultiply(e))return t||(gu(e)==="-"||l.defs.printMode!==l.PRINTMODE_LATEX)&&(l.defs.printMode===l.PRINTMODE_LATEX?n+=S(" \\left ("):n+=S("(")),n+=C(e),t||(gu(e)==="-"||l.defs.printMode!==l.PRINTMODE_LATEX)&&(l.defs.printMode===l.PRINTMODE_LATEX?n+=S(" \\right ) "):n+=S(")")),n;if(l.isadd(e))return t||(n+=S("(")),n+=C(e),t||(n+=S(")")),n;if(l.ispower(e)){let o=l.cadr(e),i=l.caddr(e);return n+=yu(o,i),n}if(l.car(e)===ie.symbol(l.FUNCTION)){let o=l.cadr(e);if(!l.defs.codeGen){let i=l.caddr(e);n+=S("function "),l.DEBUG&&console.log(`emittedString from print_factor ${l.defs.stringsEmittedByUserPrintouts}`),n+=Za(i),n+=S(" -> ")}return n+=C(o),n}if(l.car(e)===ie.symbol(l.PATTERN))return n+=C(l.caadr(e)),l.defs.printMode===l.PRINTMODE_LATEX?n+=S(" \\rightarrow "):l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag?n+=S(" -> "):n+=S("->"),n+=C(l.car(l.cdr(l.cadr(e)))),n;if(l.car(e)===ie.symbol(l.INDEX)&&l.issymbol(l.cadr(e)))return n+=P$(e),n;if(l.isfactorial(e))return n+=t$(e),n;if(l.car(e)===ie.symbol(l.ABS)&&l.defs.printMode===l.PRINTMODE_LATEX)return n+=r$(e),n;if(l.car(e)===ie.symbol(l.SQRT)&&l.defs.printMode===l.PRINTMODE_LATEX)return n+=d$(e),n;if(l.isfactorial(e)){if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=m$(e),n;if(l.defs.codeGen)return n+=_$(e),n}else if(l.car(e)===ie.symbol(l.UNIT)){if(l.defs.codeGen)return n+=b$(e),n}else if(l.isinv(e)){if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=g$(e),n;if(l.defs.codeGen)return n+=y$(e),n}else{if(l.car(e)===ie.symbol(l.BINOMIAL)&&l.defs.printMode===l.PRINTMODE_LATEX)return n+=n$(e),n;if(l.car(e)===ie.symbol(l.DEFINT)&&l.defs.printMode===l.PRINTMODE_LATEX)return n+=v$(e),n;if(l.isinnerordot(e)){if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=o$(e),n;if(l.defs.codeGen)return n+=i$(e),n}else if(l.car(e)===ie.symbol(l.SIN)){if(l.defs.codeGen)return n+=s$(e),n}else if(l.car(e)===ie.symbol(l.COS)){if(l.defs.codeGen)return n+=a$(e),n}else if(l.car(e)===ie.symbol(l.TAN)){if(l.defs.codeGen)return n+=l$(e),n}else if(l.car(e)===ie.symbol(l.ARCSIN)){if(l.defs.codeGen)return n+=u$(e),n}else if(l.car(e)===ie.symbol(l.ARCCOS)){if(l.defs.codeGen)return n+=c$(e),n}else if(l.car(e)===ie.symbol(l.ARCTAN)){if(l.defs.codeGen)return n+=f$(e),n}else if(l.car(e)===ie.symbol(l.SUM)){if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=x$(e),n;if(l.defs.codeGen)return n+=p$(e),n}else if(l.car(e)===ie.symbol(l.PRODUCT)){if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=L$(e),n;if(l.defs.codeGen)return n+=C$(e),n}else if(l.car(e)===ie.symbol(l.FOR)){if(l.defs.codeGen)return n+=S$(e),n}else if(l.car(e)===ie.symbol(l.DO)){if(l.defs.codeGen)return n+=R$(e),n}else if(l.car(e)===ie.symbol(l.TEST)){if(l.defs.codeGen)return n+=A$(e),n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=h$(e),n}else if(l.car(e)===ie.symbol(l.TESTLT)){if(l.defs.codeGen)return n+="(("+C(l.cadr(e))+") < ("+C(l.caddr(e))+"))",n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=O$(e),n}else if(l.car(e)===ie.symbol(l.TESTLE)){if(l.defs.codeGen)return n+="(("+C(l.cadr(e))+") <= ("+C(l.caddr(e))+"))",n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=M$(e),n}else if(l.car(e)===ie.symbol(l.TESTGT)){if(l.defs.codeGen)return n+="(("+C(l.cadr(e))+") > ("+C(l.caddr(e))+"))",n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=T$(e),n}else if(l.car(e)===ie.symbol(l.TESTGE)){if(l.defs.codeGen)return n+="(("+C(l.cadr(e))+") >= ("+C(l.caddr(e))+"))",n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=N$(e),n}else if(l.car(e)===ie.symbol(l.TESTEQ)){if(l.defs.codeGen)return n+="(("+C(l.cadr(e))+") === ("+C(l.caddr(e))+"))",n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=I$(e),n}else if(l.car(e)===ie.symbol(l.FLOOR)){if(l.defs.codeGen)return n+="Math.floor("+C(l.cadr(e))+")",n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=" \\lfloor {"+C(l.cadr(e))+"} \\rfloor ",n}else if(l.car(e)===ie.symbol(l.CEILING)){if(l.defs.codeGen)return n+="Math.ceiling("+C(l.cadr(e))+")",n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=" \\lceil {"+C(l.cadr(e))+"} \\rceil ",n}else if(l.car(e)===ie.symbol(l.ROUND)){if(l.defs.codeGen)return n+="Math.round("+C(l.cadr(e))+")",n}else if(l.car(e)===ie.symbol(l.SETQ))return l.defs.codeGen?(n+=w$(e),n):(n+=C(l.cadr(e)),n+=S("="),n+=C(l.caddr(e)),n)}if(l.iscons(e)){if(n+=En(l.car(e)),e=l.cdr(e),t||(n+=S("(")),l.iscons(e))for(n+=C(l.car(e)),e=l.cdr(e);l.iscons(e);)n+=S(","),n+=C(l.car(e)),e=l.cdr(e);return t||(n+=S(")")),n}return e===ie.symbol(l.DERIVATIVE)?n+="d":e===ie.symbol(l.E)?l.defs.codeGen?n+=S("Math.E"):n+=S("e"):e===ie.symbol(l.PI)?l.defs.printMode===l.PRINTMODE_LATEX?n+=S("\\pi"):n+=S("pi"):n+=S(ie.get_printname(e)),n}function Za(e){let t="";switch(e.k){case l.CONS:for(t+="(",t+=Za(l.car(e)),e===l.cdr(e)&&(console.log("oh no recursive!"),l.breakpoint),e=l.cdr(e);l.iscons(e);)t+=" ",t+=Za(l.car(e)),e=l.cdr(e),e===l.cdr(e)&&e!==ie.symbol(l.NIL)&&(console.log("oh no recursive!"),l.breakpoint);e!==ie.symbol(l.NIL)&&(t+=" . ",t+=Za(e)),t+=")";break;case l.STR:t+=e.str;break;case l.NUM:case l.DOUBLE:t+=hd.print_number(e,!0);break;case l.SYM:t+=ie.get_printname(e);break;default:t+="<tensor>"}return t}At.print_list=Za;function Bb(){let e="";return l.defs.printMode===l.PRINTMODE_LATEX||(l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag&&!l.defs.codeGen?e+=S(" "):e+=S("*")),e}function pd(e){return l.ispower(e)&&l.cadr(e)!==ie.symbol(l.E)&&ht.isnegativeterm(l.caddr(e))}function D$(e){for(e=l.cdr(e);l.iscons(e);){let t=l.car(e);if(pd(t))return!0;e=l.cdr(e)}return!1}});var N=A(a=>{"use strict";var k$=a&&a.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(a,"__esModule",{value:!0});a.evalFloats=a.evalPolar=a.doexpand=a.noexpand=a.Constants=a.$=a.reset_after_error=a.MEQUAL=a.MZERO=a.MSIGN=a.isidentitymatrix=a.isinv=a.istranspose=a.isinnerordot=a.isfactorial=a.ispower=a.ismultiply=a.isadd=a.caddaddr=a.cdddaddr=a.caddadr=a.cddaddr=a.cadaddr=a.caddddr=a.cddddr=a.cadddr=a.cdaddr=a.caddar=a.cadadr=a.caaddr=a.cdddr=a.cddar=a.cdadr=a.cadar=a.caddr=a.caadr=a.cddr=a.cdar=a.cadr=a.caar=a.cdr=a.car=a.issymbol=a.isNumericAtomOrTensor=a.istensor=a.isstr=a.isNumericAtom=a.isdouble=a.isrational=a.iscons=a.dotprod_unicode=a.transpose_unicode=a.logbuf=a.mtotal=a.primetab=a.parse_time_simplifications=a.predefinedSymbolsInGlobalScope_doNotTrackInDependencies=a.MAXDIM=a.MAX_CONSECUTIVE_APPLICATIONS_OF_SINGLE_RULE=a.MAX_CONSECUTIVE_APPLICATIONS_OF_ALL_RULES=a.MAXPRIMETAB=a.E=a.C6=a.C5=a.C4=a.C3=a.C2=a.C1=a.SYMBOL_X_UNDERSCORE=a.SYMBOL_B_UNDERSCORE=a.SYMBOL_A_UNDERSCORE=a.SYMBOL_IDENTITY_MATRIX=a.SYMBOL_Z=a.SYMBOL_Y=a.SYMBOL_X=a.SYMBOL_T=a.SYMBOL_S=a.SYMBOL_R=a.SYMBOL_N=a.SYMBOL_J=a.SYMBOL_I=a.SYMBOL_D=a.SYMBOL_C=a.SYMBOL_B=a.SYMBOL_A=a.PI=a.VERSION=a.SECRETX=a.METAX=a.METAB=a.METAA=a.DRAWX=a.YYE=a.MAX_FIXED_PRINTOUT_DIGITS=a.FORCE_FIXED_PRINTOUT=a.TRACE=a.ASSUME_REAL_VARIABLES=a.BAKE=a.AUTOEXPAND=a.LAST_PLAIN_PRINT=a.LAST_LIST_PRINT=a.LAST_LATEX_PRINT=a.LAST_FULL_PRINT=a.LAST_2DASCII_PRINT=a.LAST_PRINT=a.LAST=a.NIL=a.ZERO=a.UNIT=a.TRANSPOSE=a.TESTLT=a.TESTLE=a.TESTGT=a.TESTGE=a.TESTEQ=a.TEST=a.TAYLOR=a.TANH=a.TAN=a.SYMBOLSINFO=a.SUM=a.SUBST=a.STOP=a.SQRT=a.SHAPE=a.SINH=a.SIN=a.SIMPLIFY=a.SILENTPATTERN=a.SGN=a.SETQ=a.ROOTS=a.YYRECT=a.ROUND=a.REAL=a.RATIONALIZE=a.RANK=a.QUOTIENT=a.QUOTE=a.PRODUCT=a.PRINTPLAIN=a.PRINTLIST=a.PRINTLATEX=a.PRINTFULL=a.PRINT2DASCII=a.PRINT=a.PRINT_LEAVE_X_ALONE=a.PRINT_LEAVE_E_ALONE=a.PRIME=a.POWER=a.POLAR=a.PATTERNSINFO=a.PATTERN=a.OUTER=a.OR=a.OPERATOR=a.NUMERATOR=a.NUMBER=a.NROOTS=a.NOT=a.MULTIPLY=a.MOD=a.LOOKUP=a.LOG=a.LEGENDRE=a.LEADING=a.LCM=a.LAGUERRE=a.ISPRIME=a.ISINTEGER=a.INVG=a.INV=a.INTEGRAL=a.INNER=a.INDEX=a.IMAG=a.HILBERT=a.HERMITE=a.GCD=a.GAMMA=a.FUNCTION=a.FOR=a.FLOOR=a.FLOATF=a.FILTER=a.FACTORPOLY=a.FACTORIAL=a.FACTOR=a.EXPSIN=a.EXPCOS=a.EXPAND=a.EXP=a.EVAL=a.ERFC=a.ERF=a.EIGENVEC=a.EIGENVAL=a.EIGEN=a.DSOLVE=a.DRAW=a.DOT=a.DO=a.DIVISORS=a.DIRAC=a.DIM=a.DET=a.DERIVATIVE=a.DENOMINATOR=a.DEGREE=a.DEFINT=a.DECOMP=a.COSH=a.COS=a.CONTRACT=a.CONJ=a.CONDENSE=a.COFACTOR=a.COEFF=a.CLOCK=a.CLEARPATTERNS=a.CLEARALL=a.CLEAR=a.CIRCEXP=a.CHOOSE=a.CHECK=a.CEILING=a.BINOMIAL=a.BINDING=a.BESSELY=a.BESSELJ=a.ATOMIZE=a.ARG=a.ARCTANH=a.ARCTAN=a.ARCSINH=a.ARCSIN=a.ARCCOSH=a.ARCCOS=a.APPROXRATIO=a.AND=a.ADJ=a.ADD=a.ABS=a.SYM=a.TENSOR=a.STR=a.DOUBLE=a.NUM=a.CONS=a.Sym=a.Tensor=a.Str=a.Double=a.Num=a.Cons=a.BaseAtom=a.avoidCalculatingPowersIntoArctans=a.do_simplify_nested_radicals=a.dontCreateNewRadicalsInDenominatorWhenEvalingMultiplication=a.defs=a.PRINTMODE_LIST=a.PRINTMODE_HUMAN=a.PRINTMODE_COMPUTER=a.PRINTMODE_2DASCII=a.PRINTMODE_LATEX=a.PRINTOUTRESULT=a.DEBUG=a.NSYM=a.version=a.breakpoint=void 0;var Ad=k$(To()),Ix=eo(),zr=U();function Sx(){}a.breakpoint=Sx;a.version="2.0.1";a.NSYM=1e3;a.DEBUG=!1;a.PRINTOUTRESULT=!1;a.PRINTMODE_LATEX="PRINTMODE_LATEX";a.PRINTMODE_2DASCII="PRINTMODE_2DASCII";a.PRINTMODE_COMPUTER="PRINTMODE_COMPUTER";a.PRINTMODE_HUMAN="PRINTMODE_HUMAN";a.PRINTMODE_LIST="PRINTMODE_LIST";var Gb=class{constructor(){this.printMode=a.PRINTMODE_COMPUTER,this.recursionLevelNestedRadicalsRemoval=0,this.errorMessage="",this.symbolsDependencies={},this.symbolsHavingReassignments=[],this.symbolsInExpressionsWithoutAssignments=[],this.patternHasBeenFound=!1,this.inited=!1,this.chainOfUserSymbolsNotFunctionsBeingEvaluated=[],this.stringsEmittedByUserPrintouts="",this.called_from_Algebra_block=!1,this.expanding=!1,this.evaluatingAsFloats=!1,this.evaluatingPolar=!1,this.esc_flag=!1,this.trigmode=0,this.out_count=0,this.test_flag=!1,this.codeGen=!1,this.userSimplificationsInListForm=[],this.userSimplificationsInStringForm=[],this.fullDoubleOutput=!1}};a.defs=new Gb;a.dontCreateNewRadicalsInDenominatorWhenEvalingMultiplication=!0;a.do_simplify_nested_radicals=!0;a.avoidCalculatingPowersIntoArctans=!0;var Mo=class{toString(){return Ix.print_expr(this)}toLatexString(){return Ix.collectLatexStringFromReturnValue(this)}};a.BaseAtom=Mo;var vu=class extends Mo{constructor(t,r){super(),this.k=a.CONS,this.cons={car:t,cdr:r}}*[Symbol.iterator](){let t=this;for(;Ha(t);)yield Le(t),t=se(t)}tail(){return Ha(this.cons.cdr)?[...this.cons.cdr]:[]}map(t){let r=Le(this),n=se(this);return Ha(n)&&(n=n.map(t)),new vu(t(r),n)}};a.Cons=vu;var Qa=class extends Mo{constructor(t,r=Ad.default.one){super(),this.a=t,this.b=r,this.q=this,this.k=a.NUM}};a.Num=Qa;var rs=class extends Mo{constructor(t){super(),this.d=t,this.k=a.DOUBLE}};a.Double=rs;var Fb=class extends Mo{constructor(t){super(),this.str=t,this.k=a.STR}};a.Str=Fb;var jb=class extends Mo{constructor(){super(...arguments),this.tensor=this,this.k=a.TENSOR,this.ndim=0,this.dim=[],this.elem=[]}get nelem(){return this.elem.length}};a.Tensor=jb;var zb=class extends Mo{constructor(t){super(),this.printname=t,this.k=a.SYM}};a.Sym=zb;a.CONS=0;a.NUM=1;a.DOUBLE=2;a.STR=3;a.TENSOR=4;a.SYM=5;a.ABS="abs";a.ADD="add";a.ADJ="adj";a.AND="and";a.APPROXRATIO="approxratio";a.ARCCOS="arccos";a.ARCCOSH="arccosh";a.ARCSIN="arcsin";a.ARCSINH="arcsinh";a.ARCTAN="arctan";a.ARCTANH="arctanh";a.ARG="arg";a.ATOMIZE="atomize";a.BESSELJ="besselj";a.BESSELY="bessely";a.BINDING="binding";a.BINOMIAL="binomial";a.CEILING="ceiling";a.CHECK="check";a.CHOOSE="choose";a.CIRCEXP="circexp";a.CLEAR="clear";a.CLEARALL="clearall";a.CLEARPATTERNS="clearpatterns";a.CLOCK="clock";a.COEFF="coeff";a.COFACTOR="cofactor";a.CONDENSE="condense";a.CONJ="conj";a.CONTRACT="contract";a.COS="cos";a.COSH="cosh";a.DECOMP="decomp";a.DEFINT="defint";a.DEGREE="deg";a.DENOMINATOR="denominator";a.DERIVATIVE="derivative";a.DET="det";a.DIM="dim";a.DIRAC="dirac";a.DIVISORS="divisors";a.DO="do";a.DOT="dot";a.DRAW="draw";a.DSOLVE="dsolve";a.EIGEN="eigen";a.EIGENVAL="eigenval";a.EIGENVEC="eigenvec";a.ERF="erf";a.ERFC="erfc";a.EVAL="eval";a.EXP="exp";a.EXPAND="expand";a.EXPCOS="expcos";a.EXPSIN="expsin";a.FACTOR="factor";a.FACTORIAL="factorial";a.FACTORPOLY="factorpoly";a.FILTER="filter";a.FLOATF="float";a.FLOOR="floor";a.FOR="for";a.FUNCTION="function";a.GAMMA="Gamma";a.GCD="gcd";a.HERMITE="hermite";a.HILBERT="hilbert";a.IMAG="imag";a.INDEX="component";a.INNER="inner";a.INTEGRAL="integral";a.INV="inv";a.INVG="invg";a.ISINTEGER="isinteger";a.ISPRIME="isprime";a.LAGUERRE="laguerre";a.LCM="lcm";a.LEADING="leading";a.LEGENDRE="legendre";a.LOG="log";a.LOOKUP="lookup";a.MOD="mod";a.MULTIPLY="multiply";a.NOT="not";a.NROOTS="nroots";a.NUMBER="number";a.NUMERATOR="numerator";a.OPERATOR="operator";a.OR="or";a.OUTER="outer";a.PATTERN="pattern";a.PATTERNSINFO="patternsinfo";a.POLAR="polar";a.POWER="power";a.PRIME="prime";a.PRINT_LEAVE_E_ALONE="printLeaveEAlone";a.PRINT_LEAVE_X_ALONE="printLeaveXAlone";a.PRINT="print";a.PRINT2DASCII="print2dascii";a.PRINTFULL="printcomputer";a.PRINTLATEX="printlatex";a.PRINTLIST="printlist";a.PRINTPLAIN="printhuman";a.PRODUCT="product";a.QUOTE="quote";a.QUOTIENT="quotient";a.RANK="rank";a.RATIONALIZE="rationalize";a.REAL="real";a.ROUND="round";a.YYRECT="rect";a.ROOTS="roots";a.SETQ="equals";a.SGN="sgn";a.SILENTPATTERN="silentpattern";a.SIMPLIFY="simplify";a.SIN="sin";a.SINH="sinh";a.SHAPE="shape";a.SQRT="sqrt";a.STOP="stop";a.SUBST="subst";a.SUM="sum";a.SYMBOLSINFO="symbolsinfo";a.TAN="tan";a.TANH="tanh";a.TAYLOR="taylor";a.TEST="test";a.TESTEQ="testeq";a.TESTGE="testge";a.TESTGT="testgt";a.TESTLE="testle";a.TESTLT="testlt";a.TRANSPOSE="transpose";a.UNIT="unit";a.ZERO="zero";a.NIL="nil";a.LAST="last";a.LAST_PRINT="lastprint";a.LAST_2DASCII_PRINT="last2dasciiprint";a.LAST_FULL_PRINT="lastfullprint";a.LAST_LATEX_PRINT="lastlatexprint";a.LAST_LIST_PRINT="lastlistprint";a.LAST_PLAIN_PRINT="lastplainprint";a.AUTOEXPAND="autoexpand";a.BAKE="bake";a.ASSUME_REAL_VARIABLES="assumeRealVariables";a.TRACE="trace";a.FORCE_FIXED_PRINTOUT="forceFixedPrintout";a.MAX_FIXED_PRINTOUT_DIGITS="maxFixedPrintoutDigits";a.YYE="~";a.DRAWX="$DRAWX";a.METAA="$METAA";a.METAB="$METAB";a.METAX="$METAX";a.SECRETX="$SECRETX";a.VERSION="version";a.PI="pi";a.SYMBOL_A="a";a.SYMBOL_B="b";a.SYMBOL_C="c";a.SYMBOL_D="d";a.SYMBOL_I="i";a.SYMBOL_J="j";a.SYMBOL_N="n";a.SYMBOL_R="r";a.SYMBOL_S="s";a.SYMBOL_T="t";a.SYMBOL_X="x";a.SYMBOL_Y="y";a.SYMBOL_Z="z";a.SYMBOL_IDENTITY_MATRIX="I";a.SYMBOL_A_UNDERSCORE="a_";a.SYMBOL_B_UNDERSCORE="b_";a.SYMBOL_X_UNDERSCORE="x_";a.C1="$C1";a.C2="$C2";a.C3="$C3";a.C4="$C4";a.C5="$C5";a.C6="$C6";a.E=a.YYE;a.MAXPRIMETAB=1e4;a.MAX_CONSECUTIVE_APPLICATIONS_OF_ALL_RULES=5;a.MAX_CONSECUTIVE_APPLICATIONS_OF_SINGLE_RULE=10;a.MAXDIM=24;a.predefinedSymbolsInGlobalScope_doNotTrackInDependencies=["rationalize","abs","e","i","pi","sin","ceiling","cos","roots","integral","derivative","defint","sqrt","eig","cov","deig","dcov","float","floor","product","root","round","sum","test","unit"];a.parse_time_simplifications=!0;a.primetab=function(){let e=[2],t=3;for(;e.length<a.MAXPRIMETAB;){let r=0,n=Math.sqrt(t);for(;r<e.length&&e[r]<=n;){if(t%e[r]===0){r=-1;break}r++}r!==-1&&e.push(t),t+=2}return e[a.MAXPRIMETAB]=0,e}();var $$=!1;a.mtotal=0;a.logbuf="";a.transpose_unicode=7488;a.dotprod_unicode=183;function Ha(e){return e.k===a.CONS}a.iscons=Ha;function Rx(e){return e.k===a.NUM}a.isrational=Rx;function wx(e){return e.k===a.DOUBLE}a.isdouble=wx;function Lx(e){return Rx(e)||wx(e)}a.isNumericAtom=Lx;function U$(e){return e.k===a.STR}a.isstr=U$;function Cx(e){return e.k===a.TENSOR}a.istensor=Cx;function Px(e){if(Lx(e)||e===zr.symbol(a.SYMBOL_IDENTITY_MATRIX))return!0;if(!Cx(e))return!1;let t=e.tensor.nelem,r=e.tensor.elem;for(let n=0;n<t;n++)if(!Px(r[n]))return!1;return!0}a.isNumericAtomOrTensor=Px;function B$(e){return e.k===a.SYM}a.issymbol=B$;function Le(e){return Ha(e)?e.cons.car:zr.symbol(a.NIL)}a.car=Le;function se(e){return Ha(e)?e.cons.cdr:zr.symbol(a.NIL)}a.cdr=se;function G$(e){return Le(Le(e))}a.caar=G$;function F$(e){return Le(se(e))}a.cadr=F$;function j$(e){return se(Le(e))}a.cdar=j$;function z$(e){return se(se(e))}a.cddr=z$;function Y$(e){return Le(Le(se(e)))}a.caadr=Y$;function V$(e){return Le(se(se(e)))}a.caddr=V$;function Z$(e){return Le(se(Le(e)))}a.cadar=Z$;function X$(e){return se(Le(se(e)))}a.cdadr=X$;function H$(e){return se(se(Le(e)))}a.cddar=H$;function Q$(e){return se(se(se(e)))}a.cdddr=Q$;function W$(e){return Le(Le(se(se(e))))}a.caaddr=W$;function J$(e){return Le(se(Le(se(e))))}a.cadadr=J$;function K$(e){return Le(se(se(Le(e))))}a.caddar=K$;function eU(e){return se(Le(se(se(e))))}a.cdaddr=eU;function tU(e){return Le(se(se(se(e))))}a.cadddr=tU;function rU(e){return se(se(se(se(e))))}a.cddddr=rU;function nU(e){return Le(se(se(se(se(e)))))}a.caddddr=nU;function oU(e){return Le(se(Le(se(se(e)))))}a.cadaddr=oU;function iU(e){return se(se(Le(se(se(e)))))}a.cddaddr=iU;function sU(e){return Le(se(se(Le(se(e)))))}a.caddadr=sU;function aU(e){return se(se(se(Le(se(se(e))))))}a.cdddaddr=aU;function lU(e){return Le(se(se(Le(se(se(e))))))}a.caddaddr=lU;function uU(e){return Le(e)===zr.symbol(a.ADD)}a.isadd=uU;function cU(e){return Le(e)===zr.symbol(a.MULTIPLY)}a.ismultiply=cU;function fU(e){return Le(e)===zr.symbol(a.POWER)}a.ispower=fU;function dU(e){return Le(e)===zr.symbol(a.FACTORIAL)}a.isfactorial=dU;function mU(e){return Le(e)===zr.symbol(a.INNER)||Le(e)===zr.symbol(a.DOT)}a.isinnerordot=mU;function _U(e){return Le(e)===zr.symbol(a.TRANSPOSE)}a.istranspose=_U;function bU(e){return Le(e)===zr.symbol(a.INV)}a.isinv=bU;function gU(e){return e===zr.symbol(a.SYMBOL_IDENTITY_MATRIX)}a.isidentitymatrix=gU;function yU(e){return e.isPositive()?1:e.isZero()?0:-1}a.MSIGN=yU;function vU(e){return e.isZero()}a.MZERO=vU;function qU(e,t){return e==null,e.equals(t)}a.MEQUAL=qU;function EU(){a.defs.esc_flag=!1,$$=!1,a.defs.evaluatingAsFloats=!1,a.defs.evaluatingPolar=!1}a.reset_after_error=EU;a.$={};var nr=class{static One(){return a.defs.evaluatingAsFloats?nr.oneAsDouble:nr.one}static NegOne(){return a.defs.evaluatingAsFloats?nr.negOneAsDouble:nr.negOne}static Zero(){return a.defs.evaluatingAsFloats?nr.zeroAsDouble:nr.zero}static Pi(){return a.defs.evaluatingAsFloats?nr.piAsDouble:zr.symbol(a.PI)}};a.Constants=nr;nr.one=new Qa(Ad.default(1));nr.oneAsDouble=new rs(1);nr.negOne=new Qa(Ad.default(-1));nr.negOneAsDouble=new rs(-1);nr.zero=new Qa(Ad.default(0));nr.zeroAsDouble=new rs(0);nr.piAsDouble=new rs(Math.PI);function xU(e,...t){let r=a.defs.expanding;a.defs.expanding=!1;try{return e(...t)}finally{a.defs.expanding=r}}a.noexpand=xU;function pU(e,...t){let r=a.defs.expanding;a.defs.expanding=!0;try{return e(...t)}finally{a.defs.expanding=r}}a.doexpand=pU;function hU(e,...t){let r=a.defs.evaluatingPolar;a.defs.evaluatingPolar=!0;try{return e(...t)}finally{a.defs.evaluatingPolar=r}}a.evalPolar=hU;function AU(e,...t){let r=a.defs.evaluatingAsFloats;a.defs.evaluatingAsFloats=!0;try{return e(...t)}finally{a.defs.evaluatingAsFloats=r}}a.evalFloats=AU});var $x=A(Wa=>{"use strict";Object.defineProperty(Wa,"__esModule",{value:!0});Wa.exec=Wa.parse=void 0;var Od=Ee(),Dx=F(),OU=K(),MU=Yo(),qu=N(),TU=su(),Yb=U();qu.defs.inited||(qu.defs.inited=!0,TU.init());function kx(e){if(typeof e=="string"){let[,t]=MU.scan(e);return t}else return typeof e=="number"?e%1===0?Dx.integer(e):Dx.double(e):typeof e.k=="number"?e:(console.warn("unknown argument type",e),Yb.symbol(qu.NIL))}function NU(e){let t;try{t=kx(e),Od.check_stack()}catch(r){throw qu.reset_after_error(),r}return t}Wa.parse=NU;function IU(e,...t){let r,n=Yb.get_binding(Yb.usr_symbol(e));Od.check_stack();let o=OU.makeList(n,...t.map(kx));try{r=Od.top_level_eval(o),Od.check_stack()}catch(i){throw qu.reset_after_error(),i}return r}Wa.exec=IU});var DU=A(Td=>{Object.defineProperty(Td,"__esModule",{value:!0});var ve=N(),SU=ir(),RU=su(),wU=Ee(),Ja=U(),Vb=$x(),Md=D_(),LU=Gl(),Lt=H(),Ux=Ne(),CU=Yo(),Bx={version:ve.version,isadd:ve.isadd,ismultiply:ve.ismultiply,ispower:ve.ispower,isfactorial:ve.isfactorial,car:ve.car,cdr:ve.cdr,caar:ve.caar,cadr:ve.cadr,cdar:ve.cdar,cddr:ve.cddr,caadr:ve.caadr,caddr:ve.caddr,cadar:ve.cadar,cdadr:ve.cdadr,cddar:ve.cddar,cdddr:ve.cdddr,caaddr:ve.caaddr,cadadr:ve.cadadr,caddar:ve.caddar,cdaddr:ve.cdaddr,cadddr:ve.cadddr,cddddr:ve.cddddr,caddddr:ve.caddddr,cadaddr:ve.cadaddr,cddaddr:ve.cddaddr,caddadr:ve.caddadr,cdddaddr:ve.cdddaddr,caddaddr:ve.caddaddr,symbol:Ja.symbol,iscons:ve.iscons,isrational:ve.isrational,isdouble:ve.isdouble,isNumericAtom:ve.isNumericAtom,isstr:ve.isstr,istensor:ve.istensor,issymbol:ve.issymbol,iskeyword:Ja.iskeyword,CONS:ve.CONS,Cons:ve.Cons,NUM:ve.NUM,Num:ve.Num,DOUBLE:ve.DOUBLE,Double:ve.Double,STR:ve.STR,Str:ve.Str,TENSOR:ve.TENSOR,Tensor:ve.Tensor,SYM:ve.SYM,Sym:ve.Sym,approxRadicals:Md.approxRadicals,approxRationalsOfLogs:Md.approxRationalsOfLogs,approxAll:Md.approxAll,testApprox:Md.testApprox,make_hashed_itab:LU.make_hashed_itab,isZeroAtomOrTensor:Lt.isZeroAtomOrTensor,isnegativenumber:Lt.isnegativenumber,isplusone:Lt.isplusone,isminusone:Lt.isminusone,isinteger:Lt.isinteger,isnonnegativeinteger:Lt.isnonnegativeinteger,isposint:Lt.isposint,isnegativeterm:Lt.isnegativeterm,isimaginarynumber:Lt.isimaginarynumber,iscomplexnumber:Lt.iscomplexnumber,iseveninteger:Lt.iseveninteger,isnegative:Lt.isnegative,issymbolic:Lt.issymbolic,isintegerfactor:Lt.isintegerfactor,isoneover:Lt.isoneover,isfraction:Lt.isfraction,isoneoversqrttwo:Lt.isoneoversqrttwo,isminusoneoversqrttwo:Lt.isminusoneoversqrttwo,isfloating:Lt.isfloating,isimaginaryunit:Lt.isimaginaryunit,isquarterturn:Lt.isquarterturn,isnpi:Lt.isnpi,equal:Ux.equal,length:Ux.length,scan:CU.scan,Find:SU.Find,get_binding:Ja.get_binding,set_binding:Ja.set_binding,usr_symbol:Ja.usr_symbol,collectUserSymbols:Ja.collectUserSymbols,init:RU.init,exec:Vb.exec,parse:Vb.parse,run:wU.run},PU=["abs","add","adj","and","approxratio","arccos","arccosh","arcsin","arcsinh","arctan","arctanh","arg","atomize","besselj","bessely","binding","binomial","ceiling","check","choose","circexp","clear","clearall","clearpatterns","clock","coeff","cofactor","condense","conj","contract","cos","cosh","decomp","defint","deg","denominator","det","derivative","dim","dirac","divisors","do","dot","draw","dsolve","eigen","eigenval","eigenvec","erf","erfc","eval","exp","expand","expcos","expsin","factor","factorial","factorpoly","filter","float","floor","for","Gamma","gcd","hermite","hilbert","imag","component","inner","integral","inv","invg","isinteger","isprime","laguerre","lcm","leading","legendre","log","mod","multiply","not","nroots","number","numerator","operator","or","outer","pattern","patternsinfo","polar","power","prime","print","print2dascii","printcomputer","printlatex","printlist","printhuman","product","quote","quotient","rank","rationalize","real","rect","roots","round","equals","shape","sgn","silentpattern","simplify","sin","sinh","sqrt","stop","subst","sum","symbolsinfo","tan","tanh","taylor","test","testeq","testge","testgt","testle","testlt","transpose","unit","zero"];Array.from(PU).map(e=>Bx[e]=Vb.exec.bind(Td,e));Td.default=Bx});DU();})();
